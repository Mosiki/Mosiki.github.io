<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>sqliteé›†æˆè¸©å‘</title>
    <link href="/sqlite-xx.html"/>
    <url>/sqlite-xx.html</url>
    
    <content type="html"><![CDATA[<p>ä»…è®°å½•ä¸€ä¸ªè¸©å‘é—®é¢˜</p><p>å­¦ä¹ éœ€è¦ï¼Œä¸æƒ³ç”¨ MySQL é‚£ä¸€å¥—ï¼Œæƒ³æä¸€ä¸ªå¯ä»¥æŒä¹…åŒ–çš„ç®€å•æ•°æ®åº“ï¼Œé¦–å…ˆæ’é™¤äº† H2ï¼Œäºæ˜¯æƒ³åˆ°ç”¨ sqliteï¼Œå¥ˆä½•æäº†åŠå¤©ï¼Œä¸€ç›´å¯åŠ¨ä¸èµ·æ¥ï¼Œåœ¨ç½‘ä¸Šæ‰¾äº†ä¸€åœˆ demoï¼ŒåŒæ ·çš„ä»£ç é…ç½®åœ¨æˆ‘çš„å·¥ç¨‹é‡Œæ„£æ˜¯è·‘ä¸èµ·æ¥ã€‚</p><a id="more"></a><p>å·®å¼‚å°±åœ¨ç½‘ä¸Šçš„ demo éƒ½æ˜¯åŸºäº maven çš„ï¼Œè€Œæˆ‘çš„å·¥ç¨‹æ˜¯ gradle çš„</p><p>æ¯”å¦‚è¿™ä¸ªï¼š<code>https://www.jianshu.com/p/85866250850c</code></p><p>ä¸‹è½½ä»–çš„å·¥ç¨‹æœ¬åœ°å¯ä»¥æ­£å¸¸è¿è¡Œä½¿ç”¨ï¼Œå®Œå…¨ copy æ–‡ç« æä¾›çš„ demo é…ç½®åˆ°è‡ªå·±çš„ gradle å·¥ç¨‹ä¸­ï¼Œè¿è¡Œå°±æç¤º</p><figure class="highlight reasonml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs reasonml"><br>Failed <span class="hljs-keyword">to</span> load ApplicationContext<br>java.lang.IllegalStateException: Failed <span class="hljs-keyword">to</span> load ApplicationContext<br>at org.springframework.test.context.cache.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DefaultCacheAwareContextLoaderDelegate</span>.</span></span>load<span class="hljs-constructor">Context(DefaultCacheAwareContextLoaderDelegate.<span class="hljs-params">java</span>:132)</span><br>at org.springframework.test.context.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DefaultTestContext</span>.</span></span>get<span class="hljs-constructor">ApplicationContext(DefaultTestContext.<span class="hljs-params">java</span>:123)</span><br>at org.springframework.test.context.web.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ServletTestExecutionListener</span>.</span></span>set<span class="hljs-constructor">UpRequestContextIfNecessary(ServletTestExecutionListener.<span class="hljs-params">java</span>:190)</span><br>at org.springframework.test.context.web.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ServletTestExecutionListener</span>.</span></span>prepare<span class="hljs-constructor">TestInstance(ServletTestExecutionListener.<span class="hljs-params">java</span>:132)</span><br>at org.springframework.test.context.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">TestContextManager</span>.</span></span>prepare<span class="hljs-constructor">TestInstance(TestContextManager.<span class="hljs-params">java</span>:244)</span><br>at org.springframework.test.context.junit4.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringJUnit4ClassRunner</span>.</span></span>create<span class="hljs-constructor">Test(SpringJUnit4ClassRunner.<span class="hljs-params">java</span>:227)</span><br>at org.springframework.test.context.junit4.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringJUnit4ClassRunner$1</span>.</span></span>run<span class="hljs-constructor">ReflectiveCall(SpringJUnit4ClassRunner.<span class="hljs-params">java</span>:289)</span><br>at org.junit.internal.runners.model.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ReflectiveCallable</span>.</span></span>run(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ReflectiveCallable</span>.</span></span>java:<span class="hljs-number">12</span>)<br>at org.springframework.test.context.junit4.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringJUnit4ClassRunner</span>.</span></span><span class="hljs-keyword">method</span><span class="hljs-constructor">Block(SpringJUnit4ClassRunner.<span class="hljs-params">java</span>:291)</span><br>at org.springframework.test.context.junit4.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringJUnit4ClassRunner</span>.</span></span>run<span class="hljs-constructor">Child(SpringJUnit4ClassRunner.<span class="hljs-params">java</span>:246)</span><br>at org.springframework.test.context.junit4.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringJUnit4ClassRunner</span>.</span></span>run<span class="hljs-constructor">Child(SpringJUnit4ClassRunner.<span class="hljs-params">java</span>:97)</span><br>at org.junit.runners.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ParentRunner$4</span>.</span></span>run(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ParentRunner</span>.</span></span>java:<span class="hljs-number">331</span>)<br>at org.junit.runners.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ParentRunner$1</span>.</span></span>schedule(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ParentRunner</span>.</span></span>java:<span class="hljs-number">79</span>)<br>at org.junit.runners.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ParentRunner</span>.</span></span>run<span class="hljs-constructor">Children(ParentRunner.<span class="hljs-params">java</span>:329)</span><br>at org.junit.runners.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ParentRunner</span>.</span></span>access<span class="hljs-constructor">$100(ParentRunner.<span class="hljs-params">java</span>:66)</span><br>at org.junit.runners.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ParentRunner$2</span>.</span></span>evaluate(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ParentRunner</span>.</span></span>java:<span class="hljs-number">293</span>)<br>at org.springframework.test.context.junit4.statements.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">RunBeforeTestClassCallbacks</span>.</span></span>evaluate(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">RunBeforeTestClassCallbacks</span>.</span></span>java:<span class="hljs-number">61</span>)<br>at org.springframework.test.context.junit4.statements.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">RunAfterTestClassCallbacks</span>.</span></span>evaluate(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">RunAfterTestClassCallbacks</span>.</span></span>java:<span class="hljs-number">70</span>)<br>at org.junit.runners.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ParentRunner$3</span>.</span></span>evaluate(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ParentRunner</span>.</span></span>java:<span class="hljs-number">306</span>)<br>at org.junit.runners.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ParentRunner</span>.</span></span>run(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ParentRunner</span>.</span></span>java:<span class="hljs-number">413</span>)<br>at org.springframework.test.context.junit4.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringJUnit4ClassRunner</span>.</span></span>run(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringJUnit4ClassRunner</span>.</span></span>java:<span class="hljs-number">190</span>)<br>at org.gradle.api.internal.tasks.testing.junit.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">JUnitTestClassExecutor</span>.</span></span>run<span class="hljs-constructor">TestClass(JUnitTestClassExecutor.<span class="hljs-params">java</span>:110)</span><br>at org.gradle.api.internal.tasks.testing.junit.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">JUnitTestClassExecutor</span>.</span></span>execute(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">JUnitTestClassExecutor</span>.</span></span>java:<span class="hljs-number">58</span>)<br>at org.gradle.api.internal.tasks.testing.junit.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">JUnitTestClassExecutor</span>.</span></span>execute(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">JUnitTestClassExecutor</span>.</span></span>java:<span class="hljs-number">38</span>)<br>at org.gradle.api.internal.tasks.testing.junit.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractJUnitTestClassProcessor</span>.</span></span>process<span class="hljs-constructor">TestClass(AbstractJUnitTestClassProcessor.<span class="hljs-params">java</span>:62)</span><br>at org.gradle.api.internal.tasks.testing.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SuiteTestClassProcessor</span>.</span></span>process<span class="hljs-constructor">TestClass(SuiteTestClassProcessor.<span class="hljs-params">java</span>:51)</span><br>at java.base/jdk.internal.reflect.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">NativeMethodAccessorImpl</span>.</span></span>invoke0(Native Method)<br>at java.base/jdk.internal.reflect.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">NativeMethodAccessorImpl</span>.</span></span>invoke(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">NativeMethodAccessorImpl</span>.</span></span>java:<span class="hljs-number">62</span>)<br>at java.base/jdk.internal.reflect.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DelegatingMethodAccessorImpl</span>.</span></span>invoke(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DelegatingMethodAccessorImpl</span>.</span></span>java:<span class="hljs-number">43</span>)<br>at java.base/java.lang.reflect.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Method</span>.</span></span>invoke(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Method</span>.</span></span>java:<span class="hljs-number">566</span>)<br>at org.gradle.internal.dispatch.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ReflectionDispatch</span>.</span></span>dispatch(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ReflectionDispatch</span>.</span></span>java:<span class="hljs-number">36</span>)<br>at org.gradle.internal.dispatch.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ReflectionDispatch</span>.</span></span>dispatch(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ReflectionDispatch</span>.</span></span>java:<span class="hljs-number">24</span>)<br>at org.gradle.internal.dispatch.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ContextClassLoaderDispatch</span>.</span></span>dispatch(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ContextClassLoaderDispatch</span>.</span></span>java:<span class="hljs-number">33</span>)<br>at org.gradle.internal.dispatch.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ProxyDispatchAdapter$DispatchingInvocationHandler</span>.</span></span>invoke(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ProxyDispatchAdapter</span>.</span></span>java:<span class="hljs-number">94</span>)<br>at com.sun.proxy.$<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Proxy2</span>.</span></span>process<span class="hljs-constructor">TestClass(Unknown Source)</span><br>at org.gradle.api.internal.tasks.testing.worker.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">TestWorker</span>.</span></span>process<span class="hljs-constructor">TestClass(TestWorker.<span class="hljs-params">java</span>:118)</span><br>at java.base/jdk.internal.reflect.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">NativeMethodAccessorImpl</span>.</span></span>invoke0(Native Method)<br>at java.base/jdk.internal.reflect.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">NativeMethodAccessorImpl</span>.</span></span>invoke(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">NativeMethodAccessorImpl</span>.</span></span>java:<span class="hljs-number">62</span>)<br>at java.base/jdk.internal.reflect.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DelegatingMethodAccessorImpl</span>.</span></span>invoke(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DelegatingMethodAccessorImpl</span>.</span></span>java:<span class="hljs-number">43</span>)<br>at java.base/java.lang.reflect.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Method</span>.</span></span>invoke(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Method</span>.</span></span>java:<span class="hljs-number">566</span>)<br>at org.gradle.internal.dispatch.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ReflectionDispatch</span>.</span></span>dispatch(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ReflectionDispatch</span>.</span></span>java:<span class="hljs-number">36</span>)<br>at org.gradle.internal.dispatch.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ReflectionDispatch</span>.</span></span>dispatch(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ReflectionDispatch</span>.</span></span>java:<span class="hljs-number">24</span>)<br>at org.gradle.internal.remote.internal.hub.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageHubBackedObjectConnection$DispatchWrapper</span>.</span></span>dispatch(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageHubBackedObjectConnection</span>.</span></span>java:<span class="hljs-number">182</span>)<br>at org.gradle.internal.remote.internal.hub.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageHubBackedObjectConnection$DispatchWrapper</span>.</span></span>dispatch(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageHubBackedObjectConnection</span>.</span></span>java:<span class="hljs-number">164</span>)<br>at org.gradle.internal.remote.internal.hub.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageHub$Handler</span>.</span></span>run(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MessageHub</span>.</span></span>java:<span class="hljs-number">412</span>)<br>at org.gradle.internal.concurrent.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ExecutorPolicy$CatchAndRecordFailures</span>.</span></span>on<span class="hljs-constructor">Execute(ExecutorPolicy.<span class="hljs-params">java</span>:64)</span><br>at org.gradle.internal.concurrent.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ManagedExecutorImpl$1</span>.</span></span>run(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ManagedExecutorImpl</span>.</span></span>java:<span class="hljs-number">48</span>)<br>at java.base/java.util.concurrent.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ThreadPoolExecutor</span>.</span></span>run<span class="hljs-constructor">Worker(ThreadPoolExecutor.<span class="hljs-params">java</span>:1128)</span><br>at java.base/java.util.concurrent.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ThreadPoolExecutor$Worker</span>.</span></span>run(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ThreadPoolExecutor</span>.</span></span>java:<span class="hljs-number">628</span>)<br>at org.gradle.internal.concurrent.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ThreadFactoryImpl$ManagedThreadRunnable</span>.</span></span>run(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ThreadFactoryImpl</span>.</span></span>java:<span class="hljs-number">56</span>)<br>at java.base/java.lang.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Thread</span>.</span></span>run(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Thread</span>.</span></span>java:<span class="hljs-number">834</span>)<br>Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean <span class="hljs-keyword">with</span> name &#x27;userMapper&#x27; defined <span class="hljs-keyword">in</span> file <span class="hljs-literal">[<span class="hljs-operator">/</span>U<span class="hljs-identifier">sers</span><span class="hljs-operator">/</span><span class="hljs-identifier">wejan</span><span class="hljs-operator">/</span>C<span class="hljs-identifier">oding</span><span class="hljs-operator">/</span>P<span class="hljs-identifier">rojects</span><span class="hljs-operator">/</span><span class="hljs-number">2021</span><span class="hljs-operator">/</span><span class="hljs-identifier">test</span>-<span class="hljs-identifier">sqlite2</span><span class="hljs-operator">/</span><span class="hljs-identifier">build</span><span class="hljs-operator">/</span><span class="hljs-identifier">classes</span><span class="hljs-operator">/</span><span class="hljs-identifier">java</span><span class="hljs-operator">/</span><span class="hljs-identifier">main</span><span class="hljs-operator">/</span><span class="hljs-identifier">com</span><span class="hljs-operator">/</span><span class="hljs-identifier">shinemo</span><span class="hljs-operator">/</span><span class="hljs-identifier">baas</span><span class="hljs-operator">/</span><span class="hljs-identifier">repository</span><span class="hljs-operator">/</span><span class="hljs-identifier">mapper</span><span class="hljs-operator">/</span>U<span class="hljs-identifier">serMapper</span>.<span class="hljs-identifier">class</span>]</span>: Invocation <span class="hljs-keyword">of</span> init <span class="hljs-keyword">method</span> failed; nested <span class="hljs-keyword">exception</span> is java.lang.IllegalArgumentException: Property &#x27;sqlSessionFactory&#x27; <span class="hljs-keyword">or</span> &#x27;sqlSessionTemplate&#x27; are required<br>at org.springframework.beans.factory.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractAutowireCapableBeanFactory</span>.</span></span>initialize<span class="hljs-constructor">Bean(AbstractAutowireCapableBeanFactory.<span class="hljs-params">java</span>:1794)</span><br>at org.springframework.beans.factory.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractAutowireCapableBeanFactory</span>.</span></span><span class="hljs-keyword">do</span><span class="hljs-constructor">CreateBean(AbstractAutowireCapableBeanFactory.<span class="hljs-params">java</span>:594)</span><br>at org.springframework.beans.factory.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractAutowireCapableBeanFactory</span>.</span></span>create<span class="hljs-constructor">Bean(AbstractAutowireCapableBeanFactory.<span class="hljs-params">java</span>:516)</span><br>at org.springframework.beans.factory.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractBeanFactory</span>.</span></span>lambda<span class="hljs-constructor">$doGetBean$0(AbstractBeanFactory.<span class="hljs-params">java</span>:324)</span><br>at org.springframework.beans.factory.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DefaultSingletonBeanRegistry</span>.</span></span>get<span class="hljs-constructor">Singleton(DefaultSingletonBeanRegistry.<span class="hljs-params">java</span>:226)</span><br>at org.springframework.beans.factory.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractBeanFactory</span>.</span></span><span class="hljs-keyword">do</span><span class="hljs-constructor">GetBean(AbstractBeanFactory.<span class="hljs-params">java</span>:322)</span><br>at org.springframework.beans.factory.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractBeanFactory</span>.</span></span>get<span class="hljs-constructor">Bean(AbstractBeanFactory.<span class="hljs-params">java</span>:202)</span><br>at org.springframework.beans.factory.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DefaultListableBeanFactory</span>.</span></span>pre<span class="hljs-constructor">InstantiateSingletons(DefaultListableBeanFactory.<span class="hljs-params">java</span>:878)</span><br>at org.springframework.context.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractApplicationContext</span>.</span></span>finish<span class="hljs-constructor">BeanFactoryInitialization(AbstractApplicationContext.<span class="hljs-params">java</span>:879)</span><br>at org.springframework.context.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractApplicationContext</span>.</span></span>refresh(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractApplicationContext</span>.</span></span>java:<span class="hljs-number">551</span>)<br>at org.springframework.boot.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringApplication</span>.</span></span>refresh(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringApplication</span>.</span></span>java:<span class="hljs-number">758</span>)<br>at org.springframework.boot.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringApplication</span>.</span></span>refresh(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringApplication</span>.</span></span>java:<span class="hljs-number">750</span>)<br>at org.springframework.boot.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringApplication</span>.</span></span>refresh<span class="hljs-constructor">Context(SpringApplication.<span class="hljs-params">java</span>:397)</span><br>at org.springframework.boot.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringApplication</span>.</span></span>run(<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringApplication</span>.</span></span>java:<span class="hljs-number">315</span>)<br>at org.springframework.boot.test.context.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SpringBootContextLoader</span>.</span></span>load<span class="hljs-constructor">Context(SpringBootContextLoader.<span class="hljs-params">java</span>:120)</span><br>at org.springframework.test.context.cache.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DefaultCacheAwareContextLoaderDelegate</span>.</span></span>load<span class="hljs-constructor">ContextInternal(DefaultCacheAwareContextLoaderDelegate.<span class="hljs-params">java</span>:99)</span><br>at org.springframework.test.context.cache.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DefaultCacheAwareContextLoaderDelegate</span>.</span></span>load<span class="hljs-constructor">Context(DefaultCacheAwareContextLoaderDelegate.<span class="hljs-params">java</span>:124)</span><br><span class="hljs-operator">... </span><span class="hljs-number">50</span> more<br>Caused by: java.lang.IllegalArgumentException: Property &#x27;sqlSessionFactory&#x27; <span class="hljs-keyword">or</span> &#x27;sqlSessionTemplate&#x27; are required<br>at org.springframework.util.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Assert</span>.</span></span>not<span class="hljs-constructor">Null(Assert.<span class="hljs-params">java</span>:201)</span><br>at org.mybatis.spring.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">SqlSessionDaoSupport</span>.</span></span>check<span class="hljs-constructor">DaoConfig(SqlSessionDaoSupport.<span class="hljs-params">java</span>:122)</span><br>at org.mybatis.spring.mapper.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">MapperFactoryBean</span>.</span></span>check<span class="hljs-constructor">DaoConfig(MapperFactoryBean.<span class="hljs-params">java</span>:73)</span><br>at org.springframework.dao.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DaoSupport</span>.</span></span>after<span class="hljs-constructor">PropertiesSet(DaoSupport.<span class="hljs-params">java</span>:44)</span><br>at org.springframework.beans.factory.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractAutowireCapableBeanFactory</span>.</span></span>invoke<span class="hljs-constructor">InitMethods(AbstractAutowireCapableBeanFactory.<span class="hljs-params">java</span>:1853)</span><br>at org.springframework.beans.factory.support.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AbstractAutowireCapableBeanFactory</span>.</span></span>initialize<span class="hljs-constructor">Bean(AbstractAutowireCapableBeanFactory.<span class="hljs-params">java</span>:1790)</span><br><span class="hljs-operator">... </span><span class="hljs-number">66</span> more<br><br></code></pre></div></td></tr></table></figure><p>ä¸€ç•ªæ’æŸ¥æ‰å‘ç°æŒ‰ç…§ç½‘ä¸Šçš„é…ç½®ä¸è¡Œè¦æ”¹æˆå¦‚ä¸‹</p><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">datasource:</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:sqlite::resource:db/test.db</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">org.sqlite.SQLiteDataSource</span><br>    <span class="hljs-comment">#driver-class-name: org.sqlite.JDBC</span><br></code></pre></div></td></tr></table></figure><p>å¦‚æœ <strong>type</strong> å‚æ•°æœªæŒ‡å®šï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>GithubPagesåšå®¢è‡ªå®šä¹‰åŸŸåHTTPSåŒ–</title>
    <link href="/github-pages-https.html"/>
    <url>/github-pages-https.html</url>
    
    <content type="html"><![CDATA[<p>ç©åšå®¢ä» 16 å¹´åˆ°ç°åœ¨ï¼Œä¸»é¢˜ä¸çŸ¥é“æ¢äº†å¤šå°‘ä¸ªï¼Œä½†æ˜¯å›¾åºŠæœåŠ¡ä¸€ç›´ä¾èµ–çš„ä¸ƒç‰›äº‘æ²¡æœ‰æ¢è¿‡ï¼Œä¹Ÿè®¸æ˜¯ç™½å«–æƒ¯äº†ï¼Œæ²¡å¾€ä¸ƒç‰›äº‘å……è¿‡ä¸€æ¯›é’±ï¼Œç”šè‡³è´¦å•é‡Œæ˜¾ç¤ºæ¬ äº† 2 å—é’± ğŸ˜†ã€‚<br>å‡ ä¸ªæœˆå‰ä¸ƒç‰›äº‘æ›´æ”¹äº†æµ‹è¯•åŸŸåçš„é™åˆ¶ï¼Œæ¯ä¸ª bucket åˆ†é…çš„åŸŸååªæœ‰ä¸€ä¸ªæœˆçš„æœ‰æ•ˆæœŸï¼Œåˆ°æœŸè‡ªåŠ¨é‡Šæ”¾æ— æ³•ä½¿ç”¨ã€‚å› ä¸ºè¿™ä¸ªåŸå› ï¼Œä¸´æ—¶ç”¨äº†ä¸ƒç‰›ç‰çš„æ–‡ä»¶åŒæ­¥æœåŠ¡ï¼Œæ¯ä¸ªæœˆæ–°å¢ä¸€ä¸ª bucketï¼Œç„¶åå†æŠŠåŸŸåé‡Šæ”¾äº†çš„ bucket åŒæ­¥åˆ°æ–°çš„ bucket ä¸­ï¼Œå†æ‰‹åŠ¨å…¨å±€æ›¿æ¢åšå®¢ä¸­æ‰€æœ‰å›¾ç‰‡çš„åŸŸåï¼Œå¾ˆæ˜¯éº»çƒ¦ã€‚ä½†æ˜¯ä¹Ÿä¸€ç›´æ²¡æ‰¾åˆ°è§£å†³çš„æ–¹æ³•ã€‚<br>è€Œä¸”å› ä¸ºä¸ƒç‰›äº‘çš„æµ‹è¯•åŸŸåæ˜¯ http çš„ï¼Œä¹Ÿä¸€ç›´å› ä¸ºè¿™ä¸ªåŸå› ï¼Œå¯¼è‡´åšå®¢è¿Ÿè¿Ÿæ²¡æœ‰è¿™ä¹ˆä¹… HTTPS åŒ–ã€‚<br>ç›´åˆ°å‰ä¸¤å¤©ï¼Œå®åœ¨å—ä¸äº†æ¯ä¸ªæœˆçš„é‡å¤æœºæ¢°æ“ä½œï¼Œæƒ³åŠæ³•è§£å†³äº†å›¾åºŠçš„é—®é¢˜ï¼ŒåŒæ—¶é¡ºä¾¿æŠŠåšå®¢ææˆäº† HTTPSï¼Œä»¥ä¾›å‚è€ƒã€‚</p><a id="more"></a><h2 id="å›¾åºŠè¿ç§»"><a href="#å›¾åºŠè¿ç§»" class="headerlink" title="å›¾åºŠè¿ç§»"></a>å›¾åºŠè¿ç§»</h2><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨ https åŸŸåç½‘é¡µä¸­ï¼Œæ— æ³•å¼•ç”¨é https çš„èµ„æºï¼Œæ¯”å¦‚å›¾ç‰‡ï¼Œä¼šå¯¼è‡´èµ„æºæ— æ³•åŠ è½½ã€‚<br>æ‰€ä»¥å¦‚æœæƒ³è¦å°†åšå®¢ HTTPS åŒ–ï¼Œé¦–å½“å…¶å†²å°±æ˜¯è§£å†³å›¾åºŠçš„é—®é¢˜ï¼Œå³éœ€è¦ä¸€ä¸ª https çš„å›¾åºŠã€‚<br>å¦‚æœä½¿ç”¨ä¸ƒç‰›äº‘ï¼Œåªèƒ½è‡ªå®šä¹‰åŸŸåï¼Œç¬”è€…æ²¡æœ‰å…¶ä»–çš„åŸŸåï¼Œä¹Ÿè§‰å¾—å¤‡æ¡ˆæµç¨‹å¾ˆéº»çƒ¦ï¼Œåªèƒ½æ”¾å¼ƒè¿™ä¸€æƒ³æ³•ã€‚<br>å¦‚æœä½¿ç”¨å…¬å¼€çš„å…¶ä»–å›¾åºŠï¼Œåˆå®³æ€•ä¸å¤Ÿç¨³å®šï¼Œå¯¼è‡´èµ„æºå›¾ç‰‡å…¨éƒ¨ä¸¢å¤±å°±å¤ªä¸åˆ’ç®—äº†ï¼Œè¿™æ¡è·¯ä¹Ÿåªèƒ½æ”¾å¼ƒã€‚<br>æœ€ç»ˆé€‰æ‹©åœ¨ github ä¸Šå¼€äº†ä¸€ä¸ª<a href="https://github.com/Mosiki/blog-imgs">æ–°çš„ä»“åº“</a>ï¼Œä¸“é—¨ç”¨äºå­˜æ”¾åšå®¢çš„å›¾ç‰‡ä¸èµ„æºã€‚</p><p>ä¸ƒç‰›äº‘æä¾›äº†ä¸€ä¸ª <a href="https://developer.qiniu.com/kodo/1302/qshell#2">qshell</a> å·¥å…·å¯ä»¥å¿«é€Ÿä¸‹è½½ bucket ä¸­çš„æ‰€æœ‰æ–‡ä»¶</p><p>é¦–å…ˆå»<a href="https://portal.qiniu.com/user/key">ä¸ƒç‰›äº‘åå°</a> è·å– ak/sk</p><p>ç„¶åè®¾ç½® qshell çš„å¯†é’¥</p><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli"><span class="hljs-string">./qshell</span> account ak sk<br></code></pre></div></td></tr></table></figure><p>å†æ·»åŠ ä¸€ä¸ª qn.conf é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹dest_dir ä¸ºä¿å­˜ä¸‹è½½æ–‡ä»¶çš„ä½ç½®ï¼Œä¿®æ”¹ bucket ä¸ºä½ çš„ä¸ƒç‰›å­˜å‚¨åº“åç§°ï¼Œcdn_domain ä¿®æ”¹ä¸º bucket åˆ†é…çš„æµ‹è¯•åŸŸåï¼ˆå¦‚æœæµ‹è¯•åŸŸååˆ°æœŸäº†ï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ªä¸åŒäºå½“å‰ bucketåŒºåŸŸçš„ bucketï¼Œæ¯”å¦‚å½“å‰æ˜¯ååŒ—çš„ï¼Œå°±åˆ›å»ºä¸€ä¸ªåå—çš„ bucketï¼Œå¯ä»¥é€šè¿‡è·¨åŒºåŸŸåŒæ­¥å°†æ—§çš„ bucket æ–‡ä»¶åŒæ­¥åˆ°æ–°çš„ bucket ä¸­ï¼Œé…ç½®ä¸­çš„ bucket å€¼ä¹Ÿè¦æ”¹æˆæ–°çš„ bucket åç§°ï¼‰</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;dest_dir&quot;</span>   :   <span class="hljs-string">&quot;/home/wejan/Desktop/images&quot;</span>,<br>    <span class="hljs-attr">&quot;bucket&quot;</span>     :   <span class="hljs-string">&quot;test-bucket&quot;</span>,<br>    <span class="hljs-attr">&quot;prefix&quot;</span>     :   <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-attr">&quot;suffixes&quot;</span>   :   <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-attr">&quot;cdn_domain&quot;</span> :   <span class="hljs-string">&quot;http://opvasdfx.bkt.clouddn.com&quot;</span>,<br>    <span class="hljs-attr">&quot;referer&quot;</span>    :   <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-attr">&quot;log_file&quot;</span>   :   <span class="hljs-string">&quot;download.log&quot;</span>,<br>    <span class="hljs-attr">&quot;log_level&quot;</span>  :   <span class="hljs-string">&quot;info&quot;</span>,<br>    <span class="hljs-attr">&quot;log_rotate&quot;</span> :   <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;log_stdout&quot;</span> :   <span class="hljs-literal">false</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±æ˜¯ä½¿ç”¨ qshell æ¥ä¸‹è½½æ–‡ä»¶äº†ï¼ˆå¦‚æœæ˜¯ä½¿ç”¨äº†è·¨åŒºåŸŸåŒæ­¥ï¼Œéœ€è¦ç­‰å¾…æ–‡ä»¶å…¨éƒ¨åŒæ­¥å®Œæˆåå†è¿›è¡Œï¼‰ã€‚</p><figure class="highlight armasm"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs armasm">./qshell download <span class="hljs-meta">qn</span>.conf<br></code></pre></div></td></tr></table></figure><p>ç­‰å¾…å…¨éƒ¨ä¸‹è½½å®Œæ¯•å°±å¥½äº†ã€‚</p><p>ä¸‹é¢å°±æ˜¯å» GitHub åˆ›å»ºä¸€ä¸ªä»“åº“ï¼Œå°†ä¸‹è½½çš„æ–‡ä»¶å…¨éƒ¨æ¨é€åˆ°è¿™ä¸ªä»“åº“ä¸­ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs csharp">cd /home/wejan/Desktop/images <span class="hljs-comment">// è¿›å…¥ä¸‹è½½ç›®å½•</span><br>git <span class="hljs-keyword">init</span><br>git <span class="hljs-keyword">add</span> *<br>git commit -m <span class="hljs-string">&quot;init&quot;</span><br>git remote <span class="hljs-keyword">add</span> origin git@github.com:Mosiki/blog-imgs.git   <span class="hljs-comment">// ä¿®æ”¹æˆä½ ç”¨äºå­˜æ”¾å›¾ç‰‡çš„ repo åœ°å€</span><br>git push origin<br></code></pre></div></td></tr></table></figure><h2 id="å›¾åºŠåŠ é€Ÿ"><a href="#å›¾åºŠåŠ é€Ÿ" class="headerlink" title="å›¾åºŠåŠ é€Ÿ"></a>å›¾åºŠåŠ é€Ÿ</h2><p>ç”±äºå›½å†…ç½‘ç»œç¯å¢ƒçš„åŸå› ï¼Œå¯èƒ½ GitHub ä¸Šçš„å›¾ç‰‡æ— æ³•åŠ è½½å‡ºæ¥ï¼Œå°±éœ€è¦ç”¨åˆ°åŠ é€ŸæœåŠ¡ï¼Œä¹Ÿæ˜¯å…è´¹çš„ã€‚<br>æ–‡ä»¶å‰ç¼€æ ¼å¼æ”¹æˆå¦‚ä¸‹ï¼š<br><code>https://cdn.jsdelivr.net/gh/GitHub ç”¨æˆ·å/ä»“åº“åç§°/</code><br>ä¾‹å¦‚ç¬”è€…çš„ï¼š<br><code>https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs</code></p><p>æ–‡ä»¶åŸé“¾æ¥(/blog æ˜¯ blog-imgs ä¸‹çš„ä¸€ä¸ªç›®å½•åç§°)ï¼š<br><code>https://raw.githubusercontent.com/Mosiki/blog-imgs/master/blog/avatar.png</code><br>åŠ é€Ÿåçš„é“¾æ¥ï¼š<br><code>https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/avatar.png</code></p><p>æ‰¹é‡æŠŠåšå®¢ä¸é…ç½®ä¸­çš„å›¾ç‰‡å‰ç¼€æ›¿æ¢æˆåŠ é€ŸåŸŸå <code>https://cdn.jsdelivr.net/gh/GitHub ç”¨æˆ·å/ä»“åº“åç§°/</code> </p><p>åœ¨ç½‘ä¸Šæ‰¾äº†æ‰¹é‡æ›¿æ¢çš„è„šæœ¬å‘ç°éƒ½è¿è¡Œä¸äº†ï¼Œç´¢æ€§ç›´æ¥ç”¨ idea æ‰“å¼€ hexo çš„ç›®å½• <code>command + shift + r</code> è¿›è¡Œå…¨å±€åŸŸåæ›¿æ¢ã€‚</p><h2 id="å›¾åºŠä¸Šä¼ é…ç½®"><a href="#å›¾åºŠä¸Šä¼ é…ç½®" class="headerlink" title="å›¾åºŠä¸Šä¼ é…ç½®"></a>å›¾åºŠä¸Šä¼ é…ç½®</h2><p>å›¾åºŠé…ç½®å¥½äº†ï¼Œä¸ºäº†æ–¹ä¾¿ä¸Šä¼ å›¾ç‰‡åˆ°æ–°å›¾åºŠä¸­ï¼Œç¬”è€…ä½¿ç”¨äº† <a href="https://molunerfinn.com/PicGo/">PicGO</a> è¿™ä¸ªå·¥å…·ã€‚å¯ä»¥ç›´æ¥å°† GitHub å½“æˆå›¾åºŠä½¿ç”¨ï¼Œé…ç½®å¥½è‡ªå®šä¹‰é“¾æ¥ï¼Œä¸Šä¼ å›¾ç‰‡åï¼Œå¯ä»¥ç›´æ¥ç”ŸæˆåŠ é€Ÿåçš„å›¾åºŠé“¾æ¥ã€‚å…·ä½“é…ç½®å‚è§ <a href="https://picgo.github.io/PicGo-Doc/zh/guide/config.html#github%E5%9B%BE%E5%BA%8A">PicGO çš„æ–‡æ¡£</a></p><p>ä¸ºäº†ç›´æ¥ç”ŸæˆåŠ é€Ÿçš„å›¾åºŠé“¾æ¥ï¼Œè¿˜éœ€è¦ä¸€ç‚¹å°å·¥ä½œã€‚å¯ä»¥å‚è€ƒç¬”è€…çš„é…ç½®ï¼Œä¿®æ”¹ä¸ºä½ çš„ä»“åº“ï¼Œä»¥åå°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä½¿ç”¨ GitHub å›¾åºŠäº†~<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/2021/06/18/1624027216546.png"></p><h2 id="åšå®¢HTTPSåŒ–"><a href="#åšå®¢HTTPSåŒ–" class="headerlink" title="åšå®¢HTTPSåŒ–"></a>åšå®¢HTTPSåŒ–</h2><p>å•°é‡Œå§å—¦äº†åŠå¤©ï¼Œç»ˆäºæ¥åˆ°æœ¬æ–‡ä¸»é¢˜ï¼Œå¦‚ä½•å®ç°åšå®¢è‡ªå®šä¹‰åŸŸå https åŒ–ï¼Œå…¶å®è¿™ä¸ª GitHub å·²ç»æä¾›äº†è¿™ä¸ªåŠŸèƒ½ï¼Œä¹Ÿæ— éœ€å€ŸåŠ©å…¶ä»–çš„ä»»ä½•ç¬¬ä¸‰æ–¹æœåŠ¡å³å¯å®ç°ã€‚</p><p>ç™»å½•ä½ çš„åŸŸåç®¡ç†åå°ï¼Œç¬”è€…æ˜¯åœ¨ DNSpodï¼Œæ·»åŠ å¦‚ä¸‹ä¸¤æ¡ A è®°å½•å’Œä¸€æ¡ CNAME é…ç½®</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/2021/06/18/1624027404191.png"></p><p>ç¬”è€…åšå®¢çš„ä»“åº“æ˜¯ <code>mosiki.github.io</code> æ‰€ä»¥åœ¨ CNAME è®°å½•ä¸­çš„å€¼å¡«çš„æ˜¯ <code>mosiki.github.io.</code> è¿™é‡Œæ”¹æˆä½ è‡ªå·±çš„åšå®¢ repo åœ°å€å³å¯ã€‚ </p><p>æ‰“å¼€åšå®¢ repo çš„ setting -&gt; pages é¡µé¢ï¼Œå‹¾é€‰å¼€å¯ https çš„æŒ‰é’®ï¼Œç­‰å¾…è‡ªåŠ¨é…ç½®è¯ä¹¦å³å¯ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/2021/06/18/1624027675363.png"></p><p>å†è®¿é—®ä½ çš„åšå®¢ï¼Œçœ‹æ˜¯å¦ https å·²ç»ç”Ÿæ•ˆäº†å‘¢~</p><p>æœ¬æ–‡å®Œ~</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å‡½æ•°å¼ç¼–ç¨‹ç‰›åˆ€å°è¯•-æ›´ä¼˜é›…åœ°è¿›è¡Œæ¥å£é‡è¯•è°ƒç”¨</title>
    <link href="/retry-method-invoke.html"/>
    <url>/retry-method-invoke.html</url>
    
    <content type="html"><![CDATA[<p>èƒŒæ™¯æ˜¯é¡¹ç›®å±äºå¾®æœåŠ¡æ¶æ„ï¼Œé¡¹ç›®ä¹‹é—´æ— æ³•é¿å…åœ°éœ€è¦è¿›è¡Œæ¥å£è°ƒç”¨ï¼Œå…¬å¸ä½¿ç”¨çš„æ˜¯å†…éƒ¨å¼€å‘çš„ RPC æ¡†æ¶ï¼Œæ¡†æ¶ä¸æ”¯æŒé‡è¯•æœºåˆ¶ã€‚</p><p>åœ¨æ—¥å¸¸çš„ä¸šåŠ¡å¼€å‘å½“ä¸­ï¼Œè‡ªå·±çš„æœåŠ¡ç³»ç»Ÿå¾€å¾€ä¾èµ–å¤šä¸ªå…¶ä»–æœåŠ¡ï¼Œä½†æ˜¯æ— æ³•ä¿è¯ä¾èµ–æœåŠ¡çš„ç¨³å®šæ€§ï¼Œå¦‚æœå‡ºç°ä¾èµ–æœåŠ¡çŸ­æš‚ä¸å¯ç”¨å°±ä¼šå¯¼è‡´è‡ªå·±çš„æœåŠ¡å‡ºç°é—®é¢˜ã€‚</p><p>è¿™ç§é—®é¢˜å¾ˆçƒ¦ï¼Œä½†æ˜¯åˆæ— å¯é¿å…ï¼Œåªèƒ½é‡‡å–å…¶ä»–çš„é€”å¾„å°½é‡å‡å°‘è¿™ç§é—®é¢˜çš„å‘ç”Ÿï¼Œè€Œæ¥å£è°ƒç”¨é‡è¯•ä¾¿æ˜¯æœ€ç®€å•çš„æ–¹å¼ã€‚</p><a id="more"></a><p>æœ€è¿‘åœ¨é‡æ„è‡ªå·±ä»¥å‰å†™çš„ä»£ç ï¼Œä¾èµ–æ¥å£è°ƒç”¨çš„é‡è¯•æ˜¯é€šè¿‡é€’å½’æ¥å®ç°çš„ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">getUser</span><span class="hljs-params">(Long uid, <span class="hljs-keyword">int</span> retryCount)</span> </span>&#123;<br>    User info = <span class="hljs-keyword">new</span> User();<br>    <span class="hljs-keyword">int</span> ret = userClient.getUser(uid, info);<br>    <span class="hljs-keyword">if</span> (RetCode.RET_SUCCESS == ret) &#123;<br>        <span class="hljs-keyword">return</span> info;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (retryCount &gt; <span class="hljs-number">0</span>) &#123;<br>        sleep3ms();<br>        <span class="hljs-keyword">return</span> getUser(uid, --retryCount);<br>    &#125;<br>    log.error(<span class="hljs-string">&quot;getUser fail.  ret: &#123;&#125;, uid: &#123;&#125;&quot;</span>, ret, uid);<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ApiException(<span class="hljs-string">&quot;è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥&quot;</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> OrgInfo <span class="hljs-title">getOrg</span><span class="hljs-params">(Long orgId, <span class="hljs-keyword">int</span> retryCount)</span> </span>&#123;<br>    OrgInfo info = <span class="hljs-keyword">new</span> OrgInfo();<br>    <span class="hljs-keyword">int</span> ret = orgClient.getOrg(orgId, info);<br>    <span class="hljs-keyword">if</span> (RetCode.RET_SUCCESS == ret) &#123;<br>        <span class="hljs-keyword">return</span> info;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (retryCount &gt; <span class="hljs-number">0</span>) &#123;<br>        sleep3ms();<br>        <span class="hljs-keyword">return</span> getOrg(orgId, --retryCount);<br>    &#125;<br>    log.error(<span class="hljs-string">&quot;getOrg fail.  ret: &#123;&#125;, orgId: &#123;&#125;&quot;</span>, ret, orgId);<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ApiException(<span class="hljs-string">&quot;è·å–ä¼ä¸šä¿¡æ¯å¤±è´¥&quot;</span>);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sleep3ms</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        Thread.sleep(<span class="hljs-number">3</span>);<br>    &#125; <span class="hljs-keyword">catch</span> (InterruptedException ignored) &#123;<br>        Thread.currentThread().interrupt();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è°ƒç”¨æ–¹æ³•æ–¹å¼ï¼š<code>getUser(uid, 3)</code> <code>getOrg(orgId, 3)</code> å½“ä¾èµ–æ¥å£çŸ­æš‚å‡ºç°é—®é¢˜ï¼Œå°±è¿›è¡Œé€’å½’é‡è¯•ï¼Œé‡è¯•æˆåŠŸå°±è¿”å›è°ƒç”¨ç»“æœï¼›å½“é‡è¯•æ¬¡æ•°å…¨éƒ¨ç”¨å®Œï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œè¿™ç§æƒ…å†µä¸€èˆ¬æ˜¯å¯¹æ–¹æœåŠ¡æŒ‚æ‰äº†ï¼Œå¼ºä¾èµ–çš„åœºæ™¯ä¸‹ï¼Œè‡ªå·±çš„ä¸šåŠ¡ä¹Ÿæ˜¯æ— æ³•è¿›è¡Œçš„ã€‚</p><p>è¿™ä¸¤ä¸ªæ–¹æ³•å¾ˆæ˜æ˜¾çš„é—®é¢˜å°±æ˜¯ï¼Œæ–¹æ³•é«˜åº¦ç±»ä¼¼å´åˆä¸åŒã€‚</p><p>æ­£å¥½æœ€è¿‘åœ¨çœ‹ <em>CompletableFuture</em> æºç ï¼Œæºç ä¸­å¯¹äº Java8 ä¸­çš„å‡½æ•°å¼æ¥å£ä½¿ç”¨ç»™äºˆäº†æˆ‘å¯å‘ï¼Œè¿™æ®µé‡è¯•çš„ä»£ç å¯ä»¥é€šè¿‡å‡½æ•°å¼ç¼–ç¨‹çš„æ–¹å¼æ¥è¿›è¡Œä¼˜åŒ–ã€‚</p><p>é¦–å…ˆéœ€è¦äº†è§£å‡ ä¸ªåŸºç¡€çš„å‡½æ•°å¼æ¥å£ï¼š</p><ul><li>Function&lt;T, R&gt; ï¼šæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå€¼</li><li>Supplier&lt;T&gt;ï¼šä¸æ¥æ”¶å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå€¼</li><li>Predicate&lt;T&gt;ï¼šè°“è¯ï¼Œæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªBooleanç»“æœ</li></ul><p>å‡½æ•°å¼ç¼–ç¨‹çš„ç‰¹ç‚¹å°±æ˜¯å°†å‡½æ•°çš„å®ç°æ”¾åˆ°è°ƒç”¨è€…å¤„ï¼Œè€Œä¸æ˜¯å‡½æ•°å†…éƒ¨ï¼Œä¼ é€’è¡Œä¸ºè€Œä¸æ˜¯ä¼ é€’å€¼ï¼Œæä¾›äº†æ›´é«˜å±‚æ¬¡çš„æŠ½è±¡ã€‚</p><p>å¤§æ¦‚ç†è§£è¿™å‡ ä¸ªå‡½æ•°å¼æ¥å£çš„ä½¿ç”¨åï¼Œäºæ˜¯æç‚¼å‡ºäº†å¦‚ä¸‹å·¥å…·ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * é‡è¯•å·¥å…·ç±»</span><br><span class="hljs-comment"> * åº”ç”¨åœºæ™¯ï¼šæ¥å£è°ƒç”¨é‡è¯•</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> WeJan</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2021-02-06</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RetryUtil</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(RetryUtil.class);<br><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ–¹æ³•é‡è¯•è°ƒç”¨ï¼ˆæœªæ‰§è¡ŒæˆåŠŸæ‰è¿›è¡Œé‡è¯•ï¼‰</span><br><span class="hljs-comment">     * ä¸å¤„ç†æ–¹æ³•è°ƒç”¨å¼‚å¸¸</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> invokeMethod          æ‰§è¡Œæ–¹æ³•</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> retryCondition        é‡è¯•æ¡ä»¶</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> fixedWaitMilliseconds é‡è¯•é—´éš”æ—¶é—´(æ¯«ç§’)</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> retryCount            é‡è¯•æ¬¡æ•°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> exception             è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ï¼ŒæŠ›å‡ºæŒ‡å®šå¼‚å¸¸</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ–¹æ³•è¿”å›</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;U&gt; <span class="hljs-function">U <span class="hljs-title">invoke</span><span class="hljs-params">(Supplier&lt;U&gt; invokeMethod,</span></span><br><span class="hljs-function"><span class="hljs-params">                               Predicate&lt;U&gt; retryCondition,</span></span><br><span class="hljs-function"><span class="hljs-params">                               <span class="hljs-keyword">long</span> fixedWaitMilliseconds,</span></span><br><span class="hljs-function"><span class="hljs-params">                               <span class="hljs-keyword">int</span> retryCount,</span></span><br><span class="hljs-function"><span class="hljs-params">                               Supplier&lt;? extends RuntimeException&gt; exception)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> RetryUtil.invoke(invokeMethod, retryCondition, fixedWaitMilliseconds, retryCount, <span class="hljs-keyword">null</span>, exception);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ–¹æ³•é‡è¯•è°ƒç”¨ï¼ˆæœªæ‰§è¡ŒæˆåŠŸæ‰è¿›è¡Œé‡è¯•ï¼‰</span><br><span class="hljs-comment">     * å¯æ‰‹åŠ¨å¤„ç†å¼‚å¸¸ï¼Œè®¾ç½®é»˜è®¤å€¼</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> invokeMethod          æ‰§è¡Œæ–¹æ³•</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> retryCondition        é‡è¯•æ¡ä»¶</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> fixedWaitMilliseconds é‡è¯•é—´éš”æ—¶é—´(æ¯«ç§’)</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> retryCount            é‡è¯•æ¬¡æ•°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> exceptionally         æ‰§è¡Œæ–¹æ³•å‘ç”Ÿå¼‚å¸¸å¤„ç†ï¼Œè¿”å›é»˜è®¤å€¼, ä¸º null åˆ™ç›´æ¥ä¸ŠæŠ›å¼‚å¸¸</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> exception             è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ï¼ŒæŠ›å‡ºæŒ‡å®šå¼‚å¸¸</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ–¹æ³•è¿”å›</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;U&gt; <span class="hljs-function">U <span class="hljs-title">invoke</span><span class="hljs-params">(Supplier&lt;U&gt; invokeMethod,</span></span><br><span class="hljs-function"><span class="hljs-params">                               Predicate&lt;U&gt; retryCondition,</span></span><br><span class="hljs-function"><span class="hljs-params">                               <span class="hljs-keyword">long</span> fixedWaitMilliseconds,</span></span><br><span class="hljs-function"><span class="hljs-params">                               <span class="hljs-keyword">int</span> retryCount,</span></span><br><span class="hljs-function"><span class="hljs-params">                               Function&lt;Exception, U&gt; exceptionally,</span></span><br><span class="hljs-function"><span class="hljs-params">                               Supplier&lt;? extends RuntimeException&gt; exception)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (invokeMethod == <span class="hljs-keyword">null</span> || retryCondition == <span class="hljs-keyword">null</span> || exception == <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullPointerException();<br>        &#125;<br>        U result = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            result = invokeMethod.get();<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            LOGGER.error(<span class="hljs-string">&quot;&quot;</span>, e);<br>            <span class="hljs-keyword">if</span> (exceptionally != <span class="hljs-keyword">null</span>) &#123;<br>                <span class="hljs-keyword">return</span> exceptionally.apply(e);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">throw</span> e;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (!retryCondition.test(result)) &#123;<br>            <span class="hljs-keyword">return</span> result;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (retryCount &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                TimeUnit.MILLISECONDS.sleep(fixedWaitMilliseconds);<br>            &#125; <span class="hljs-keyword">catch</span> (InterruptedException ignored) &#123;<br>            &#125;<br>            LOGGER.error(<span class="hljs-string">&quot;retryCount: &#123;&#125;&quot;</span>, retryCount);<br>            <span class="hljs-keyword">return</span> invoke(invokeMethod, retryCondition, fixedWaitMilliseconds, --retryCount, exceptionally, exception);<br>        &#125;<br>        <span class="hljs-keyword">throw</span> exception.get();<br>    &#125;<br><br>&#125;<br></code></pre></div></td></tr></table></figure><p>æœ‰äº†è¿™ä¸ªå·¥å…·ç±»ï¼Œä¸Šé¢ç¤ºä¾‹ä¸­çš„ä»£ç å°±å¯ä»¥ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">getUser</span><span class="hljs-params">(Long uid)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> RetryUtil.invoke(() -&gt; &#123;<br>                User info = <span class="hljs-keyword">new</span> User();<br>                <span class="hljs-keyword">int</span> ret = userClient.getUser(uid, info);<br>                <span class="hljs-keyword">if</span> (RetCode.RET_SUCCESS == ret) &#123;<br>                    <span class="hljs-keyword">return</span> info;<br>                &#125;<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>            &#125;,<br>            Objects::isNull,        <span class="hljs-comment">// é‡è¯•æ¡ä»¶ä¸ºè°ƒç”¨è¿”å›ç»“æœä¸ºnull</span><br>            <span class="hljs-number">5</span>,           <span class="hljs-comment">// ç­‰å¾…5æ¯«ç§’</span><br>            <span class="hljs-number">3</span>,                <span class="hljs-comment">// é‡è¯•3æ¬¡</span><br>            () -&gt; <span class="hljs-keyword">new</span> ApiException(<span class="hljs-string">&quot;è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥&quot;</span>)); <span class="hljs-comment">// è¶…å‡ºé‡è¯•æ¬¡æ•°æŠ›å‡ºå¼‚å¸¸</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> OrgInfo <span class="hljs-title">getOrg</span><span class="hljs-params">(Long orgId)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> RetryUtil.invoke(() -&gt; &#123;<br>                OrgInfo info = <span class="hljs-keyword">new</span> OrgInfo();<br>                <span class="hljs-keyword">int</span> ret = orgClient.getOrg(orgId, info);<br>                <span class="hljs-keyword">if</span> (RetCode.RET_SUCCESS == ret) &#123;<br>                    <span class="hljs-keyword">return</span> info;<br>                &#125;<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>            &#125;,<br>            Objects::isNull,<br>            <span class="hljs-number">5</span>,<br>            <span class="hljs-number">3</span>,<br>            () -&gt; <span class="hljs-keyword">new</span> ApiException(<span class="hljs-string">&quot;è·å–ä¼ä¸šä¿¡æ¯å¤±è´¥&quot;</span>));<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¿™ä¸ªå·¥å…·ç±»ä¹Ÿç®—æ˜¯è‡ªå·±å¯¹äºå‡½æ•°å¼ç¼–ç¨‹çš„ç¬¬ä¸€æ¬¡å®è·µï¼Œå‘ç°è¿˜æ˜¯è›®æœ‰æ„æ€çš„å“ˆå“ˆ</p><p>æˆåŠŸæ°´äº†ä¸€ç¯‡~</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>2020å¹´ç»ˆæ€»ç»“</title>
    <link href="/2020-year-end-summary.html"/>
    <url>/2020-year-end-summary.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹ æƒ¯äº†æ¯å¹´å¤§æ•°æ®ç»™è‡ªå·±åšæ€»ç»“ï¼Œè‡ªå·±å·¥ä½œå­¦ä¹ ä¸Šçš„è‡ªæˆ‘å¹´ç»ˆæ€»ç»“å´æ˜¯ä¸€æ‹–å†æ‹–ï¼Œæœ¬åº” 2020 å¹´ 12 æœˆä»½å°±è¯¥å®Œæˆçš„æ–‡ç« è¢«æ‹–å»¶åˆ°äº† 2021 å¹´çš„ 2 æœˆä»½ã€‚ä¹Ÿæ˜¯å› ä¸ºè‡ªå·±æ²¡æœ‰æå‰è§„åˆ’å¥½æ—¶é—´ï¼Œåˆ°äº† 12 æœˆåº•æ‰æƒ³èµ·è¿™ä¹ˆä¸€ä»¶äº‹æƒ…ï¼Œæ­£å¥½æœˆåº•è¯¸äº‹é¢‡å¤šï¼Œä¹Ÿæ²¡ä»€ä¹ˆæ—¶é—´æ¥å†™ã€‚<br>æœ¬æ¥æ‹–å»¶æˆä¸æ‰“ç®—å†™å¹´ç»ˆæ€»ç»“äº†ï¼Œçœ‹äº†ä¸€ä¸‹åšå®¢å½’æ¡£æ–‡ç« ï¼Œè¿ç»­å†™äº†å¥½å‡ å¹´çš„å¹´ç»ˆæ€»ç»“ï¼Œä»Šå¹´ä¹Ÿä¸èƒ½ç ´ä¾‹ï¼Œå¿ç€å¤´çš®å†™ä¹Ÿè¦å¼ºè¿«è‡ªå·±å†™å®Œã€‚</p><a id="more"></a><h2 id="å»å¹´ç«‹çš„-Flag"><a href="#å»å¹´ç«‹çš„-Flag" class="headerlink" title="å»å¹´ç«‹çš„ Flag"></a>å»å¹´ç«‹çš„ Flag</h2><p>å…ˆç…§ä¾‹è¿‡ä¸€ä¸‹æµæ°´è´¦<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/Snipaste_2021-01-27_19-15-11.png">  </p><ul><li>2020 å¹´åšå®¢å‘æ–‡ 19 ç¯‡ï¼Œ90ï¼…éƒ½å†™äºä¸ŠåŠå¹´ï¼Œä¸‹åŠå¹´ä¹Ÿåªæ˜¯æ°´äº†ä¸€ç¯‡ï¼Œæ€»æ–‡ç« æ•°é‡å°‘äº 24 ç¯‡ï¼Œæ¯æœˆå¹³å‡åšå®¢æ•°é‡ä¸è¶³ä¸¤ç¯‡ï¼Œflag 1 æœªå®Œæˆã€‚</li><li>2020 å¹´æ—©èµ· 70 å¤©ï¼Œç•ªèŒ„æ•°é‡æœªè¾¾æ ‡ï¼Œflag 2 æœªå®Œæˆ</li><li>åªè¯»å®Œã€Šé‡æ„ã€‹ï¼Œã€ŠSpring æºç æ·±åº¦åˆ†æã€‹çœ‹äº†äº†å¼€å¤´ï¼Œflag 3 æœªå®Œæˆ</li><li>åªè¯»å®Œã€Šæå®šã€‹ï¼Œå…¶ä»–æ²¡çœ‹ï¼Œflag 4 æœªå®Œæˆ</li></ul><p>æ€»ç»“ï¼Œ2020 å¹´ flag ä¸€ä¸ªæ²¡å®Œæˆï¼Œå…¨éƒ¨æ‰“è„¸ã€‚<br>flag ä¹‹å¤–ï¼Œå…»æˆäº†æ¯æ—¥æ€»ç»“ï¼Œæ¯æ—¥ä¿¯å§æ’‘ä¹ æƒ¯ï¼Œè¿˜èƒ½ç¨ç¨è¡¥æ•‘ä¸€ä¸‹ã€‚</p><h2 id="è¿›æ­¥"><a href="#è¿›æ­¥" class="headerlink" title="è¿›æ­¥"></a>è¿›æ­¥</h2><p>2020 è¿™ä¸€å¹´é‡Œï¼Œè‡ªæˆ‘æ„Ÿè§‰å†™ä»£ç çš„æ•ˆç‡æå‡äº†ä¸€å¤§æˆªã€‚ä»¥å‰å¯èƒ½é¢„ä¼° 3 å¤©çš„å·¥ä½œé‡ï¼Œç°åœ¨å¯èƒ½æœ€å¤šä¸€å¤©å°±èƒ½æå®šï¼Œè€Œä¸”ç›¸å¯¹ä»¥å‰æ›´å°‘åœ°å‡ºç° bugï¼Œå¯¹è‡ªå·±çš„ä»£ç è´¨é‡æ›´æœ‰ä¿¡å¿ƒã€‚</p><p>æŠ›å¼€å·¥ä½œç»éªŒå¸¦æ¥å·¥ä½œæ•ˆç‡æˆé•¿è¿™æ–¹é¢ä¸è¯´ï¼Œæˆ‘è®¤ä¸ºåŠ©åŠ›è‡ªå·±æ•ˆç‡æå‡ä¸»è¦å¾—ç›Šäºä»Šå¹´å…»æˆçš„ä¸¤ä¸ªä¹ æƒ¯ã€‚<br>ç¬¬ä¸€ä¸ªä¹ æƒ¯æ˜¯å¯¹äº ä»£ç ç¼–è¾‘å™¨ï¼ˆIDEAï¼‰ çš„æ“ä½œä¼˜åŒ–ï¼ŒæŒæ¡äº† vim æ¨¡å¼è¿›è¡Œç¼–ç ï¼ˆIdeaVim æ’ä»¶ï¼‰ã€‚vim æ¨¡å¼é™ä½äº†å‡»é”®æ¬¡æ•°ï¼Œä»£ç é—´è·³è½¬æ›´åŠ è¿…é€Ÿç²¾å‡†ï¼›é…åˆ IDEA å¿«æ·é”®ï¼ŒåŒæ‰‹å¾ˆå°‘ç¦»å¼€é”®ç›˜ï¼Œå¤§å¤§å‡å°‘äº†é¼ æ ‡çš„ä¾èµ–ã€‚è¿™ä¸¤ç‚¹å¯¹æ¯”ä¹‹å‰ï¼Œå¯èƒ½æ­£å¦‚åŒä¸€ä¸ªèµ·ç‚¹ç»ˆç‚¹ï¼Œä¹‹å‰æ˜¯æ­¥è¡Œåˆ°è¾¾ï¼Œè€Œç°åœ¨æ˜¯å¼€è½¦åˆ°è¾¾ï¼Œæ•ˆç‡ä¸Šçš„æå‡ä¸æ˜¯ä¸€ç‚¹ç‚¹ã€‚</p><p>ç¬¬äºŒä¸ªä¹ æƒ¯æ˜¯åœ¨å¼€å§‹ä¸€ä¸ªéœ€æ±‚ä¹‹å‰ï¼Œå…ˆä»”ç»†è¿‡å‡ é PRD äº§å“ç¨¿ï¼Œç¡®å®šéœ€æ±‚ä¹‹åï¼Œå…ˆç”¨çº¸ç¬”å†™ä¸‹ç¼–ç è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜ï¼ˆä¸»è¦æ˜¯ä¸šåŠ¡ä¸Šçš„ï¼‰ï¼Œåˆ—å‡ºä¸€ä¸ªæ¸…å•åˆ—è¡¨åï¼Œé’ˆå¯¹è¿™äº›é—®é¢˜å»æ€è€ƒæ–¹æ¡ˆï¼ˆæå‰æ€è€ƒå¯ä»¥å‡å°‘ç¼–ç è¿‡ç¨‹ä¸­çš„åœé¡¿ï¼‰ï¼Œæœ‰é—®é¢˜çš„ç‚¹æå‰ä¸äº§å“æ²Ÿé€šç¡®è®¤ï¼Œé™ä½ä»£ç è¿”å·¥é‡åšä¿®æ”¹çš„å¯èƒ½æ€§ã€‚å½“è¿™ä¸€åˆ‡å®Œæˆåï¼Œå…·ä½“ç¼–ç æ—¶å†™å®Œä¸€ä¸ªç‚¹ï¼Œå°±å°†æ¸…å•ä¸­çš„åˆ—è¡¨é¡¹åˆ’æ‰ï¼Œä»è€Œé™ä½å¿ƒç†ä¸Šçš„è®¤çŸ¥å‹åŠ›ï¼Œå†™ä»£ç æ—¶å¿ƒæƒ…ä¼šæ›´åŠ è½»æ¾æ„‰å¿«ã€‚</p><h2 id="GTD-ä¹‹è·¯"><a href="#GTD-ä¹‹è·¯" class="headerlink" title="GTD ä¹‹è·¯"></a>GTD ä¹‹è·¯</h2><p>å­¦ä¹  GTD ä¸€å¹´å¤šï¼ŒæŠŠ ã€Šæå®šã€‹ä¸€ä¹¦è¯»äº† 2 éï¼Œæ»´ç­”æ¸…å•ä¹Ÿä»˜è´¹æˆå¹´è´¹ä¼šå‘˜ï¼ŒGTD çš„å®è·µä¹‹è·¯å¹¶æ²¡æœ‰æˆ‘æ‰€æƒ³è±¡çš„é‚£èˆ¬å®¹æ˜“ã€‚æ²¡æœ‰å®Œå®Œå…¨å…¨åœ°æŒ‰ç…§æå®šä¸€ä¹¦å»ç†æ¸…ï¼Œå¯¼è‡´æ¸…å•ä¸­çš„ä»»åŠ¡å †ç§¯å¦‚å±±ï¼Œå´æ— æ³•ä»å…¶ä¸­ä»»ä½•ä¸€ä¸ªä»»åŠ¡å¼€å§‹è¡ŒåŠ¨ã€‚æ–°çš„ä¸€å¹´ä¼šæŠ½ç©ºå†æŠŠã€Šæå®šã€‹ç²¾è¯»ä¸€éï¼Œé‡æ„æ¸…å•ï¼Œè¾¾åˆ°éšä¾¿å“ªä¸€ä¸ªç†æ¸…çš„ä»»åŠ¡å¯ä»¥é©¬ä¸Šè¡ŒåŠ¨çš„åœ°æ­¥ã€‚</p><h2 id="ä¸æ¸¸æˆçš„æˆ˜å½¹"><a href="#ä¸æ¸¸æˆçš„æˆ˜å½¹" class="headerlink" title="ä¸æ¸¸æˆçš„æˆ˜å½¹"></a>ä¸æ¸¸æˆçš„æˆ˜å½¹</h2><p>2020 å¹´ï¼Œå› ä¸ºç–«æƒ…çš„åŸå› ï¼Œæ˜¥èŠ‚æ”¾å‡å›æ­å·çš„è·¯ä¸å¤ªé¡ºåˆ©ï¼Œæœºç¥¨æ€»æ˜¯é€€äº†åˆä¹°ï¼Œä¹°äº†åˆé€€ï¼Œå›æ­çš„æ—¥æœŸè¢«ä¸æ–­æ¨è¿Ÿï¼Œé‡è¦çš„äº‹æƒ…ä¹Ÿè¢«è‡ªå·±ä¸æ–­æ‹–å»¶ï¼Œè¿™ä¹Ÿé¢„ç¤ºäº† 2020 å¹´åˆæ˜¯ä¸€ä¸ªæ¯«æ— é•¿è¿›çš„ä¸€å¹´ã€‚<br>å¾…åœ¨å®¶é‡Œè¿™æ®µæ—¶é—´ï¼Œæ²¡å¿ä½åˆç©èµ·ç‹è€…è£è€€ï¼Œå†æ¬¡èµ°åœ¨æ²‰è¿·çš„é“è·¯ä¹‹ä¸Šï¼Œæ”¾å‡å‰çš„å‡æœŸå®‰æ’è‡ªç„¶è€Œç„¶åœ°è¢«æŠ›è¯¸è„‘åï¼Œæ¯å¹´éƒ½è¦è‡ªå·±éƒ½è¦å’Œæ¸¸æˆä½œä¸€ç•ªè‹¦è‹¦æ–—äº‰ï¼Œä¹Ÿæ˜¯ä¸€ä»¶æéš¾ä»¥ç†è§£çš„äº‹æƒ…ã€‚<br>æ¸¸æˆäºæˆ‘è€Œè¨€ï¼Œä¸äºšäºæ´ªæ°´çŒ›å…½ï¼Œéšæ—¶éƒ½å¯èƒ½åå™¬æˆ‘çš„ä¸€åˆ‡ï¼›ä¸ç¢°æ¸¸æˆï¼Œä¾¿æ˜¯æœ€ä¼˜è§£ã€‚</p><h2 id="æŠ•èµ„"><a href="#æŠ•èµ„" class="headerlink" title="æŠ•èµ„"></a>æŠ•èµ„</h2><p>è§è¯äº† BTC çªç ´ 2 ä¸‡ï¼Œ3 ä¸‡ï¼Œ4 ä¸‡åˆ€çš„å¤§å…³ï¼Œæƒ­æ„§çš„æ˜¯åœ¨ 1 ä¸‡åˆ€åªä¹°äº† 2 åƒå—ï¼Œè€Œä¸”è¿˜åœ¨çªç ´ 2 ä¸‡çš„å‰å¤•å…¨éƒ¨å–æ‰äº†ã€‚<br>é«˜ä½æ¥ç›˜ï¼Œæ·±å¥—å¥½å‡ å¹´çš„ EOS å›æœ¬ä»ç„¶é¥é¥æ— æœŸï¼Œåˆ›å§‹äºº BM ç¬¬ä¸‰æ¬¡æŠ›å¼ƒäº†é¡¹ç›®å¼€æºœï¼ŒçœŸæ˜¯ X äº†ç‹—ï¼<br>ç‚’å¸è¿™å‡ å¹´æœ‰ç›ˆåˆ©æœ‰äºæŸï¼Œæ€»ä½“ä¸‹æ¥è¿˜æ˜¯æ²¡å›æœ¬ï¼Œè¿™å‡ å¹´ç‚’å¸å¤§æ¦‚å°±åªæ˜¯ç©äº†ä¸ªå¯‚å¯ã€‚<br>ä¸‹åŠå¹´æ¥è§¦åˆçº¦äº¤æ˜“ï¼Œä¾ç„¶æ˜¯äºæŸå±…å¤šï¼Œå¿ƒæ€å¤ªå·®ï¼Œæ¨¡æ‹Ÿé‡‘éƒ½è¢«äºä¸ªç²¾å…‰ã€‚æ‰“ç®—å¤šå­¦ä¹ ä¸€äº›å¸‚åœºåŸºç¡€çŸ¥è¯†ï¼Œæ—¥åå†çœ‹å§ï¼</p><h2 id="åšå®¢"><a href="#åšå®¢" class="headerlink" title="åšå®¢"></a>åšå®¢</h2><p>2020 å¹´ï¼Œåšå®¢æ–­æ›´ã€‚ä¸å­¦ä¹ ï¼Œè‚šå­é‡Œçš„å¢¨æ°´ä¸ä¼šæ— æ•…å¢åŠ ï¼Œæ²¡æœ‰å¢¨æ°´ï¼Œè‡ªç„¶å†™ä¸å‡ºä»»ä½•æ–‡ç« ã€‚å¼ºå†™ä¹Ÿæ˜¯æ°´æ–‡è€Œå·²ã€‚<br>è¶ç€å¹´åº•çš„é—²ä½™æ—¶é—´ï¼ŒæŠŠç”¨äº† 2 å¹´å¤šçš„åšå®¢ä¸»é¢˜ç»™æ¢äº†ï¼Œé’ˆå¯¹è‡ªå®šä¹‰çš„éƒ¨åˆ†è¿›è¡Œäº†é€‚é…ï¼ŒèŠ±äº†å°åŠå¤©æ—¶é—´ã€‚<br>å¯¹äºæŠ˜è…¾è¿™ç§äº‹æƒ…ï¼Œè‡ªå·±å€’æ˜¯å¾ˆçƒ­è¡·ï¼Œå´ååå¯¹å­¦ä¹ è¿™ä»¶äº‹æƒ…ä¸é‚£ä¹ˆä¸Šå¿ƒï¼Œä¹Ÿå°±å¯¼è‡´äº†è‡ªèº«èƒ½åŠ›å¢é•¿åœæ»ã€‚</p><h2 id="è®°å½•"><a href="#è®°å½•" class="headerlink" title="è®°å½•"></a>è®°å½•</h2><p>ä»å»å¹´ 9 æœˆä»½å¼€å§‹ï¼Œé€æ¸å…»æˆåšæ¯æ—¥æ€»ç»“çš„ä¹ æƒ¯ï¼Œä¸€ç›´æŒç»­åˆ°ç°åœ¨ï¼Œè™½ç„¶æ²¡æœ‰å‘ç°åšæ€»ç»“å¯¹è‡ªå·±æœ‰ä»€ä¹ˆå®è´¨æ€§çš„æå‡ï¼Œä½†æ˜¯è‡³å°‘å¢åŠ äº†è‡ªå·±æ¯å¤©æ€è€ƒçš„æ—¶é—´ã€‚é‚£ç‚¹æ€è€ƒæ—¶é—´è™½å¾®ä¸è¶³é“ï¼Œé‡å˜ä¼šå¼•èµ·è´¨å˜ï¼Œæ€»ä¼šæœ‰å‘æŒ¥ä½œç”¨çš„ä¸€å¤©ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20210123152325.png">  </p><h2 id="å¥èº«"><a href="#å¥èº«" class="headerlink" title="å¥èº«"></a>å¥èº«</h2><p>ç«‹äº†å¾ˆå¤šå…³äºå¥èº«çš„ flagï¼Œç»“æœæ— ä¸€ä¸æ˜¯ç‹ ç‹ æ‰“è„¸ã€‚<br>æœ‰ä¸€å¤©çªå‘å¥‡æƒ³ï¼Œæ—¢ç„¶ç«‹çš„ flag éƒ½åšä¸åˆ°ï¼Œä¸å¦‚å…»æˆä¸€ä¸ªæ¯å¤©åš 10 ä¸ªä¿¯å§æ’‘çš„ä¹ æƒ¯å§ï¼10 ä¸ªä¿¯å§æ’‘å¾ˆç®€å•ï¼Œåªéœ€è¦å‡ åç§’å°±å¯ä»¥å®Œæˆï¼›åœ¨ä¹ æƒ¯å…»æˆçš„è¿‡ç¨‹ä¸­ï¼Œè§‰å¾—å¯ä»¥æé«˜æ•°é‡æ—¶å°±ä¼šå¤šåšä¸€äº›ï¼Œä» 10 ä¸ªï¼Œ20 ä¸ªï¼Œä¸€ç›´åˆ° 60 ä¸ªï¼Œåˆ°äº† 60 ä¸ªæ—¶æ„Ÿè§‰å¾ˆéš¾åšæŒä¸‹å»ï¼Œäºæ˜¯åˆé™ä½æ•°é‡åˆ° 40 ä¸ªï¼Œç°åœ¨æ¯å¤©åªåš 40 ä¸ªä¿¯å§æ’‘ã€‚å¯¹äºæˆ‘è€Œè¨€ï¼Œåšä¿¯å§æ’‘çš„å¥½å¤„è¿˜æ˜¯æœ‰çš„ï¼Œèƒ¸è†›å¼€å§‹å˜å¾—å®½åšï¼Œä¹Ÿæœ‰äº†ä¸€ç‚¹èƒ¸è‚Œï¼Œè¿™éƒ½æ˜¯åœ¨è¿™ä¸€å¹´é‡Œå¯è§æ€§çš„æ”¹å˜ï¼Œå¦å¤–ä¹Ÿå¯ä»¥èˆ’å±•é•¿æœŸæ¡é¼ æ ‡å¸¦æ¥çš„åèƒŒé…¸ç—›ï¼Œä¸å‡ºæ„å¤–ï¼Œè¿™ä¸ªä¿¯å§æ’‘çš„ä¹ æƒ¯è‡ªå·±å°†ä¼šä¸€ç›´æŒç»­ä¸‹å»ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20210123152531.png">  </p><h2 id="æ–°ä¸€å¹´ç›®æ ‡"><a href="#æ–°ä¸€å¹´ç›®æ ‡" class="headerlink" title="æ–°ä¸€å¹´ç›®æ ‡"></a>æ–°ä¸€å¹´ç›®æ ‡</h2><p>ç›®æ ‡å¾ˆç®€å•ï¼Œä¿æŒç°åœ¨å·²ç»ä¿æŒä½çš„ä¹ æƒ¯ï¼Œå®Œæˆ 2020 å¹´çš„ç›®æ ‡ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>ç½‘ç«™å…¬å‘Š</title>
    <link href="/notice.html"/>
    <url>/notice.html</url>
    
    <content type="html"><![CDATA[<hr><a id="more"></a><h2 id="2020å¹´12æœˆ27æ—¥"><a href="#2020å¹´12æœˆ27æ—¥" class="headerlink" title="2020å¹´12æœˆ27æ—¥"></a>2020å¹´12æœˆ27æ—¥</h2><p>ç³Ÿå¿ƒçš„2020å¹´å³å°†è¿‡å»ï¼Œè¾æ—§è¿æ–°ï¼Œåšå®¢ä¹Ÿåº”è¯¥æœ‰æ‰€å˜åŒ–ï¼ŒèŠ±äº†åŠå¤©åˆ‡æ¢åšå®¢ä¸»é¢˜ä¸º <a href="https://github.com/fluid-dev/hexo-theme-fluid">Fluid</a>ï¼Œå¾ˆèµçš„ä¸»é¢˜ï¼</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Poiä¸è§„åˆ™è¡¨æ ¼å¯¼å…¥</title>
    <link href="/custom-read-poi.html"/>
    <url>/custom-read-poi.html</url>
    
    <content type="html"><![CDATA[<p>åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ <a href="https://nullpointer.pw/easypoi%E5%AF%BC%E5%85%A5Excel%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html">easypoi å¯¼å…¥ Excel æœ€ä½³å®è·µ </a> è¯¦ç»†ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ EasyPoi æ¥è¿›è¡Œæ•°æ®çš„å¯¼å…¥ä¸å¤šé‡æ ¡éªŒï¼Œä½†æ˜¯ EasyPoi æ›´æ“…é•¿ä¸æ¯”è¾ƒè§„æ•´çš„è¡¨æ ¼è¾“å…¥å¯¼å…¥ï¼Œå¦‚æœé‡åˆ°ä¸è§„åˆ™çš„è¡¨æ ¼æ—¶ï¼Œå¯èƒ½å°±æ²¡é‚£ä¹ˆè½»æ¾æå®šå¯¼å…¥äº†ã€‚æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•å®ç°ä¸è§„åˆ™è¡¨æ ¼æ•°æ®å¯¼å…¥ã€‚</p><p>æœ¬æ–‡æºç åœ°å€ï¼š</p><a id="more"></a><p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ï¼Œä¸è§„åˆ™çš„è¡¨æ ¼é•¿ä»€ä¹ˆæ ·å­ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œè¿™ç§è¡¨æ ¼å¦‚æœç»§ç»­ä½¿ç”¨ EasyPoi å…¶å®æ¯”è¾ƒå›°éš¾åšåˆ°å¾ˆä¾¿æ·çš„å¯¼å…¥ï¼Œä½†æ˜¯è¿™ç§è¡¨æ ¼ä¸€èˆ¬æ ¼å¼ç›¸å¯¹å›ºå®šï¼Œåªæœ‰ä¸ªåˆ«å€¼çš„ä½ç½®ä¸è§„åˆ™ï¼ˆè“è‰²æ¡†å†…ï¼‰ï¼Œè€Œä¸­é—´ä½ç½®çš„æ•°æ®æ ¼å¼æ¯”è¾ƒè§„æ•´ï¼ˆçº¢è‰²æ¡†å†…ï¼‰ã€‚<br>æˆ‘ä»¬å¯ä»¥å–é•¿è¡¥çŸ­ï¼Œä¸è§„åˆ™çš„åœ°æ–¹æ•°æ®ç‰¹æ®Šå¤„ç†è¯»å–ï¼Œè€Œæœ‰è§„åˆ™çš„åœ°æ–¹ä¾ç„¶ä½¿ç”¨ EasyPoi è¿›è¡Œè¯»å–ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/1598236528403.png"></p><h2 id="è¯»å–ç¤ºä¾‹"><a href="#è¯»å–ç¤ºä¾‹" class="headerlink" title="è¯»å–ç¤ºä¾‹"></a>è¯»å–ç¤ºä¾‹</h2><p>çº¢è‰²æ¡†å†…çš„æ•°æ®è¯»å–æœ¬æ–‡å°±ä¸å†å±•ç¤ºäº†ï¼Œå¯ä»¥å‚è€ƒä¸Šæ–‡çš„é“¾æ¥ã€‚æœ¬æ–‡ä¸»è¦è®²è§£å¦‚ä½•æå–è“è‰²æ¡†å†…çš„æ•°æ®ã€‚ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œç¬”è€…å‚è€ƒäº†ç½‘ä¸Šçš„æ–‡ç« ï¼ŒæŠ½å–äº†ä¸€ä¸ªå·¥å…·ç±»ï¼ŒåŸºäºæ‰€è§å³æ‰€å¾—çš„æ–¹å¼å»è·å–å¯¹åº”å•å…ƒæ ¼çš„å€¼ã€‚</p><p>ä½¿ç”¨ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExcelReadHelperTest</span> </span>&#123;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testImport</span><span class="hljs-params">()</span> </span>&#123;<br>        InputStream in = getClass().getResourceAsStream(<span class="hljs-string">&quot;/excel/ç¤ºä¾‹ Excel3.xlsx&quot;</span>);<br>        ExcelReadHelper readHelper = <span class="hljs-keyword">new</span> ExcelReadHelper(in);<br>        <span class="hljs-comment">// è·å– B4 å•å…ƒæ ¼çš„æ•°æ®ï¼Œä»¥ä¸‹åŒç†</span><br>        String b4 = readHelper.getValueAt(<span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-number">4</span>);<br>        String c23 = readHelper.getValueAt(<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-number">23</span>);<br>        String c24 = readHelper.getValueAt(<span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-number">24</span>);<br>        String m4 = readHelper.getValueAt(<span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-number">4</span>);<br>        String m5 = readHelper.getValueAt(<span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-number">5</span>);<br>        Assert.assertEquals(<span class="hljs-string">&quot;ä¸€ä¼—ç§‘æŠ€æœ‰é™å…¬å¸&quot;</span>, b4);<br>        Assert.assertEquals(<span class="hljs-string">&quot;13112345678&quot;</span>, c23);<br>        Assert.assertEquals(<span class="hljs-string">&quot;370827198801021000&quot;</span>, c24);<br>        Assert.assertEquals(<span class="hljs-string">&quot;XH-HZHY-20170504&quot;</span>, m4);<br>        Assert.assertEquals(<span class="hljs-string">&quot;2017.5.4&quot;</span>, m5);<br>        readHelper.close();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¦‚å›¾æ‰€ç¤ºï¼Œå¦‚æœè¦è¯»å–è”ç³»äººç”µè¯ï¼Œå…ˆæ‰¾åˆ°æ•°æ®æ‰€åœ¨å•å…ƒæ ¼ï¼ŒC23ï¼Œä»£ç ä¸­ç›´æ¥é€šè¿‡ <code>readHelper.getValueAt(&quot;C&quot;, 23);</code> å³å¯è·å–å¯¹åº”çš„å€¼ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/sp20200824_102152_997.png"></p><h2 id="å·¥å…·ç±»æºç "><a href="#å·¥å…·ç±»æºç " class="headerlink" title="å·¥å…·ç±»æºç "></a>å·¥å…·ç±»æºç </h2><p>éœ€è¦ä¾èµ– POI ç›¸å…³ä¾èµ–ï¼Œå¦‚æœå¼•å…¥äº† EasyPoi çš„è¯ï¼Œå°±æ— éœ€é‡å¤å¼•å…¥äº†ã€‚</p><p>EasyPoi çš„ä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.afterturn<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>easypoi-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.2.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.apache.poi.hssf.util.CellReference;<br><span class="hljs-keyword">import</span> org.apache.poi.ss.usermodel.*;<br><span class="hljs-keyword">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-keyword">import</span> java.text.DecimalFormat;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExcelReadHelper</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Workbook workbook;<br>    <span class="hljs-keyword">private</span> Sheet sheet;<br>    <span class="hljs-comment">//Sheet æ€»æ•°</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> sheetCount;<br>    <span class="hljs-comment">//å½“å‰è¡Œ</span><br>    <span class="hljs-keyword">private</span> Row row;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ExcelReadHelper</span><span class="hljs-params">(InputStream is)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// åªæ”¯æŒ xlsxï¼Œå¦‚æœè¦æ”¯æŒ xlsï¼Œè‡ªè¡Œä¿®æ”¹ä¸‹ä¸€è¡Œä»£ç </span><br>            workbook = <span class="hljs-keyword">new</span> XSSFWorkbook(is);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e);<br>        &#125;<br>        sheetCount = workbook.getNumberOfSheets();<br>        setSheetAt(<span class="hljs-number">0</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å…³é—­å·¥ä½œç°¿</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> IOException</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">close</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (workbook != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                workbook.close();<br>            &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–å•å…ƒæ ¼çœŸå®ä½ç½®</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> row è¡Œç´¢å¼•</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> col åˆ—ç´¢å¼•</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> [è¡Œ, åˆ— ]</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getCellLoc</span><span class="hljs-params">(Integer row, Integer col)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> String.format(<span class="hljs-string">&quot;[%s,%s]&quot;</span>, row + <span class="hljs-number">1</span>, CellReference.convertNumToColString(col));<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¹æ®æ ‡ç­¾è®¾ç½® Sheet</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> labels</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setSheetByLabel</span><span class="hljs-params">(String... labels)</span> </span>&#123;<br>        Sheet sheet = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">for</span> (String label : labels) &#123;<br>            sheet = workbook.getSheet(label);<br>            <span class="hljs-keyword">if</span> (sheet != <span class="hljs-keyword">null</span>) &#123;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (sheet == <span class="hljs-keyword">null</span>) &#123;<br>            StringBuilder sheetStr = <span class="hljs-keyword">new</span> StringBuilder();<br>            <span class="hljs-keyword">for</span> (String label : labels) &#123;<br>                sheetStr.append(label).append(<span class="hljs-string">&quot;,&quot;</span>);<br>            &#125;<br>            sheetStr.deleteCharAt(sheetStr.lastIndexOf(<span class="hljs-string">&quot;,&quot;</span>));<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(sheetStr.toString() + <span class="hljs-string">&quot;Sheet does not exist&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">this</span>.sheet = sheet;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¹æ®ç´¢å¼•è®¾ç½® Sheet</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> index</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setSheetAt</span><span class="hljs-params">(Integer index)</span> </span>&#123;<br>        Sheet sheet = workbook.getSheetAt(index);<br>        <span class="hljs-keyword">if</span> (sheet == <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(index + <span class="hljs-string">&quot;Sheet does not exist&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">this</span>.sheet = sheet;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–å•å…ƒæ ¼å†…å®¹å¹¶è½¬ä¸º String ç±»å‹</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> row     è¡Œå·ï¼Œä» 1 å¼€å§‹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> colName åˆ—å·</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@SuppressWarnings(&quot;deprecation&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getValueAt</span><span class="hljs-params">(String colName, <span class="hljs-keyword">int</span> row)</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> colIdx = CellReference.convertColStringToIndex(colName);<br>        <span class="hljs-keyword">int</span> rowIdx = row &lt; <span class="hljs-number">0</span> ? <span class="hljs-number">0</span> : row - <span class="hljs-number">1</span>;<br>        Cell cell = sheet.getRow(rowIdx).getCell(colIdx);<br>        String value = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">if</span> (cell != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">switch</span> (cell.getCellType()) &#123;<br>                <span class="hljs-keyword">case</span> Cell.CELL_TYPE_STRING:<br>                    value = cell.getStringCellValue() + <span class="hljs-string">&quot;&quot;</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> Cell.CELL_TYPE_NUMERIC:<br>                    <span class="hljs-keyword">if</span> (DateUtil.isCellDateFormatted(cell)) &#123;<br>                        value = cell.getDateCellValue().getTime() + <span class="hljs-string">&quot;&quot;</span>;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        DecimalFormat df = <span class="hljs-keyword">new</span> DecimalFormat(<span class="hljs-string">&quot;0&quot;</span>);<br>                        <span class="hljs-keyword">return</span> df.format(cell.getNumericCellValue());<br>                    &#125;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> Cell.CELL_TYPE_FORMULA:<br>                    value = cell.getNumericCellValue() + <span class="hljs-string">&quot;&quot;</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-keyword">case</span> Cell.CELL_TYPE_BOOLEAN:<br>                    value = cell.getBooleanCellValue() + <span class="hljs-string">&quot;&quot;</span>;<br>                    <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> (value == <span class="hljs-keyword">null</span> || value.isEmpty()) ? <span class="hljs-keyword">null</span> : value.trim();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–å½“å‰è¡ŒæŒ‡å®šåˆ—å†…å®¹</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> col åˆ—å·ï¼Œä» 1 å¼€å§‹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getValue</span><span class="hljs-params">(Integer col)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> getValueAt(CellReference.convertNumToColString(col + <span class="hljs-number">1</span>), col);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å– Sheet åç§°</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getSheetLabel</span><span class="hljs-params">()</span> </span>&#123;<br>        String label = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">if</span> (sheet != <span class="hljs-keyword">null</span>) &#123;<br>            label = sheet.getSheetName();<br>        &#125;<br>        <span class="hljs-keyword">return</span> label;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è¡Œåç§»</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> offset åç§»é‡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">offsetRow</span><span class="hljs-params">(Integer offset)</span> </span>&#123;<br>        <span class="hljs-keyword">boolean</span> state = <span class="hljs-keyword">true</span>;<br>        <span class="hljs-keyword">if</span> (row == <span class="hljs-keyword">null</span>) &#123;<br>            row = sheet.getRow(offset - <span class="hljs-number">1</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            row = sheet.getRow(row.getRowNum() + offset);<br>            <span class="hljs-keyword">if</span> (row == <span class="hljs-keyword">null</span>) &#123;<br>                state = <span class="hljs-keyword">false</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> state;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è®¾ç½®è¡Œ</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> index ç´¢å¼•</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">setRow</span><span class="hljs-params">(Integer index)</span> </span>&#123;<br>        row = sheet.getRow(index);<br>        <span class="hljs-keyword">return</span> row != <span class="hljs-keyword">null</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åç§»ä¸€è¡Œ</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">nextRow</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> offsetRow(<span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åç§»åˆ°ä¸‹ä¸€ä¸ª Sheet</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">nextSheet</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">boolean</span> state = <span class="hljs-keyword">true</span>;<br>        <span class="hljs-keyword">if</span> (sheet == <span class="hljs-keyword">null</span>) &#123;<br>            sheet = workbook.getSheetAt(<span class="hljs-number">0</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">int</span> index = workbook.getSheetIndex(sheet) + <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">if</span> (index &gt;= sheetCount) &#123;<br>                sheet = <span class="hljs-keyword">null</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                sheet = workbook.getSheetAt(index);<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (sheet == <span class="hljs-keyword">null</span>) &#123;<br>                state = <span class="hljs-keyword">false</span>;<br>            &#125;<br>        &#125;<br>        row = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">return</span> state;<br>    &#125;<br><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æºç åœ°å€"><a href="#æºç åœ°å€" class="headerlink" title="æºç åœ°å€"></a>æºç åœ°å€</h2><ul><li><a href="https://github.com/Mosiki/learning-modules/tree/master/learning-easypoi">https://github.com/Mosiki/learning-modules/tree/master/learning-easypoi</a></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://zkhdev.github.io/2018/10/14/java-dev6/">https://zkhdev.github.io/2018/10/14/java-dev6/</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Poiè¯»å–æŒ‡å®šä½ç½®çš„å•å…ƒæ ¼</tag>
      
      <tag>EasyPoiä¸è§„åˆ™æ•°æ®å¯¼å…¥</tag>
      
      <tag>Poiå¤æ‚è¡¨æ ¼æ•°æ®å¯¼å…¥</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€å®æˆ˜ã€‘Flywayè¿ç§»æŒ‡å—æœ€ä½³å®è·µ</title>
    <link href="/flyway-best-practice.html"/>
    <url>/flyway-best-practice.html</url>
    
    <content type="html"><![CDATA[<p>é¡¹ç›®åœ¨å¤šç¯å¢ƒè¿­ä»£å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ•°æ®åº“çš„è¡¨ç»“æ„ä¸æ–­å˜æ›´ï¼Œåœ¨éƒ¨ç½²æ—¶ï¼Œå¾€å¾€ä¼šå‡ºç°æ•°æ®åº“è¡¨ç»“æ„æœªåŠæ—¶å˜æ›´å¯¼è‡´å‡ºç°é—®é¢˜ï¼Œè€—è´¹åœ¨è¡¨ç»“æ„ä¸Šçš„æ—¶é—´ç›¸å½“å¤šï¼Œä¸Šçº¿è¿‡ç¨‹æŒç»­ç—›è‹¦ï¼Œä»£ç æœ‰ GIT/SVN æ¥æ§åˆ¶ï¼Œæ•°æ®åº“ä¸­çš„è¡¨ç‰ˆæœ¬ä¹Ÿå¯ä»¥åšåˆ°ç‰ˆæœ¬æ§åˆ¶ï¼Œæœ¬æ–‡è®²è§£é€šè¿‡ flyway çš„æ–¹å¼æ¥ç®¡ç†æ•°æ®åº“ç‰ˆæœ¬å˜åŠ¨ã€‚</p><a id="more"></a><h2 id="é¡¹ç›®ç—›ç‚¹"><a href="#é¡¹ç›®ç—›ç‚¹" class="headerlink" title="é¡¹ç›®ç—›ç‚¹"></a>é¡¹ç›®ç—›ç‚¹</h2><p>ä¸€ä¸ªé¡¹ç›®å•ä¸ªç¯å¢ƒè¿­ä»£å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹äºæ•°æ®åº“è¡¨çš„ä¿®æ”¹ DDLï¼Œå¯ä»¥é€šè¿‡ç‰ˆæœ¬æ§åˆ¶å·¥å…·ä¸€èµ·è¿›è¡Œæ§åˆ¶ã€‚åªéœ€è¦åœ¨é¡¹ç›®ä¸Šçº¿ä¹‹å‰ï¼Œäººå·¥æ‰§è¡Œæ–°å¢çš„ DDL å³å¯ï¼ŒDDL çš„ç‰ˆæœ¬æ˜¯ä¸å½“å‰é¡¹ç›®è¿­ä»£ç‰ˆæœ¬ä¸€è‡´ï¼Œç»†è‡´ç‚¹ä¸è‡³äºå‡ºç°é—®é¢˜ã€‚</p><p>å•ä¸ªç¯å¢ƒç‰ˆæœ¬è¿­ä»£ï¼Œæ•°æ®åº“çš„ç‰ˆæœ¬å·å˜æ›´æµç¨‹å¦‚ä¸‹å›¾ï¼š    </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200620135512.png">  </p><p>å¯¹äºåä¼ä¸šæœåŠ¡çš„å…¬å¸è€Œè¨€ï¼ŒåŒä¸€ä¸ªé¡¹ç›®ä¼šåŒæ—¶éƒ¨ç½²åˆ°å¤šå¥—ç¯å¢ƒå½“ä¸­ã€‚éšç€é¡¹ç›®è¿­ä»£è¿›è¡Œï¼Œä¸åŒç¯å¢ƒçš„é¡¹ç›®ç‰ˆæœ¬å¯èƒ½å¹¶éæ˜¯åŒæ­¥ä¸€è‡´çš„ï¼Œç”šè‡³å› ä¸ºæœ‰çš„ç¯å¢ƒéœ€è¦å®šåˆ¶åŒ–å¼€å‘ï¼Œå‡ºç°åŒä¸€ä¸ªé¡¹ç›®å¤šä¸ªåˆ†æ”¯ï¼Œä»£ç ä¹Ÿæ„ˆè¡Œæ„ˆè¿œã€‚</p><p>å¤šä¸ªç¯å¢ƒç‰ˆæœ¬è¿­ä»£ï¼Œæ•°æ®åº“çš„ç‰ˆæœ¬å·å˜æ›´æµç¨‹å¦‚ä¸‹å›¾ï¼š    </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200620135616.png">  </p><p>äºæ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸Šçº¿æœåŠ¡ä¹‹å‰å°±å¾ˆç—›è‹¦ï¼Œè¦æƒ³èµ·ä¸Šçº¿ç¯å¢ƒçš„å½“å‰è¡¨ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Œæƒ³ä¸èµ·æ¥ï¼Œå°±è¦å¯¹æ¯”çº¿ä¸Šåº“é‡Œçš„è¡¨ï¼Œåˆ¤æ–­æ˜¯å¦æ‰§è¡Œè¿‡äº†å¢é‡çš„ DDLï¼Œæ¯ä¸ªç¯å¢ƒçš„å¢é‡ DDL éƒ½å¯èƒ½æ˜¯ä¸åŒçš„ï¼Œéœ€è¦é’ˆå¯¹æ¯ä¸ªç¯å¢ƒå†™ä¸åŒçš„ DDLï¼Œå‘å¸ƒæ—¶æˆ˜æˆ˜å…¢å…¢åœ°ç”Ÿæ€•æ¼äº†æ‰§è¡Œå“ªä¸ªç‰ˆæœ¬çš„ DDL å¯¼è‡´çº¿ä¸Š Bugã€‚</p><p>é‚£å¦‚ä½•è§£å†³è¿™ç§ç³Ÿç³•çš„æƒ…å†µå‘¢ï¼Ÿ</p><p>ç†æƒ³çŠ¶æ€ï¼šé¡¹ç›®å¯åŠ¨æ—¶è‡ªåŠ¨ç»´æŠ¤æ•°æ®åº“ç‰ˆæœ¬åˆ°æœ€æ–°ï¼Œä¸éœ€è¦äººå·¥å¤„ç† DDLï¼Œé¿å…å‡ºé”™ã€‚</p><p>Flyway å°±æä¾›äº†è¾¾åˆ°è¿™ç§ç†æƒ³çŠ¶æ€çš„åŠŸèƒ½ã€‚</p><p>å…ˆè¯´ä¸€ä¸‹ Flyway çš„åŸç†ã€‚</p><p>å¼€å‘è€…å°†æ¯ä¸ªç‰ˆæœ¬çš„ DDL æ”¾åˆ°é¡¹ç›®ä¸­ï¼Œé¡¹ç›®åœ¨æ–°ç¯å¢ƒå¯åŠ¨æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºä¸€å¼ è¡¨ç”¨äºè®°å½• DDL çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œéšåè‡ªåŠ¨æ‰§è¡Œæœªæ‰§è¡Œè¿‡çš„ DDLï¼ŒåŒæ—¶å°†æ‰§è¡Œè¿‡çš„ DDL ä¿¡æ¯å­˜å…¥å…ƒæ•°æ®è¡¨ä¸­ã€‚ä¸‹æ¬¡å†å¯åŠ¨æ—¶ï¼Œæ£€æµ‹åˆ°æ‰§è¡Œè¿‡äº†ï¼Œå°±ä¸ä¼šé‡å¤æ‰§è¡Œã€‚</p><h2 id="æœ¬æ–‡ç¯å¢ƒ"><a href="#æœ¬æ–‡ç¯å¢ƒ" class="headerlink" title="æœ¬æ–‡ç¯å¢ƒ"></a>æœ¬æ–‡ç¯å¢ƒ</h2><ul><li>SpringBoot 2.1.3.RELEASE</li><li>Flyway 5.2.1</li></ul><h2 id="è¿ç§»æ­¥éª¤"><a href="#è¿ç§»æ­¥éª¤" class="headerlink" title="è¿ç§»æ­¥éª¤"></a>è¿ç§»æ­¥éª¤</h2><ol><li><p>å¼•å…¥ä¾èµ–</p> <figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.flywaydb<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>flyway-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>6.4.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>æ³¨ï¼šå¦‚æœ springboot ç‰ˆæœ¬ä½äº 2.0.0ï¼Œæœ€å¥½ä½¿ç”¨ 5.2.1 ç‰ˆæœ¬çš„ flyway-core   </p></li><li><p>æ·»åŠ  flyway é…ç½®æ–‡ä»¶</p><figure class="highlight yml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">flyway:</span> <span class="hljs-comment"># flyway æ•°æ®åº“ DDL ç‰ˆæœ¬æ§åˆ¶</span><br>    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># æ­£å¼ç¯å¢ƒæ‰å¼€å¯</span><br>    <span class="hljs-attr">clean-disabled:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># ç¦ç”¨æ•°æ®åº“æ¸…ç†</span><br>    <span class="hljs-attr">encoding:</span> <span class="hljs-string">UTF-8</span><br>    <span class="hljs-attr">locations:</span> <span class="hljs-string">classpath:/db</span><br>    <span class="hljs-comment">#  flyway ä¼šåœ¨åº“ä¸­åˆ›å»ºæ­¤åç§°å…ƒæ•°æ®è¡¨ï¼Œç”¨äºè®°å½•æ‰€æœ‰ç‰ˆæœ¬æ¼”åŒ–å’ŒçŠ¶æ€,åŒä¸€ä¸ªåº“ä¸åŒé¡¹ç›®å¯èƒ½å†²çªï¼Œæ¯ä¸ªé¡¹ç›®ä¸€å¼ è¡¨æ¥è®°å½•</span><br>    <span class="hljs-attr">table:</span> <span class="hljs-string">flyway_schema_history_FlywayExample</span> <span class="hljs-comment">#TODO å€¼çš„åç¼€æŒ‡å®šä¸ºå½“å‰é¡¹ç›®åç§°</span><br>    <span class="hljs-attr">baseline-version:</span> <span class="hljs-number">1</span> <span class="hljs-comment"># åŸºçº¿ç‰ˆæœ¬é»˜è®¤å¼€å§‹åºå· é»˜è®¤ä¸º 1</span><br>    <span class="hljs-attr">baseline-on-migrate:</span> <span class="hljs-literal">true</span> <span class="hljs-comment">#  é’ˆå¯¹éç©ºæ•°æ®åº“æ˜¯å¦é»˜è®¤è°ƒç”¨åŸºçº¿ç‰ˆæœ¬,ä¸ºç©ºçš„è¯é»˜è®¤ä¼šè°ƒç”¨åŸºçº¿ç‰ˆæœ¬</span><br>    <span class="hljs-attr">placeholders:</span> <span class="hljs-comment"># å®šä¹‰ afterMigrateError.sql è¦æ¸…ç†çš„å…ƒæ•°æ®è¡¨è¡¨å</span><br>      <span class="hljs-attr">flyway-table:</span> <span class="hljs-string">$&#123;spring.flyway.table&#125;</span><br></code></pre></div></td></tr></table></figure><p>flyway åœ¨å¯åŠ¨çš„æ—¶å€™ä¼šè‡ªåŠ¨åˆ›å»ºä¸€å¼ åç§°ä¸º <code>flyway_schema_history</code> çš„å…ƒæ•°æ®è¡¨ï¼Œå¦‚æœå¤šä¸ªé¡¹ç›®è¿æ¥çš„æ˜¯åŒä¸€ä¸ªæ•°æ®åº“ï¼Œä¼šäº§ç”Ÿå†²çªå½±å“ï¼Œæ‰€ä»¥éœ€è¦æ¯ä¸ªé¡¹ç›®éƒ½æœ‰ä¸€å¼ è‡ªå·±çš„å…ƒæ•°æ®è¡¨ï¼ŒæŒ‡å®š spring.flyway.table çš„å€¼å³å¯ï¼Œå¯ä»¥æŒ‡å®šä¸º <code>flyway_schema_history_&#123;é¡¹ç›®åç§°&#125;</code>ï¼Œè¿™æ ·åŸºæœ¬å¯ä»¥åšåˆ°ä¸ä¼šå‘ç”Ÿå†²çªäº†ã€‚</p></li><li><p>é¡¹ç›® resource ç›®å½•æ·»åŠ æ–‡ä»¶å¤¹. </p><p>åˆ›å»ºä¸Šä¸€æ­¥ä¸­ spring.flyway.locations ä¸­æŒ‡å®šå€¼çš„ç›®å½•ï¼Œæœ¬æ–‡æ˜¯åˆ›å»º db ç›®å½•. </p></li><li><p>é¡¹ç›® SQL è¿ç§». </p><p>SQL è¿ç§»è¿™é‡Œæœ‰ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯å½“å‰é¡¹ç›®åœ¨æ‰€æœ‰ç¯å¢ƒéƒ½æ˜¯åˆæ¬¡éƒ¨ç½²ï¼Œå³æ•°æ®åº“ä¸­å°šæœªæœ‰ä»»ä½•å½“å‰é¡¹ç›®çš„è¡¨ï¼Œè¿™ç§æƒ…å†µå¾ˆå¥½å¤„ç†ï¼Œä¸»è¦è®²ä¸€ä¸‹éåˆæ¬¡éƒ¨ç½²çš„æƒ…å†µ SQL è¿ç§»æ­¥éª¤ã€‚  </p><ol><li><p>å…ˆ dump ä¸€ä»½æ‰€æœ‰ç¯å¢ƒä¸­å½“å‰é¡¹ç›®æœ€æ–°ç‰ˆæœ¬çš„è¡¨ç»“æ„ï¼Œåœ¨ <code>resources/db</code>ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª <code>base_init.sql</code> æ–‡ä»¶ï¼Œå°†æœ€æ–°ç‰ˆæœ¬çš„ DDL ä»¥åŠéœ€è¦åˆå§‹åŒ–çš„æ•°æ®æ”¾åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œè¿™ä¸ª sql æ–‡ä»¶åæœŸå°±ä¸è¦åšä»»ä½•ä¿®æ”¹ã€‚</p></li><li><p><code>resources/db</code> ç›®å½•å¢åŠ ä¸€ä¸ªåä¸º <code>V1__init.sql</code>çš„æ–‡ä»¶ï¼Œå†…å®¹ä¸ºç©ºï¼Œç”¨äºå ä½</p></li><li><p>å°†æ‰€æœ‰ç¯å¢ƒçš„è¡¨ç»“æ„éƒ½ç»Ÿä¸€åˆ° <code>base_init.sql</code>è¿™ä¸ªç‰ˆæœ¬</p></li><li><p>å¦‚æœæœ‰æ–°å¢çš„ DDLï¼Œåˆ™åˆ›å»ºä¸€ä¸ªé«˜ç‰ˆæœ¬çš„ sql æ–‡ä»¶ï¼Œå¦‚<code>V2__add_table.sql</code>ï¼Œé¡¹ç›®å¯åŠ¨çš„æ—¶å€™ä¼šè‡ªåŠ¨æ‰§è¡Œ sqlï¼Œä½†æ˜¯ä¸ä¼šæ‰§è¡Œ V1 ç‰ˆæœ¬çš„ï¼Œæ‰€ä»¥æ·»åŠ äº† V1 ç‰ˆæœ¬çš„ç”¨äºå ä½ã€‚<strong>æ³¨æ„å¦‚æœæ–°å¢çš„ DDL ç‰ˆæœ¬æ²¡æœ‰æ‰§è¡Œå‡ºé”™ï¼Œåˆ‡å‹¿ä¿®æ”¹ï¼ï¼ï¼</strong></p></li><li><p>sql æ–‡ä»¶çš„å‘½åå…·æœ‰ä¸€å®šè§„åˆ™ï¼Œä»¥<code>V</code>å¼€å¤´ï¼Œæ¥ç€ä¸¤ä¸ªä¸‹åˆ’çº¿ <code>__</code>ï¼Œæ¥ç€å¯ä»¥å†™æ³¨é‡Šï¼Œç„¶åä»¥ <code>.sql</code> ç»“å°¾ï¼Œå¦‚<code>V3__alter_table.sql</code> ç‰ˆæœ¬å·æ”¯æŒå°ç‰ˆæœ¬<code>x.y.z</code>æ ¼å¼ï¼Œä½†æ˜¯ä¸ºäº†ç®€å•èµ·è§ï¼Œç›´æ¥ç”¨ä¸€ä¸ªæ•°å­—é€’å¢æ›´æ–¹ä¾¿ã€‚</p></li><li><p><strong>å¦‚æœéœ€è¦éƒ¨ç½²åˆ°æ–°çš„ç¯å¢ƒï¼Œåˆ™åªéœ€è¦æ‰§è¡Œ <code>base_init.sql</code>ä¸­ DDL å³å¯ï¼Œå…¶ä»–ç‰ˆæœ¬çš„ DDL äº¤ç»™ flyway å°±å¯ä»¥äº†</strong>ã€‚</p></li><li><p>Over~</p></li><li><p>æœ‰æ—¶å€™å¦‚æœæ–°ç‰ˆæœ¬çš„ DDL å†™é”™äº†ï¼Œå¯èƒ½ä¼šå¯¼è‡´ flyway æ‰§è¡Œå¤±è´¥ï¼Œä¼šåœ¨å…ƒæ•°æ®è¡¨ä¸­å¢åŠ ä¸€æ¡æ‰§è¡Œ status ä¸º 0 çš„è®°å½•ï¼Œåªè¦ status æœ‰ä¸º 0 çš„è®°å½•ï¼Œé¡¹ç›®å°±æ— æ³•å¯åŠ¨ï¼Œè¿™æ ·å°±å¾ˆéš¾å—ï¼Œç½‘ä¸Šè§£å†³æ–¹å¼å¤šæ˜¯æ‰‹åŠ¨å»æ•°æ®åº“åˆ é™¤è¿™æ¡è®°å½•ï¼Œè¿™æœªå…å¤ªå±é™©ï¼Œå¯ä»¥åˆ©ç”¨ flyway çš„ callback æ¥å®ç°æ‰§è¡Œå¤±è´¥ï¼Œè‡ªåŠ¨åˆ é™¤å¤±è´¥è®°å½•ã€‚åœ¨ <code>resources/db</code>ç›®å½•ä¸‹æ·»åŠ åä¸º <code>afterMigrateError.sql</code>æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¸º</p><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-comment">-- SQL æ‰§è¡Œå¤±è´¥ï¼Œæ¸…ç† flyway å…ƒæ•°æ®è¡¨ä¸­å¤±è´¥çš„æ‰§è¡Œè®°å½•</span><br>DELETE IGNORE FROM `$&#123;flyway-table&#125;` WHERE success = 0;<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­çš„å˜é‡å°±æ˜¯å½“å‰é¡¹ç›®å…ƒæ•°æ®è¡¨çš„è¡¨åç§°ã€‚</p></li><li><p>å¦‚æœå½“å‰é¡¹ç›®<strong>åœ¨æ‰€æœ‰ç¯å¢ƒéƒ½æ˜¯åˆæ¬¡éƒ¨ç½²</strong>ï¼Œé‚£å°±ä¸éœ€è¦ <code>base_init.sql</code>ï¼Œåˆå§‹åŒ–ç›´æ¥æ”¾åˆ° <code>V1__init.sql</code> å½“ä¸­ï¼Œä¸Šçº¿æ—¶ä¸å†éœ€è¦æ‰‹åŠ¨æ‰§è¡Œ SQLï¼Œå…¨éƒ¨äº¤ç”± flyway æ¥æ‰§è¡Œå³å¯ã€‚å¦‚æœæ•°æ®åº“æ¯”å¦‚æµ‹è¯•ç¯å¢ƒå­˜åœ¨ç»å¸¸æ‰‹åŠ¨ä¿®æ”¹è¡¨å¢åŠ è¡¨çš„æƒ…å†µï¼Œéœ€è¦å…³é—­ flywayï¼Œå­˜åœ¨ flyway å› ä¸ºåœ¨æ‰‹åŠ¨æ‰§è¡Œ SQL æ‰§è¡Œä¹‹åå†æ‰§è¡Œå¯¼è‡´æ‰§è¡Œå¤±è´¥çš„æƒ…å†µï¼Œæ‰€ä»¥æŸä¸ªç¯å¢ƒä½¿ç”¨äº† flyway æ§åˆ¶ç‰ˆæœ¬ä¹‹åï¼Œå°±ä¸è¦å†æ‰‹åŠ¨å¢åˆ æ”¹è¡¨ã€‚</p></li><li><p>Over~~~</p></li></ol></li></ol><h2 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h2><ol><li><p>å‡ºç° <strong>java.sql.SQLException: sql injection violation, comment not allow : CREATE TABLE xxxxxx.flyway_schema_history_xxx</strong><br>æ£€æŸ¥æ˜¯å¦ä½¿ç”¨çš„æ˜¯ druid ï¼Œé”™è¯¯åŸå› æ˜¯å»ºè¡¨è¯­å¥ä¸­åŒ…å«äº† SQL æ³¨é‡Šï¼Œdruid é»˜è®¤ä¼šæ‹¦æˆªåŒ…å«æ³¨é‡Šçš„ SQL æ‰§è¡Œï¼Œéœ€è¦ä¿®æ”¹ druid é…ç½®ï¼Œå…è®¸æ³¨é‡Šã€‚ï¼ˆä¸çŸ¥é“ flyway ä¸ºä»€ä¹ˆè¦æŠŠæ³¨é‡Šå†™åˆ°å»ºè¡¨è¯­å¥ä¸­ï¼‰</p><figure class="highlight yml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">datasource:</span><br>    <span class="hljs-attr">druid:</span><br>      <span class="hljs-comment"># ...... çœç•¥å…¶ä»–</span><br>      <span class="hljs-attr">filter:</span><br>        <span class="hljs-attr">stat:</span><br>          <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br>        <span class="hljs-attr">slf4j:</span><br>          <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br>        <span class="hljs-attr">wall:</span><br>          <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br>          <span class="hljs-attr">config:</span><br>            <span class="hljs-attr">comment-allow:</span> <span class="hljs-literal">true</span><br><span class="hljs-comment">#     filters: stat,wall,slf4j æ³¨é‡Šæ­¤è¡Œï¼Œfilteræ”¹æˆä¸Šé¢çš„æ ¼å¼</span><br></code></pre></div></td></tr></table></figure></li></ol><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é’ˆå¯¹å¤šç¯å¢ƒè¿ç§»æµç¨‹</p><ol><li>æ‰€æœ‰ç¯å¢ƒæ•°æ®åº“è¡¨ç‰ˆæœ¬ç»Ÿä¸€åˆ°æœ€æ–°ç‰ˆæœ¬</li><li>å°†æœ€æ–°ç‰ˆæœ¬ DDL æ”¾åˆ° <code>base_init.sql</code>ä¸­</li><li>åç»­è¿­ä»£åœ¨ resource/db ç›®å½•ä¸‹å¢åŠ æ–°ç‰ˆæœ¬çš„ DDL æ–‡ä»¶</li><li>å¦‚æœæ˜¯æ–°ç¯å¢ƒï¼Œå…ˆé€šè¿‡ <code>base_init.sql</code> è¿›è¡Œåˆå§‹åŒ–ï¼Œå†å¯åŠ¨é¡¹ç›®å³å¯ï¼Œéæ–°ç¯å¢ƒï¼Œç›´æ¥å¯åŠ¨é¡¹ç›®å³å¯</li></ol><h2 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h2><ul><li><a href="https://github.com/Mosiki/learning-modules/tree/master/learning-flyway">https://github.com/Mosiki/learning-modules/tree/master/learning-flyway</a></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li>Flyway å®˜ç½‘åœ°å€ï¼š <a href="https://flywaydb.org/">https://flywaydb.org/</a>     </li><li>Druid : <a href="https://github.com/alibaba/druid/issues/3546">https://github.com/alibaba/druid/issues/3546</a>  </li><li>Springboot flyway repair <a href="https://flywaydb.org/documentation/callbacks">callbacks</a></li><li>Springboot flyway repair: <a href="https://stackoverflow.com/questions/37462550/flyway-repair-with-spring-boot">https://stackoverflow.com/questions/37462550/flyway-repair-with-spring-boot</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Flywayè¿ç§»</tag>
      
      <tag>æ•°æ®åº“SQLç‰ˆæœ¬æ§åˆ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®æˆ˜åŸºäºRediså®ç°é˜»å¡é˜Ÿåˆ—</title>
    <link href="/redis-block-queue.html"/>
    <url>/redis-block-queue.html</url>
    
    <content type="html"><![CDATA[<p>æ—¥å¸¸éœ€æ±‚å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸å…ä¼šé‡åˆ°éœ€è¦é€šè¿‡ä»£ç è¿›è¡Œå¼‚æ­¥å¤„ç†çš„æƒ…å†µï¼Œæ¯”å¦‚æ‰¹é‡å‘é€é‚®ä»¶ï¼Œæ‰¹é‡å‘é€çŸ­ä¿¡ï¼Œæ•°æ®å¯¼å…¥ï¼Œä¸ºäº†å‡å°‘ç”¨æˆ·çš„ç­‰å¾…ï¼Œä¸å¸Œæœ›ä¸€ç›´èŠèŠ±è½¬å•Šè½¬ï¼Œå› æ­¤éœ€è¦è¿›è¡Œå¼‚æ­¥å¤„ç†ï¼Œåšæ³•å°±æ˜¯è®²è¦å¤„ç†çš„æ•°æ®æ·»åŠ åˆ°é˜Ÿåˆ—å½“ä¸­ï¼Œç„¶åæŒ‰ç…§æ’é˜Ÿçš„å…ˆåé¡ºåºè¿›è¡Œå¼‚æ­¥å¤„ç†ã€‚  </p><p>è¿™ä¸ªé˜Ÿåˆ—ï¼Œå¯ä»¥æ˜¯ä¸“ä¸šçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¦‚ RocketMQ/RabbitMQ ç­‰ï¼Œä¸€èˆ¬é¡¹ç›®ä¸­ï¼Œå¦‚æœåªæ˜¯ä¸ºäº†è¿›è¡Œå¼‚æ­¥ï¼Œæœªå…æœ‰ç‚¹æ€é¸¡ç”¨ç‰›åˆ€çš„æ„å‘³ã€‚<br>ä¹Ÿå¯ä»¥ä½¿ç”¨åŸºäº JVM å†…å­˜å®ç°é˜Ÿåˆ—ï¼Œä½†æ˜¯å¦‚æœé¡¹ç›®è¿›è¡Œäº†é‡å¯ï¼Œå°±ä¼šé€ æˆé˜Ÿåˆ—æ•°æ®ä¸¢å¤±ã€‚<br>å¤§éƒ¨åˆ†çš„é¡¹ç›®éƒ½ä¼šç”¨åˆ° Redis ä¸­é—´ä»¶ä½œä¸ºç¼“å­˜ä½¿ç”¨ï¼Œæ­¤æ—¶ä½¿ç”¨ Redis çš„ list ç»“æ„æ¥å®ç°é˜Ÿåˆ—åˆ™æ˜¯éå¸¸åˆé€‚çš„é€‰æ‹©ã€‚  </p><p>å› æ­¤ï¼Œæœ¬æ–‡ä¸»è¦è®²è§£åŸºäº Redis çš„æ–¹å¼å®ç°å¼‚æ­¥é˜Ÿåˆ—ã€‚</p><a id="more"></a><p>åŸºäº Redis çš„ list å®ç°é˜Ÿåˆ—çš„æ–¹å¼ä¹Ÿæœ‰å¤šç§ï¼Œå…ˆè¯´ç¬¬ä¸€ç§ä¸æ¨èçš„æ–¹å¼ï¼Œå³ä½¿ç”¨<code>LPUSH</code>ç”Ÿäº§æ¶ˆæ¯ï¼Œç„¶å while(true) ä¸­é€šè¿‡<code>RPOP</code>æ¶ˆè´¹æ¶ˆæ¯ï¼Œè¿™ç§æ–¹å¼çš„ç¡®å¯ä»¥å®ç°ï¼Œä½†æ˜¯ä¸æ–­ä»£ç ä¸æ–­çš„è½®è¯¢ï¼ŒåŠ¿å¿…ä¼šæ¶ˆè€—ä¸€äº›ç³»ç»Ÿçš„èµ„æºã€‚</p><p>ç¬¬äºŒç§æ–¹å¼ä¹Ÿæ˜¯ä¸æ¨èçš„æ–¹å¼ï¼Œä¹Ÿæ˜¯é€šè¿‡ <code>LPUSH</code>ç”Ÿäº§æ¶ˆæ¯ï¼Œç„¶åé€šè¿‡ <code>BRPOP</code> è¿›è¡Œ<strong>é˜»å¡åœ°</strong>ç­‰å¾…å¹¶æ¶ˆè´¹æ¶ˆæ¯ï¼Œè¿™ç§æ–¹å¼è¾ƒç¬¬ä¸€ç§æ–¹å¼å‡å°‘äº†æ— ç”¨çš„è½®è¯¢ï¼Œé™ä½ç³»ç»Ÿèµ„æºçš„æ¶ˆè€—ï¼Œä½†æ˜¯å¯èƒ½ä¼šå­˜åœ¨é˜Ÿåˆ—æ¶ˆæ¯ä¸¢å¤±çš„æƒ…å†µï¼Œå¦‚æœå–å‡ºäº†æ¶ˆæ¯ç„¶åå¤„ç†å¤±è´¥ï¼Œè¿™ä¸ªè¢«å–å‡ºçš„æ¶ˆæ¯å°±å°†ä¸¢å¤±ã€‚</p><p>ç¬¬äºŒç§æ–¹å¼å°±æ˜¯ä¸‹æ–‡è¦ä»‹ç»çš„æ–¹å¼ï¼Œé¦–å…ˆä¹Ÿæ˜¯é€šè¿‡ <code>LPUSH</code> ç”Ÿäº§æ¶ˆæ¯ï¼Œç„¶åé€šè¿‡ <code>BRPOPLPUSH</code><strong>é˜»å¡</strong>åœ°ç­‰å¾… list æ–°æ¶ˆæ¯åˆ°æ¥ï¼Œæœ‰äº†æ–°æ¶ˆæ¯æ‰å¼€å§‹æ¶ˆè´¹ï¼ŒåŒæ—¶å°†æ¶ˆæ¯å¤‡ä»½åˆ°å¦å¤–ä¸€ä¸ª list å½“ä¸­ï¼Œè¿™ç§æ–¹å¼å…·å¤‡äº†ç¬¬äºŒç§æ–¹å¼çš„ä¼˜ç‚¹ï¼Œå³å‡å°‘äº†æ— ç”¨çš„è½®è¯¢ï¼ŒåŒæ—¶ä¹Ÿå¯¹æ¶ˆæ¯è¿›è¡Œäº†å¤‡ä»½ä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œå¦‚æœå¤„ç†æˆåŠŸï¼Œå¯ä»¥é€šè¿‡ <code>LREM</code> å¯¹å¤‡ä»½çš„ list ä¸­å½“å‰çš„è¿™æ¡æ¶ˆæ¯è¿›è¡Œåˆ é™¤å¤„ç†ã€‚è¿™ç§æ–¹å¼å®ç°æ–¹å¼å¯ä»¥å‚è€ƒ <a href="http://redisdoc.com/list/rpoplpush.html#id3">æ¨¡å¼ï¼š å®‰å…¨çš„é˜Ÿåˆ— </a>.<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200614160321.png">  </p><h2 id="Redis-åŸºç¡€"><a href="#Redis-åŸºç¡€" class="headerlink" title="Redis åŸºç¡€"></a>Redis åŸºç¡€</h2><figure class="highlight vala"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vala"><span class="hljs-meta"># å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ value æ’å…¥åˆ°åˆ—è¡¨ key çš„è¡¨å¤´</span><br>LPUSH key value [value â€¦]<br><br><span class="hljs-meta"># é˜»å¡å¼ç­‰å¾…ï¼Œå°†åˆ—è¡¨ source ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´  (å°¾å…ƒç´ ) å¼¹å‡ºï¼Œå¹¶è¿”å›ç»™å®¢æˆ·ç«¯ã€‚å°† source å¼¹å‡ºçš„å…ƒç´ æ’å…¥åˆ°åˆ—è¡¨ destination ï¼Œä½œä¸º destination åˆ—è¡¨çš„çš„å¤´å…ƒç´ ã€‚è¶…æ—¶å‚æ•° timeout æ¥å—ä¸€ä¸ªä»¥ç§’ä¸ºå•ä½çš„æ•°å­—ä½œä¸ºå€¼ã€‚è¶…æ—¶å‚æ•°è®¾ä¸º 0 è¡¨ç¤ºé˜»å¡æ—¶é—´å¯ä»¥æ— é™æœŸå»¶é•¿ (block indefinitely) ã€‚</span><br>BRPOPLPUSH source destination timeout<br><br><span class="hljs-meta"># æ ¹æ®å‚æ•° count çš„å€¼ï¼Œç§»é™¤åˆ—è¡¨ä¸­ä¸å‚æ•° value ç›¸ç­‰çš„å…ƒç´ ã€‚</span><br>LREM key count value<br></code></pre></div></td></tr></table></figure><h2 id="ä»£ç å®ç°é˜Ÿåˆ—æ¶ˆæ¯ç”Ÿäº§è€…"><a href="#ä»£ç å®ç°é˜Ÿåˆ—æ¶ˆæ¯ç”Ÿäº§è€…" class="headerlink" title="ä»£ç å®ç°é˜Ÿåˆ—æ¶ˆæ¯ç”Ÿäº§è€…"></a>ä»£ç å®ç°é˜Ÿåˆ—æ¶ˆæ¯ç”Ÿäº§è€…</h2><p>ç¬”è€…ä½¿ç”¨çš„æ˜¯ Spring ç›¸å…³ API å®ç°å¯¹ Redis æŒ‡ä»¤çš„è°ƒç”¨ã€‚é¦–å…ˆå®ç°æ¶ˆæ¯çš„ç”Ÿäº§ä»£ç ï¼Œå°è£…åˆ°ä¸€ä¸ªå·¥å…·ç±»æ–¹æ³•å½“ä¸­ã€‚è¿™é‡Œå¾ˆç®€å•ï¼Œå°±æ˜¯è°ƒç”¨äº† lpush æ–¹æ³•ï¼Œå°†åºåˆ—åŒ–çš„ key å’Œ value æ·»åŠ åˆ°åˆ—è¡¨å½“ä¸­å»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Resource</span><br><span class="hljs-keyword">private</span> RedisConnectionFactory connectionFactory;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lPush</span><span class="hljs-params">(<span class="hljs-meta">@Nonnull</span> String key, <span class="hljs-meta">@Nonnull</span> String value)</span> </span>&#123;<br>  RedisConnection connection = RedisConnectionUtils.getConnection(connectionFactory);<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">byte</span>[] byteKey = RedisSerializer.string().serialize(getKey(key));<br>    <span class="hljs-keyword">byte</span>[] byteValue = RedisSerializer.string().serialize(value);<br>    <span class="hljs-keyword">assert</span> byteKey != <span class="hljs-keyword">null</span>;<br>    connection.lPush(byteKey, byteValue);<br>  &#125; <span class="hljs-keyword">finally</span> &#123;<br>    RedisConnectionUtils.releaseConnection(connection, connectionFactory);<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ä»£ç å®ç°é˜Ÿåˆ—æ¶ˆæ¯æ¶ˆè´¹è€…"><a href="#ä»£ç å®ç°é˜Ÿåˆ—æ¶ˆæ¯æ¶ˆè´¹è€…" class="headerlink" title="ä»£ç å®ç°é˜Ÿåˆ—æ¶ˆæ¯æ¶ˆè´¹è€…"></a>ä»£ç å®ç°é˜Ÿåˆ—æ¶ˆæ¯æ¶ˆè´¹è€…</h2><p> å› ä¸ºå®ç°é˜Ÿåˆ—æ¶ˆè´¹æ¶ˆæ¯çš„ä»£ç æ¯”è¾ƒå¤šï¼Œä¸å¯èƒ½æ¯ä¸ªéœ€è¦é˜»å¡æ¶ˆè´¹çš„åœ°æ–¹ï¼Œå¯¹éœ€è¦å†™è¿™ä¸€å¨ä»£ç ï¼Œå› æ­¤ä½¿ç”¨ Java8 çš„å‡½æ•°å¼æ¥å£å®ç°æ–¹æ³•çš„ä¼ é€’ï¼ŒåŒæ—¶é˜»å¡å¼è·å–æ¶ˆæ¯ä»£ç ä½¿ç”¨æ–°çº¿ç¨‹å»æ‰§è¡Œã€‚</p><p>æœ‰äººçœ‹åˆ°ä»¥ä¸‹ä»£ç è¦åæ§½äº†ï¼Œä¸æ˜¯è¯´ä¸ç”¨ while(true) å—ï¼Œæ€ä¹ˆä½ è¿™é‡Œé¢è¿˜æ˜¯æœ‰ï¼Œè¿™é‡Œç¨å¾®è§£é‡Šä¸€ä¸‹ï¼Œå› ä¸º SpringBoot ä¸€èˆ¬ä¼šæŒ‡å®š timeout çš„å…¨å±€è¶…æ—¶æ—¶é—´ï¼Œå³ä½¿ <code>BRPOPLPUSH</code> è®¾ç½®äº† 0ï¼Œå³æ— é™æœŸï¼Œå½“è¶…å‡ºäº† timeout è®¾ç½®çš„å€¼æ—¶ï¼Œå°±ä¼šæŠ›å‡º QueryTimeoutException å¼‚å¸¸å¯¼è‡´çº¿ç¨‹é€€å‡ºï¼Œå› æ­¤æ·»åŠ äº† try/catch å¯¹å¼‚å¸¸è¿›è¡Œæ•è·å¹¶å¿½ç•¥ï¼ŒåŒæ—¶ä½¿ç”¨ while(true) ä¿è¯çº¿ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚<br>ä»£ç ä¸­è®°å½•äº†å½“å‰æ¶ˆæ¯å¤„ç†ç»“æœï¼Œå¦‚æœå¤„ç†ç»“æœä¸ºæˆåŠŸï¼Œéœ€è¦å¯¹å¤‡ä»½é˜Ÿåˆ—çš„å½“å‰æ¶ˆæ¯è¿›è¡Œåˆ é™¤ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">bRPopLPush</span><span class="hljs-params">(<span class="hljs-meta">@Nonnull</span> String key, Consumer&lt;String&gt; consumer)</span> </span>&#123;<br>  CompletableFuture.runAsync(() -&gt; &#123;<br>    RedisConnection connection = RedisConnectionUtils.getConnection(connectionFactory);<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-keyword">byte</span>[] srcKey = RedisSerializer.string().serialize(getKey(key));<br>      <span class="hljs-keyword">byte</span>[] dstKey = RedisSerializer.string().serialize(getBackupKey(key));<br>      <span class="hljs-keyword">assert</span> srcKey != <span class="hljs-keyword">null</span>;<br>      <span class="hljs-keyword">assert</span> dstKey != <span class="hljs-keyword">null</span>;<br>      <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>        <span class="hljs-keyword">byte</span>[] byteValue = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">boolean</span> success = <span class="hljs-keyword">false</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>          byteValue = connection.bRPopLPush(<span class="hljs-number">0</span>, srcKey, dstKey);<br>          <span class="hljs-keyword">if</span> (byteValue != <span class="hljs-keyword">null</span> &amp;&amp; byteValue.length != <span class="hljs-number">0</span>) &#123;<br>            consumer.accept(<span class="hljs-keyword">new</span> String(byteValue));<br>            success = <span class="hljs-keyword">true</span>;<br>          &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (Exception ignored) &#123;<br>          <span class="hljs-comment">// é˜²æ­¢è·å– key è¾¾åˆ°è¶…æ—¶æ—¶é—´æŠ›å‡º QueryTimeoutException å¼‚å¸¸é€€å‡º</span><br>           <span class="hljs-comment">// é˜²æ­¢ Redis è¿æ¥å¤±æ•ˆï¼Œé‡æ–°è·å–è¿æ¥  https://github.com/Mosiki/learning-modules/issues/5</span><br>RedisConnectionUtils.releaseConnection(connection, connectionFactory);<br>         connection = RedisConnectionUtils.getConnection(connectionFactory);<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>          <span class="hljs-keyword">if</span> (success) &#123;<br>            <span class="hljs-comment">// å¤„ç†æˆåŠŸæ‰åˆ é™¤å¤‡ä»½é˜Ÿåˆ—çš„ key</span><br>            connection.lRem(dstKey, <span class="hljs-number">1</span>, byteValue);<br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>      RedisConnectionUtils.releaseConnection(connection, connectionFactory);<br>    &#125;<br>  &#125;);<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æµ‹è¯•ä»£ç "><a href="#æµ‹è¯•ä»£ç " class="headerlink" title="æµ‹è¯•ä»£ç "></a>æµ‹è¯•ä»£ç </h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testLPush</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123;<br>  String queueA = <span class="hljs-string">&quot;queueA&quot;</span>;<br>  <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>    String msg = <span class="hljs-string">&quot;Hello-&quot;</span> + i++;<br>    redisBlockQueue.lPush(queueA, msg);<br>    System.out.println(<span class="hljs-string">&quot;lPush: &quot;</span> + msg);<br>    Thread.sleep(<span class="hljs-number">3000</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testBRPopLPush</span><span class="hljs-params">()</span> </span>&#123;<br>  String queueA = <span class="hljs-string">&quot;queueA&quot;</span>;<br>  redisBlockQueue.bRPopLPush(queueA, (val) -&gt; &#123;<br>    <span class="hljs-comment">// åœ¨è¿™é‡Œå¤„ç†å…·ä½“çš„ä¸šåŠ¡é€»è¾‘</span><br>    System.out.println(<span class="hljs-string">&quot;val: &quot;</span> + val);<br>  &#125;);<br><br>  <span class="hljs-comment">// é˜²æ­¢ Junit è¿›ç¨‹é€€å‡º</span><br>  LockSupport.park();<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/redis-queue.gif">  </p><h2 id="é¡¹ç›®ä½¿ç”¨æ–¹å¼"><a href="#é¡¹ç›®ä½¿ç”¨æ–¹å¼" class="headerlink" title="é¡¹ç›®ä½¿ç”¨æ–¹å¼"></a>é¡¹ç›®ä½¿ç”¨æ–¹å¼</h2><p>ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œæˆ‘å°†å…¶æŠ½å–ä¸ºäº†ä¸€ä¸ªå·¥å…·ç±»ï¼Œä½¿ç”¨æ—¶é€šè¿‡ Spring æ³¨å…¥ä½¿ç”¨å³å¯ï¼Œ<br>é˜Ÿåˆ—æ¶ˆè´¹å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™å°±è¿›è¡Œé˜»å¡ç›‘å¬é˜Ÿåˆ—ï¼Œç­‰å¾…æ¶ˆè´¹</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Resource</span><br><span class="hljs-keyword">private</span> RedisBlockQueue redisBlockQueue;<br><br><span class="hljs-meta">@PostConstruct</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>&#123;<br>   redisBlockQueue.bRPopLPush(xx, (value) -&gt; &#123;<br>     <span class="hljs-comment">//...</span><br>   &#125;);<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æœ¬æ–‡å®Œæ•´ä»£ç ä¸‹è½½"><a href="#æœ¬æ–‡å®Œæ•´ä»£ç ä¸‹è½½" class="headerlink" title="æœ¬æ–‡å®Œæ•´ä»£ç ä¸‹è½½"></a>æœ¬æ–‡å®Œæ•´ä»£ç ä¸‹è½½</h2><ul><li><a href="https://github.com/Mosiki/learning-modules/tree/master/learning-redis">github åœ°å€ </a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redisé˜»å¡é˜Ÿåˆ—å®ç°</tag>
      
      <tag>å¼‚æ­¥é˜Ÿåˆ—å¤„ç†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¥å£é‰´æƒç­¾åå®è·µ</title>
    <link href="/interface-authentication.html"/>
    <url>/interface-authentication.html</url>
    
    <content type="html"><![CDATA[<p>å·¥ä½œå½“ä¸­ä¸å…è¦ä¸å…¶ä»–çš„å…¬å¸è¿›è¡Œæ‰“äº¤é“ï¼Œæ¯”å¦‚è°ƒç”¨å¯¹æ–¹çš„æ¥å£å®ŒæˆæŸé¡¹æ“ä½œï¼Œæˆ–è€…æä¾›æ¥å£ç»™å¯¹æ–¹è°ƒç”¨ï¼Œè¿™äº›æ¥å£å¯èƒ½ä½¿ç”¨è€…æœ‰å¾ˆå¤šå…¬å¸ï¼Œä¸ºäº†ä¿è¯æ¥å£çš„å®‰å…¨æ€§ï¼Œéœ€è¦è®¾è®¡ä¸€äº›æ–¹å¼æ¥å¯¹æ¥å£è¿›è¡Œä¿æŠ¤ï¼Œå¸¸è§çš„ä¿æŠ¤æªæ–½æœ‰ IP ç™½åå•ä¸æ¥å£ç­¾åã€‚<br>IP ç™½åå•è¿™ç§æ–¹å¼å°±ä¸å¤šè¯´å¾ˆç®€å•ï¼Œåˆ¤æ–­æ¥å£è°ƒç”¨è€… IP æ˜¯å¦åœ¨è®¾å®šçš„ç™½åå• IP ä¹‹ä¸­å³å¯ã€‚ä½†æ˜¯ IP ç™½åå•è¿™ç§æ–¹å¼æœ‰ä¸ªå¼Šç«¯å°±æ˜¯ç»´æŠ¤ç™½åå• IP åˆ—è¡¨æˆäº†ä½“åŠ›æ´»ï¼Œè°ƒç”¨æ–¹å¢åŠ æœåŠ¡å™¨æˆ–è€…å‡å°‘æœåŠ¡å™¨å°±è¦æ›´æ–°ç™½åå•ï¼Œå¯¹äºæ¥å£æä¾›æ–¹ä¸æ˜¯å¾ˆå‹å¥½ï¼Œæœ€å¥½ä½¿ç”¨ç­¾åçš„æ–¹å¼ä¸€åŠ³æ°¸é€¸ï¼Œå› æ­¤æœ¬æ–‡ä¸»è¦è®²è®²å¸¸ç”¨çš„æ¥å£ç­¾åæ–¹å¼ï¼Œä¸»è¦åº”ç”¨ä¸æœåŠ¡ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´çš„æ¥å£äº¤äº’ã€‚<br>å› ä¸ºç”Ÿæˆç­¾åè¿‡ç¨‹ä¸­ä½¿ç”¨åˆ°äº† appSecretï¼Œå› æ­¤è¿™ç§æ–¹å¼æœ€å¥½ä¸è¦ç”¨äºå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´çš„æ¥å£åŠ å¯†ï¼ŒappSecret å†™æ­»åœ¨ APP ä¸­ï¼Œé€†å‘æŠ€æœ¯è·å–ä¸æ˜¯å¤ªå›°éš¾çš„äº‹æƒ…ï¼Œå½“ç„¶éè¦ä½¿ç”¨ï¼ŒappSecret æœ€å¥½é€šè¿‡ç™»å½•æ—¶åŠ¨æ€ç”Ÿæˆï¼Œå†™æ­»çš„æ–¹å¼ä¸€å‘æ˜¯ä¸æ¨èçš„åšæ³•ã€‚</p><a id="more"></a><h2 id="æ¥å£ç­¾åä½œç”¨"><a href="#æ¥å£ç­¾åä½œç”¨" class="headerlink" title="æ¥å£ç­¾åä½œç”¨"></a>æ¥å£ç­¾åä½œç”¨</h2><p>æ¥å£ç­¾åè§£å†³äº†å¦‚ä¸‹è¿™äº›é—®é¢˜ï¼š</p><ul><li>é˜²æ­¢æ¥å£éæ³•è°ƒç”¨</li><li>é˜²æ­¢æ¥å£å‚æ•°è¢«ç¯¡æ”¹</li><li>é˜²æ­¢æ¥å£è¿‡æœŸå‚æ•°è¯·æ±‚</li><li>é˜²æ­¢æ¥å£è¯·æ±‚é‡æ”¾</li></ul><h2 id="æ¥å£ç­¾åæ–¹å¼"><a href="#æ¥å£ç­¾åæ–¹å¼" class="headerlink" title="æ¥å£ç­¾åæ–¹å¼"></a>æ¥å£ç­¾åæ–¹å¼</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œæ¥å£ç­¾åæ–¹å¼ä¸»è¦æ˜¯è¿™æ ·çš„ï¼Œæ‰€æœ‰çš„æ¥å£éƒ½éœ€è¦ä¼ é€’è¿™å‡ ä¸ªå…¬å…±å‚æ•°<code>appKey</code>ã€ <code>sign</code>ã€<code>timestamp</code>ã€<code>nonce</code>ï¼Œsign çš„è®¡ç®—è§„åˆ™ä¸º</p><ol><li>æ‹¼æ¥æ¥å£çš„æ‰€æœ‰å‚æ•°ï¼Œå‚æ•°åæŒ‰ç…§ ASCII ç ä»å°åˆ°å¤§æ’åºï¼ˆå­—å…¸åºï¼‰ï¼Œæ‹¼æ¥çš„æ ¼å¼å¦‚ k1=v1&amp;k2=v2&amp;k3=v3 å¾—åˆ° params</li><li>Base64(HMAC_SHA1(params, appSecret))ï¼Œå¾—åˆ° sign å€¼</li><li>sign åŠ åˆ°å‚æ•°ä¸­ï¼Œå‘é€è¯·æ±‚ç›®æ ‡æ¥å£<br>ä»¥ä¸Šå°±æ˜¯ç”Ÿæˆç­¾åçš„è¿‡ç¨‹ã€‚</li></ol><p>éªŒè¯ç­¾åçš„è¿‡ç¨‹ä¸ä¹‹ç›¸åŒï¼Œå°±æ˜¯ä»è¯·æ±‚ä¸­æå–æ‰€æœ‰çš„å‚æ•°ï¼ˆé™¤å» signï¼‰ï¼Œç„¶ååŒæ ·çš„æ–¹å¼ç”Ÿæˆç­¾åï¼Œç„¶åå°†ç­¾åç»“æœä¸è¯·æ±‚ä¸­çš„ sign å‚æ•°è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœä¸€è‡´åˆ™éªŒç­¾æˆåŠŸå¦åˆ™å¤±è´¥ã€‚ä¸ºäº†ä¿è¯æ¥å£å‚æ•°çš„æ—¶æ•ˆæ€§ï¼Œä¸€èˆ¬ä¼šåœ¨éªŒç­¾ä¹‹å‰æ ¡éªŒ <code>timestamp</code> å‚æ•°æ˜¯å¦è¶…æ—¶ï¼Œæ¯”å¦‚ä¸å½“å‰æ—¶é—´ç›¸å·® 10 åˆ†é’Ÿåˆ™ç›´æ¥æç¤ºéªŒç­¾å¤±è´¥ã€‚å¦å¤–ä¸ºäº†é˜²æ­¢è¯·æ±‚é‡æ”¾ï¼Œå³ç›¸åŒå‚æ•°ä¸å¯é‡å¤è¯·æ±‚ï¼Œå¯ä»¥é€šè¿‡å°† nonce å‚æ•°è¿›è¡Œç¼“å­˜ï¼Œæ¯”å¦‚é˜²æ­¢åˆ° Redis å½“ä¸­ï¼Œè®¾ç½® 10 åˆ†é’Ÿçš„æœ‰æ•ˆæœŸï¼Œå¦‚æœ nonce å­˜åœ¨ä¸ç¼“å­˜ä¸­åˆ™æç¤ºéªŒç­¾å¤±è´¥ï¼Œè¿™æ ·ä¾¿é€šè¿‡ nonce é…åˆ timestamp å®ç°äº†è¯·æ±‚é‡æ”¾ã€‚</p><p>è¯ä¸å¤šå°‘ï¼Œå¼€å§‹å®è·µä¸€ä¸‹~</p><p>ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œå°±å† main æ–¹æ³•ä¸­å®ç°ç­¾åä¸éªŒç­¾çš„é€»è¾‘ã€‚<br>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¯ä»¥é›†æˆä¸º springboot starterï¼Œé€šè¿‡æ‹¦æˆªå™¨è¿›è¡Œç»Ÿä¸€æ ¡éªŒã€‚å¦‚ä½•è‡ªå®šä¹‰ springboot starterï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¸Šä¸€ç¯‡æ–‡ç« ï¼š<a href="http://nullpointer.pw/custom-springboot-starter.html">å®ç”¨ä¸»ä¹‰ä¹‹è‡ªå®šä¹‰ SpringBootStarter</a></p><h2 id="ä¾èµ–æ·»åŠ "><a href="#ä¾èµ–æ·»åŠ " class="headerlink" title="ä¾èµ–æ·»åŠ "></a>ä¾èµ–æ·»åŠ </h2><p>å› ä¸ºåŠ å¯†ç®—æ³•ä½¿ç”¨åˆ°äº†å¼€æºå·¥å…·åŒ… <code>commons-codec</code>ï¼Œå…ˆæ·»åŠ è¿™ä¸ªä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-codec<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-codec<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.14<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h2 id="ç”Ÿæˆç­¾åä¸éªŒç­¾"><a href="#ç”Ÿæˆç­¾åä¸éªŒç­¾" class="headerlink" title="ç”Ÿæˆç­¾åä¸éªŒç­¾"></a>ç”Ÿæˆç­¾åä¸éªŒç­¾</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.apache.commons.codec.binary.Base64;<br><span class="hljs-keyword">import</span> org.apache.commons.codec.digest.HmacAlgorithms;<br><span class="hljs-keyword">import</span> org.apache.commons.codec.digest.HmacUtils;<br><br><span class="hljs-keyword">import</span> java.time.Duration;<br><span class="hljs-keyword">import</span> java.time.Instant;<br><span class="hljs-keyword">import</span> java.time.LocalDateTime;<br><span class="hljs-keyword">import</span> java.time.ZoneOffset;<br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> java.time.temporal.ChronoUnit.SECONDS;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> WeJan</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2020-05-31</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AuthTest</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;********************************* ç­¾å *********************************&quot;</span>);<br><span class="hljs-comment">//        long timestamp = LocalDateTime.now().plusMinutes(-10).toInstant(ZoneOffset.ofHours(8)).toEpochMilli();</span><br>        <span class="hljs-keyword">long</span> timestamp = System.currentTimeMillis();<br>        String appKey = <span class="hljs-string">&quot;testtest&quot;</span>;<br>        String appSecret = <span class="hljs-string">&quot;123456&quot;</span>;<br><br>        Map&lt;String, String&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br>        map.put(<span class="hljs-string">&quot;appKey&quot;</span>, appKey);<br>        map.put(<span class="hljs-string">&quot;k1&quot;</span>, <span class="hljs-string">&quot;k1&quot;</span>);<br>        map.put(<span class="hljs-string">&quot;k2&quot;</span>, <span class="hljs-string">&quot;k2&quot;</span>);<br>        map.put(<span class="hljs-string">&quot;timestamp&quot;</span>, String.valueOf(timestamp));<br>        String outSignData = getSignData(map);<br>        <span class="hljs-keyword">byte</span>[] hmac = <span class="hljs-keyword">new</span> HmacUtils(HmacAlgorithms.HMAC_SHA_1, appSecret).hmac(outSignData);<br>        String sign = <span class="hljs-keyword">new</span> String(Base64.encodeBase64(hmac));<br>        map.put(<span class="hljs-string">&quot;sign&quot;</span>, sign);<br>        System.out.println(<span class="hljs-string">&quot;outSign: &quot;</span> + sign);<br>        System.out.println(<span class="hljs-string">&quot;outSignData: &quot;</span> + outSignData);<br>        String outParams = JSONObject.toJSONString(map);<br>        System.out.println(<span class="hljs-string">&quot;outParams: &quot;</span> + outParams);<br><br>        System.out.println(<span class="hljs-string">&quot;\n\n********************************* éªŒç­¾ *********************************&quot;</span>);<br>        Map&lt;String, String&gt; inMap = JSONObject.parseObject(outParams, <span class="hljs-keyword">new</span> TypeReference&lt;Map&lt;String, String&gt;&gt;() &#123;<br>        &#125;);<br>        <span class="hljs-comment">// æ ¡éªŒè¯·æ±‚æ˜¯å¦è¿‡æœŸ</span><br>        String inTimeStamp = inMap.getOrDefault(<span class="hljs-string">&quot;timestamp&quot;</span>, <span class="hljs-string">&quot;0&quot;</span>);<br>        LocalDateTime inTime = LocalDateTime.ofInstant(Instant.ofEpochMilli(Long.parseLong(inTimeStamp)), ZoneOffset.ofHours(<span class="hljs-number">8</span>));<br>        Duration duration = Duration.between(inTime, LocalDateTime.now());<br>        <span class="hljs-keyword">long</span> seconds = duration.get(SECONDS);<br>        System.out.println(<span class="hljs-string">&quot;seconds: &quot;</span> + seconds);<br>        <span class="hljs-keyword">if</span> (seconds &gt; <span class="hljs-number">10</span> * <span class="hljs-number">60</span>) &#123;<br>            System.out.println(<span class="hljs-string">&quot;è¯·æ±‚è¶…æ—¶&quot;</span>);<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        String inSignData = getSignData(inMap);<br>        System.out.println(<span class="hljs-string">&quot;inSignData: &quot;</span> + inSignData);<br>        <span class="hljs-keyword">byte</span>[] inHmac = <span class="hljs-keyword">new</span> HmacUtils(HmacAlgorithms.HMAC_SHA_1, appSecret).hmac(inSignData);<br>        String sign2 = <span class="hljs-keyword">new</span> String(Base64.encodeBase64(inHmac));<br>        System.out.println(<span class="hljs-string">&quot;sign2: &quot;</span> + sign2);<br>        System.out.println(<span class="hljs-string">&quot;éªŒç­¾ç»“æœ: &quot;</span> + sign.equals(sign2));<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getSignData</span><span class="hljs-params">(Map&lt;String, String&gt; params)</span> </span>&#123;<br>        StringBuilder content = <span class="hljs-keyword">new</span> StringBuilder();<br>        <span class="hljs-comment">// key è‡ªç„¶æ’åº</span><br>        List&lt;String&gt; keys = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(params.keySet());<br>        Collections.sort(keys);<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; keys.size(); i++) &#123;<br>            String key = keys.get(i);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;sign&quot;</span>.equals(key)) &#123;<br>                <span class="hljs-keyword">continue</span>;<br>            &#125;<br>            String value = params.get(key);<br>            <span class="hljs-keyword">if</span> (value != <span class="hljs-keyword">null</span>) &#123;<br>                content.append(i == <span class="hljs-number">0</span> ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&amp;&quot;</span>).append(key).append(<span class="hljs-string">&quot;=&quot;</span>).append(value);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                content.append(i == <span class="hljs-number">0</span> ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&amp;&quot;</span>).append(key).append(<span class="hljs-string">&quot;=&quot;</span>);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> content.toString();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs markdown"><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-emphasis">* ç­¾å <span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span>*</span><br>outSign: eADUCnVqcArdexcdMVcHkPJQyXU=<br>outSignData: appKey=testtest&amp;k1=k1&amp;k2=k2&amp;timestamp=1590996917340<br>outParams: &#123;&quot;k1&quot;:&quot;k1&quot;,&quot;k2&quot;:&quot;k2&quot;,&quot;sign&quot;:&quot;eADUCnVqcArdexcdMVcHkPJQyXU=&quot;,&quot;appKey&quot;:&quot;testtest&quot;,&quot;timestamp&quot;:&quot;1590996917340&quot;&#125;<br><br><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-emphasis">* éªŒç­¾ <span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span>*</span><br>seconds: 0<br>inSignData: appKey=testtest&amp;k1=k1&amp;k2=k2&amp;timestamp=1590996917340<br>sign2: eADUCnVqcArdexcdMVcHkPJQyXU=<br>éªŒç­¾ç»“æœ: true<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¥å£é‰´æƒ</tag>
      
      <tag>æ¥å£ç­¾å</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®ç”¨ä¸»ä¹‰ä¹‹è‡ªå®šä¹‰SpringBootStarter</title>
    <link href="/custom-springboot-starter.html"/>
    <url>/custom-springboot-starter.html</url>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©ä»¥å®ç”¨è§’åº¦åˆ‡å…¥ï¼Œæ¥ç¤ºèŒƒè‡ªå®šä¹‰ springboot starter åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­çš„å®é™…åº”ç”¨ã€‚</p><p>SpringBoot ç›¸å¯¹äº Spring æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯æä¾›äº†ç›¸å½“æ•°é‡çš„ starterï¼Œåªéœ€å¼•å…¥ starter è¿›è¡Œæå°‘é‡çš„é…ç½®å°±å¯ä½¿ç”¨ç›¸åº”çš„åŠŸèƒ½ï¼Œæœ‰æ•ˆå‡å°‘ Spring å†—ä½™å¤æ‚çš„é…ç½®æ–‡ä»¶ã€‚ä½†æ—¥å¸¸å·¥ä½œå½“ä¸­ï¼Œæˆ‘ä»¬è‡ªå·±ä¹Ÿä¼šå°è£…ä¸€äº›æ¯”è¾ƒé€šç”¨çš„ä»£ç  jar åŒ…ï¼Œå¼•å…¥åˆ°æ–°çš„é¡¹ç›®ä¸­å¾ˆéš¾é¿å…æ·»åŠ ç›¸åº”çš„é…ç½®ï¼Œæ¯”å¦‚ Bean çš„å£°æ˜ã€‚å€Ÿé‰´ SpringBoot å®˜æ–¹åšæ³•ï¼Œæˆ‘ä»¬è‡ªå·±ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ‰€éœ€è¦çš„ Starterã€‚</p><p>ä»Šå¤©ä»¥ç»Ÿä¸€é¡¹ç›®æ—¥æœŸæ ¼å¼åŒ–åŠŸèƒ½ä¸ºä¾‹ï¼Œä»å¤´åˆ°å°¾åœ°ä»‹ç»å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ª Starterã€‚</p><a id="more"></a><h2 id="å¼•å…¥-Starter-åˆè¡·"><a href="#å¼•å…¥-Starter-åˆè¡·" class="headerlink" title="å¼•å…¥ Starter åˆè¡·"></a>å¼•å…¥ Starter åˆè¡·</h2><p>å¯¹äºä¸€ä¸ªéœ€è¦æä¾› HTTP æ¥å£çš„æœåŠ¡æ¥è¯´ï¼Œæ—¥æœŸçš„æ ¼å¼åŒ–ä¸ºå‹å¥½çš„æ ¼å¼è¿”å›æ˜¯ä¸€ä¸ªæ— æ³•é¿å…çš„é—®é¢˜ã€‚å®ä½“ç±»ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Example</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> LocalDateTime localDateTime;<br>    <span class="hljs-keyword">private</span> LocalDate localDate;<br>    <span class="hljs-keyword">private</span> Date date;<br>    <span class="hljs-keyword">private</span> LocalTime localTime;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>åšæ³•æœ‰å¾ˆå¤šï¼Œç¬¬ä¸€ç§æ˜¯æ¯”å¦‚æ•°æ®åº“å®ä½“ç±»å­—æ®µä½¿ç”¨çš„æ˜¯ Date ç±»å‹ï¼ŒLocalDateTime ç±»å‹ï¼Œè¿”å›ç»™å‰ç«¯çš„ VO ä¸­å­—æ®µåˆ™ä½¿ç”¨ Long ç±»å‹æˆ–è€… String ç±»å‹ï¼Œåœ¨å®ä½“ç±»è¿›è¡Œè½¬æ¢çš„è¿‡ç¨‹ä¸­è½¬æ¢æ—¶é—´ç±»å‹ã€‚</p><p>ç¬¬äºŒç§æ–¹å¼æ˜¯å¯ä»¥ä½¿ç”¨<code>@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</code>æ³¨è§£çš„æ–¹å¼ï¼Œä¸è¿‡è¿™ç§æ–¹å¼å°±éœ€è¦åœ¨æ‰€æœ‰çš„ VO ä¸Šæ·»åŠ è¿™ä¸ªæ³¨è§£ã€‚</p><p>ç¬¬ä¸‰ç§æ–¹å¼æ˜¯è¿˜å¯ä»¥åœ¨ application.yml ä¸­é…ç½®å¦‚ä¸‹</p><figure class="highlight yml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">jackson:</span><br>    <span class="hljs-attr">date-format:</span> <span class="hljs-string">yyyy-MM-dd</span> <span class="hljs-string">HH:mm:ss</span><br></code></pre></div></td></tr></table></figure><p>å‰ä¸¤ç§æ–¹å¼éƒ½æ¯”è¾ƒ lowï¼Œæš‚ä¸”ä¸è°ˆï¼Œç¬¬ä¸‰ç§æ–¹å¼å¯ä»¥å®ç°ç»Ÿä¸€å…¨å±€ Date ç±»å‹çš„æ ¼å¼åŒ–ï¼Œä½†æ˜¯éšç€ Java8 çš„å¹¿æ³›åº”ç”¨ï¼ŒJava8 æ–°çš„ Time ç›¸å…³ç±»ä½¿ç”¨æ›´å¤šï¼Œè€Œç¬¬ä¸‰ç§æ–¹å¼æ— æ³•å®ç° LocalDateTime ç­‰æ ¼å¼åŒ–ã€‚</p><p>è®¿é—®æ¥å£ <code>http://127.0.0.1:8083/learning-example/test</code></p><p>æœªæ·»åŠ é…ç½®å‰è¿”å›ï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;data&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;localDateTime&quot;</span>: <span class="hljs-string">&quot;2020-05-14T10:15:13.311&quot;</span>,<br>        <span class="hljs-attr">&quot;localDate&quot;</span>: <span class="hljs-string">&quot;2020-05-14&quot;</span>,<br>        <span class="hljs-attr">&quot;date&quot;</span>: <span class="hljs-string">&quot;2020-05-14T02:15:13.306+0000&quot;</span>,<br>        <span class="hljs-attr">&quot;localTime&quot;</span>: <span class="hljs-string">&quot;10:15:13.311&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;success&quot;</span>: <span class="hljs-literal">true</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ·»åŠ é…ç½®åè¿”å›ï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;data&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;localDateTime&quot;</span>: <span class="hljs-string">&quot;2020-05-14T10:17:37.437&quot;</span>,<br>        <span class="hljs-attr">&quot;localDate&quot;</span>: <span class="hljs-string">&quot;2020-05-14&quot;</span>,<br>        <span class="hljs-attr">&quot;date&quot;</span>: <span class="hljs-string">&quot;2020-05-14 02:17:37&quot;</span>,<br>        <span class="hljs-attr">&quot;localTime&quot;</span>: <span class="hljs-string">&quot;10:17:37.437&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;success&quot;</span>: <span class="hljs-literal">true</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>å‘ç°å³ä¾¿æ·»åŠ  <code>spring.jackson.date-format</code> é…ç½®ï¼Œä¹Ÿä»…ä»…å¯¹ Date ç±»å‹çš„ç”Ÿæ•ˆå®Œæˆæ ¼å¼åŒ–ï¼Œè€Œ Java 8 æ–°çš„æ—¶é—´å¯¹è±¡å‡æœªèµ·åˆ°ä½œç”¨ã€‚</p><p>ä¸‹é¢é€šè¿‡è§£å†³ä»¥ä¸Šé—®é¢˜è¿‡ç¨‹ï¼Œæ¥ç¤ºèŒƒå¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ª SpringBoot Starter</p><h2 id="è‡ªå®šä¹‰-Starter"><a href="#è‡ªå®šä¹‰-Starter" class="headerlink" title="è‡ªå®šä¹‰ Starter"></a>è‡ªå®šä¹‰ Starter</h2><h3 id="åˆ›å»ºä¸€ä¸ª-starter-å·¥ç¨‹"><a href="#åˆ›å»ºä¸€ä¸ª-starter-å·¥ç¨‹" class="headerlink" title="åˆ›å»ºä¸€ä¸ª starter å·¥ç¨‹"></a>åˆ›å»ºä¸€ä¸ª starter å·¥ç¨‹</h3><p>spring Boot starter çš„å·¥ç¨‹å®˜æ–¹ç»™å‡ºäº†è§„èŒƒï¼Œå¦‚ä¸‹</p><blockquote><p><strong>å®˜æ–¹å‘½åç©ºé—´</strong></p><ul><li>å‰ç¼€ï¼šspring-boot-starter-</li><li>æ¨¡å¼ï¼šspring-boot-starter-æ¨¡å—å</li><li>ä¸¾ä¾‹ï¼šspring-boot-starter-webã€spring-boot-starter-jdbc</li></ul><p><strong>è‡ªå®šä¹‰å‘½åç©ºé—´</strong></p><ul><li>åç¼€ï¼š-spring-boot-starter</li><li>æ¨¡å¼ï¼šæ¨¡å—-spring-boot-starter</li><li>ä¸¾ä¾‹ï¼šmybatis-spring-boot-starter</li></ul></blockquote><p>æ–°å»ºå·¥ç¨‹å‘½åä¸º <code>common-spring-boot-starter</code>ï¼Œæ·»åŠ ç›¸å…³ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-autoconfigure<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--ç”Ÿæˆå±æ€§æç¤º--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--jackson --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-json<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h3 id="å®šä¹‰è‡ªåŠ¨é…ç½®ç±»"><a href="#å®šä¹‰è‡ªåŠ¨é…ç½®ç±»" class="headerlink" title="å®šä¹‰è‡ªåŠ¨é…ç½®ç±»"></a>å®šä¹‰è‡ªåŠ¨é…ç½®ç±»</h3><p>ä¸ºäº†ä½¿ starter æ›´çµæ´»ï¼Œä¾¿äºè‡ªå®šä¹‰ï¼Œæ¯”å¦‚æ˜¯å¦å¯ç”¨å…¨å±€æ ¼å¼åŒ–ï¼Œæ ¼å¼åŒ–çš„æ ¼å¼ç­‰ï¼Œæä¾› starter é…ç½®å¼€å…³æ¥æ§åˆ¶ã€‚</p><p>é€šè¿‡é…åˆä½¿ç”¨ <code>@ConditionalOnProperty</code> æ³¨è§£ï¼Œæ¥è¾¾åˆ°è‡ªå®šä¹‰æ˜¯å¦å¼€å¯å…¨å±€æ ¼å¼åŒ–å¼€å…³çš„ç›®çš„ï¼Œåªæœ‰å½“é…ç½®ä¸­å­˜åœ¨ <code>common.date-format.enabled</code> ï¼Œä¸”å€¼ä¸º true æ—¶ï¼Œæ‰å¯ç”¨ã€‚</p><p>é€šè¿‡ <code>@EnableConfigurationProperties</code> æ³¨è§£åŠ è½½é…ç½®ï¼Œå¯ä»¥è‡ªè¡Œå®šä¹‰æ ¼å¼åŒ–çš„æ ¼å¼ï¼Œæ¯”å¦‚ LocalDate é»˜è®¤æ ¼å¼ä¸º <code>yyyy-MM-dd</code>ï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ä¸º <code>yyyy/MM/dd</code>ï¼Œå¯ä»¥åšåˆ°ç›¸å½“çµæ´»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@EnableConfigurationProperties(DateFormatProperties.class)</span><br><span class="hljs-meta">@ConditionalOnProperty(prefix = &quot;common.date-format&quot;, name = &quot;enabled&quot;, matchIfMissing = false, havingValue = &quot;true&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DateFormatAutoConfiguration</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> DateFormatProperties dateFormatProperties;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">DateFormatAutoConfiguration</span><span class="hljs-params">(DateFormatProperties dateFormatProperties)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.dateFormatProperties = dateFormatProperties;<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Jackson2ObjectMapperBuilderCustomizer <span class="hljs-title">customizer</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> builder -&gt; &#123;<br>            builder.locale(Locale.CHINA);<br>            builder.timeZone(TimeZone.getTimeZone(ZoneId.systemDefault()));<br>            builder.simpleDateFormat(dateFormatProperties.getDatePattern());<br>            builder.modules(<span class="hljs-keyword">new</span> JavaTimeModule());<br>        &#125;;<br>    &#125;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JavaTimeModule</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SimpleModule</span> </span>&#123;<br>        JavaTimeModule() &#123;<br>            <span class="hljs-keyword">super</span>(PackageVersion.VERSION);<br>            DateTimeFormatter localDateTimeFormatter = DateTimeFormatter.ofPattern(dateFormatProperties.getLocalDateTimePattern());<br>            DateTimeFormatter localDateFormatter = DateTimeFormatter.ofPattern(dateFormatProperties.getLocalDatePattern());<br>            DateTimeFormatter localTimeFormatter = DateTimeFormatter.ofPattern(dateFormatProperties.getLocalTimePattern());<br><br>            <span class="hljs-keyword">this</span>.addSerializer(LocalDateTime.class, <span class="hljs-keyword">new</span> LocalDateTimeSerializer(localDateTimeFormatter));<br>            <span class="hljs-keyword">this</span>.addSerializer(LocalDate.class, <span class="hljs-keyword">new</span> LocalDateSerializer(localDateFormatter));<br>            <span class="hljs-keyword">this</span>.addSerializer(LocalTime.class, <span class="hljs-keyword">new</span> LocalTimeSerializer(localTimeFormatter));<br>            <span class="hljs-keyword">this</span>.addDeserializer(LocalDateTime.class, <span class="hljs-keyword">new</span> LocalDateTimeDeserializer(localDateTimeFormatter));<br>            <span class="hljs-keyword">this</span>.addDeserializer(LocalDate.class, <span class="hljs-keyword">new</span> LocalDateDeserializer(localDateFormatter));<br>            <span class="hljs-keyword">this</span>.addDeserializer(LocalTime.class, <span class="hljs-keyword">new</span> LocalTimeDeserializer(localTimeFormatter));<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> WeJan</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2020-05-14</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@ConfigurationProperties(&quot;common.date-format&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DateFormatProperties</span> </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Date Format Pattern</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String datePattern = <span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * LocalDateTime Format Pattern</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String localDateTimePattern = <span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * LocalDate Format Pattern</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String localDatePattern = <span class="hljs-string">&quot;yyyy-MM-dd&quot;</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * LocalTime Format Pattern</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String localTimePattern = <span class="hljs-string">&quot;HH:mm:ss&quot;</span>;<br><br>  <span class="hljs-comment">// TODO ç¯‡å¹…é™åˆ¶ï¼Œæ­¤å¤„çœç•¥ getter/setter æ–¹æ³•</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="è®©é…ç½®ç±»ç”Ÿæ•ˆ"><a href="#è®©é…ç½®ç±»ç”Ÿæ•ˆ" class="headerlink" title="è®©é…ç½®ç±»ç”Ÿæ•ˆ"></a>è®©é…ç½®ç±»ç”Ÿæ•ˆ</h3><p>ä¸Šæ–‡ä»…å®šä¹‰äº†è‡ªåŠ¨é…ç½®ç±»ï¼Œä½†æ˜¯æƒ³è¦è®© Spring åŠ è½½è¿™ä¸ªé…ç½®ç±»ï¼Œè¿˜éœ€è¦åœ¨ starter å·¥ç¨‹ä¸­æ·»åŠ  <strong>spring.factories</strong> </p><p>åœ¨ <code>resources</code> ç›®å½•ä¸‹å»ºç«‹ <strong>META-INF</strong> æ–‡ä»¶å¤¹ï¼Œå†åˆ›å»º <strong>spring.factories</strong> æ–‡ä»¶ï¼Œå†æŒ‡å®šè‡ªåŠ¨é…ç½®ç±»çš„å…¨é™å®šç±»åã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.boot</span><span class="hljs-selector-class">.autoconfigure</span>.EnableAutoConfiguration=\<br>pw<span class="hljs-selector-class">.nullpointer</span><span class="hljs-selector-class">.boot</span><span class="hljs-selector-class">.autoconfigure</span><span class="hljs-selector-class">.date</span>.DateFormatAutoConfiguration<br></code></pre></div></td></tr></table></figure><h3 id="Install-æœ¬åœ°-maven-ä»“åº“"><a href="#Install-æœ¬åœ°-maven-ä»“åº“" class="headerlink" title="Install æœ¬åœ° maven ä»“åº“"></a>Install æœ¬åœ° maven ä»“åº“</h3><p>æ‰§è¡Œ mvn installï¼Œå®‰è£…åˆ°æœ¬åœ° maven ä»“åº“</p><h2 id="æµ‹è¯•-starter"><a href="#æµ‹è¯•-starter" class="headerlink" title="æµ‹è¯• starter"></a>æµ‹è¯• starter</h2><h3 id="å¼•å…¥è‡ªå®šä¹‰çš„-starter"><a href="#å¼•å…¥è‡ªå®šä¹‰çš„-starter" class="headerlink" title="å¼•å…¥è‡ªå®šä¹‰çš„ starter"></a>å¼•å…¥è‡ªå®šä¹‰çš„ starter</h3><p>åˆ›å»º example å·¥ç¨‹ï¼Œå¼•å…¥åˆšæ‰ install åˆ° maven ä»“åº“çš„ starter</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>pw.nullpointer.tp<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>common-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h3 id="å¼€å¯-starter-æ—¶é—´æ ¼å¼åŒ–åŠŸèƒ½"><a href="#å¼€å¯-starter-æ—¶é—´æ ¼å¼åŒ–åŠŸèƒ½" class="headerlink" title="å¼€å¯ starter æ—¶é—´æ ¼å¼åŒ–åŠŸèƒ½"></a>å¼€å¯ starter æ—¶é—´æ ¼å¼åŒ–åŠŸèƒ½</h3><p>ä¸Šæ–‡ä¸­è‡ªå®šä¹‰çš„ starter é»˜è®¤è®¾ç½®çš„æ˜¯ä¸å¯ç”¨ï¼Œå› æ­¤éœ€è¦åœ¨é…ç½®æ–‡ä»¶<code>application.yml</code>ä¸­å¯ç”¨ä¸€ä¸‹æ ¼å¼åŒ–åŠŸèƒ½ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yml"><span class="hljs-attr">common:</span><br>  <span class="hljs-attr">date-format:</span><br>    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># å¼€å¯æ—¶é—´æ ¼å¼åŒ–åŠŸèƒ½</span><br></code></pre></div></td></tr></table></figure><h3 id="å¯åŠ¨é¡¹ç›®æµ‹è¯•"><a href="#å¯åŠ¨é¡¹ç›®æµ‹è¯•" class="headerlink" title="å¯åŠ¨é¡¹ç›®æµ‹è¯•"></a>å¯åŠ¨é¡¹ç›®æµ‹è¯•</h3><p>è®¿é—®æ¥å£ï¼š<a href="http://127.0.0.1:8083/learning-example/test%EF%BC%8C%E8%BF%94%E5%9B%9E%E5%A6%82%E4%B8%8B%EF%BC%9A">http://127.0.0.1:8083/learning-example/testï¼Œè¿”å›å¦‚ä¸‹ï¼š</a></p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;data&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;localDateTime&quot;</span>: <span class="hljs-string">&quot;2020-05-14 11:22:29&quot;</span>,<br>        <span class="hljs-attr">&quot;localDate&quot;</span>: <span class="hljs-string">&quot;2020-05-14&quot;</span>,<br>        <span class="hljs-attr">&quot;date&quot;</span>: <span class="hljs-string">&quot;2020-05-14 11:22:29&quot;</span>,<br>        <span class="hljs-attr">&quot;localTime&quot;</span>: <span class="hljs-string">&quot;11:22:29&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;success&quot;</span>: <span class="hljs-literal">true</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æ ¼å¼åŒ–å·²ç»ç”Ÿæ•ˆäº†ï¼Œé¡ºä¾¿æµ‹è¯•ä¸€ä¸‹è‡ªå®šä¹‰æ ¼å¼åŒ–ï¼Œä¿®æ”¹ application.yml æ–‡ä»¶</p><figure class="highlight yml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yml"><span class="hljs-attr">common:</span><br>  <span class="hljs-attr">date-format:</span><br>    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">local-date-pattern:</span> <span class="hljs-string">yyyy/MM/dd</span><br></code></pre></div></td></tr></table></figure><p>å†æ¬¡æµ‹è¯•ï¼Œæ¥å£è¿”å›ï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;data&quot;</span>: &#123;<br>        <span class="hljs-attr">&quot;localDateTime&quot;</span>: <span class="hljs-string">&quot;2020-05-14 11:27:16&quot;</span>,<br>        <span class="hljs-attr">&quot;localDate&quot;</span>: <span class="hljs-string">&quot;2020/05/14&quot;</span>,<br>        <span class="hljs-attr">&quot;date&quot;</span>: <span class="hljs-string">&quot;2020-05-14 11:27:16&quot;</span>,<br>        <span class="hljs-attr">&quot;localTime&quot;</span>: <span class="hljs-string">&quot;11:27:16&quot;</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;success&quot;</span>: <span class="hljs-literal">true</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ä¼˜åŒ–-starter-å±æ€§æç¤º"><a href="#ä¼˜åŒ–-starter-å±æ€§æç¤º" class="headerlink" title="ä¼˜åŒ– starter å±æ€§æç¤º"></a>ä¼˜åŒ– starter å±æ€§æç¤º</h2><p>åœ¨ä½¿ç”¨ springboot å®˜æ–¹ starter è¿‡ç¨‹ä¸­ï¼Œåœ¨ç¼–å†™ application.yml çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰å“ªäº›å±æ€§ï¼ŒIDEA ä¼šè‡ªåŠ¨æç¤ºå‡ºæ¥ï¼Œä¸ºäº†è¾¾åˆ°è¿™ç§æ•ˆæœï¼Œéœ€è¦å¼•å…¥ä¾èµ– <code>spring-boot-configuration-processor</code>ï¼Œå¼•å…¥åï¼Œstarter åœ¨æ‰“åŒ…çš„è¿‡ç¨‹ä¸­ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆ <code>spring-configuration-metadata.json</code> æ–‡ä»¶ï¼Œä½¿ç”¨ starter è¿‡ç¨‹ä¸­ä¾¿æœ‰ç›¸åº”çš„æç¤ºäº†ã€‚å‰æ–‡åˆå§‹åŒ– starter çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»å¼•å…¥è¿‡è¿™ä¸ªä¾èµ–äº†ï¼Œæ‰€ä»¥å°±ä¸ç”¨å†é‡å¤å¼•å…¥äº†ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>ä½†åªæ ¹æ®è¿™ä¸ªä¾èµ–ç”Ÿæˆçš„<code>spring-configuration-metadata.json</code> æ–‡ä»¶ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­å¯ä»¥å‘ç° <code>common.date-format.enabled</code> è¿™ä¸ªå±æ€§å¼€å…³æ˜¯æ²¡æœ‰æç¤ºå‡ºæ¥çš„ï¼Œå¯ä»¥çŒœæµ‹åˆ° <code>spring-boot-configuration-processor</code>æ˜¯æ ¹æ®å±æ€§ç”Ÿæˆçš„ï¼Œä½†æ˜¯ enabled è¿™ä¸ªéå±æ€§ï¼Œæ‰€ä»¥æ— æ³•ç”Ÿæˆã€‚ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ starter çš„äººï¼Œæˆ‘ä»¬å¯ä»¥è¿½åŠ ä¸€ä¸ª <code>additional-spring-configuration-metadata.json</code> æ–‡ä»¶ï¼Œæ‰‹åŠ¨æ·»åŠ ç›¸åº”çš„æç¤ºï¼Œæ–‡ä»¶å†…å®¹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;properties&quot;</span>: [<br>    &#123;<br>      <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;common.date-format.enabled&quot;</span>,<br>      <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;java.lang.Boolean&quot;</span>,<br>      <span class="hljs-attr">&quot;description&quot;</span>: <span class="hljs-string">&quot;æ˜¯å¦å¼€å¯æ—¶é—´æ ¼å¼åŒ–&quot;</span>,<br>      <span class="hljs-attr">&quot;defaultValue&quot;</span>: <span class="hljs-literal">false</span><br>    &#125;<br>  ]<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä½¿ç”¨æ•ˆæœï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/image-20200516184327486.png" alt="image-20200516184327486"></p><p>æµ‹è¯•å®Œæ¯•ï¼Œä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œå¯ä»¥å°†è‡ªå®šä¹‰çš„ starter å‘å¸ƒåˆ°å…¬å¸çš„ç§æœã€‚<code>mvn deploy</code></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡é€šè¿‡è®²è§£å®ç°ä¸€ä¸ªé¡¹ç›®æ—¶é—´å…¨å±€æ ¼å¼åŒ–åŠŸèƒ½ï¼Œå¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ª springboot starterï¼Œå½“ç„¶ starter åŠŸèƒ½ä¸ä»…é™å¦‚æ­¤ï¼Œå¯ä»¥è‡ªè¡Œè§¦ç±»æ—é€šæ‰©å±•ï¼Œæ¯”å¦‚é¡¹ç›®çš„ç™»å½•æ‹¦æˆªå™¨ã€é€šç”¨æ—¥å¿—ã€å…¨å±€å¼‚å¸¸å¤„ç†ç­‰å·¥ç¨‹éƒ½å¯ä»¥ä½œä¸º starter çš„ä¸€éƒ¨åˆ†æ¥å®ç°ï¼Œè¯»è€…è‹¥çœ‹å®Œæœ‰å¸®åŠ©å¹¶å®è·µåº”ç”¨ï¼Œå¯ä»¥è¯„è®ºç•™è¨€åº”ç”¨çš„åœºæ™¯ã€‚</p><h2 id="ä»£ç ä¸‹è½½"><a href="#ä»£ç ä¸‹è½½" class="headerlink" title="ä»£ç ä¸‹è½½"></a>ä»£ç ä¸‹è½½</h2><ul><li><a href="https://github.com/Mosiki/learning-modules/tree/master/learning-springboot">https://github.com/Mosiki/learning-modules/tree/master/learning-springboot</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è‡ªå®šä¹‰SpringBootStarter</tag>
      
      <tag>LocalDateTimeæ ¼å¼åŒ–</tag>
      
      <tag>SpringBootStarterå®é™…åº”ç”¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆ©ç”¨Springçš„@ConditionXXXæ³¨è§£å®ç°ç­–ç•¥æ¨¡å¼</title>
    <link href="/spring-condition-annotation.html"/>
    <url>/spring-condition-annotation.html</url>
    
    <content type="html"><![CDATA[<p>åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæœ‰è¿™æ ·çš„ä¸€ç§å¸¸è§çš„åœºæ™¯ï¼Œæ¯”å¦‚æ ¹æ®ç¯å¢ƒçš„ä¸åŒï¼Œå‘çŸ­ä¿¡çš„æœåŠ¡ä¹Ÿæ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯ä¾èµ–çŸ­ä¿¡æœåŠ¡çš„ç³»ç»Ÿè°ƒç”¨çš„éƒ½æ˜¯ç›¸åŒçš„æ¥å£ï¼Œè¿™æ ·å°±éœ€è¦é’ˆå¯¹ç¯å¢ƒæ¥åšåŒºåˆ†ï¼Œè°ƒç”¨ä¸åŒçš„çŸ­ä¿¡é€šé“æ¥å£ã€‚ä¸¾ä¾‹çš„è¿™ç§æƒ…å†µï¼Œä½ å¯èƒ½ä¼šæƒ³åˆ°ä½¿ç”¨ç­–ç•¥æ¨¡å¼çš„æ–¹å¼æ¥å®ç°ï¼Œå½“ç„¶è¿™ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><p>ä½†æ˜¯åªæœ‰ä¸¤ç§ç­–ç•¥è€Œä¸”åœ¨ä¸€ä¸ªç¯å¢ƒå½“ä¸­ï¼Œ<strong>åªä¼šæœ‰ä¸€ç§å›ºå®šç­–ç•¥å¯ä»¥ç”Ÿæ•ˆçš„æƒ…å†µä¸‹</strong>ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼æœªå…è¿‡äºéº»çƒ¦ï¼Œæœ¬æ–‡å°¤å…¶é€‚åˆç§æœ‰åŒ–é¡¹ç›®éƒ¨ç½²ï¼Œä¼šæ ¹æ®ç§æœ‰åŒ–ç¯å¢ƒæ‰§è¡Œä¸åŒç­–ç•¥çš„æƒ…å†µã€‚</p><a id="more"></a><blockquote><p>æœ¬æ–‡é¦–å‘äºä¸ªäººåšå®¢ï¼š<a href="http://nullpointer.pw/spring-condition-annotation.html">http://nullpointer.pw/spring-condition-annotation.html</a></p></blockquote><h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><p>æœ¬æ–‡è®²è§£å¦‚ä½•ä½¿ç”¨@ConditionXXX ç³»åˆ—æ³¨è§£æ¥æ›´æ–¹ä¾¿åœ°å®ç°è¿™ç§ç­–ç•¥é€‰æ‹©çš„åœºæ™¯ã€‚</p><p>@ConditionXXX ç³»åˆ—æ³¨è§£æ˜¯ Spring æä¾›çš„ä¸€ç»„æ³¨è§£ï¼Œä¸‹é¢è¡¨æ ¼åˆ—å‡ºæ‰€æœ‰çš„æ³¨è§£ä»¥åŠå¯¹åº”çš„ä½œç”¨ï¼Œå¸¸ç”¨çš„æ³¨è§£é€šè¿‡â˜†æ ‡æ³¨</p><p>ä¸Šæ–‡ä¸­çš„ä¾‹å­ä¸­ï¼Œå¤šä¸ªç­–ç•¥åŒä¸€ä¸ªç¯å¢ƒå…¶å®åªéœ€è¦åŠ è½½ä¸€ä¸ªé€‚åˆçš„ç­–ç•¥å³å¯ï¼Œå®Œå…¨æ²¡æœ‰å¿…è¦åŠ è½½ç”¨ä¸ä¸Šçš„å…¶ä»–ç­–ç•¥ï¼Œåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œåªå–æ‰€éœ€çš„ç­–ç•¥å°±è¶³çŸ£ï¼Œå®ç°èµ·æ¥ç›¸è¾ƒäºç­–ç•¥æ¨¡å¼æ–¹ä¾¿ä¸æ˜¯ä¸€ç‚¹ç‚¹ã€‚</p><h2 id="å¸¸ç”¨æ³¨è§£"><a href="#å¸¸ç”¨æ³¨è§£" class="headerlink" title="å¸¸ç”¨æ³¨è§£"></a>å¸¸ç”¨æ³¨è§£</h2><table><thead><tr><th align="left">æ³¨è§£</th><th align="left">ä½œç”¨</th><th align="center">å¸¸ç”¨</th></tr></thead><tbody><tr><td align="left">@ConditionalOnProperty</td><td align="left">å½“æŒ‡å®šçš„å±æ€§æœ‰æŒ‡å®šçš„å€¼æ—¶è¿›è¡Œå®ä¾‹åŒ–</td><td align="center">â˜†</td></tr><tr><td align="left">@ConditionalOnMissingBean</td><td align="left">å½“å®¹å™¨é‡Œæ²¡æœ‰æŒ‡å®š Bean çš„æ¡ä»¶ä¸‹è¿›è¡Œå®ä¾‹åŒ–ã€‚</td><td align="center">â˜†</td></tr><tr><td align="left">@ConditionalOnExpression</td><td align="left">åŸºäº SpEL è¡¨è¾¾å¼çš„æ¡ä»¶åˆ¤æ–­ï¼Œå¤šæ¡ä»¶</td><td align="center">â˜†</td></tr><tr><td align="left">@ConditionalOnBean</td><td align="left">ä»…ä»…åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¸­å­˜åœ¨æŸä¸ªå¯¹è±¡æ—¶ï¼Œæ‰ä¼šå®ä¾‹åŒ–ä¸€ä¸ª Beanã€‚</td><td align="center"></td></tr></tbody></table><p>ä»¥ä¸åŒç¯å¢ƒå‘é€çŸ­ä¿¡ä¸ºä¾‹ï¼Œè¿›è¡Œä»£ç å®ç° (å½“ç„¶è¿™ä¸ªä¾‹å­æœ‰ç‚¹å¼ºä¸Šçš„å¼‚å‘³ï¼Œä¸è¿‡ç”¨äºæ¥è§£é‡Šè¿™å‡ ä¸ªä¸»é”®çš„åŠŸç”¨å´æ˜¯å¾ˆåˆé€‚ï¼Œå…·ä½“åº”ç”¨åœºæ™¯è¯·è§¦ç±»æ—é€š)ã€‚</p><h2 id="ç¤ºä¾‹å®ç°"><a href="#ç¤ºä¾‹å®ç°" class="headerlink" title="ç¤ºä¾‹å®ç°"></a>ç¤ºä¾‹å®ç°</h2><p>é¦–å…ˆä¼šå®šä¹‰ä¸€ä¸ªç”¨äºå‘é€çŸ­ä¿¡çš„æ¥å£ï¼Œå› ä¸ºä¼šæœ‰å¤šç§ç¯å¢ƒï¼Œå¦‚å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€ç”Ÿäº§ç¯å¢ƒï¼Œæ‰€ä»¥ä¼šæœ‰ç›¸åº”ç¯å¢ƒçš„å®ç°ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">SmsService</span> </span>&#123;<br>    <span class="hljs-function">Boolean <span class="hljs-title">send</span><span class="hljs-params">(String mobile, String content)</span></span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å®šä¹‰å¤šç¯å¢ƒé…ç½®ç±»</p><figure class="highlight applescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs applescript">- <span class="hljs-built_in">application</span>.yml<br>- <span class="hljs-built_in">application</span>-dev.yml<br>- <span class="hljs-built_in">application</span>-prod.yml<br>- <span class="hljs-built_in">application</span>-test.yml<br></code></pre></div></td></tr></table></figure><p>åœ¨ <code>application-xxx.yml</code> ä¸­åˆ†åˆ«æŒ‡å®šé…ç½®ï¼Œå¦‚ application-dev.yml</p><figure class="highlight yml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yml"><span class="hljs-attr">custom:</span><br>  <span class="hljs-attr">env:</span> <span class="hljs-string">dev</span><br></code></pre></div></td></tr></table></figure><p>å®ç°æ¯ä¸ªç¯å¢ƒçš„å…·ä½“çŸ­ä¿¡å‘é€å®ç°ç±»ï¼Œä½¿ç”¨åˆ°äº† <code>@ConditionalOnProperty(name = &#123;&quot;custom.env&quot;&#125;, havingValue = &quot;test&quot;)</code> ï¼Œå«ä¹‰å°±æ˜¯è¯»å–é…ç½®æ–‡ä»¶ä¸­ key ä¸º <code>custom.env</code> çš„é…ç½®ï¼Œå¦‚æœå€¼ä¸º havingValue å±æ€§æ‰€æŒ‡å®šçš„å€¼ <code>test</code>ï¼Œåˆ™ä¼šå®ä¾‹åŒ–è¿™ä¸ª Beanï¼Œå¦åˆ™ä¸è¿›è¡Œå®ä¾‹åŒ–ã€‚</p><p>ä»¥ä¸‹å…¶ä»–ç¯å¢ƒçš„åŒç†ï¼Œä¸å†èµ˜è¿°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æµ‹è¯•ç¯å¢ƒçŸ­ä¿¡é€šé“</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> WeJan</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2020-04-28</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Service</span><br><span class="hljs-meta">@ConditionalOnProperty(name = &#123;&quot;custom.env&quot;&#125;, havingValue = &quot;test&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestSmsServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">SmsService</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">send</span><span class="hljs-params">(String mobile, String content)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;çŸ­ä¿¡å‘é€æˆåŠŸ, by TestSmsServiceImpl&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å¼€å‘ç¯å¢ƒçŸ­ä¿¡é€šé“</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> WeJan</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2020-04-28</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Service</span><br><span class="hljs-meta">@ConditionalOnProperty(name = &#123;&quot;custom.env&quot;&#125;, havingValue = &quot;dev&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DevSmsServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">SmsService</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">send</span><span class="hljs-params">(String mobile, String content)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;çŸ­ä¿¡å‘é€æˆåŠŸ, by DevSmsServiceImpl&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ç”Ÿäº§ç¯å¢ƒçŸ­ä¿¡é€šé“</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> WeJan</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2020-04-28</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Service</span><br><span class="hljs-meta">@ConditionalOnProperty(name = &#123;&quot;custom.env&quot;&#125;, havingValue = &quot;prod&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProdSmsServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">SmsService</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">send</span><span class="hljs-params">(String mobile, String content)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;çŸ­ä¿¡å‘é€æˆåŠŸ, by ProdSmsServiceImpl&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œä½¿ç”¨ <code>@ConditionalOnProperty</code> ä¾¿è¶³ä»¥æ»¡è¶³å¤§éƒ¨åˆ†çš„éœ€æ±‚ï¼Œä½†è¿˜æ˜¯æœ‰ä¾‹å¤–æƒ…å†µï¼Œéœ€è¦è®¾ç½®å…œåº•ç­–ç•¥ï¼Œå¯ä»¥é€šè¿‡ <code>@ConditionalOnMissingBean</code> æ¥å®ç°ï¼Œè¯¥æ³¨è§£ value å±æ€§ä¸­å¯¹åº”çš„ç±»è‹¥éƒ½æœªæ›¾å®ä¾‹åŒ–ï¼Œåˆ™å®ä¾‹åŒ–å½“å‰çš„ Beanã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">**<br> * é»˜è®¤çŸ­ä¿¡é€šé“<br> *<br> * <span class="hljs-meta">@author</span> WeJan<br> * <span class="hljs-meta">@since</span> <span class="hljs-number">2020</span>-<span class="hljs-number">04</span>-<span class="hljs-number">28</span><br> */<br><span class="hljs-meta">@Service</span><br><span class="hljs-meta">@ConditionalOnMissingBean(value = &#123;DevSmsServiceImpl.class, TestSmsServiceImpl.class, ProdSmsServiceImpl.class&#125;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DefaultSmsServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">SmsService</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">send</span><span class="hljs-params">(String mobile, String content)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;çŸ­ä¿¡å‘é€æˆåŠŸ, by DefaultSmsServiceImpl&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æµ‹è¯•ä¸€ç•ª"><a href="#æµ‹è¯•ä¸€ç•ª" class="headerlink" title="æµ‹è¯•ä¸€ç•ª"></a>æµ‹è¯•ä¸€ç•ª</h2><p>ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œä½¿ç”¨ <code>@ActiveProfiles</code> æ³¨è§£æŒ‡å®šå½“å‰æµ‹è¯•ä½¿ç”¨çš„é…ç½®ç¯å¢ƒï¼Œ </p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-comment">//@ActiveProfiles(value = &quot;prod&quot;)</span><br><span class="hljs-comment">//@ActiveProfiles(value = &quot;dev&quot;)</span><br><span class="hljs-meta">@ActiveProfiles(value = &quot;test&quot;)</span><br><span class="hljs-meta">@SpringBootTest(classes = SpringApp.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SmsServiceTest</span> </span>&#123;<br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> SmsService smsService;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testSend</span><span class="hljs-params">()</span> </span>&#123;<br>        smsService.send(<span class="hljs-string">&quot;13333333333&quot;</span>, <span class="hljs-string">&quot;Test&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æµ‹è¯•å½“æ¿€æ´»ç¯å¢ƒä¸º <code>dev</code> æ—¶ï¼Œæ§åˆ¶å°è¾“å‡ºï¼Œå…¶ä»–ç¯å¢ƒä¸å†æ¼”ç¤ºï¼Œè¯»è€…å¯è‡ªè¡Œå°è¯•ã€‚</p><figure class="highlight applescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs applescript">çŸ­ä¿¡å‘é€æˆåŠŸ, <span class="hljs-keyword">by</span> DevSmsServiceImpl<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ConditionalOnPropertyæ³¨è§£çš„åº”ç”¨</tag>
      
      <tag>ConditionalOnMissingBeanæ³¨è§£çš„åº”ç”¨</tag>
      
      <tag>ConditionalOnExpressionæ³¨è§£çš„åº”ç”¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¡¹ç›®äºŒè¿›åˆ¶æ ‡ä½å®æˆ˜åº”ç”¨</title>
    <link href="/binary-tag.html"/>
    <url>/binary-tag.html</url>
    
    <content type="html"><![CDATA[<p>å››æœˆå·²è¿‡å¤§åŠï¼Œç´§æ€¥è¡¥ä¸Šä¸€ç¯‡åšå®¢ï¼Œæœ¬æ–‡å°†è®²è§£äºŒè¿›åˆ¶çŠ¶æ€ä½åœ¨é¡¹ç›®ä¸­çš„å®æˆ˜åº”ç”¨ï¼ŒæŠ€æœ¯åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯åˆ©ç”¨äºŒçº§åˆ¶ä¸ä½è¿ç®—å®ç°ã€‚è¿™ç§æ–¹å¼çš„åº”ç”¨åœºæ™¯è¿˜æ˜¯æ¯”è¾ƒå¹¿æ³›ï¼Œå¸Œæœ›å¯¹ä½ æœ‰ç”¨~</p><a id="more"></a><blockquote><p>æœ¬æ–‡é¦–å‘äºä¸ªäººåšå®¢ï¼š<a href="http://nullpointer.pw/binary-tag.html">http://nullpointer.pw/binary-tag.html</a></p></blockquote><blockquote><p>æ›´æ–°æ—¥å¿—ï¼š<br>2020-11-22 11:00:43: å¢åŠ æ•°æ®åº“æŸ¥è¯¢è¿‡æ»¤ç¤ºä¾‹</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200423125326.png"><br>ä¸¾ä¸ªæ —å­ï¼Œéœ€è¦ä¿å­˜è¿™äº›çŠ¶æ€ä½ ä¼šæ€ä¹ˆè®¾è®¡è¡¨å‘¢ï¼Ÿ</p><p>ä½ å¯èƒ½ä¼šæƒ³ï¼Œè¿™å¾ˆç®€å•å•Šï¼Œé’ˆå¯¹ä¸€ä¸ªå¼€å…³åŠ ä¸€ä¸ªçŠ¶æ€å­—æ®µå˜›~ </p><p>å‘µå‘µçœŸæ˜¯å¤ªå¹´è½»ï¼Œè¿™æ ·å¼€å‘ä¸Šçº¿åï¼Œäº§å“åˆè¦å¢åŠ æ–°çš„æé†’æ–¹å¼ï¼Œå¦‚å›¾<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200423125748.png">  </p><p>éš¾ä¸æˆï¼Œå†åŠ çŠ¶æ€å­—æ®µï¼Ÿ</p><p>å¯ä»¥å‘ç°ï¼Œä»¥ä¸Šè¿™ç§åšæ³•ï¼Œåœ¨éœ€æ±‚æ”¹åŠ¨æ—¶å°±ä¼šå¾ˆè›‹ç–¼ï¼Œè€Œä¸”è¿™åªæ˜¯æé†’çš„å¼€å…³è®¾ç½®ï¼Œè‹¥æœ‰å…¶ä»–ç±»å‹çš„å¼€å…³è®¾ç½®å°±æ›´åŠ éº»çƒ¦ã€‚</p><p>æ‰€ä»¥è¿™é‡Œå¼•å…¥ä»Šå¤©çš„ä¸»é¢˜ï¼ŒäºŒè¿›åˆ¶çŠ¶æ€ä½ã€‚</p><h2 id="äºŒè¿›åˆ¶ä¸ä½è¿ç®—"><a href="#äºŒè¿›åˆ¶ä¸ä½è¿ç®—" class="headerlink" title="äºŒè¿›åˆ¶ä¸ä½è¿ç®—"></a>äºŒè¿›åˆ¶ä¸ä½è¿ç®—</h2><p>è¿™æ ·æ•°æ®åº“åªéœ€è¦æ·»åŠ ä¸€ä¸ªæ•´æ•°å­—æ®µä¿å­˜å³å¯ã€‚<strong>ä½¿ç”¨2çš„æ¬¡å¹‚å€¼ä»£è¡¨ä¸€ç§çŠ¶æ€</strong>ï¼Œæ¯”å¦‚ä½¿ç”¨ <code>1</code>(2Âº) ä»£è¡¨å¼€å¯ç«™å†…æé†’ï¼Œ<code>2</code>(2Â¹) ä»£è¡¨ å¼€å¯é‚®ä»¶æé†’ï¼Œ<code>4</code>(2Â²) ä»£è¡¨å¼€å¯çŸ­ä¿¡æé†’ç­‰ç­‰ï¼Œè¿™æ ·è¿™ä¸ªçŠ¶æ€ä½å­—æ®µåªéœ€è¦å­˜å‚¨ <code>7</code>å³å¯è¡¨ç¤ºå·²å¼€å¯è¿™å‡ é¡¹æé†’ã€‚å› ä¸º 7 ä¸è¿™å‡ ä¸ªçŠ¶æ€å€¼è¿›è¡Œä¸è¿ç®—æ—¶éƒ½ç­‰äºçŠ¶æ€å€¼æœ¬èº«ï¼Œå¦‚æœä¸ç­‰äºåˆ™ä¸ºå¼€å¯ã€‚</p><p>é¦–å…ˆå›é¡¾ä¸€ä¸‹äºŒè¿›åˆ¶ä¸ä½è¿ç®—çš„åŸºç¡€çŸ¥è¯†</p><table><thead><tr><th>åè¿›åˆ¶</th><th>äºŒè¿›åˆ¶</th></tr></thead><tbody><tr><td>0</td><td>0000 0000</td></tr><tr><td>1</td><td>0000 0001</td></tr><tr><td>2</td><td>0000 0010</td></tr><tr><td>3</td><td>0000 0011</td></tr><tr><td>4</td><td>0000 0100</td></tr><tr><td>5</td><td>0000 0101</td></tr><tr><td>6</td><td>0000 0110</td></tr><tr><td>7</td><td>0000 0111</td></tr></tbody></table><p>æˆ–è¿ç®—ï¼šbitä½ä¸Šæœ‰1ä¸º1ã€‚ä¾‹å¦‚ï¼š2 | 1 == 0000 0010 | 0000 0001 == 3<br>ä¸è¿ç®—ï¼šbitä½éƒ½ä¸º1æ‰ä¸º1ã€‚ ä¾‹å¦‚  5 &amp; 2 == 0000 0101 &amp; 0000 0010 == 0</p><h2 id="å®é™…åº”ç”¨"><a href="#å®é™…åº”ç”¨" class="headerlink" title="å®é™…åº”ç”¨"></a>å®é™…åº”ç”¨</h2><p>ä»¥ä¸Šæ–‡æé†’å¼€å…³ä¸ºä¾‹ï¼š<br>ç°åœ¨æ‰“å¼€ ç«™å†…æé†’ï¼Œä¸æ‰“å¼€é‚®ä»¶æé†’ï¼Œæ‰“å¼€çŸ­ä¿¡æé†’ï¼Œæœ€ç»ˆçš„å€¼çš„è®¡ç®—æ–¹æ³•ä¸ºï¼š<br><code>1 | 4 = 5</code></p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  è®¡ç®—çŠ¶æ€ä½</span><br><span class="hljs-comment"> *  tags: å·²æœ‰çŠ¶æ€ä½</span><br><span class="hljs-comment"> *  value: éœ€è¦æ·»åŠ çš„çŠ¶æ€å€¼</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">addTag</span><span class="hljs-params">(<span class="hljs-keyword">int</span> tags, <span class="hljs-keyword">int</span>... values)</span> </span>&#123;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> value : values) &#123;<br>    tags |= value;<br>  &#125;<br>  <span class="hljs-keyword">return</span> tags;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç°åœ¨åˆ¤æ–­æ˜¯å¦æ‰“å¼€äº†ç«™å†…æé†’</p><p>5 &amp; 1 == 0000 0101 &amp; 0000 0001 == 1 </p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> *  æ˜¯å¦åŒ…å«çŠ¶æ€ä½</span><br><span class="hljs-comment"> *  tags: å·²æœ‰çŠ¶æ€ä½</span><br><span class="hljs-comment"> *  value: éœ€è¦åˆ¤æ–­çš„çŠ¶æ€å€¼</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasTag</span><span class="hljs-params">(<span class="hljs-keyword">int</span> tags, <span class="hljs-keyword">int</span> value)</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> (tags &amp; value) == value;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç°åœ¨è¦å…³é—­ç«™å†…æé†’</p><p>5 ^ 1 == 0000 0101 ^ 0000 0001 == 4</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">  * ç§»é™¤çŠ¶æ€ä½</span><br><span class="hljs-comment">  * tags: å·²æœ‰çŠ¶æ€ä½</span><br><span class="hljs-comment">  * value: éœ€è¦ç§»é™¤çš„çŠ¶æ€å€¼</span><br><span class="hljs-comment">  */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">delTag</span><span class="hljs-params">(<span class="hljs-keyword">int</span> tags, <span class="hljs-keyword">int</span> value)</span> </span>&#123;<br>  <span class="hljs-keyword">if</span> ((tags &amp; value) != value) <span class="hljs-keyword">return</span> tags;<br>  <span class="hljs-keyword">return</span> tags ^ value;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> tag = addTag(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>);<br>    System.out.println(tag); <span class="hljs-comment">// 5</span><br>    System.out.println(hasTag(tag, <span class="hljs-number">1</span>)); <span class="hljs-comment">// true</span><br>    System.out.println(hasTag(tag, <span class="hljs-number">2</span>)); <span class="hljs-comment">// false</span><br>    System.out.println(hasTag(tag, <span class="hljs-number">4</span>)); <span class="hljs-comment">// true</span><br>    tag = delTag(tag, <span class="hljs-number">4</span>);<br>    System.out.println(tag); <span class="hljs-comment">// 1</span><br>    System.out.println(hasTag(tag, <span class="hljs-number">4</span>)); <span class="hljs-comment">// false</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ä½¿ç”¨ä¼˜åŒ–"><a href="#ä½¿ç”¨ä¼˜åŒ–" class="headerlink" title="ä½¿ç”¨ä¼˜åŒ–"></a>ä½¿ç”¨ä¼˜åŒ–</h2><p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œè¿™äº›çŠ¶æ€å¯ä»¥é€šè¿‡æšä¸¾å€¼è¿›è¡Œå°è£…èµ·æ¥ï¼Œæ–¹ä¾¿ä½¿ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Getter</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">NotifyTypeEnum</span> </span>&#123;<br>    IN_MAIL(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;ç«™å†…ä¿¡æé†’&quot;</span>, <span class="hljs-number">1</span>),<br>    EMAIL(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;é‚®ä»¶æé†’&quot;</span>, <span class="hljs-number">2</span>),<br>    SMS(<span class="hljs-number">3</span>, <span class="hljs-string">&quot;çŸ­ä¿¡æé†’&quot;</span>, <span class="hljs-number">4</span>),<br>    ;<br><br>    <span class="hljs-comment">// æšä¸¾å€¼</span><br>    <span class="hljs-keyword">private</span> Integer code;<br>    <span class="hljs-comment">// æšä¸¾æè¿°</span><br>    <span class="hljs-keyword">private</span> String desc;<br>    <span class="hljs-comment">// çŠ¶æ€ä½</span><br>    <span class="hljs-keyword">private</span> Integer tag;<br><br>    NotifyTypeEnum(Integer code, String desc, Integer tag) &#123;<br>        <span class="hljs-keyword">this</span>.code = code;<br>        <span class="hljs-keyword">this</span>.desc = desc;<br>        <span class="hljs-keyword">this</span>.tag = tag;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasTag</span><span class="hljs-params">(<span class="hljs-keyword">int</span> tags)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> (tags &amp; <span class="hljs-keyword">this</span>.tag) == tag;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> tags = <span class="hljs-number">5</span>;<br>        System.out.println(NotifyTypeEnum.IN_MAIL.hasTag(tags)); <span class="hljs-comment">// true</span><br>        System.out.println(NotifyTypeEnum.EMAIL.hasTag(tags)); <span class="hljs-comment">// false</span><br>        System.out.println(NotifyTypeEnum.SMS.hasTag(tags)); <span class="hljs-comment">// true</span><br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æ•°æ®åº“çŠ¶æ€ç­›é€‰"><a href="#æ•°æ®åº“çŠ¶æ€ç­›é€‰" class="headerlink" title="æ•°æ®åº“çŠ¶æ€ç­›é€‰"></a>æ•°æ®åº“çŠ¶æ€ç­›é€‰</h2><p>è¯„è®ºä¸­æœ‰åŒå­¦æåˆ°</p><blockquote><p>å¦‚æœç°åœ¨æœ‰éœ€æ±‚ éœ€è¦è¿‡æ»¤å…¶ä¸­ä¸€ä¸ªçŠ¶æ€å€¼ æ€ä¹ˆæ“ä½œ</p></blockquote><p>å¯¹äºè¿™ä¸ªé—®é¢˜å…¶å®ä¹Ÿæ˜¯å¯ä»¥å®ç°çš„ï¼Œå› ä¸º SQL ä¹Ÿæ˜¯æ”¯æŒä½è¿ç®—çš„ã€‚æ¯”å¦‚æœ‰ä¸ªè¡¨å­—æ®µåç§°ä¸º notice_flagsï¼Œç°åœ¨è¦ç­›é€‰æ‰€æœ‰å¼€å¯äº† <code>EMAIL</code> æé†’æ–¹å¼çš„æ‰€æœ‰è®°å½•ï¼ŒSQL ä¸­å¯ä»¥è¿™ä¹ˆå†™(#{flag} ä¸º EMAIL çš„ flag å€¼)</p><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql">select * from table_name where (notice_flags &amp; #&#123;flag&#125; != 0)   <br></code></pre></div></td></tr></table></figure><p>è¿™æ¡ SQL ä¼šè¿›è¡Œä¸è¿ç®—ï¼ŒæŸ¥è¯¢å‡ºæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è®°å½•ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://blog.csdn.net/qq_36631014/article/details/79675924">java ç¼–ç¨‹ä½¿ç”¨äºŒè¿›åˆ¶è¿›è¡ŒçŠ¶æ€æ§åˆ¶</a></li><li><a href="https://www.cnblogs.com/xujanus/p/3627939.html">æ•°æ®åº“è®¾è®¡â€”â€”å¦‚ä½•åˆ©ç”¨ä¸€ä¸ªæ•´æ•°å‹å­—æ®µä¸ºç”¨æˆ·æ‰“ä¸Š 63 ä¸ªæ ‡</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>äºŒè¿›åˆ¶æ ‡ä½ä½¿ç”¨</tag>
      
      <tag>äºŒè¿›åˆ¶çŠ¶æ€ä½ä½¿ç”¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€å¯¹ä½ æ— ç”¨è¯·ææˆ‘ç³»åˆ—ã€‘å¿…ä¼š Linux æŠ€å·§</title>
    <link href="/linux-command.html"/>
    <url>/linux-command.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡éå•çº¯ç½‘ä¸Šä»‹ç» Linux å‘½ä»¤åŠå‚æ•°çš„é›·åŒæ–‡ç« ï¼Œè€Œæ˜¯çœŸæ­£åœ¨å®é™…å·¥ä½œä¸­èƒ½æ´¾ä¸Šç”¨åœºçš„ Linux å®ç”¨æŠ€å·§ã€‚ä¸»è¦ä»‹ç»æ—¥å¿—æ’æŸ¥ç›¸å…³çš„æŠ€å·§ï¼Œæå¸¦å¸¸è§çš„å…¶ä»– Linux æ“ä½œä»¥åŠ vim æŠ€å·§ã€‚</p><a id="more"></a><blockquote><p>æœ¬æ–‡é¦–å‘äºä¸ªäººåšå®¢ï¼š<a href="http://nullpointer.pw/linux-command.html">http://nullpointer.pw/linux-command.html</a></p></blockquote><h2 id="æ—¥å¿—ç›¸å…³ï¼š"><a href="#æ—¥å¿—ç›¸å…³ï¼š" class="headerlink" title="æ—¥å¿—ç›¸å…³ï¼š"></a>æ—¥å¿—ç›¸å…³ï¼š</h2><p>åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œç»å¸¸éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šé€šè¿‡æŸ¥çœ‹æ—¥å¿—çš„æ–¹å¼æ¥å®šä½ bug é—®é¢˜ï¼ŒæŒæ¡ä¸€å®šçš„æ—¥å¿—æ’æŸ¥æŠ€å·§åˆ™æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚æ˜æ˜æœ‰äº›å¯ä»¥é€šè¿‡å¾ˆåŸºç¡€çš„å‘½ä»¤å°±å¯ä»¥å®ç°ï¼Œä½†ç½‘ä¸Šæœ‰äº›äººååå–œæ¬¢ç‚«æŠ€ï¼Œæ•…ä½œé«˜æ·±å¼„å‡ºä¸€äº›ç‰¹åˆ«å¤æ‚çš„ç”¨æ³•æ¥å®Œæˆï¼Œå…¶å®çœŸçš„æ²¡æœ‰é‚£ç§å¿…è¦ã€‚æœ¬æ–‡åªè®²æœ€å¸¸ç”¨å®ç”¨çš„ç”¨æ³•ã€‚</p><p>ç¬”è€…æˆªå–äº†ä¸€äº›æ—¥å¿—ä½œä¸ºç¤ºä¾‹ï¼Œä»¥ä¾›è¯»è€…ç»ƒä¹ ã€‚</p><p>Tips: å‘½ä»¤ä¸­åŒ…å«äºåŒå¼•å· â€œ â€œ ä¸­çš„éƒ½æ˜¯å…³é”®å­—</p><p>ç¤ºä¾‹æ—¥å¿—<a href="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200328/info.log.zip">ç‚¹æˆ‘ä¸‹è½½ </a></p><h3 id="é™æ€æ—¥å¿—æŸ¥æ‰¾"><a href="#é™æ€æ—¥å¿—æŸ¥æ‰¾" class="headerlink" title="é™æ€æ—¥å¿—æŸ¥æ‰¾"></a>é™æ€æ—¥å¿—æŸ¥æ‰¾</h3><ol><li>æ ¹æ®å…³é”®å­—æŸ¥æ‰¾æ—¥å¿—<figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">grep <span class="hljs-string">&quot;1584345069121&quot;</span> info.log<br></code></pre></div></td></tr></table></figure></li><li>æ ¹æ®å…³é”®å­—æŸ¥æ‰¾æ—¥å¿—ï¼Œå¹¶æ˜¾ç¤ºæŸ¥æ‰¾ç»“æœé™„è¿‘ 5 è¡Œ(å‰5è¡Œä¸å5è¡Œ)æ—¥å¿—<figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">grep <span class="hljs-string">&quot;1584345069121&quot;</span> info.log -C5<br></code></pre></div></td></tr></table></figure></li><li>æ ¹æ®å…³é”®å­—æŸ¥æ‰¾æ—¥å¿—ï¼Œå¹¶æ˜¾ç¤ºæŸ¥æ‰¾ç»“æœå (After)5 è¡Œæ—¥å¿— <figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">grep <span class="hljs-string">&quot;1584345069121&quot;</span> info.log -A5<br></code></pre></div></td></tr></table></figure></li><li>æ ¹æ®å…³é”®å­—æŸ¥æ‰¾æ—¥å¿—ï¼Œå¹¶æ˜¾ç¤ºæŸ¥æ‰¾ç»“æœå‰ (Before)5 è¡Œæ—¥å¿— <figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">grep <span class="hljs-string">&quot;1584345069121&quot;</span> info.log -B5<br></code></pre></div></td></tr></table></figure></li><li>æ ¹æ®å¤šä¸ªå…³é”®å­—æŸ¥æ‰¾æ—¥å¿—ï¼Œå¤šä¸ªå…³é”®å­—ä¸ºæˆ–å…³ç³»ï¼Œæ»¡è¶³å…¶ä¸­ä¸€ä¸ªæ¡ä»¶åˆ™åŒ¹é…ï¼Œå…³é”®å­—ä¹‹é—´ç”¨<code>\|</code>åˆ†éš”ï¼Œè¡¨ç¤ºæˆ–<figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">grep <span class="hljs-string">&quot;1584345069121\|1584345066236&quot;</span> info.log<br></code></pre></div></td></tr></table></figure></li><li>æ ¹æ®å¤šä¸ªå…³é”®å­—æŸ¥æ‰¾æ—¥å¿—ï¼Œéœ€è¦æ»¡è¶³å…¶ä¸­å…¨éƒ¨æ¡ä»¶æ‰åŒ¹é…<figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">grep <span class="hljs-string">&quot;76953334&quot;</span> info.log | grep <span class="hljs-string">&quot;1584349673402&quot;</span><br></code></pre></div></td></tr></table></figure></li><li>æŸ¥æ‰¾ä¸åŒ…å«å…³é”®å­—çš„æ—¥å¿—ï¼Œæ”¯æŒå¤šä¸ªå…³é”®å­—ï¼Œå…³é”®å­—ä¹‹é—´ç”¨<code>\|</code>åˆ†éš”ï¼Œè¡¨ç¤ºæˆ– <figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">grep -v <span class="hljs-string">&quot;handle&quot;</span> info.log<br></code></pre></div></td></tr></table></figure></li><li>æ ¹æ®å…³é”®å­— A æŸ¥æ‰¾ï¼Œå¹¶ä¸”è¿‡æ»¤åŒ…å«å…³é”®å­— B çš„æ—¥å¿—<figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">grep <span class="hljs-string">&quot;76953334&quot;</span> info.log | grep -v <span class="hljs-string">&quot;handle&quot;</span><br></code></pre></div></td></tr></table></figure><h3 id="æ»šåŠ¨æ—¥å¿—æŸ¥æ‰¾"><a href="#æ»šåŠ¨æ—¥å¿—æŸ¥æ‰¾" class="headerlink" title="æ»šåŠ¨æ—¥å¿—æŸ¥æ‰¾"></a>æ»šåŠ¨æ—¥å¿—æŸ¥æ‰¾</h3></li></ol><p>é™¤äº†ä»¥ä¸Šåœ¨é™æ€æ—¥å¿—ä¸­æŸ¥æ‰¾ä¹‹å¤–ï¼Œæœ‰æ—¶å€™è°ƒè¯•éœ€è¦çœ‹æŒ‡å®šæ—¥å¿—ï¼Œè€Œæ—¥å¿—åˆå­˜åœ¨æ»šåŠ¨åˆ·æ–°è¾ƒå¿«çš„æƒ…å†µï¼Œæ­¤æ—¶å°±å¯ä»¥é€šè¿‡ <code>grep</code> ç›¸å…³æŠ€å·§å¯¹åˆ·æ–°çš„æ»šåŠ¨æ—¥å¿—è¿›è¡Œè¿‡æ»¤ç­›é€‰ï¼Œæ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚</p><ol><li>æ»šåŠ¨æ—¥å¿—ä¸­æ ¹æ®å…³é”®å­—æœç´¢æ—¥å¿—<figure class="highlight 1c"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs 1c">tail -<span class="hljs-number">300</span>f info.<span class="hljs-built_in">log</span> <span class="hljs-string">| grep &quot;</span><span class="hljs-number">76953334</span><span class="hljs-string">&quot;</span><br></code></pre></div></td></tr></table></figure></li><li>æ»šåŠ¨æ—¥å¿—ä¸­æ ¹æ®ã€å…³é”®å­— Aã€‘æœç´¢æ—¥å¿—ï¼Œä¸”è¿‡æ»¤æ‰åŒ…å«ã€å…³é”®å­— Bã€‘çš„æ—¥å¿—<figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim">tail -<span class="hljs-number">300</span><span class="hljs-keyword">f</span> info.<span class="hljs-built_in">log</span> | <span class="hljs-keyword">grep</span> <span class="hljs-string">&quot;76953334&quot;</span> | <span class="hljs-keyword">grep</span> -v <span class="hljs-string">&quot;2450&quot;</span><br></code></pre></div></td></tr></table></figure></li></ol><h2 id="è§£å‹ç¼©"><a href="#è§£å‹ç¼©" class="headerlink" title="è§£å‹ç¼©"></a>è§£å‹ç¼©</h2><p>å‹ç¼©è§£å‹ä¹Ÿæ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ä¸€äº›æ“ä½œï¼Œå¸¸è§çš„å‹ç¼©åŒ…å°±æ˜¯<code>tar.gz</code>ä¸<code>zip</code>ä¸¤ç§ï¼Œä¸‹æ–‡åˆ†åˆ«ä»‹ç»è¿™ä¸¤ç§æ ¼å¼çš„å‹ç¼©ä¸è§£å‹æ–¹å¼ã€‚</p><ol><li>gzip å‹ç¼©æ–‡ä»¶æˆ–ç›®å½•ï¼Œå…·ä½“å‚æ•°å«ä¹‰è§å‚è€ƒé“¾æ¥<figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">tar zcvf tempdir/ fileName.tar.gz<br></code></pre></div></td></tr></table></figure></li><li>è§£å‹ tar.gz æ ¼å¼ (gzip) å‹ç¼©åŒ… (ä¸å‹ç¼©å‘½ä»¤æ¯”è¾ƒåªæ˜¯å‚æ•° c æ”¹æˆäº† x)<figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">tar zxvf fileName.tar.gz<br></code></pre></div></td></tr></table></figure></li><li>zip å‹ç¼©æ–‡ä»¶æˆ–ç›®å½•ï¼ˆ-r è¡¨ç¤ºåŒ…å«å­ç›®å½•ï¼‰<figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">zip -r fileName.zip tempdir/<br></code></pre></div></td></tr></table></figure></li><li>zip è§£å‹åˆ°æŒ‡å®šç›®å½•ï¼ˆ-o è¡¨ç¤ºé‡åæ–‡ä»¶è¦†ç›–æ—¶ä¸æç¤ºï¼Œå¯é€‰å‚æ•°ï¼‰<figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">unzip -o fileName.zip -d tempdir2/<br></code></pre></div></td></tr></table></figure><h2 id="è¿›ç¨‹ç›¸å…³"><a href="#è¿›ç¨‹ç›¸å…³" class="headerlink" title="è¿›ç¨‹ç›¸å…³"></a>è¿›ç¨‹ç›¸å…³</h2></li></ol><p>å·¥ä½œä¸­å¶å°”ä¼šéœ€è¦çœ‹ä¸€ä¸‹åº”ç”¨è¿›ç¨‹çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ä»€ä¹ˆæ—¶å€™å¯åŠ¨çš„ï¼Œå¯åŠ¨äº†å¤šä¹…è¿™äº›ä¿¡æ¯ï¼Œä»¥ä¸‹å‘½ä»¤å¯ä»¥å‘Šè¯‰ä½ ç­”æ¡ˆã€‚</p><ol><li>æŸ¥çœ‹ç«¯å£æ˜¯å¦è¢«å ç”¨<figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">netstat -l | grep 8080<br></code></pre></div></td></tr></table></figure></li><li>æŸ¥çœ‹è¿›ç¨‹å¯åŠ¨æ—¶é—´<figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">ps -p 8080 -o lstart<br></code></pre></div></td></tr></table></figure></li><li>æŸ¥çœ‹è¿›ç¨‹è¿è¡Œå¤šé•¿æ—¶é—´<figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">ps -p 8080 -o etime<br></code></pre></div></td></tr></table></figure><h2 id="VIM-å°æŠ€å·§"><a href="#VIM-å°æŠ€å·§" class="headerlink" title="VIM å°æŠ€å·§"></a>VIM å°æŠ€å·§</h2></li></ol><p>åˆ—ä¸¾äº†å‡ ä¸ª VIM å°æŠ€å·§ï¼Œæ‰¹é‡æ³¨é‡Šè¡Œã€æ›¿æ¢æ“ä½œ<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/111.gif">  </p><ol><li><p>æ‰¹é‡æ³¨é‡Šè¡Œ</p><ol><li>control + v è¿›å…¥åˆ—æ¨¡å¼</li><li>é€‰æ‹©è¦æ³¨é‡Šçš„åˆ—</li><li>shift + i è¿›å…¥ INSERT æ¨¡å¼</li><li>è¾“å…¥# æˆ–å…¶ä»–ä½ æƒ³è¦æ’å…¥çš„æ–‡å­—</li><li>è¿ç»­æŒ‰ä¸¤æ¬¡ ESC</li></ol></li><li><p>æ‰¹é‡å–æ¶ˆæ³¨é‡Šè¡Œ</p><ol><li>control + v è¿›å…¥åˆ—æ¨¡å¼</li><li>é€‰ä¸­è¦åˆ é™¤çš„æ–‡å­—</li><li>d é”®è¿›è¡Œåˆ é™¤</li></ol></li><li><p>æœç´¢å¹¶æ›¿æ¢å…³é”®å­— (INFO æ›¿æ¢ä¸º ERROR)<br>å…¨æ–‡æ›¿æ¢ï¼š    vim æ­£å¸¸æ¨¡å¼ä¸‹    <code>:%s/INFO/ERROR</code> å›è½¦ç¡®å®š<br>å½“å‰è¡Œæ›¿æ¢ï¼švim æ­£å¸¸æ¨¡å¼ä¸‹    <code>:s/INFO/ERROR</code> å›è½¦ç¡®å®š<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/vim-replace.gif"></p></li><li><p>æ‹·è´ä¸æ¸…ç©ºå…¨æ–‡å†…å®¹<br>æ‹·è´å…¨æ–‡å†…å®¹ï¼švim æ­£å¸¸æ¨¡å¼ä¸‹ <code>:%y</code><br>æ¸…ç©ºå…¨æ–‡å†…å®¹ï¼švim æ­£å¸¸æ¨¡å¼ä¸‹ <code>:%d</code></p></li></ol><h2 id="ç³»ç»Ÿç›¸å…³"><a href="#ç³»ç»Ÿç›¸å…³" class="headerlink" title="ç³»ç»Ÿç›¸å…³"></a>ç³»ç»Ÿç›¸å…³</h2><ol><li>ä»è·¯å¾„ <code>/home</code> ä¸‹å¼€å§‹å‘ä¸‹éå†æŸ¥æ‰¾åç§°åŒ…å« <code>nginx.conf</code> çš„æ–‡ä»¶<figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">find /home -name nginx.conf<br></code></pre></div></td></tr></table></figure></li><li>æŸ¥çœ‹ç£ç›˜å ç”¨<figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">df -h</span> <br></code></pre></div></td></tr></table></figure></li><li>æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ–‡ä»¶æˆ–ç›®å½•å ç”¨ç©ºé—´<figure class="highlight gml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gml">du -h --<span class="hljs-built_in">max</span>-<span class="hljs-symbol">depth</span>=<span class="hljs-number">1</span><br></code></pre></div></td></tr></table></figure><h2 id="å…¶ä»–æ–‡ç« "><a href="#å…¶ä»–æ–‡ç« " class="headerlink" title="å…¶ä»–æ–‡ç« "></a>å…¶ä»–æ–‡ç« </h2></li></ol><p>ç¬”è€…å†™çš„ä¸€äº›åœ¨ Spring å®¹å™¨ä¸­å…³äºè®¾è®¡æ¨¡å¼çš„å®è·µæ–‡ç« </p><ul><li> <a href="http://nullpointer.pw/design-patterns-strategy.html">è®¾è®¡æ¨¡å¼ä¹‹ç­–ç•¥æ¨¡å¼å®æˆ˜ </a></li><li> <a href="http://nullpointer.pw/design-patterns-state.html">è®¾è®¡æ¨¡å¼ä¹‹çŠ¶æ€æ¨¡å¼å®æˆ˜ </a></li><li> <a href="http://nullpointer.pw/design-patterns-chain-responsibility.html">è®¾è®¡æ¨¡å¼ä¹‹è´£ä»»é“¾æ¨¡å¼å®æˆ˜ </a></li><li> <a href="http://nullpointer.pw/design-patterns-observer.html">è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼å®æˆ˜ </a></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://www.cnblogs.com/peida/archive/2012/11/30/2795656.html">æ¯å¤©ä¸€ä¸ª linux å‘½ä»¤ï¼ˆ28ï¼‰ï¼štar å‘½ä»¤ </a></li><li><a href="https://www.runoob.com/linux/linux-comm-zip.html">Linux zip å‘½ä»¤ </a></li><li><a href="https://harttle.land/2016/08/08/vim-search-in-file.html">åœ¨ Vim ä¸­ä¼˜é›…åœ°æŸ¥æ‰¾å’Œæ›¿æ¢ </a></li><li><a href="https://harttle.land/2015/12/03/little-known-vim-skills.html">é‚£äº›é²œä¸ºäººçŸ¥çš„ Vim å°æŠ€å·§ </a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æœåŠ¡å™¨</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼å®æˆ˜</title>
    <link href="/design-patterns-observer.html"/>
    <url>/design-patterns-observer.html</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä»‹ç»è§‚å¯Ÿè€…æ¨¡å¼åœ¨é¡¹ç›®ä¸­çš„å®é™…åº”ç”¨ã€‚</p><a id="more"></a><p>ç±»å‹ï¼šè¡Œä¸ºå‹æ¨¡å¼</p><p>æ„å›¾ï¼šä¸€å¯¹å¤šå…³ç³»ä¾èµ–çš„å¤šä¸ªå¯¹è±¡ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œæ‰€æœ‰ä¾èµ–çš„å¯¹è±¡éƒ½å¯ä»¥å¾—åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°</p><p>ä¸»è¦è§£å†³ï¼šé™ä½å¯¹è±¡é—´çš„å…³è”ä¾èµ–æ€§</p><p>è§‚å¯Ÿè€…æ¨¡å¼ä¹Ÿç§°ä¸ºå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œç›‘å¬å™¨æ¨¡å¼ã€‚</p><p><a href="http://nullpointer.pw/design-patterns.html">è®¾è®¡æ¨¡å¼ç³»åˆ—æ–‡ç« ç›®å½• </a></p><h2 id="è§’è‰²"><a href="#è§’è‰²" class="headerlink" title="è§’è‰²"></a>è§’è‰²</h2><blockquote><p>æŠ½è±¡ä¸»é¢˜ï¼ˆSubjectï¼‰è§’è‰²ï¼šæŠ½è±¡ä¸»é¢˜è§’è‰²æä¾›ç»´æŠ¤ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡èšé›†çš„æ“ä½œæ–¹æ³•ï¼Œå¯¹èšé›†çš„å¢åŠ ã€åˆ é™¤ç­‰ã€‚<br>å…·ä½“ä¸»é¢˜ï¼ˆConcreteSubjectï¼‰è§’è‰²ï¼šå°†æœ‰å…³çŠ¶æ€å­˜å…¥å…·ä½“çš„è§‚å¯Ÿè€…å¯¹è±¡ï¼›åœ¨å…·ä½“ä¸»é¢˜çš„å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶ï¼Œç»™æ‰€æœ‰ç™»è®°è¿‡çš„è§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ã€‚å…·ä½“ä¸»é¢˜è§’è‰²è´Ÿè´£å®ç°æŠ½è±¡ä¸»é¢˜ä¸­èšé›†çš„ç®¡ç†æ–¹æ³•ã€‚<br>æŠ½è±¡è§‚å¯Ÿè€…ï¼ˆObserverï¼‰è§’è‰²ï¼šä¸ºå…·ä½“è§‚å¯Ÿè€…æä¾›ä¸€ä¸ªæ›´æ–°æ¥å£ã€‚<br>å…·ä½“è§‚å¯Ÿè€…ï¼ˆConcreteObserverï¼‰è§’è‰²ï¼šå­˜å‚¨ä¸ä¸»é¢˜ç›¸å…³çš„è‡ªæ´½çŠ¶æ€ï¼Œå®ç°æŠ½è±¡è§‚å¯Ÿè€…æä¾›çš„æ›´æ–°æ¥å£ã€‚</p></blockquote><h2 id="UML"><a href="#UML" class="headerlink" title="UML"></a>UML</h2><img  src=http://www.plantuml.com/plantuml/svg/ZP512u9048Nl-oi6JrOeT1K9eMlGeLymxewvKRknEmgH_VT4Sy62wlZcVJFlmHIUqN5pEGiiFJkK3FACtiEXAK_Kgxi0M84jFRcMdCzWfptd-vVU32uoewpZQHZe1MJGMgq6ID4VaB5ALxU9yN4m7qAClRRMI4TCytwoHdEa6QuDawjG4eJ8aMsk2fc-dFxDJ-5vboJlZKHOpxiq_JWQTgDr13Q1Q1c5Wg8We_fVF040><h2 id="Java-æä¾›è§‚å¯Ÿè€…æ¨¡å¼çš„æ”¯æŒ"><a href="#Java-æä¾›è§‚å¯Ÿè€…æ¨¡å¼çš„æ”¯æŒ" class="headerlink" title="Java æä¾›è§‚å¯Ÿè€…æ¨¡å¼çš„æ”¯æŒ"></a>Java æä¾›è§‚å¯Ÿè€…æ¨¡å¼çš„æ”¯æŒ</h2><p>ä¸€èˆ¬åœ¨çœŸå®é¡¹ç›®ä¹‹ä¸­ï¼Œä¸ä¼šå®Œå…¨æ‰‹åŠ¨å®ç°ä¸€ä¸ªè§‚å¯Ÿè€…æ¨¡å¼ï¼Œå› ä¸ºåœ¨ JAVA è¯­è¨€çš„ java.util åº“é‡Œé¢ï¼Œå·²ç»æä¾›äº†ä¸€ä¸ª Observable ç±»ä»¥åŠä¸€ä¸ª Observer æ¥å£ï¼Œæ„æˆ JAVA è¯­è¨€å¯¹è§‚å¯Ÿè€…æ¨¡å¼çš„æ”¯æŒã€‚ç›´æ¥ä½¿ç”¨æä¾›çš„ util å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteObserver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Observer</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(Observable o, Object arg)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ¥æ”¶åˆ°æ›´æ–°&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConcreteSubject</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Observable</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">change</span><span class="hljs-params">()</span> </span>&#123;<br>        setChanged();<br>        <span class="hljs-keyword">this</span>.notifyObservers();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        ConcreteObserver concreteObserver = <span class="hljs-keyword">new</span> ConcreteObserver();<br>        ConcreteSubject subject = <span class="hljs-keyword">new</span> ConcreteSubject();<br>        subject.addObserver(concreteObserver);<br>        subject.change();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><p>é™¤äº† Java è‡ªèº« æä¾›çš„è§‚å¯Ÿè€…æ¨¡å¼æ”¯æŒå¤–ï¼ŒGuava ä¹ŸåŸºäºè§‚å¯Ÿè€…æ¨¡å¼å®ç°çš„ ç”Ÿäº§/æ¶ˆè´¹æ¨¡å‹ï¼Œåœ¨ä½¿ç”¨ä¸Šï¼Œæ¯” Observable ç›¸å¯¹ç®€å•ï¼Œå¦‚æœéœ€è¦è®¢é˜…æ¶ˆæ¯åªéœ€è¦åœ¨æ–¹æ³•ä¸Šæ·»åŠ  <strong>@Subscribe</strong> æ³¨è§£å³å¯ã€‚ä½¿ç”¨  <strong>EventBus çš„ post æ–¹æ³•</strong>åˆ†å‘äº‹ä»¶ç»™æ¶ˆè´¹è€…ã€‚</p><p>æœ¬æ–‡ä»¥ç”¨æˆ·æ³¨å†Œä¸ºä¾‹ï¼Œå½“ç”¨æˆ·æ³¨å†Œå®Œæˆåï¼Œä¹‹åå¯èƒ½ä¼šæœ‰ä¸€ç³»åˆ—çš„è€—æ—¶æ“ä½œï¼Œæ¯”å¦‚å‘é€æ¶ˆæ¯é€šçŸ¥ï¼ŒåŒæ­¥æ•°æ®åˆ°ç¼“å­˜ç­‰æ“ä½œã€‚ä¸ºäº†ç»™ç”¨æˆ·æä¾›å¥½çš„ä½“éªŒï¼Œè¿™é‡Œä½¿ç”¨ EventBus æ¥è¿›è¡Œå¼‚æ­¥åŒ–ã€‚</p><h3 id="å®šä¹‰æŠ½è±¡ä¸»é¢˜"><a href="#å®šä¹‰æŠ½è±¡ä¸»é¢˜" class="headerlink" title="å®šä¹‰æŠ½è±¡ä¸»é¢˜"></a>å®šä¹‰æŠ½è±¡ä¸»é¢˜</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractProducer</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> AsyncEventBus eventBus = <span class="hljs-keyword">new</span> AsyncEventBus(<span class="hljs-string">&quot;_event_async_&quot;</span>, Executors.newFixedThreadPool(<span class="hljs-number">4</span>));<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">registerAsyncEvent</span><span class="hljs-params">(EventConsumer consumer)</span> </span>&#123;<br>        eventBus.register(consumer);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">post</span><span class="hljs-params">(T event)</span></span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å®šä¹‰æŠ½è±¡è§‚å¯Ÿè€…"><a href="#å®šä¹‰æŠ½è±¡è§‚å¯Ÿè€…" class="headerlink" title="å®šä¹‰æŠ½è±¡è§‚å¯Ÿè€…"></a>å®šä¹‰æŠ½è±¡è§‚å¯Ÿè€…</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">EventConsumer</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">consume</span><span class="hljs-params">(T event)</span></span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å°è£…-Event-äº‹ä»¶å¯¹è±¡"><a href="#å°è£…-Event-äº‹ä»¶å¯¹è±¡" class="headerlink" title="å°è£… Event äº‹ä»¶å¯¹è±¡"></a>å°è£… Event äº‹ä»¶å¯¹è±¡</h3><p>Event äº‹ä»¶å¯¹è±¡ç”¨äºäº‹ä»¶å®£å‘æ—¶å‚æ•°ä¼ é€’ä½¿ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRegisterEvent</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> UserDto userDto;<br>&#125;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@ToString</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDto</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> LocalDateTime registerTime;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å®šä¹‰å…·ä½“çš„ä¸»é¢˜ä¸è§‚å¯Ÿè€…å¯¹è±¡"><a href="#å®šä¹‰å…·ä½“çš„ä¸»é¢˜ä¸è§‚å¯Ÿè€…å¯¹è±¡" class="headerlink" title="å®šä¹‰å…·ä½“çš„ä¸»é¢˜ä¸è§‚å¯Ÿè€…å¯¹è±¡"></a>å®šä¹‰å…·ä½“çš„ä¸»é¢˜ä¸è§‚å¯Ÿè€…å¯¹è±¡</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">// ä¸»é¢˜å¯¹è±¡ï¼Œæä¾›æ³¨å†Œä¸»é¢˜æ–¹æ³•</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRegisterProducer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractProducer</span>&lt;<span class="hljs-title">UserRegisterEvent</span>&gt; </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">post</span><span class="hljs-params">(UserRegisterEvent event)</span> </span>&#123;<br>        eventBus.post(event);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// è§‚å¯Ÿè€…å¯¹è±¡ï¼Œç›‘å¬ä¸»é¢˜äº‹ä»¶</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRegisterNotifyConsumer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">EventConsumer</span>&lt;<span class="hljs-title">UserRegisterEvent</span>&gt;,</span><br><span class="hljs-class">        <span class="hljs-title">InitializingBean</span> </span>&#123;<br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> UserRegisterProducer userRegisterProducer;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-meta">@Subscribe</span> <span class="hljs-comment">// ç›‘å¬äº‹ä»¶</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">consume</span><span class="hljs-params">(UserRegisterEvent event)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ¥æ”¶åˆ°ç”¨æˆ·æ³¨å†Œäº‹ä»¶ï¼Œå¼€å§‹æ¨é€é€šçŸ¥&quot;</span>);<br>        System.out.println(event);<br>        System.out.println(<span class="hljs-string">&quot;æ¥æ”¶åˆ°ç”¨æˆ·æ³¨å†Œäº‹ä»¶ï¼Œé€šçŸ¥æ¨é€å®Œæ¯•&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterPropertiesSet</span><span class="hljs-params">()</span> </span>&#123;<br>        userRegisterProducer.registerAsyncEvent(<span class="hljs-keyword">this</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// è§‚å¯Ÿè€…å¯¹è±¡ï¼Œç›‘å¬ä¸»é¢˜äº‹ä»¶</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRegisterSyncCacheConsumer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">EventConsumer</span>&lt;<span class="hljs-title">UserRegisterEvent</span>&gt;,</span><br><span class="hljs-class">        <span class="hljs-title">InitializingBean</span> </span>&#123;<br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> UserRegisterProducer userRegisterProducer;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterPropertiesSet</span><span class="hljs-params">()</span> </span>&#123;<br>        userRegisterProducer.registerAsyncEvent(<span class="hljs-keyword">this</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-meta">@Subscribe</span> <span class="hljs-comment">// ç›‘å¬äº‹ä»¶</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">consume</span><span class="hljs-params">(UserRegisterEvent event)</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ¥æ”¶åˆ°ç”¨æˆ·æ³¨å†Œäº‹ä»¶ï¼Œå¼€å§‹åŒæ­¥ Cache&quot;</span>);<br>        System.out.println(event.getUserDto());<br>        System.out.println(<span class="hljs-string">&quot;æ¥æ”¶åˆ°ç”¨æˆ·æ³¨å†Œäº‹ä»¶ï¼ŒåŒæ­¥ Cache å®Œæ¯•&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„ï¼Œè§‚å¯Ÿè€…å¯¹è±¡éœ€è¦åœ¨ç±»è¿›è¡Œå®ä¾‹åŒ–çš„æ—¶å€™ï¼Œè¿›è¡Œæ³¨å†Œäº‹ä»¶ï¼Œæ‰€ä»¥å®ç°äº† InitializingBean æ¥å£ï¼Œç›‘å¬äº‹ä»¶æ¶ˆæ¯ï¼Œéœ€è¦åœ¨ç›‘å¬æ–¹æ³•ä¸Šæ·»åŠ  @Subscribe æ³¨è§£ã€‚</p><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRegisterProducerTest</span> </span>&#123;<br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> UserRegisterProducer userRegisterProducer;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">post</span><span class="hljs-params">()</span> </span>&#123;<br>        UserRegisterEvent event = <span class="hljs-keyword">new</span> UserRegisterEvent();<br>        event.setUserDto(<span class="hljs-keyword">new</span> UserDto(<span class="hljs-number">1L</span>, <span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>, LocalDateTime.now()));<br>        userRegisterProducer.post(event);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç»“æœè¾“å‡ºï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">æ¥æ”¶åˆ°ç”¨æˆ·æ³¨å†Œäº‹ä»¶ï¼Œå¼€å§‹æ¨é€é€šçŸ¥<br>æ¥æ”¶åˆ°ç”¨æˆ·æ³¨å†Œäº‹ä»¶ï¼Œå¼€å§‹åŒæ­¥ Cache<br>UserDto(<span class="hljs-attribute">id</span>=1, <span class="hljs-attribute">name</span>=å¼ ä¸‰, <span class="hljs-attribute">registerTime</span>=2020-03-05T22:12:26.386)<br>æ¥æ”¶åˆ°ç”¨æˆ·æ³¨å†Œäº‹ä»¶ï¼ŒåŒæ­¥ Cache å®Œæ¯•<br>UserRegisterEvent(<span class="hljs-attribute">userDto</span>=UserDto(id=1, <span class="hljs-attribute">name</span>=å¼ ä¸‰, <span class="hljs-attribute">registerTime</span>=2020-03-05T22:12:26.386))<br>æ¥æ”¶åˆ°ç”¨æˆ·æ³¨å†Œäº‹ä»¶ï¼Œé€šçŸ¥æ¨é€å®Œæ¯•<br></code></pre></div></td></tr></table></figure><p>å› ä¸ºè§‚å¯Ÿè€…æ¨¡å¼æ˜¯æ— æ³•æ§åˆ¶æ¶ˆè´¹é¡ºåºçš„ï¼Œå¯èƒ½æ¯æ¬¡çš„è¾“å‡ºç»“æœéƒ½æ˜¯ä¸ä¸€è‡´çš„ã€‚</p><h2 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h2><ul><li><a href="https://github.com/Mosiki/learning-modules/tree/master/learning-designpatterns">https://github.com/Mosiki/learning-modules/tree/master/learning-designpatterns</a></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://juejin.im/post/5bcf53f351882577e5120b99">https://juejin.im/post/5bcf53f351882577e5120b99</a></li><li><a href="https://www.cnblogs.com/java-my-life/archive/2012/05/16/2502279.html">https://www.cnblogs.com/java-my-life/archive/2012/05/16/2502279.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼ä¹‹è´£ä»»é“¾æ¨¡å¼å®æˆ˜</title>
    <link href="/design-patterns-chain-responsibility.html"/>
    <url>/design-patterns-chain-responsibility.html</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä»¥ç”µå•†ç³»ç»Ÿè®¢å•é‡‘é¢è®¡ç®—ä¸ºä¾‹ï¼Œç”µå•†è®¢å•æœ€ç»ˆçš„é‡‘é¢å¯èƒ½æ˜¯è¿™æ ·çš„</p><p><strong>åº”æ”¯ä»˜é‡‘é¢=è®¢å•é‡‘é¢-ä¼˜æƒ åˆ¸ä¼˜æƒ é‡‘é¢-ä¿ƒé”€æ´»åŠ¨ä¼˜æƒ é‡‘é¢-ä¼šå‘˜æƒç›Šä¼˜æƒ é‡‘é¢</strong></p><p>å½“ç„¶ä¹Ÿæœ‰å¯èƒ½è¿˜ä¼šå¢åŠ å…¶ä»–çš„è®¡ç®—æ­¥éª¤ï¼Œä½¿ç”¨è´£ä»»é“¾æ¨¡å¼æ¥å®ç°è®¢å•é‡‘é¢è®¡ç®—ï¼Œè‹¥å¢åŠ äº†å…¶ä»–è®¡ç®—æ­¥éª¤ï¼Œç›´æ¥å°†æ­¥éª¤åŠ å…¥åˆ°é“¾ä¸­å³å¯ï¼Œè€Œæ— éœ€æ”¹åŠ¨ä»¥å‰çš„ä»£ç ï¼Œæœ€å¤§ç¨‹åº¦å‡å°å‡ºé”™çš„å¯èƒ½æ€§ã€‚è´£ä»»é“¾åˆ†ä¸ºçº¯è´£ä»»é“¾ä¸ä¸çº¯è´£ä»»é“¾ï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œå¾ˆå°‘æœ‰çº¯çš„è´£ä»»é“¾ï¼Œæ‰€è°“çº¯çš„è´£ä»»é“¾ï¼Œå°±æ˜¯å•ä¸ªé“¾ä¸Šå¤„ç†å™¨è¦ä¹ˆç‹¬ç«‹å¤„ç†ï¼Œè¦ä¹ˆå¤„ç†ä¸äº†äº¤ç»™ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†ã€‚</p><a id="more"></a><p><a href="http://nullpointer.pw/design-patterns.html">è®¾è®¡æ¨¡å¼ç³»åˆ—æ–‡ç« ç›®å½• </a></p><p>ç±»å‹ï¼šè¡Œä¸ºå‹æ¨¡å¼</p><p>æ„å›¾ï¼šä¸ºè¯·æ±‚åˆ›å»ºäº†ä¸€ä¸ªæ¥æ”¶æ­¤æ¬¡è¯·æ±‚å¯¹è±¡çš„é“¾ï¼Œè®©è¯·æ±‚æ²¿ç€é“¾ä¼ é€’è¯·æ±‚ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼š   </p><ol><li>éœ€è¦å¤šä¸ªå¯¹è±¡å¤„ç†ä¸€ä¸ªè¯·æ±‚</li></ol><h2 id="è§’è‰²ï¼š"><a href="#è§’è‰²ï¼š" class="headerlink" title="è§’è‰²ï¼š"></a>è§’è‰²ï¼š</h2><ul><li>AbstractHandler: æŠ½è±¡å¤„ç†è€…</li><li>ConcreteHandlerï¼šå…·ä½“å¤„ç†è€…</li></ul><h2 id="UML"><a href="#UML" class="headerlink" title="UML"></a>UML</h2><img  src=http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuKfCAYufIamkKKZEIImkLd24SZqIyr9oKeiKghaK57GLYakJarEBY_EBhD0L0AMr5QfXXjHcG4I3KWjBKujBD3IvQhcu80Oxv-Sb5wKcbgH2DHg2ZLPM85w74HuTwCwsgT7LnRIIE6L6cCRbwzfXUDmXDIy56800><h2 id="å®æˆ˜å¼€å‘"><a href="#å®æˆ˜å¼€å‘" class="headerlink" title="å®æˆ˜å¼€å‘"></a>å®æˆ˜å¼€å‘</h2><p>æœ¬æ–‡å‚ç…§ Tomcat æºç ä¸­çš„ Filter Chain å®ç°è´£ä»»é“¾ï¼Œä½¿ç”¨å¤šä¸ªè®¢å•å¤„ç†å™¨å¯¹è®¢å•è¿›è¡Œå¤„ç†ã€‚</p><h3 id="æœ¬æ–‡ç¤ºä¾‹-UML-å›¾"><a href="#æœ¬æ–‡ç¤ºä¾‹-UML-å›¾" class="headerlink" title="æœ¬æ–‡ç¤ºä¾‹ UML å›¾"></a>æœ¬æ–‡ç¤ºä¾‹ UML å›¾</h3><img  src=http://www.plantuml.com/plantuml/svg/lPFB2W8X58RtFiN1DjF5WRR341EpQH6q2DhRA8qmQQXTO9ftpx0WL6WJRRnm_dE-twDMnb9jpySEqRsncZOMceuQ0ylNTaKbwxY67W6Ce7-h1gPy9DjenhLVrqfQVdCL_3o3ZvYkMoeaDCznN5oKO471AnU7rcRZGaYB1eIyZLgTJqf-rl5EVeDFCtVYz5_WbdRS_1SPfpsHn2SNQs5i6Ro0XOjFeVtcw0LseF05bNT24lUPraKjISk2gugXU8A140LuZkCp8nIteSppbCcqC7QPreKsAowP-tCF><h3 id="å®ç°æŠ½è±¡å¤„ç†è€…"><a href="#å®ç°æŠ½è±¡å¤„ç†è€…" class="headerlink" title="å®ç°æŠ½è±¡å¤„ç†è€…"></a>å®ç°æŠ½è±¡å¤„ç†è€…</h3><p>ä¸ºäº†ç®€åŒ–ç¤ºä¾‹ï¼Œä»£ç ä¸­å…³äºä¼˜æƒ é‡‘é¢çš„è®¡ç®—éƒ½é‡‡å–å†™æ­»çš„æ–¹å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> WeJan</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2020-02-11</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractHandler</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doHandle</span><span class="hljs-params">(OrderHandleContext context, OrderHandlerChain chain)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è®¢å•å¤„ç†å™¨çš„æƒé‡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">int</span> <span class="hljs-title">weight</span><span class="hljs-params">()</span></span>;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å°è£…å¤„ç†å™¨é“¾å¤„ç†å…ƒç´ ä¸Šä¸‹æ–‡</span><br><span class="hljs-comment"> *  </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> WeJan</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2020-02-11</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@Accessors(chain = true)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderHandleContext</span> </span>&#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å½“å‰å¤„ç†å™¨ä½äºå¤„ç†å™¨ chain ä¸Šçš„ä½ç½®</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> pos;<br><br>    <span class="hljs-comment">// è®¢å•å·</span><br>    <span class="hljs-keyword">private</span> String orderNo;<br><br>    <span class="hljs-comment">// è®¢å•é‡‘é¢</span><br>    <span class="hljs-keyword">private</span> Double amount;<br><br>    <span class="hljs-comment">// VIP ç­‰çº§</span><br>    <span class="hljs-keyword">private</span> Integer vipLevel;<br><br>    <span class="hljs-comment">// ä¼˜æƒ åˆ¸</span><br>    <span class="hljs-keyword">private</span> String couponNo;<br>&#125;<br><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å°è£…å¤„ç†å™¨æƒé‡</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> WeJan</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2020-03-04</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Getter</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">OrderHandlerWeightEnum</span> </span>&#123;<br>    COUPON(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;ä¼˜æƒ åˆ¸&quot;</span>),<br>    SALES(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;ä¿ƒé”€æ´»åŠ¨&quot;</span>),<br>    VIP(<span class="hljs-number">3</span>, <span class="hljs-string">&quot;VIP&quot;</span>),<br>    ;<br>    <span class="hljs-keyword">private</span> Integer code;<br>    <span class="hljs-keyword">private</span> String desc;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="åˆå§‹åŒ–è®¢å•å¤„ç†å™¨é“¾"><a href="#åˆå§‹åŒ–è®¢å•å¤„ç†å™¨é“¾" class="headerlink" title="åˆå§‹åŒ–è®¢å•å¤„ç†å™¨é“¾"></a>åˆå§‹åŒ–è®¢å•å¤„ç†å™¨é“¾</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> WeJan</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2020-03-03</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderHandlerChain</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ApplicationContextAware</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> List&lt;AbstractHandler&gt; chain = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(<span class="hljs-number">10</span>);<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handle</span><span class="hljs-params">(OrderHandleContext context)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (context.getPos() &lt; chain.size()) &#123;<br>            AbstractHandler handler = chain.get(context.getPos());<br>            <span class="hljs-comment">// ç§»åŠ¨ä½äºå¤„ç†å™¨é“¾ä¸­çš„ä½ç½®</span><br>            context.setPos(context.getPos() + <span class="hljs-number">1</span>);<br>            handler.doHandle(context, <span class="hljs-keyword">this</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setApplicationContext</span><span class="hljs-params">(ApplicationContext applicationContext)</span> <span class="hljs-keyword">throws</span> BeansException </span>&#123;<br>        Map&lt;String, AbstractHandler&gt; beans = applicationContext.getBeansOfType(AbstractHandler.class);<br>        chain.addAll(beans.values());<br>        <span class="hljs-comment">// æ ¹æ®å¤„ç†å™¨çš„æƒé‡ï¼Œå¯¹å¤„ç†å™¨é“¾ä¸­å…ƒç´ è¿›è¡Œæ’åº</span><br>        chain.sort(Comparator.comparingInt(AbstractHandler::weight));<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å®ç°å…·ä½“å¤„ç†è€…"><a href="#å®ç°å…·ä½“å¤„ç†è€…" class="headerlink" title="å®ç°å…·ä½“å¤„ç†è€…"></a>å®ç°å…·ä½“å¤„ç†è€…</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CouponOrderHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractHandler</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doHandle</span><span class="hljs-params">(OrderHandleContext context, OrderHandlerChain chain)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (context.getCouponNo() != <span class="hljs-keyword">null</span>) &#123;<br>            context.setAmount(context.getAmount() - <span class="hljs-number">10</span>);<br>        &#125;<br>        <span class="hljs-comment">// è°ƒç”¨ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†</span><br>        chain.handle(context);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-title">weight</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> OrderHandlerWeightEnum.COUPON.getCode();<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SalesOrderHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractHandler</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doHandle</span><span class="hljs-params">(OrderHandleContext context, OrderHandlerChain chain)</span> </span>&#123;<br>        Double amount = context.getAmount();<br>        <span class="hljs-keyword">if</span> (amount &gt; <span class="hljs-number">80</span>) &#123;<br>            context.setAmount(amount * <span class="hljs-number">0.9</span>);<br>        &#125;<br>        <span class="hljs-comment">// è°ƒç”¨ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†</span><br>        chain.handle(context);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-title">weight</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> OrderHandlerWeightEnum.SALES.getCode();<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VipOrderHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractHandler</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doHandle</span><span class="hljs-params">(OrderHandleContext context, OrderHandlerChain chain)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (context.getVipLevel() &gt; <span class="hljs-number">2</span>) &#123;<br>            context.setAmount(context.getAmount() - <span class="hljs-number">5</span>);<br>        &#125;<br>        <span class="hljs-comment">// è°ƒç”¨ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†</span><br>        chain.handle(context);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-title">weight</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> OrderHandlerWeightEnum.VIP.getCode();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-meta">@SpringBootTest(classes = App.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ChainTest</span> </span>&#123;<br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> OrderHandlerChain chain;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">name</span><span class="hljs-params">()</span> </span>&#123;<br>        OrderHandleContext order = <span class="hljs-keyword">new</span> OrderHandleContext()<br>                .setOrderNo(<span class="hljs-string">&quot;123&quot;</span>)<br>                .setAmount(<span class="hljs-number">100d</span>)<br>                .setVipLevel(<span class="hljs-number">3</span>)<br>                .setCouponNo(<span class="hljs-string">&quot;111&quot;</span>);<br>        chain.handle(order);<br>        System.out.println(<span class="hljs-string">&quot;è®¢å•æœ€ç»ˆé‡‘é¢ä¸ºï¼š &quot;</span> + order.getAmount());<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºç»“æœä¸ºï¼š</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">76</span>.<span class="hljs-number">0</span><br></code></pre></div></td></tr></table></figure><p> å¤„ç†å™¨é“¾è°ƒç”¨ handle æ–¹æ³•ï¼Œé€ä¸ªè°ƒç”¨å¤„ç†å™¨é“¾ä¸­çš„å¤„ç†å™¨çš„ doHanle æ–¹æ³•ï¼Œå¯¹è®¢å•è¿›è¡Œå¤„ç†ï¼Œå½“å‰å¤„ç†å™¨å¤„ç†å®Œæ¯•åï¼Œå¯ä»¥é€‰æ‹©æ˜¯å¦ç»§ç»­äº¤ç”±ä¸‹ä¸€ä¸ªå¤„ç†å™¨è¿›è¡Œå¤„ç†ï¼Œå³è®¾ç½® <code>chain.handle(context);</code>ï¼Œå¦‚æœä¸éœ€è¦ç»§ç»­å¾€ä¸‹å¤„ç†ï¼Œä¸è°ƒç”¨æ­¤ä»£ç å³å¯ã€‚</p><p> ç½‘ä¸Šæµä¼ çš„ä»£ç éƒ½æ˜¯ç›´æ¥åœ¨æŠ½è±¡å¤„ç†å™¨ä¸­åŒ…å«ä¸‹ä¸€ä¸ªå¤„ç†å™¨çš„å¼•ç”¨ï¼Œè¿™æ ·å¯¼è‡´åœ¨å®¢æˆ·ç«¯ä½¿ç”¨çš„æ—¶å€™ï¼Œå°±éœ€è¦æ‰‹åŠ¨å»é€ä¸ª set ä¸‹çº§å¤„ç†å™¨ï¼Œæ‰‹è¯¯å¾ˆå®¹æ˜“é€ æˆå¤„ç†å™¨æ­»å¾ªç¯çš„æƒ…å†µï¼Œä¹Ÿå¯èƒ½å‡ºç°ç¼ºå¤±æŸä¸ªå¤„ç†å™¨çš„æƒ…å†µï¼Œå› è€Œæœ¬æ–‡å‚ç…§ Tomcat æºç ä¸­ Filter çš„ä½œæ³•ï¼Œå¼•å…¥äº† Chain ç±»ï¼Œç»Ÿä¸€å¯¹å¤„ç†å™¨å°è£…ä¸ºé“¾ï¼Œå‡å°‘å®¢æˆ·ç«¯ä½¿ç”¨æ—¶å‡ºé”™çš„å¯èƒ½ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é“¾å¼å¤„ç†çš„å¥½å¤„åœ¨äºå¢åŠ å‡å°‘æ–°çš„å¤„ç†å™¨ä¸ä¼šå½±å“å…¶ä»–å¤„ç†å™¨çš„é€»è¾‘ï¼Œå„ä¸ªå¤„ç†å™¨ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œå¯ä»¥å‡å°è€¦åˆå¸¦æ¥çš„å½±å“ã€‚</p><h2 id="æºç ä¸‹è½½"><a href="#æºç ä¸‹è½½" class="headerlink" title="æºç ä¸‹è½½"></a>æºç ä¸‹è½½</h2><ul><li><a href="https://github.com/Mosiki/learning-modules/tree/master/learning-designpatterns">https://github.com/Mosiki/learning-modules/tree/master/learning-designpatterns</a></li></ul><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="https://juejin.im/post/5bd95adfe51d45607e02ecc0">è®¾è®¡æ¨¡å¼ | è´£ä»»é“¾æ¨¡å¼åŠå…¸å‹åº”ç”¨ </a></li><li><a href="https://www.kancloud.cn/sstd521/design/193560">https://www.kancloud.cn/sstd521/design/193560</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç»“åˆSpringå®è·µè´£ä»»é“¾æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼ä¹‹é—¨é¢æ¨¡å¼å®æˆ˜</title>
    <link href="/design-patterns-facade.html"/>
    <url>/design-patterns-facade.html</url>
    
    <content type="html"><![CDATA[<p>ç±»å‹ï¼šç»“æ„å‹æ¨¡å¼</p><p>æ„å›¾ï¼šå®šä¹‰ä¸€ä¸ªç»Ÿä¸€çš„ç³»ç»Ÿæ¥å£ï¼Œéšè—å¤šä¸ªå­ç³»ç»Ÿçš„å¤æ‚æ€§ã€‚</p><p>ä¸»è¦è§£å†³ï¼šé™ä½è®¿é—®ç³»ç»Ÿå®¢æˆ·ç«¯å†…éƒ¨å­ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šè§£è€¦åˆå®¢æˆ·ç«¯ä¸å…·ä½“å­ç³»ç»Ÿï¼Œå­ç³»ç»Ÿä¸å®¢æˆ·ç«¯æ— éœ€æ„ŸçŸ¥å¯¹æ–¹ï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦äº²è‡ªè°ƒç”¨å­ç³»ç»Ÿçš„æ¥å£ï¼ŒæŠŠåŸæœ¬éœ€è¦ä¸å¤šä¸ªå­ç³»ç»Ÿçš„äº¤äº’å…¨éƒ¨å°è£…åˆ°é—¨é¢ç±»ä¸­ï¼Œå®¢æˆ·ç«¯åªéœ€è¦å’Œ Facade ç±»äº¤äº’å³å¯ã€‚</p><a id="more"></a><p><a href="http://nullpointer.pw/design-patterns.html">è®¾è®¡æ¨¡å¼ç³»åˆ—æ–‡ç« ç›®å½• </a></p><h2 id="è§’è‰²"><a href="#è§’è‰²" class="headerlink" title="è§’è‰²"></a>è§’è‰²</h2><ul><li>Facadeï¼š é—¨é¢è§’è‰²ï¼Œå§”æ‰˜å®¢æˆ·ç«¯çš„è¯·æ±‚åˆ°å…·ä½“çš„å®¢æˆ·ç«¯</li><li>SubSystemï¼šå­ç³»ç»Ÿè§’è‰²</li></ul><h2 id="UML"><a href="#UML" class="headerlink" title="UML"></a>UML</h2><p>ä½¿ç”¨é—¨é¢æ¨¡å¼å°è£…ä¹‹å‰ UMLï¼š</p><img  src=http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuKhEIImkLl3DJodDINLKgEPIKD1MA4ajBZ7Kq5ImKYZBpqpXgkL2KUM4fCe8fofd95N6AAf2W28AkhfsC4lH1PpG1Pov75BpKe2E1G00><p>ä½¿ç”¨é—¨é¢æ¨¡å¼å°è£…ä¹‹å UMLï¼š</p><img  src=http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuKhEIImkLd1BJ4vCILMevb9Gq5N8pKyfpKbrLB1Iy8Mma4ITuA9EIABES55deAYsGabgSOcXXYPGj2m_CmKkP8GfP8mGgkM2EWPgAzWr66QXgN92KcM4KvKpaYfK6qE08WgwkdRG4E221WH81EPv324dJ25dBeVKl1HWU080><p>å¯ä»¥çœ‹åˆ°å®¢æˆ·ç«¯ç”±ä¾èµ–ä¸‰ä¸ªå¯¹è±¡å˜æˆä¾èµ–ä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡é—¨é¢å¯¹è±¡å°è£…å­ç³»ç»Ÿï¼Œå¯¹äºå®¢æˆ·ç«¯ï¼Œå±è”½å­ç³»ç»Ÿå†…éƒ¨çš„å¤æ‚æ€§ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé—¨é¢ç±»ä¸è¦å‚ä¸ä»»ä½•å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚    </p><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><p>åœ¨å¤§é‡ä½¿ç”¨ Dubbo è¿›è¡Œæ¥å£è°ƒç”¨çš„é¡¹ç›®ç³»ç»Ÿä¸­ï¼Œæœ‰å¾ˆå¤š Dubbo æ–¹æ³•æ˜¯å±äºå…¬ç”¨çš„æ–¹æ³•ï¼Œè™½ç„¶å®¢æˆ·ç«¯ç±»å¯ä»¥æ³¨å…¥ä¸åŒçš„ Dubbo æœåŠ¡ç±»è¿›è¡Œæ¥å£è°ƒç”¨ï¼Œä½†æ˜¯æ˜æ˜¾å®¢æˆ·ç«¯ä¸å…¶ä»–å­ç³»ç»Ÿçš„ä¾èµ–è¿‡äºç´§å¯†ã€‚</p><p>å½“ä¸€ä¸ªå­ç³»ç»Ÿéœ€è¦è¿›è¡Œä¿®æ”¹æ—¶ï¼Œéœ€è¦ä¿®æ”¹æ‰€æœ‰è°ƒç”¨æ­¤ç³»ç»Ÿçš„æ¥å£ï¼Œæ­¤æ—¶æœ€é€‚åˆä½¿ç”¨é—¨é¢æ¨¡å¼æ¥å°è£…è¿™äº›å­ç³»ç»Ÿçš„æ¥å£ï¼Œç„¶åç»Ÿä¸€å¯¹å®¢æˆ·ç«¯æä¾›æ–¹æ³•è¿›è¡Œè°ƒç”¨ï¼Œå¤§å¤§é™ä½å®¢æˆ·ç«¯ä¸å­ç³»ç»Ÿé—´çš„è€¦åˆæ€§ã€‚</p><p>æœ¬æ–‡ä¸ºäº†ç®€åŒ–ç¤ºä¾‹ï¼Œå°±ä¸æœªå¼•å…¥ Dubboï¼Œè€Œæ˜¯ç›´æ¥ Mock äº†ä¸¤ä¸ªè¿œç¨‹æœåŠ¡ç±»ã€‚ç¤ºä¾‹æä¾›ä¸€ä¸ªé’ˆå¯¹è·å–ç”¨æˆ·ç›¸å…³ä¿¡æ¯çš„é—¨é¢ç±»ã€‚</p><h2 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h2><h3 id="å®šä¹‰ä¸¤ä¸ª-Mock-çš„è¿œç¨‹æœåŠ¡ç±»"><a href="#å®šä¹‰ä¸¤ä¸ª-Mock-çš„è¿œç¨‹æœåŠ¡ç±»" class="headerlink" title="å®šä¹‰ä¸¤ä¸ª Mock çš„è¿œç¨‹æœåŠ¡ç±»"></a>å®šä¹‰ä¸¤ä¸ª Mock çš„è¿œç¨‹æœåŠ¡ç±»</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MockUserRemoteService</span> </span>&#123;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isNewUser</span><span class="hljs-params">(Long userId)</span> </span>&#123;<br>        <span class="hljs-comment">// TODO è°ƒç”¨è¿œç¨‹æ¥å£</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> UserInfo <span class="hljs-title">getUserInfo</span><span class="hljs-params">(Long userId)</span> </span>&#123;<br>        <span class="hljs-comment">// TODO è°ƒç”¨è¿œç¨‹æ¥å£</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> UserInfo();<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MockDeptRemoteService</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> DeptInfo <span class="hljs-title">getDeptInfo</span><span class="hljs-params">(Long userId)</span> </span>&#123;<br>        <span class="hljs-comment">// TODO è°ƒç”¨è¿œç¨‹æ¥å£</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> DeptInfo();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å®šä¹‰ç”¨æˆ·é—¨é¢ç±»"><a href="#å®šä¹‰ç”¨æˆ·é—¨é¢ç±»" class="headerlink" title="å®šä¹‰ç”¨æˆ·é—¨é¢ç±»"></a>å®šä¹‰ç”¨æˆ·é—¨é¢ç±»</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserFacade</span> </span>&#123;<br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> MockUserRemoteService userRemoteService;<br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> MockDeptRemoteService deptRemoteService;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ¤æ–­æ˜¯å¦æ˜¯æ–°ç”¨æˆ·</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isNewUser</span><span class="hljs-params">(Long userId)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> userRemoteService.isNewUser(userId);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–ç”¨æˆ·ä¿¡æ¯</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> UserInfo <span class="hljs-title">getUserInfo</span><span class="hljs-params">(Long userId)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> userRemoteService.getUserInfo(userId);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–ç”¨æˆ·éƒ¨é—¨ä¿¡æ¯</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> DeptInfo <span class="hljs-title">getDeptInfo</span><span class="hljs-params">(Long userId)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> deptRemoteService.getDeptInfo(userId);<br>    &#125;<br><br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="æµ‹è¯•å®¢æˆ·ç«¯è°ƒç”¨"><a href="#æµ‹è¯•å®¢æˆ·ç«¯è°ƒç”¨" class="headerlink" title="æµ‹è¯•å®¢æˆ·ç«¯è°ƒç”¨"></a>æµ‹è¯•å®¢æˆ·ç«¯è°ƒç”¨</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-meta">@SpringBootTest(classes = App.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FacadeTest</span> </span>&#123;<br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">protected</span> UserFacade userFacade;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test1</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">long</span> userId = <span class="hljs-number">11L</span>;<br>        UserInfo userInfo = userFacade.getUserInfo(userId);<br>        DeptInfo deptInfo = userFacade.getDeptInfo(userId);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é—¨é¢æ¨¡å¼è¿˜æ˜¯å¾ˆå¥½ç†è§£çš„ï¼Œå°è£…äº†å­ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œé€šè¿‡é—¨é¢å¯¹è±¡åªæš´éœ²å®¢æˆ·ç«¯éœ€è¦çš„æ¥å£ï¼Œä¸€äº›å†…éƒ¨çš„æ¥å£å¯ä»¥åšåˆ°å¯¹å®¢æˆ·ç«¯éšè—ã€‚</p><blockquote><p><strong>é—¨é¢æ¨¡å¼çš„ä¼˜ç‚¹</strong><br>ã€€ã€€é—¨é¢æ¨¡å¼çš„ä¼˜ç‚¹ï¼š<br>ã€€ã€€<strong>â—ã€€ã€€æ¾æ•£è€¦åˆ</strong><br>ã€€ã€€é—¨é¢æ¨¡å¼æ¾æ•£äº†å®¢æˆ·ç«¯ä¸å­ç³»ç»Ÿçš„è€¦åˆå…³ç³»ï¼Œè®©å­ç³»ç»Ÿå†…éƒ¨çš„æ¨¡å—èƒ½æ›´å®¹æ˜“æ‰©å±•å’Œç»´æŠ¤ã€‚<br>ã€€ã€€<strong>â—ã€€ã€€ç®€å•æ˜“ç”¨</strong><br>ã€€ã€€é—¨é¢æ¨¡å¼è®©å­ç³»ç»Ÿæ›´åŠ æ˜“ç”¨ï¼Œå®¢æˆ·ç«¯ä¸å†éœ€è¦äº†è§£å­ç³»ç»Ÿå†…éƒ¨çš„å®ç°ï¼Œä¹Ÿä¸éœ€è¦è·Ÿä¼—å¤šå­ç³»ç»Ÿå†…éƒ¨çš„æ¨¡å—è¿›è¡Œäº¤äº’ï¼Œåªéœ€è¦è·Ÿé—¨é¢ç±»äº¤äº’å°±å¯ä»¥äº†ã€‚<br>ã€€ã€€<strong>â—ã€€ã€€æ›´å¥½çš„åˆ’åˆ†è®¿é—®å±‚æ¬¡</strong><br>ã€€ã€€é€šè¿‡åˆç†ä½¿ç”¨ Facadeï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°åˆ’åˆ†è®¿é—®çš„å±‚æ¬¡ã€‚æœ‰äº›æ–¹æ³•æ˜¯å¯¹ç³»ç»Ÿå¤–çš„ï¼Œæœ‰äº›æ–¹æ³•æ˜¯ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨çš„ã€‚æŠŠéœ€è¦æš´éœ²ç»™å¤–éƒ¨çš„åŠŸèƒ½é›†ä¸­åˆ°é—¨é¢ä¸­ï¼Œè¿™æ ·æ—¢æ–¹ä¾¿å®¢æˆ·ç«¯ä½¿ç”¨ï¼Œä¹Ÿå¾ˆå¥½åœ°éšè—äº†å†…éƒ¨çš„ç»†èŠ‚ã€‚</p></blockquote><h2 id="æºç ä¸‹è½½"><a href="#æºç ä¸‹è½½" class="headerlink" title="æºç ä¸‹è½½"></a>æºç ä¸‹è½½</h2><ul><li><a href="https://github.com/Mosiki/learning-modules/tree/master/learning-designpatterns">https://github.com/Mosiki/learning-modules/tree/master/learning-designpatterns</a></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://www.kancloud.cn/sstd521/design/193594">é—¨é¢æ¨¡å¼çš„æ³¨æ„äº‹é¡¹ </a></li><li><a href="https://www.cnblogs.com/java-my-life/archive/2012/05/02/2478101.html">ã€ŠJAVA ä¸æ¨¡å¼ã€‹ä¹‹é—¨é¢æ¨¡å¼ </a></li></ul>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼ä¹‹çŠ¶æ€æ¨¡å¼å®æˆ˜</title>
    <link href="/design-patterns-state.html"/>
    <url>/design-patterns-state.html</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä»¥è¿è¥æ´»åŠ¨çŠ¶æ€è½¬æ¢ä¸ºä¾‹ï¼Œç»“åˆ Spring æ¼”ç¤ºçŠ¶æ€æ¨¡å¼çš„å®è·µåº”ç”¨ã€‚</p><a id="more"></a><h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><blockquote><p>2021 å¹´ 02 æœˆ 09 æ—¥</p><p>è¯„è®ºä¸­åŒ¿åè¯„è®ºæåˆ°å¯èƒ½å‡ºç°å¹¶å‘é—®é¢˜ï¼Œå®¡è§†ä»£ç å‘ç° ActivityState ç±»æŒæœ‰äº†å…¨å±€å˜é‡ ActivityContextï¼Œåœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œä¼šé€ æˆæ•°æ®å…±äº«å¯¼è‡´çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œè§£å†³åŠæ³•å¾ˆç®€å•ï¼Œä½¿ç”¨ ThreadLocal å¯¹è±¡åŒ…è£… ActivityContext å³å¯ï¼Œéœ€è¦æ³¨æ„ç”¨å®Œéœ€è¦è¿›è¡Œé‡Šæ”¾ï¼Œæš‚æ—¶æ²¡æƒ³åˆ°å…¶ä»–æ›´å¥½çš„æ–¹æ³•è§£å†³ã€‚</p><p>æ„Ÿè°¢è¯„è®ºä¸­å“¥ä»¬æå‡ºçš„é—®é¢˜ï¼Œæœ‰ç©ºåŠ  QQ ç¾¤ <strong>967808880</strong> ä¸€å—äº¤æµäº¤æµã€‚</p></blockquote><p>ç±»å‹ï¼šè¡Œä¸ºå‹æ¨¡å¼</p><p>æ„å›¾ï¼šå…è®¸å¯¹è±¡åœ¨å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥å¥½åƒä¿®æ”¹äº†å®ƒçš„ç±»ã€‚</p><p>ä¸»è¦è§£å†³ï¼šä¸€ä¸ªå¯¹è±¡å­˜åœ¨å¤šä¸ªçŠ¶æ€ï¼Œæ¯ä¸ªçŠ¶æ€è¡Œä¸ºä¸åŒï¼ŒçŠ¶æ€å¯ä»¥ç›¸äº’è½¬æ¢ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼š1ã€è¡Œä¸ºéšçŠ¶æ€æ”¹å˜è€Œæ”¹å˜çš„åœºæ™¯ã€‚ 2ã€å‡å°‘ switch..case ä»¥åŠ ifâ€¦else</p><p><a href="http://nullpointer.pw/design-patterns.html">è®¾è®¡æ¨¡å¼ç³»åˆ—æ–‡ç« ç›®å½• </a></p><h2 id="è§’è‰²"><a href="#è§’è‰²" class="headerlink" title="è§’è‰²"></a>è§’è‰²</h2><ul><li><p>Stateï¼šæŠ½è±¡çŠ¶æ€è§’è‰²ï¼Œè´Ÿè´£å¯¹è±¡çŠ¶æ€å®šä¹‰ï¼Œå¹¶ä¸”å°è£…ç¯å¢ƒè§’è‰²ä»¥å®ç°çŠ¶æ€åˆ‡æ¢ã€‚</p></li><li><p>Contextï¼šç¯å¢ƒè§’è‰²ï¼Œå®šä¹‰å®¢æˆ·ç«¯éœ€è¦çš„æ¥å£ï¼Œå¹¶ä¸”è´Ÿè´£å…·ä½“çŠ¶æ€çš„åˆ‡æ¢ã€‚</p></li><li><p>ConcreteStateï¼šå…·ä½“çŠ¶æ€è§’è‰²ï¼Œå½“å‰çŠ¶æ€è¦åšçš„äº‹æƒ…ï¼Œä»¥åŠå½“å‰çŠ¶æ€å¦‚ä½•è½¬æ¢å…¶ä»–çŠ¶æ€ã€‚</p></li></ul><h2 id="UML"><a href="#UML" class="headerlink" title="UML"></a>UML</h2><img  src=http://www.plantuml.com/plantuml/svg/LSx12O0m40J0_rLnJqNIWOXW2LPmnWCVCM9k1K7iNIKe-DxPPLk396np81_4ZBibGdVmGSHSST9rKqDHqaaaWo691sVQGw0tVDmaSGoQsJVaaq9VzIJl-EAQtAQSrixzFRKQn_lK1G00><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><p>æœ¬æ–‡ä»¥è¿è¥æ´»åŠ¨çŠ¶æ€ä¸ºä¾‹ï¼Œç»“åˆ Spring æ¼”ç¤ºçŠ¶æ€æ¨¡å¼çš„å®è·µåº”ç”¨ã€‚</p><p>è¿è¥æ´»åŠ¨åˆ›å»ºåˆå§‹çŠ¶æ€ä¸ºè‰ç¨¿çŠ¶æ€ï¼Œç¼–è¾‘å¥½æ´»åŠ¨ä¹‹åï¼Œè¿è¥ä¼šåå°å¯ç”¨æ´»åŠ¨ï¼Œæ­¤æ—¶æ´»åŠ¨çŠ¶æ€ä¸ºå·²å¯ç”¨ï¼›<br>å½“è¾¾åˆ°æ´»åŠ¨å¼€å§‹æ—¶é—´æ—¶ï¼Œå®šæ—¶ä»»åŠ¡ä¼šå°†æ´»åŠ¨çŠ¶æ€ç½®ä¸ºè¿›è¡Œä¸­ï¼›<br>å½“è¾¾åˆ°æ´»åŠ¨ç»“æŸæ—¶é—´æ—¶ï¼Œå®šæ—¶ä»»åŠ¡ä¼šå°†æ´»åŠ¨çŠ¶æ€ç½®ä¸ºå·²ç»“æŸã€‚<br>è¿›è¡Œä¸­çš„æ´»åŠ¨ä¹Ÿå¯èƒ½ä¼šå› ä¸ºæŸäº›åŸå› éœ€è¦æ‰‹åŠ¨åœç”¨ï¼Œæ­¤æ—¶æ´»åŠ¨çŠ¶æ€ç½®ä¸ºå·²åœç”¨ã€‚</p><p>çŠ¶æ€ä¹‹é—´æœ‰ç€ä¸¥æ ¼çš„å‰ç½®æ ¡éªŒï¼Œæ¯”å¦‚è‰ç¨¿çŠ¶æ€å¯ä»¥ç»§ç»­ä¿å­˜ä¸ºè‰ç¨¿ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œå¯åŠ¨ï¼Œä½†ä¸èƒ½ç›´æ¥åˆ‡æ¢ä¸ºè¿›è¡Œä¸­ï¼Œå¯ä»¥ç›´æ¥ç¼–è¾‘åˆ‡æ¢å›è‰ç¨¿ç®±çŠ¶æ€ï¼›æ¯”å¦‚å·²åœç”¨çš„çŠ¶æ€åªæœ‰åœ¨å¯ç”¨ä¹‹åæ‰èƒ½è¢«ç½®ä¸ºè¿›è¡Œä¸­ã€‚</p><p>æ´»åŠ¨çŠ¶æ€çš„åˆ‡æ¢çº¦æŸå¦‚ä¸‹å›¾ï¼š</p><table><thead><tr><th align="center">æ–°çŠ¶æ€â†’<br /> å½“å‰çŠ¶æ€â†“</th><th align="center">è‰ç¨¿ç®±</th><th align="center">å·²å¯ç”¨</th><th align="center">è¿›è¡Œä¸­</th><th align="center">å·²åœç”¨</th><th align="center">å·²ç»“æŸ</th></tr></thead><tbody><tr><td align="center">è‰ç¨¿ç®±</td><td align="center">âœ…</td><td align="center">âœ…</td><td align="center">âŒ</td><td align="center">âŒ</td><td align="center">âŒ</td></tr><tr><td align="center">å·²å¯ç”¨</td><td align="center">âœ…</td><td align="center">âŒ</td><td align="center">âœ…</td><td align="center">âœ…</td><td align="center">âŒ</td></tr><tr><td align="center">è¿›è¡Œä¸­</td><td align="center">âŒ</td><td align="center">âŒ</td><td align="center">âŒ</td><td align="center">âœ…</td><td align="center">âœ…</td></tr><tr><td align="center">å·²åœç”¨</td><td align="center">âŒ</td><td align="center">âœ…</td><td align="center">âŒ</td><td align="center">âŒ</td><td align="center">âŒ</td></tr><tr><td align="center">å·²ç»“æŸ</td><td align="center">âŒ</td><td align="center">âŒ</td><td align="center">âŒ</td><td align="center">âŒ</td><td align="center">âŒ</td></tr></tbody></table><p>å¦‚æœä¸é‡‡å–çŠ¶æ€æ¨¡å¼ï¼Œå¯èƒ½å†™å‡ºçš„ä»£ç å°±æ˜¯ä¸æ–­ä½¿ç”¨ if åˆ¤æ–­å‰ç½®çŠ¶æ€æ˜¯å¦ç¬¦åˆè§„åˆ™ï¼Œå½“å¢åŠ äº†æ–°çš„çŠ¶æ€ï¼Œéœ€è¦æ”¹åŠ¨åˆ¤æ–­çš„åœ°æ–¹ï¼Œä»è€Œå¯èƒ½å¼•å…¥äº† Bugã€‚</p><h3 id="æœ¬æ–‡ç¤ºä¾‹-UML-å›¾"><a href="#æœ¬æ–‡ç¤ºä¾‹-UML-å›¾" class="headerlink" title="æœ¬æ–‡ç¤ºä¾‹ UML å›¾"></a>æœ¬æ–‡ç¤ºä¾‹ UML å›¾</h3><img  src=http://www.plantuml.com/plantuml/svg/vLR1Ri8m3BtxAonnwJJr2q0Jqs3Ipdo1svejKabGOofGuTyfGOMswhAC8pqcUNxnUtQipArG8RjD3fHOAIWLJ7Eo5jzJKQMImqf862k0oMthmsZXlI1rrm28hrWQbQ5bwO6ZFu9VN73L977wgdU_kK0vR3dg7oR6v4mQBPMyA6XzPx_H_XR2cfASm_7Edd1ufkp_-DTAA_ipX3y1T2lHE5VLL76lFjHUJGSBuOuYJzWrnM1lmnmDyZ7GlGSySmgQ5hvm3FJLSobUkkH69NbrkNPKYXTNnb5f_dJG9vSC_M5luhVkg8Vk19yTutXWslbGhGdXWzrVbVVALYVwSAtgmPnrLlyupW00><h2 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h2><h3 id="å®šä¹‰æŠ½è±¡çŠ¶æ€è§’è‰²"><a href="#å®šä¹‰æŠ½è±¡çŠ¶æ€è§’è‰²" class="headerlink" title="å®šä¹‰æŠ½è±¡çŠ¶æ€è§’è‰²"></a>å®šä¹‰æŠ½è±¡çŠ¶æ€è§’è‰²</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActivityState</span> </span>&#123;<br>    <span class="hljs-comment">// æŠ½è±¡çŠ¶æ€è§’è‰²éœ€è¦æŒæœ‰ç¯å¢ƒä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œé˜²æ­¢å¹¶å‘å‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä½¿ç”¨ ThreadLocal è¿›è¡ŒåŒ…è£…</span><br>    <span class="hljs-keyword">protected</span> ThreadLocal&lt;ActivityContext&gt; activityContext = <span class="hljs-keyword">new</span> ThreadLocal&lt;&gt;();<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setActivityContext</span><span class="hljs-params">(ActivityContext activityContext)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.activityContext.set(activityContext);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> Integer <span class="hljs-title">type</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ¤æ–­æ˜¯å¦æ˜¯å½“å‰çŠ¶æ€</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isSameStatus</span><span class="hljs-params">(Activity activity)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> type().equals(activity.getStatus());<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä¿å­˜è‰ç¨¿</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">saveDraft</span><span class="hljs-params">(Activity activity)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¯ç”¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">enable</span><span class="hljs-params">(Activity activity)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¼€å§‹</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">start</span><span class="hljs-params">(Activity activity)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åœç”¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">disable</span><span class="hljs-params">(Activity activity)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åœæ­¢</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">finish</span><span class="hljs-params">(Activity activity)</span></span>;<br>  <br>    <span class="hljs-comment">// æ¸…ç†èµ„æº</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">clear</span><span class="hljs-params">()</span> </span>&#123;<br>        activityContext.remove();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å®šä¹‰ç¯å¢ƒè§’è‰²"><a href="#å®šä¹‰ç¯å¢ƒè§’è‰²" class="headerlink" title="å®šä¹‰ç¯å¢ƒè§’è‰²"></a>å®šä¹‰ç¯å¢ƒè§’è‰²</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActivityContext</span> </span>&#123;<br>    <span class="hljs-comment">// æŒæœ‰æŠ½è±¡çŠ¶æ€è§’è‰²å¼•ç”¨</span><br>    <span class="hljs-keyword">private</span> ActivityState activityState;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setActivityState</span><span class="hljs-params">(ActivityState activityState)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.activityState = activityState;<br>        <span class="hljs-keyword">this</span>.activityState.setActivityContext(<span class="hljs-keyword">this</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">saveDraft</span><span class="hljs-params">(Activity activity)</span> </span>&#123;<br>        <span class="hljs-comment">// å§”æ‰˜å…·ä½“çš„çŠ¶æ€è§’è‰²</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.activityState.saveDraft(activity);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">enable</span><span class="hljs-params">(Activity activity)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.activityState.enable(activity);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">start</span><span class="hljs-params">(Activity activity)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.activityState.start(activity);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">disable</span><span class="hljs-params">(Activity activity)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.activityState.disable(activity);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">finish</span><span class="hljs-params">(Activity activity)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.activityState.finish(activity);<br>    &#125;<br><br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å®šä¹‰å…·ä½“çŠ¶æ€è§’è‰²"><a href="#å®šä¹‰å…·ä½“çŠ¶æ€è§’è‰²" class="headerlink" title="å®šä¹‰å…·ä½“çŠ¶æ€è§’è‰²"></a>å®šä¹‰å…·ä½“çŠ¶æ€è§’è‰²</h3><p>å› ä¸ºæœ¬æ–‡ç¤ºä¾‹å…·ä½“çŠ¶æ€è§’è‰²æœ‰å¾ˆå¤šï¼Œå› æ­¤åªåˆ—ä¸¾ä¸€ä¸ªå¼€å¯çŠ¶æ€è§’è‰²ä¸¾ä¾‹å‚è€ƒï¼Œæ›´å¤šä»£ç å¯ä»¥å‚è€ƒæœ¬æ–‡å¯¹åº”çš„ GitHub ç¤ºä¾‹ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActivityEnableState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ActivityState</span> </span>&#123;<br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> ActivityDraftState activityDraftState;<br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> ActivityStartState activityStartState;<br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> ActivityDisableState activityDisableState;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">type</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> ActivityStateEnum.ENABLE.getCode();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">saveDraft</span><span class="hljs-params">(Activity activity)</span> </span>&#123;<br>        ActivityContext activityContext = <span class="hljs-keyword">this</span>.activityContext.get();<br>        activityContext.setActivityState(activityDraftState);<br>        <span class="hljs-keyword">return</span> activityContext.saveDraft(activity);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">enable</span><span class="hljs-params">(Activity activity)</span> </span>&#123;<br>   <span class="hljs-comment">// å¦‚æœå½“å‰çŠ¶æ€å·²ç»æ˜¯ enable äº†ï¼Œåˆ™æ— æ³•å†æ¬¡ enable</span><br>        <span class="hljs-keyword">if</span> (isSameStatus(activity)) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        &#125;<br>        activity.setStatus(type());<br>        <span class="hljs-comment">//TODO æ›´æ–°æ•°æ®åº“</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">start</span><span class="hljs-params">(Activity activity)</span> </span>&#123;<br>        ActivityContext activityContext = <span class="hljs-keyword">this</span>.activityContext.get();<br>        activityContext.setActivityState(activityDraftState);<br>        <span class="hljs-keyword">return</span> activityContext.start(activity);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">disable</span><span class="hljs-params">(Activity activity)</span> </span>&#123;<br>        ActivityContext activityContext = <span class="hljs-keyword">this</span>.activityContext.get();<br>        activityContext.setActivityState(activityDraftState);<br>        <span class="hljs-keyword">return</span> activityContext.disable(activity);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">finish</span><span class="hljs-params">(Activity activity)</span> </span>&#123;<br>        <span class="hljs-comment">// éè¿›è¡Œä¸­çš„æ´»åŠ¨çŠ¶æ€ï¼Œä¸å…è®¸ç›´æ¥è¿›è¡Œ finish</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å°è£…å…·ä½“çŠ¶æ€å®ä¾‹å·¥å‚"><a href="#å°è£…å…·ä½“çŠ¶æ€å®ä¾‹å·¥å‚" class="headerlink" title="å°è£…å…·ä½“çŠ¶æ€å®ä¾‹å·¥å‚"></a>å°è£…å…·ä½“çŠ¶æ€å®ä¾‹å·¥å‚</h3><p>çŠ¶æ€è§’è‰²åº”è¯¥æ˜¯å•ä¾‹çš„ï¼Œç»“åˆ Spring ä¸å·¥å‚æ¨¡å¼å¯¹å®ä¾‹è¿›è¡Œå°è£…ï¼Œæ–¹ä¾¿æ ¹æ®æ•°æ®åº“çš„ status å€¼è·å–å¯¹åº”çš„çŠ¶æ€è§’è‰²å®ä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActivityStateFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ApplicationContextAware</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;Integer, ActivityState&gt; STATE_MAP = <span class="hljs-keyword">new</span> HashMap&lt;&gt;(ActivityStateEnum.values().length);<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setApplicationContext</span><span class="hljs-params">(ApplicationContext applicationContext)</span> <span class="hljs-keyword">throws</span> BeansException </span>&#123;<br>        Map&lt;String, ActivityState&gt; beans = applicationContext.getBeansOfType(ActivityState.class);<br>        beans.values().forEach(item -&gt; STATE_MAP.put(item.type(), item));<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-meta">@SpringBootTest(classes = App.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BaseTest</span> </span>&#123;<br><br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test1</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-comment">// ä¸€èˆ¬æ´»åŠ¨éƒ½æ˜¯ä»æ•°æ®åº“æŸ¥è¯¢å‡ºæ¥äº†ï¼Œæ­¤å¤„ä¸ºæ–¹ä¾¿æµ‹è¯•ç›´æ¥ new</span><br>        Activity activity = <span class="hljs-keyword">new</span> Activity()<br>                .setId(<span class="hljs-number">1L</span>)<br>                .setName(<span class="hljs-string">&quot;æµ‹è¯•æ´»åŠ¨&quot;</span>)<br>                .setStatus(ActivityStateEnum.DRAFT.getCode())<br>                .setCreateTime(LocalDateTime.now());<br><br>        ActivityState activityState = ActivityStateFactory.STATE_MAP.get(activity.getStatus());<br>        ActivityContext context = <span class="hljs-keyword">new</span> ActivityContext();<br>        context.setActivityState(activityState);<br><br>        System.out.println(<span class="hljs-string">&quot;ä¿å­˜è‰ç¨¿: &quot;</span> + (context.saveDraft(activity) ? <span class="hljs-string">&quot;æˆåŠŸ&quot;</span> : <span class="hljs-string">&quot;å¤±è´¥&quot;</span>));<br>        System.out.println(<span class="hljs-string">&quot;æ›´æ–°æ´»åŠ¨çŠ¶æ€ä¸ºå·²å¯ç”¨: &quot;</span> + (context.enable(activity) ? <span class="hljs-string">&quot;æˆåŠŸ&quot;</span> : <span class="hljs-string">&quot;å¤±è´¥&quot;</span>));<br>        System.out.println(<span class="hljs-string">&quot;æ›´æ–°æ´»åŠ¨çŠ¶æ€ä¸ºè¿›è¡Œä¸­: &quot;</span> + (context.start(activity) ? <span class="hljs-string">&quot;æˆåŠŸ&quot;</span> : <span class="hljs-string">&quot;å¤±è´¥&quot;</span>));<br>        System.out.println(<span class="hljs-string">&quot;æ›´æ–°æ´»åŠ¨çŠ¶æ€ä¸ºå·²åœç”¨: &quot;</span> + (context.disable(activity) ? <span class="hljs-string">&quot;æˆåŠŸ&quot;</span> : <span class="hljs-string">&quot;å¤±è´¥&quot;</span>));<br>        System.out.println(<span class="hljs-string">&quot;æ›´æ–°æ´»åŠ¨çŠ¶æ€ä¸ºå·²å¯ç”¨: &quot;</span> + (context.enable(activity) ? <span class="hljs-string">&quot;æˆåŠŸ&quot;</span> : <span class="hljs-string">&quot;å¤±è´¥&quot;</span>));<br>        System.out.println(<span class="hljs-string">&quot;æ›´æ–°æ´»åŠ¨çŠ¶æ€ä¸ºè¿›è¡Œä¸­: &quot;</span> + (context.start(activity) ? <span class="hljs-string">&quot;æˆåŠŸ&quot;</span> : <span class="hljs-string">&quot;å¤±è´¥&quot;</span>));<br>        System.out.println(<span class="hljs-string">&quot;æ›´æ–°æ´»åŠ¨çŠ¶æ€ä¸ºå·²ç»“æŸ: &quot;</span> + (context.finish(activity) ? <span class="hljs-string">&quot;æˆåŠŸ&quot;</span> : <span class="hljs-string">&quot;å¤±è´¥&quot;</span>));<br>        System.out.println(<span class="hljs-string">&quot;æ›´æ–°æ´»åŠ¨çŠ¶æ€ä¸ºè¿›è¡Œä¸­: &quot;</span> + (context.start(activity) ? <span class="hljs-string">&quot;æˆåŠŸ&quot;</span> : <span class="hljs-string">&quot;å¤±è´¥&quot;</span>));<br>      <br>      <span class="hljs-comment">// æ¸…ç†èµ„æº</span><br>        activityState.clear();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç»“æœè¾“å‡ºï¼š</p><figure class="highlight makefile"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs makefile"><span class="hljs-section">ä¿å­˜è‰ç¨¿: æˆåŠŸ</span><br><span class="hljs-section">æ›´æ–°æ´»åŠ¨çŠ¶æ€ä¸ºå·²å¯ç”¨: æˆåŠŸ</span><br><span class="hljs-section">æ›´æ–°æ´»åŠ¨çŠ¶æ€ä¸ºè¿›è¡Œä¸­: æˆåŠŸ</span><br><span class="hljs-section">æ›´æ–°æ´»åŠ¨çŠ¶æ€ä¸ºå·²åœç”¨: æˆåŠŸ</span><br><span class="hljs-section">æ›´æ–°æ´»åŠ¨çŠ¶æ€ä¸ºå·²å¯ç”¨: æˆåŠŸ</span><br><span class="hljs-section">æ›´æ–°æ´»åŠ¨çŠ¶æ€ä¸ºè¿›è¡Œä¸­: æˆåŠŸ</span><br><span class="hljs-section">æ›´æ–°æ´»åŠ¨çŠ¶æ€ä¸ºå·²ç»“æŸ: æˆåŠŸ</span><br><span class="hljs-section">æ›´æ–°æ´»åŠ¨çŠ¶æ€ä¸ºè¿›è¡Œä¸­: å¤±è´¥</span><br></code></pre></div></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°çŠ¶æ€åˆ‡æ¢è·¯å¾„ï¼šè‰ç¨¿-&gt; è‰ç¨¿-&gt; å·²å¯ç”¨-&gt; è¿›è¡Œä¸­-&gt; å·²åœç”¨-&gt; å·²å¯ç”¨-&gt; è¿›è¡Œä¸­-&gt; å·²ç»“æŸ-&gt; è¿›è¡Œä¸­ï¼Œå‰é¢éƒ½æ˜¯æ­£ç¡®åˆ‡æ¢ï¼Œä½†æ˜¯å·²ç»“æŸæ— æ³•åˆ‡æ¢ä¸ºè¿›è¡Œä¸­çŠ¶æ€ï¼Œä»è€ŒéªŒè¯äº†çŠ¶æ€æ¨¡å¼çš„åº”ç”¨ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>çœ‹ä¸Šä¸€ç¯‡ç­–ç•¥æ¨¡å¼çš„æ–‡ç« ä¸­çš„ UMLï¼Œå’Œæœ¬æ–‡çš„ UML æ˜¯ç›¸åŒçš„ã€‚é‚£ä¹ˆä»–ä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<br>ç­–ç•¥æ¨¡å¼æ˜¯æä¾›äº†å¯ç›¸äº’æ›¿æ¢çš„ç®—æ³•ï¼Œæ ¹æ®å®¢æˆ·ç«¯é€‰æ‹©ä¸€ç§ç®—æ³•æŒ‡å®šä¸€ç§è¡Œä¸ºï¼›<br>çŠ¶æ€æ¨¡å¼åˆ™åŒ…å«äº†å¯¹è±¡çŠ¶æ€ï¼Œæ ¹æ®å¯¹è±¡çŠ¶æ€ä¸åŒï¼Œè¡Œä¸ºä¹Ÿä¸ä¸€æ ·ï¼Œå³çŠ¶æ€å†³å®šè¡Œä¸ºï¼Œå°†è¡Œä¸ºå¯¹åº”çš„é€»è¾‘å°è£…åˆ°å…·ä½“çŠ¶æ€ç±»ä¸­ï¼Œåœ¨ç¯å¢ƒç±»ä¸­æ¶ˆé™¤é€»è¾‘åˆ¤æ–­ï¼Œä¸”å…·ä½“å®ç°ä¸å¯ç›¸äº’æ›¿æ¢ã€‚</p><p>çŠ¶æ€æ¨¡å¼ä¸­ï¼Œå®¢æˆ·ç«¯è§’è‰²ä¸çŠ¶æ€å¯¹è±¡ä¸éœ€è¦è¿›è¡Œäº¤äº’ï¼Œæ‰€æœ‰çš„äº¤äº’éƒ½å§”æ‰˜ç»™ç¯å¢ƒè§’è‰²è¿›è¡Œã€‚</p><h2 id="æºç ä¸‹è½½"><a href="#æºç ä¸‹è½½" class="headerlink" title="æºç ä¸‹è½½"></a>æºç ä¸‹è½½</h2><ul><li><a href="https://github.com/Mosiki/learning-modules/tree/master/learning-designpatterns">https://github.com/Mosiki/learning-modules/tree/master/learning-designpatterns</a></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://www.runoob.com/design-pattern/state-pattern.html">https://www.runoob.com/design-pattern/state-pattern.html</a></li><li><a href="https://www.cnblogs.com/kubixuesheng/p/5180509.html">https://www.cnblogs.com/kubixuesheng/p/5180509.html</a></li><li><a href="https://www.kancloud.cn/sstd521/design/193606">https://www.kancloud.cn/sstd521/design/193606</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Spring çŠ¶æ€æ¨¡å¼å®æˆ˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼ä¹‹ç­–ç•¥æ¨¡å¼å®æˆ˜</title>
    <link href="/design-patterns-strategy.html"/>
    <url>/design-patterns-strategy.html</url>
    
    <content type="html"><![CDATA[<p>ç±»å‹ï¼šè¡Œä¸ºå‹æ¨¡å¼</p><p>æ„å›¾ï¼šå®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼Œä¸åŒç®—æ³•ç­–ç•¥å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œå¹¶ä¸”äº’ä¸å½±å“ã€‚</p><p>ä¸»è¦è§£å†³ï¼šåœ¨æœ‰å¤šç§ç®—æ³•ç›¸ä¼¼çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ ifâ€¦else æ‰€å¸¦æ¥çš„å¤æ‚å’Œéš¾ä»¥ç»´æŠ¤ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šä¸€ä¸ªç³»ç»Ÿéœ€è¦åŠ¨æ€åœ°åœ¨å‡ ç§ç®—æ³•ä¸­é€‰æ‹©ä¸€ç§ã€‚</p><a id="more"></a><p><a href="http://nullpointer.pw/design-patterns.html">è®¾è®¡æ¨¡å¼ç³»åˆ—æ–‡ç« ç›®å½•</a></p><h2 id="è§’è‰²"><a href="#è§’è‰²" class="headerlink" title="è§’è‰²"></a>è§’è‰²</h2><ul><li>ç­–ç•¥ä¸Šä¸‹æ–‡è§’è‰²ï¼šæŒæœ‰æŠ½è±¡ç­–ç•¥è§’è‰²çš„å¼•ç”¨ï¼Œè®¿é—®ç­–ç•¥çš„å…¥å£</li><li>æŠ½è±¡ç­–ç•¥è§’è‰²</li><li>å…·ä½“ç­–ç•¥è§’è‰²</li></ul><h2 id="UML"><a href="#UML" class="headerlink" title="UML"></a>UML</h2><img  src=http://www.plantuml.com/plantuml/svg/SoWkIImgAStDuKhEIImkLd3Epoj9hIYfvb9Gq5KeBYbAB4bDhmHoj64oda2oA2qnELL3awkMAnF6KmY6gWNfL52eJam2QKukgTNEBqW5ocJcvu4rm6r9BaejIOLfCeJe0bf3Z6eZ7AfXyWesDNfwc7OGa3VYWlfG8L_N3kuTBeVKl1HWy000><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><p>ä»¥æŠ½å¥–æ´»åŠ¨å‘å¥–ä¸ºä¾‹ï¼Œå¥–å“å¤šç§å¤šæ ·ï¼Œå¯èƒ½æ˜¯ç°é‡‘å¥–ï¼Œè¯è´¹å¥–å“ï¼Œå®ç‰©å¥–ç­‰ç­‰ï¼Œæ¯ç§å¥–å“çš„å‘æ”¾æ–¹å¼éƒ½ä¸ä¸€æ ·ï¼Œæ¯”å¦‚ç°é‡‘æ˜¯ç›´æ¥è½¬è´¦ï¼Œè¯è´¹å¥–å“æ˜¯è°ƒç”¨è¿è¥å•†æä¾›æ¥å£å‘æ”¾ï¼Œå®ç‰©å¥–éœ€è¦äººå·¥å¿«é€’å¯„é€ã€‚åœ¨æœªé‡‡ç”¨ç­–ç•¥æ¨¡å¼ä¹‹å‰ï¼Œå°‘ä¸äº†ä½¿ç”¨ ifâ€¦elseâ€¦æ¥åˆ¤æ–­å‘æ”¾ï¼Œå½“å¢åŠ ä¸€ç§å¥–å“ç±»å‹æ—¶ï¼Œå°±éœ€è¦å¢åŠ  if åˆ¤æ–­ã€‚è€Œé‡‡å–ç­–ç•¥æ¨¡å¼ä¹‹åï¼Œåªéœ€å®ç°ä¸€ä¸ªç­–ç•¥ç±»å³å¯ï¼Œå¯¹åŸæ¥çš„é€»è¾‘æ— éœ€åšä»»ä½•æ”¹åŠ¨ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–ç­–ç•¥çš„æ­£å¸¸é€»è¾‘ã€‚</p><h3 id="æœ¬æ–‡ç¤ºä¾‹UMLå›¾"><a href="#æœ¬æ–‡ç¤ºä¾‹UMLå›¾" class="headerlink" title="æœ¬æ–‡ç¤ºä¾‹UMLå›¾"></a>æœ¬æ–‡ç¤ºä¾‹UMLå›¾</h3><img  src=http://www.plantuml.com/plantuml/svg/ZPB1Yi9038RlynGvhdJh0uY8KbmHASZMYoSPfx4xK6Ta6a6tstVVQ5SHfhFqcdp_J_8dqugae_En5AgKLGLhfxynGvCdrX1U26e144D5JX8Mrz6pd_rLk1q1Nb2T2Ty6eX52iz0Tf4BmuBjR1BNStmmLDRczjLjTEy3IhBJ9GyeNliNdnnDTUzEfDTYVJcHP9b_I5TXRue4VlALrBSz1rXmtQTLacy_PPhxOxjBPUfJAqvXvROftts1o5qOFOO7a8Hr7uJY5yASU_mo7WO03T7U-0RWxtW3yJxelep_UqCRn17fPnpPu1J7b6l_wBm00><h3 id="å®šä¹‰æŠ½è±¡ç­–ç•¥æ¥å£"><a href="#å®šä¹‰æŠ½è±¡ç­–ç•¥æ¥å£" class="headerlink" title="å®šä¹‰æŠ½è±¡ç­–ç•¥æ¥å£"></a>å®šä¹‰æŠ½è±¡ç­–ç•¥æ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> WeJan</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2020-02-06</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">PrizeSendStrategy</span> </span>&#123;<br>    String DEFAULT = <span class="hljs-string">&quot;default&quot;</span>;<br>    String MONEY = <span class="hljs-string">&quot;money&quot;</span>;<br>    String IN_KIND = <span class="hljs-string">&quot;in_kind&quot;</span>;<br>    String CALL_CHARGE = <span class="hljs-string">&quot;call_charge&quot;</span>;<br><br>    <span class="hljs-function">String <span class="hljs-title">type</span><span class="hljs-params">()</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">doSend</span><span class="hljs-params">()</span></span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å®ç°å…·ä½“çš„ç­–ç•¥"><a href="#å®ç°å…·ä½“çš„ç­–ç•¥" class="headerlink" title="å®ç°å…·ä½“çš„ç­–ç•¥"></a>å®ç°å…·ä½“çš„ç­–ç•¥</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CallChargePrizeSendStrategy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">PrizeSendStrategy</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">type</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> CALL_CHARGE;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doSend</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å‘æ”¾è¯è´¹å¥–å“&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MoneyPrizeSendStrategy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">PrizeSendStrategy</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">type</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> MONEY;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doSend</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å‘æ”¾ç°é‡‘å¥–å“&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InKindPrizeSendStrategy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">PrizeSendStrategy</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">type</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> IN_KIND;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doSend</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å‘æ”¾å®ç‰©å¥–å“&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmptyPrizeSendStrategy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">PrizeSendStrategy</span> </span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">type</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> DEFAULT;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doSend</span><span class="hljs-params">()</span> </span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ä¸å‘å¥–&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="å®ç°å¯¹æŠ½è±¡ç­–ç•¥å°è£…çš„ä¸Šä¸‹æ–‡å¯¹è±¡"><a href="#å®ç°å¯¹æŠ½è±¡ç­–ç•¥å°è£…çš„ä¸Šä¸‹æ–‡å¯¹è±¡" class="headerlink" title="å®ç°å¯¹æŠ½è±¡ç­–ç•¥å°è£…çš„ä¸Šä¸‹æ–‡å¯¹è±¡"></a>å®ç°å¯¹æŠ½è±¡ç­–ç•¥å°è£…çš„ä¸Šä¸‹æ–‡å¯¹è±¡</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> WeJan</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2020-02-06</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PrizeSendContext</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> PrizeSendStrategy prizeSendStrategy;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PrizeSendContext</span><span class="hljs-params">()</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPrizeSendStrategy</span><span class="hljs-params">(PrizeSendStrategy prizeSendStrategy)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.prizeSendStrategy = prizeSendStrategy;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">executePrizeSendStrategy</span><span class="hljs-params">()</span> </span>&#123;<br>        prizeSendStrategy.doSend();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="æŠ½å–ç­–ç•¥å·¥å‚"><a href="#æŠ½å–ç­–ç•¥å·¥å‚" class="headerlink" title="æŠ½å–ç­–ç•¥å·¥å‚"></a>æŠ½å–ç­–ç•¥å·¥å‚</h3><p>å®¢æˆ·ç«¯éœ€è¦åˆ¤æ–­è¦ä½¿ç”¨å“ªä¸€ä¸ªå…·ä½“çš„ç­–ç•¥ç±»ï¼Œè‹¥è¿˜æ˜¯æŒ‰ç…§ä¼ ç»Ÿçš„æ–¹æ³• ifâ€¦elseâ€¦æ¥åˆ¤æ–­ç­–ç•¥æ¨¡å¼å°±æ²¡æœ‰æ„ä¹‰äº†ï¼Œå› æ­¤ç­–ç•¥æ¨¡å¼ä¸€èˆ¬éƒ½æ˜¯ç»“åˆå…¶ä»–æ¨¡å¼å…±åŒä½¿ç”¨ã€‚æœ¬æ–‡ä¸­ç­–ç•¥ç±»ä½¿ç”¨ String æ¥æ ‡è¯†ï¼Œä¹Ÿå¯ä»¥åœ¨ç­–ç•¥ç±»ä¸­å¢åŠ æŠ½è±¡æ–¹æ³•ï¼Œè¿”å›å€¼ä¸ºæšä¸¾ç±»å‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PrizeSendStrategyFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ApplicationContextAware</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;String, PrizeSendStrategy&gt; PRIZE_SEND_STRATEGY_MAP = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> PrizeSendStrategy <span class="hljs-title">getPrizeSendStrategy</span><span class="hljs-params">(String strategyKey)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> PRIZE_SEND_STRATEGY_MAP.getOrDefault(strategyKey, PRIZE_SEND_STRATEGY_MAP.get(DEFAULT));<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setApplicationContext</span><span class="hljs-params">(ApplicationContext applicationContext)</span> <span class="hljs-keyword">throws</span> BeansException </span>&#123;<br>        Map&lt;String, PrizeSendStrategy&gt; beans = applicationContext.getBeansOfType(PrizeSendStrategy.class);<br>        beans.values().forEach(bean -&gt; PRIZE_SEND_STRATEGY_MAP.put(bean.type(), bean));<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> WeJan</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> 2020-02-06</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-meta">@SpringBootTest(classes = App.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StrategyTest</span> </span>&#123;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span> </span>&#123;<br>        PrizeSendContext sendContext = <span class="hljs-keyword">new</span> PrizeSendContext();<br>        sendContext.setPrizeSendStrategy(PrizeSendStrategyFactory.getPrizeSendStrategy(<span class="hljs-string">&quot;money&quot;</span>));<br>        sendContext.executePrizeSendStrategy();<br>    &#125;<br><br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºç»“æœä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs plain">å‘æ”¾ç°é‡‘å¥–å“<br></code></pre></div></td></tr></table></figure><h2 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h2><ul><li><a href="https://github.com/Mosiki/learning-modules/tree/master/learning-designpatterns">https://github.com/Mosiki/learning-modules/tree/master/learning-designpatterns</a></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://www.runoob.com/design-pattern/strategy-pattern.html">https://www.runoob.com/design-pattern/strategy-pattern.html</a></li><li><a href="https://juejin.im/post/5c25b8bcf265da61117a5ea1">https://juejin.im/post/5c25b8bcf265da61117a5ea1</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼å®æˆ˜ç›®å½•</title>
    <link href="/design-patterns.html"/>
    <url>/design-patterns.html</url>
    
    <content type="html"><![CDATA[<p>é‡æ–°å­¦ä¹ ä¸€ä¸‹è®¾è®¡æ¨¡å¼ï¼ŒæŒæ¡å¥½è®¾è®¡æ¨¡å¼å¯¹ä»£ç è´¨é‡çš„æé«˜è¿˜æ˜¯å¾ˆæœ‰æ•ˆæœçš„ã€‚</p><a id="more"></a><p>æœ‰æ—¶é—´å°±ä¼šæ›´æ–°ã€‚æœ‰äº›æ¨¡å¼ä¸å¤ªå¥½æƒ³ç¤ºä¾‹ï¼Œæ‰€ä»¥ç›®å‰çš„ç¤ºä¾‹å¯èƒ½åœ¨æƒ³åˆ°æ›´å¥½çš„ç¤ºä¾‹ä¹‹åï¼Œä¼šè¢«åæœŸæ›¿æ¢æ‰ã€‚</p><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul><li><input checked="" disabled="" type="checkbox"> <a href="/design-patterns-strategy.html">è®¾è®¡æ¨¡å¼ä¹‹ç­–ç•¥æ¨¡å¼å®æˆ˜</a></li><li><input checked="" disabled="" type="checkbox"> <a href="/design-patterns-state.html">è®¾è®¡æ¨¡å¼ä¹‹çŠ¶æ€æ¨¡å¼å®æˆ˜</a></li><li><input checked="" disabled="" type="checkbox"> <a href="/design-patterns-facade.html">è®¾è®¡æ¨¡å¼ä¹‹é—¨é¢æ¨¡å¼å®æˆ˜</a></li><li><input checked="" disabled="" type="checkbox"> <a href="/design-patterns-chain-responsibility.html">è®¾è®¡æ¨¡å¼ä¹‹è´£ä»»é“¾æ¨¡å¼å®æˆ˜</a></li><li><input checked="" disabled="" type="checkbox"> <a href="/design-patterns-observer.html">è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼å®æˆ˜</a></li><li><input disabled="" type="checkbox"> è®¾è®¡æ¨¡å¼ä¹‹å‘½ä»¤æ¨¡å¼å®æˆ˜ </li><li><input disabled="" type="checkbox"> è®¾è®¡æ¨¡å¼ä¹‹æ¨¡æ¿æ–¹æ³•æ¨¡å¼å®æˆ˜</li></ul><h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><ul><li><a href="https://github.com/Mosiki/learning-modules/tree/master/learning-designpatterns">https://github.com/Mosiki/learning-modules/tree/master/learning-designpatterns</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Hibernate Validator æ ¡éªŒæœ€ä½³å®è·µ</title>
    <link href="/hibernate-validator-best-practice.html"/>
    <url>/hibernate-validator-best-practice.html</url>
    
    <content type="html"><![CDATA[<p>å‡ å¹´å‰åˆšå­¦ä¹  SpringBoot çš„æ—¶å€™ï¼Œå°±æ¥è§¦å¹¶å¼€å§‹ä½¿ç”¨ HibernateValidator æ ¡éªŒæ¡†æ¶ï¼Œæ³¨è§£æ ¡éªŒç»“åˆç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼Œå¯¹ä»£ç çš„æ•´æ´æ€§æé«˜ç‰¹åˆ«æœ‰å¸®åŠ©ã€‚ä½†æ˜¯ç›®å‰å‘ç°å…¬å¸é‡Œæ¯”è¾ƒæ–°çš„é¡¹ç›®ä¸­å¯¹å‚æ•°è¿›è¡Œæ ¡éªŒè¿˜æ˜¯ä½¿ç”¨ä»¥å‰ä¼ ç»Ÿçš„æ–¹å¼ï¼Œéœ€è¦é€ä¸€å¯¹è¯·æ±‚å¯¹è±¡ä¸­çš„å±æ€§ä½¿ç”¨ if æ¥åˆ¤æ–­åˆæ³•æ€§ï¼Œå½“éœ€è¦æ ¡éªŒçš„å±æ€§å¾ˆå¤šæ—¶ï¼Œä¸€å¤§å¨çš„ if åˆ¤æ–­æ ¡éªŒä»£ç å°±ä¸å¯é¿å…ã€‚æœ¬æ–‡ä»‹ç» HibernateValidator æ ¡éªŒæ¡†æ¶çš„æ—¥å¸¸ä½¿ç”¨ï¼Œä¸æ¶‰åŠè‡ªå®šä¹‰çº¦æŸæ³¨è§£ã€‚</p><a id="more"></a><h2 id="æ²¡æœ‰å¯¹æ¯”å°±æ²¡æœ‰ä¼¤å®³"><a href="#æ²¡æœ‰å¯¹æ¯”å°±æ²¡æœ‰ä¼¤å®³" class="headerlink" title="æ²¡æœ‰å¯¹æ¯”å°±æ²¡æœ‰ä¼¤å®³"></a>æ²¡æœ‰å¯¹æ¯”å°±æ²¡æœ‰ä¼¤å®³</h2><p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ä½¿ç”¨æ ¡éªŒæ¡†æ¶å‰åçš„ä»£ç å¯¹æ¯”<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200204173055.png"></p><p>ä½¿ç”¨æ ¡éªŒæ¡†æ¶åï¼Œä»£ç ç®€æ´å¾ˆå¤šæœ‰æœ¨æœ‰~</p><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><p>é¦–å…ˆéœ€è¦å¼•å…¥ä¾èµ–ï¼Œ<strong>éœ€è¦æ³¨æ„æ˜¯å¦ä¾èµ–æœ‰å†²çªï¼Œå¦‚æœæœ‰ä¸€å®šè¦è§£å†³æ‰å†²çª</strong></p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.hibernate.validator<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hibernate-validator<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>6.1.0.Final<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>ä¾èµ–å¼•å…¥åï¼ŒSpring ç¯å¢ƒéœ€è¦é…ç½®ä¸€ä¸‹æ ¡éªŒå™¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ValidatorConfig</span> </span>&#123;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Validator <span class="hljs-title">validator</span><span class="hljs-params">()</span> </span>&#123;<br>        ValidatorFactory validatorFactory = Validation.byProvider(HibernateValidator.class)<br>                .configure()<br>                <span class="hljs-comment">// å¿«é€Ÿå¤±è´¥</span><br>                .failFast(<span class="hljs-keyword">true</span>)<br>                .buildValidatorFactory();<br>        <span class="hljs-keyword">return</span> validatorFactory.getValidator();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œè®¾ç½® failFast ä¸º trueï¼Œä»£è¡¨ç€å¦‚æœæœ‰å¤šä¸ªå‚æ•°çš„æƒ…å†µä¸‹ï¼Œåªè¦æ ¡éªŒå‡ºä¸€ä¸ªå‚æ•°æœ‰è¯¯å°±è¿”å›é”™è¯¯è€Œä¸å†ç»§ç»­æ ¡éªŒã€‚</p><h2 id="ä¸ºå¯¹è±¡æ·»åŠ æ ¡éªŒæ³¨è§£"><a href="#ä¸ºå¯¹è±¡æ·»åŠ æ ¡éªŒæ³¨è§£" class="headerlink" title="ä¸ºå¯¹è±¡æ·»åŠ æ ¡éªŒæ³¨è§£"></a>ä¸ºå¯¹è±¡æ·»åŠ æ ¡éªŒæ³¨è§£</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StudentVo</span> </span>&#123;<br><br>    <span class="hljs-meta">@NotNull(message = &quot;å­¦å·ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> Integer id;<br><br>    <span class="hljs-meta">@NotNull(message = &quot;å§“åä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-meta">@NotNull(message = &quot;é‚®ç®±åœ°å€ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-meta">@Email(message = &quot;é‚®ç®±åœ°å€ä¸æ­£ç¡®&quot;)</span><br>    <span class="hljs-keyword">private</span> String email;<br>  <br>    <span class="hljs-keyword">private</span> Integer age;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>Hibernate Validator æ˜¯å¯¹ JSR 349 éªŒè¯è§„èŒƒçš„å…·ä½“å®ç°ï¼Œç›¸å…³çš„<a href="#%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3">å¸¸ç”¨æ³¨è§£ </a> æˆ‘è´´åœ¨æ–‡æœ«ä»¥ä¾›å‚è€ƒã€‚</p><h2 id="è¯·æ±‚æ¥å£å¤„ç†"><a href="#è¯·æ±‚æ¥å£å¤„ç†" class="headerlink" title="è¯·æ±‚æ¥å£å¤„ç†"></a>è¯·æ±‚æ¥å£å¤„ç†</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;/create&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Result&lt;StudentVo&gt; <span class="hljs-title">create</span><span class="hljs-params">(<span class="hljs-meta">@Validated</span> StudentVo student)</span> </span>&#123;<br>  System.out.println(student.toString());<br>  <span class="hljs-keyword">return</span> Result.success(student);<br>&#125;<br><br><span class="hljs-meta">@PostMapping(&quot;/update&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Result&lt;StudentVo&gt; <span class="hljs-title">update</span><span class="hljs-params">(<span class="hljs-meta">@Validated</span> StudentVo student)</span> </span>&#123;<br>  System.out.println(student.toString());<br>  <span class="hljs-keyword">return</span> Result.success(student);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„ <strong>@Validated</strong> æ˜¯ <code>org.springframework.validation.annotation.Validated</code>ï¼Œä¸è¦å¼•å…¥é”™äº†ã€‚åŠ äº†è¿™ä¸ªæ³¨è§£ä¹‹åï¼Œå°±ä¼šè‡ªåŠ¨ä¼šå‚æ•°è¿›è¡Œæ ¡éªŒã€‚å¦‚æœæ ¡éªŒä¸é€šè¿‡ï¼Œä¼šæŠ›å‡º <code>BindException</code> æˆ–è€… <code>MethodArgumentNotValidException</code>è¿™ä¸¤ä¸ªå¼‚å¸¸ä¸­çš„ä¸€ä¸ªå¼‚å¸¸ï¼Œä¸€èˆ¬é¡¹ç›®ä¸­ä¸ºäº†è§„èŒƒæ¥å£è¿”å›å€¼ï¼Œéƒ½ä¼šè¿›è¡Œç»Ÿä¸€å¼‚å¸¸å¤„ç†ã€‚</p><h2 id="æ ¡éªŒå¼‚å¸¸ç»Ÿä¸€å¼‚å¸¸å¤„ç†"><a href="#æ ¡éªŒå¼‚å¸¸ç»Ÿä¸€å¼‚å¸¸å¤„ç†" class="headerlink" title="æ ¡éªŒå¼‚å¸¸ç»Ÿä¸€å¼‚å¸¸å¤„ç†"></a>æ ¡éªŒå¼‚å¸¸ç»Ÿä¸€å¼‚å¸¸å¤„ç†</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@RestControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GlobalExceptionHandler</span> </span>&#123;<br><br>    <span class="hljs-meta">@ExceptionHandler(BindException.class)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Result <span class="hljs-title">validateErrorHandler</span><span class="hljs-params">(BindException e)</span> </span>&#123;<br>        ObjectError error = e.getAllErrors().get(<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> Result.fail(error.getDefaultMessage());<br>    &#125;<br><br>    <span class="hljs-meta">@ExceptionHandler(MethodArgumentNotValidException.class)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> Result&lt;?&gt; validateErrorHandler(MethodArgumentNotValidException e) &#123;<br>        ObjectError error = e.getBindingResult().getAllErrors().get(<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">return</span> Result.fail(error.getDefaultMessage());<br>    &#125;<br><br>    <span class="hljs-meta">@ExceptionHandler(Throwable.class)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-keyword">public</span> Result&lt;?&gt; handleException(HttpServletRequest request, Throwable ex) &#123;<br>        <span class="hljs-keyword">return</span> Result.fail(ex.getMessage());<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å› ä¸ºé…ç½®æ ¡éªŒä¸º failFastï¼Œå› æ­¤é”™è¯¯ä¿¡æ¯ä¸­åªä¼šæœ‰ä¸€æ¡è®°å½•ã€‚</p><h2 id="ç¬¬ä¸€æ¬¡æµ‹è¯•"><a href="#ç¬¬ä¸€æ¬¡æµ‹è¯•" class="headerlink" title="ç¬¬ä¸€æ¬¡æµ‹è¯•"></a>ç¬¬ä¸€æ¬¡æµ‹è¯•</h2><figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">curl -i -X POST -d <span class="hljs-string">&quot;name=å¼ ä¸‰&quot;</span> <span class="hljs-string">&#x27;http://localhost:8082/learning-validator/create&#x27;</span><br></code></pre></div></td></tr></table></figure><p>åªå¡«å†™äº† name å‚æ•°ï¼Œè€Œ id ä¸ email æœªå¡«å†™çš„æƒ…å†µä¸‹è¿›è¡Œè¯·æ±‚ï¼Œè¿”å›ç»“æœ</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<span class="hljs-attr">&quot;success&quot;</span>:<span class="hljs-literal">false</span>,<span class="hljs-attr">&quot;msg&quot;</span>:<span class="hljs-string">&quot;å­¦å·ä¸èƒ½ä¸ºç©º&quot;</span>&#125;<br></code></pre></div></td></tr></table></figure><p>æŒ‰ç…§ä¸€èˆ¬å¼€å‘é€»è¾‘è€Œè¨€ï¼Œcreate æ¥å£æ˜¯ä¸éœ€è¦ä¼ é€’ id å‚æ•°çš„ï¼Œä½†æ˜¯ update æ¥å£ä¸€èˆ¬å¿…é¡»è¦ä¼  id å‚æ•°ï¼Œéš¾ä¸æˆç”¨è¿™ä¸ªè¿™ä¸ªæ ¡éªŒæ¡†æ¶åéœ€è¦å†™ä¸¤ä¸ªå¯¹è±¡ä¹ˆï¼Ÿå…¶å®ä¸æ˜¯çš„ã€‚è¿™å°±å¼•å‡ºäº† <strong>æ ¡éªŒåˆ†ç»„</strong> çš„æ¦‚å¿µï¼Œå³å¯ä»¥é€‰æ‹©æ ¡éªŒæŸäº›ç»„çš„å±æ€§è¿›è¡Œæ ¡éªŒã€‚</p><h2 id="æ ¡éªŒåˆ†ç»„"><a href="#æ ¡éªŒåˆ†ç»„" class="headerlink" title="æ ¡éªŒåˆ†ç»„"></a>æ ¡éªŒåˆ†ç»„</h2><p>é¦–å…ˆéœ€è¦åˆ›å»ºä¸¤ä¸ªåˆ†ç»„ï¼Œ<strong>CreateGroup</strong> ä¸ <strong>UpdateGroup</strong>ï¼Œåˆ†åˆ«ä»£è¡¨ç€æ–°å¢æ—¶éœ€è¦æ ¡éªŒä¸æ›´æ–°æ—¶éœ€è¦æ ¡éªŒã€‚ä¸¤ä¸ªç»„éƒ½æ˜¯ç©ºçš„æ¥å£ï¼Œåªæ˜¯ä½œä¸ºä¸€ä¸ªæ ‡è®°ç±»ä½¿ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">CreateGroup</span> </span>&#123;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UpdateGroup</span> </span>&#123;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ¥ç€ä¿®æ”¹è¯·æ±‚å¯¹è±¡ï¼Œåˆ†åˆ«æŒ‡å®šå“ªäº›å¯¹è±¡æ˜¯å“ªäº›ç»„éœ€è¦æ ¡éªŒçš„ï¼Œå¦‚æœä¸æŒ‡å®šç»„ï¼Œé»˜è®¤éƒ½ä¼šè¿›è¡Œæ ¡éªŒã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StudentVo</span> </span>&#123;<br>    <span class="hljs-meta">@NotNull(groups = UpdateGroup.class, message = &quot;å­¦å·ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> Integer id;<br><br>    <span class="hljs-meta">@NotNull(message = &quot;å§“åä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-meta">@NotNull(groups = CreateGroup.class, message = &quot;é‚®ç®±åœ°å€ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-meta">@Email(groups = CreateGroup.class, message = &quot;é‚®ç®±åœ°å€ä¸æ­£ç¡®&quot;)</span><br>    <span class="hljs-keyword">private</span> String email;<br>  <br>    <span class="hljs-keyword">private</span> Integer age;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æœ¬æ–‡ç¤ºä¾‹ä¸­è¯·æ±‚å¯¹è±¡ï¼Œid å±æ€§åªåœ¨æ›´æ–°æ—¶æ ¡éªŒï¼›name å±æ€§æ— è®ºæ˜¯æ–°å¢è¿˜æ˜¯æ›´æ–°éƒ½è¦æ ¡éªŒï¼›email å±æ€§åªåœ¨æ–°å¢æ—¶è¿›è¡Œæ ¡éªŒï¼Œè€Œ age å±æ€§å› ä¸ºæœªæŒ‡å®šæ ¡éªŒæ³¨è§£ï¼Œå› æ­¤ä¸è¿›è¡Œæ ¡éªŒï¼Œè¿™é‡Œçš„ groups å¯ä»¥æ˜¯å¤šä¸ªåˆ†ç»„ã€‚</p><p>æŒ‡å®šå±æ€§çš„åˆ†ç»„ä¹‹åï¼Œæ§åˆ¶å™¨æ¥å£ä¹Ÿéœ€è¦æŒ‡å®šä½¿ç”¨å“ªä¸€ä¸ªç»„æ¥è¿›è¡Œæ ¡éªŒã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;/create&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Result&lt;StudentVo&gt; <span class="hljs-title">create</span><span class="hljs-params">(<span class="hljs-meta">@Validated(CreateGroup.class)</span> StudentVo student)</span> </span>&#123;<br>  System.out.println(student.toString());<br>  <span class="hljs-keyword">return</span> Result.success(student);<br>&#125;<br><br><span class="hljs-meta">@PostMapping(&quot;/update&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Result&lt;StudentVo&gt; <span class="hljs-title">update</span><span class="hljs-params">(<span class="hljs-meta">@Validated(UpdateGroup.class)</span> StudentVo student)</span> </span>&#123;<br>  System.out.println(student.toString());<br>  <span class="hljs-keyword">return</span> Result.success(student);<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ç¬¬äºŒæ¬¡æµ‹è¯•"><a href="#ç¬¬äºŒæ¬¡æµ‹è¯•" class="headerlink" title="ç¬¬äºŒæ¬¡æµ‹è¯•"></a>ç¬¬äºŒæ¬¡æµ‹è¯•</h2><figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">curl -i -X POST -d <span class="hljs-string">&quot;name=å¼ ä¸‰&quot;</span> <span class="hljs-string">&#x27;http://localhost:8082/learning-validator/create&#x27;</span><br></code></pre></div></td></tr></table></figure><p>åªå¡«å†™äº† name å‚æ•°ï¼Œè€Œ id ä¸ email æœªå¡«å†™çš„æƒ…å†µä¸‹è¿›è¡Œè¯·æ±‚ï¼Œè¿”å›ç»“æœï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<span class="hljs-attr">&quot;success&quot;</span>:<span class="hljs-literal">false</span>,<span class="hljs-attr">&quot;msg&quot;</span>:<span class="hljs-string">&quot;é‚®ç®±åœ°å€ä¸èƒ½ä¸ºç©º&quot;</span>&#125;<br></code></pre></div></td></tr></table></figure><p>å¡«å†™ name å‚æ•°ä»¥åŠ email å‚æ•°è¿›è¡Œè¯·æ±‚</p><figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">curl -i -X POST \<br>   -d <span class="hljs-string">&quot;name=å¼ ä¸‰&quot;</span> \<br>   -d <span class="hljs-string">&quot;email=vcmq@foxmail.com&quot;</span> \<br> <span class="hljs-string">&#x27;http://localhost:8082/learning-validator/create&#x27;</span><br></code></pre></div></td></tr></table></figure><p>è¿”å›ç»“æœï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<span class="hljs-attr">&quot;data&quot;</span>:&#123;<span class="hljs-attr">&quot;name&quot;</span>:<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>,<span class="hljs-attr">&quot;email&quot;</span>:<span class="hljs-string">&quot;vcmq@foxmail.com&quot;</span>&#125;,<span class="hljs-attr">&quot;success&quot;</span>:<span class="hljs-literal">true</span>,<span class="hljs-attr">&quot;msg&quot;</span>:<span class="hljs-string">&quot;success&quot;</span>&#125;<br></code></pre></div></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° id è¿™ä¸ªå­—æ®µåœ¨ create çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œæ ¡éªŒã€‚ä¿®æ”¹ä¸º update æ¥å£è¿›è¡Œæµ‹è¯•ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">curl -i -X POST \                                             <br>   -d <span class="hljs-string">&quot;name=å¼ ä¸‰&quot;</span> \<br>   -d <span class="hljs-string">&quot;email=vcmq@foxmail.com&quot;</span> \<br> <span class="hljs-string">&#x27;http://localhost:8082/learning-validator/update&#x27;</span><br></code></pre></div></td></tr></table></figure><p>è¿”å›ç»“æœï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<span class="hljs-attr">&quot;success&quot;</span>:<span class="hljs-literal">false</span>,<span class="hljs-attr">&quot;msg&quot;</span>:<span class="hljs-string">&quot;å­¦å·ä¸èƒ½ä¸ºç©º&quot;</span>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æ‰‹åŠ¨æ ¡éªŒ"><a href="#æ‰‹åŠ¨æ ¡éªŒ" class="headerlink" title="æ‰‹åŠ¨æ ¡éªŒ"></a>æ‰‹åŠ¨æ ¡éªŒ</h2><p>é™¤äº†ä½¿ç”¨@Validated æ³¨è§£æ–¹å¼æ ¡éªŒï¼Œä¹Ÿå¯ä»¥è¿›è¡Œæ‰‹åŠ¨æ ¡éªŒï¼Œæ‰‹åŠ¨æ ¡éªŒåŒæ ·ä¹Ÿæ”¯æŒåˆ†ç»„æ ¡éªŒã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;/create2&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Result&lt;StudentVo&gt; <span class="hljs-title">create2</span><span class="hljs-params">(StudentVo student)</span> </span>&#123;<br>  ValidatorUtils.validateEntity(student, CreateGroup.class);<br>  System.out.println(student.toString());<br>  <span class="hljs-keyword">return</span> Result.success(student);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ ¡éªŒå·¥å…·ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ValidatorUtils</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Validator validator;<br><br>  <span class="hljs-keyword">static</span> &#123;<br>    validator = Validation.byProvider(HibernateValidator.class)<br>      .configure()<br>      <span class="hljs-comment">// å¿«é€Ÿå¤±è´¥</span><br>      .failFast(<span class="hljs-keyword">true</span>)<br>      .buildValidatorFactory().getValidator();<br>  &#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¡éªŒå¯¹è±¡</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> object å¾…æ ¡éªŒå¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> groups å¾…æ ¡éªŒçš„ç»„</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> ApiException æ ¡éªŒä¸é€šè¿‡ï¼Œåˆ™æŠ¥ ApiException å¼‚å¸¸</span><br><span class="hljs-comment">     */</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">validateEntity</span><span class="hljs-params">(Object object, Class&lt;?&gt;... groups)</span></span><br><span class="hljs-function">    <span class="hljs-keyword">throws</span> ApiException </span>&#123;<br>    Set&lt;ConstraintViolation&lt;Object&gt;&gt; constraintViolations = validator.validate(object, groups);<br>    <span class="hljs-keyword">if</span> (!constraintViolations.isEmpty()) &#123;<br>      constraintViolations.stream().findFirst()<br>        .map(ConstraintViolation::getMessage)<br>        .ifPresent(v1 -&gt; &#123;<br>          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ApiException(v1);<br>        &#125;);<br>    &#125;<br>  &#125;<br><br></code></pre></div></td></tr></table></figure><h2 id="å¸¸ç”¨æ³¨è§£"><a href="#å¸¸ç”¨æ³¨è§£" class="headerlink" title="å¸¸ç”¨æ³¨è§£"></a>å¸¸ç”¨æ³¨è§£</h2><h3 id="ç©ºä¸éç©ºæ£€æŸ¥"><a href="#ç©ºä¸éç©ºæ£€æŸ¥" class="headerlink" title="ç©ºä¸éç©ºæ£€æŸ¥"></a>ç©ºä¸éç©ºæ£€æŸ¥</h3><table><thead><tr><th>æ³¨è§£</th><th>æ”¯æŒ Java ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>@Null</td><td>Object</td><td>ä¸º null</td></tr><tr><td>@NotNull</td><td>Object</td><td>ä¸ä¸º null</td></tr><tr><td>@NotBlank</td><td>CharSequence</td><td>ä¸ä¸º nullï¼Œä¸”å¿…é¡»æœ‰ä¸€ä¸ªéç©ºæ ¼å­—ç¬¦</td></tr><tr><td>@NotEmpty</td><td>CharSequenceã€Collectionã€Mapã€Array</td><td>ä¸ä¸º nullï¼Œä¸”ä¸ä¸ºç©ºï¼ˆlength/size&gt;0ï¼‰</td></tr></tbody></table><h3 id="Boolean-å€¼æ£€æŸ¥"><a href="#Boolean-å€¼æ£€æŸ¥" class="headerlink" title="Boolean å€¼æ£€æŸ¥"></a>Boolean å€¼æ£€æŸ¥</h3><table><thead><tr><th>æ³¨è§£</th><th>æ”¯æŒ Java ç±»å‹</th><th>è¯´æ˜</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>@AssertTrue</td><td>booleanã€Boolean</td><td>ä¸º true</td><td>ä¸º null æœ‰æ•ˆ</td></tr><tr><td>@AssertFalse</td><td>booleanã€Boolean</td><td>ä¸º false</td><td>ä¸º null æœ‰æ•ˆ</td></tr></tbody></table><h3 id="æ—¥æœŸæ£€æŸ¥"><a href="#æ—¥æœŸæ£€æŸ¥" class="headerlink" title="æ—¥æœŸæ£€æŸ¥"></a>æ—¥æœŸæ£€æŸ¥</h3><table><thead><tr><th>æ³¨è§£</th><th>æ”¯æŒ Java ç±»å‹</th><th>è¯´æ˜</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>@Future</td><td>Dateã€Calendarã€Instantã€LocalDateã€LocalDateTimeã€LocalTimeã€MonthDayã€OffsetDateTimeã€OffsetTimeã€Yearã€YearMonthã€ZonedDateTimeã€HijrahDateã€JapaneseDateã€MinguoDateã€ThaiBuddhistDate</td><td>éªŒè¯æ—¥æœŸä¸ºå½“å‰æ—¶é—´ä¹‹å</td><td>ä¸º null æœ‰æ•ˆ</td></tr><tr><td>@FutureOrPresent</td><td>Dateã€Calendarã€Instantã€LocalDateã€LocalDateTimeã€LocalTimeã€MonthDayã€OffsetDateTimeã€OffsetTimeã€Yearã€YearMonthã€ZonedDateTimeã€HijrahDateã€JapaneseDateã€MinguoDateã€ThaiBuddhistDate</td><td>éªŒè¯æ—¥æœŸä¸ºå½“å‰æ—¶é—´æˆ–ä¹‹å</td><td>ä¸º null æœ‰æ•ˆ</td></tr><tr><td>@Past</td><td>Dateã€Calendarã€Instantã€LocalDateã€LocalDateTimeã€LocalTimeã€MonthDayã€OffsetDateTimeã€OffsetTimeã€Yearã€YearMonthã€ZonedDateTimeã€HijrahDateã€JapaneseDateã€MinguoDateã€ThaiBuddhistDate</td><td>éªŒè¯æ—¥æœŸä¸ºå½“å‰æ—¶é—´ä¹‹å‰</td><td>ä¸º null æœ‰æ•ˆ</td></tr><tr><td>@PastOrPresent</td><td>Dateã€Calendarã€Instantã€LocalDateã€LocalDateTimeã€LocalTimeã€MonthDayã€OffsetDateTimeã€OffsetTimeã€Yearã€YearMonthã€ZonedDateTimeã€HijrahDateã€JapaneseDateã€MinguoDateã€ThaiBuddhistDate</td><td>éªŒè¯æ—¥æœŸä¸ºå½“å‰æ—¶é—´æˆ–ä¹‹å‰</td><td>ä¸º null æœ‰æ•ˆ</td></tr></tbody></table><h3 id="æ•°å€¼æ£€æŸ¥"><a href="#æ•°å€¼æ£€æŸ¥" class="headerlink" title="æ•°å€¼æ£€æŸ¥"></a>æ•°å€¼æ£€æŸ¥</h3><table><thead><tr><th>æ³¨è§£</th><th>æ”¯æŒ Java ç±»å‹</th><th>è¯´æ˜</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>@Max</td><td>BigDecimalã€BigIntegerï¼Œbyteã€shortã€intã€long ä»¥åŠåŒ…è£…ç±»</td><td>å°äºæˆ–ç­‰äº</td><td>ä¸º null æœ‰æ•ˆ</td></tr><tr><td>@Min</td><td>BigDecimalã€BigIntegerï¼Œbyteã€shortã€intã€long ä»¥åŠåŒ…è£…ç±»</td><td>å¤§äºæˆ–ç­‰äº</td><td>ä¸º null æœ‰æ•ˆ</td></tr><tr><td>@DecimalMax</td><td>BigDecimalã€BigIntegerã€CharSequenceï¼Œbyteã€shortã€intã€long ä»¥åŠåŒ…è£…ç±»</td><td>å°äºæˆ–ç­‰äº</td><td>ä¸º null æœ‰æ•ˆ</td></tr><tr><td>@DecimalMin</td><td>BigDecimalã€BigIntegerã€CharSequenceï¼Œbyteã€shortã€intã€long ä»¥åŠåŒ…è£…ç±»</td><td>å¤§äºæˆ–ç­‰äº</td><td>ä¸º null æœ‰æ•ˆ</td></tr><tr><td>@Negative</td><td>BigDecimalã€BigIntegerï¼Œbyteã€shortã€intã€longã€floatã€double ä»¥åŠåŒ…è£…ç±»</td><td>è´Ÿæ•°</td><td>ä¸º null æœ‰æ•ˆï¼Œ0 æ— æ•ˆ</td></tr><tr><td>@NegativeOrZero</td><td>BigDecimalã€BigIntegerï¼Œbyteã€shortã€intã€longã€floatã€double ä»¥åŠåŒ…è£…ç±»</td><td>è´Ÿæ•°æˆ–é›¶</td><td>ä¸º null æœ‰æ•ˆ</td></tr><tr><td>@Positive</td><td>BigDecimalã€BigIntegerï¼Œbyteã€shortã€intã€longã€floatã€double ä»¥åŠåŒ…è£…ç±»</td><td>æ­£æ•°</td><td>ä¸º null æœ‰æ•ˆï¼Œ0 æ— æ•ˆ</td></tr><tr><td>@PositiveOrZero</td><td>BigDecimalã€BigIntegerï¼Œbyteã€shortã€intã€longã€floatã€double ä»¥åŠåŒ…è£…ç±»</td><td>æ­£æ•°æˆ–é›¶</td><td>ä¸º null æœ‰æ•ˆ</td></tr><tr><td>@Digits(integer = 3, fraction = 2)</td><td>BigDecimalã€BigIntegerã€CharSequenceï¼Œbyteã€shortã€intã€long ä»¥åŠåŒ…è£…ç±»</td><td>æ•´æ•°ä½æ•°å’Œå°æ•°ä½æ•°ä¸Šé™</td><td>ä¸º null æœ‰æ•ˆ</td></tr></tbody></table><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><table><thead><tr><th>æ³¨è§£</th><th>æ”¯æŒ Java ç±»å‹</th><th>è¯´æ˜</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>@Pattern</td><td>CharSequence</td><td>åŒ¹é…æŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼</td><td>ä¸º null æœ‰æ•ˆ</td></tr><tr><td>@Email</td><td>CharSequence</td><td>é‚®ç®±åœ°å€</td><td>ä¸º null æœ‰æ•ˆï¼Œé»˜è®¤æ­£åˆ™ <code>&#39;.*&#39;</code></td></tr><tr><td>@Size</td><td>CharSequenceã€Collectionã€Mapã€Array</td><td>å¤§å°èŒƒå›´ï¼ˆlength/size&gt;0ï¼‰</td><td>ä¸º null æœ‰æ•ˆ</td></tr></tbody></table><h3 id="hibernate-validator-æ‰©å±•çº¦æŸï¼ˆéƒ¨åˆ†ï¼‰"><a href="#hibernate-validator-æ‰©å±•çº¦æŸï¼ˆéƒ¨åˆ†ï¼‰" class="headerlink" title="hibernate-validator æ‰©å±•çº¦æŸï¼ˆéƒ¨åˆ†ï¼‰"></a>hibernate-validator æ‰©å±•çº¦æŸï¼ˆéƒ¨åˆ†ï¼‰</h3><table><thead><tr><th>æ³¨è§£</th><th>æ”¯æŒ Java ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>@Length</td><td>String</td><td>å­—ç¬¦ä¸²é•¿åº¦èŒƒå›´</td></tr><tr><td>@Range</td><td>æ•°å€¼ç±»å‹å’Œ String</td><td>æŒ‡å®šèŒƒå›´</td></tr><tr><td>@URL</td><td></td><td>URL åœ°å€éªŒè¯</td></tr></tbody></table><h2 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h2><ul><li><a href="https://github.com/Mosiki/learning-modules/tree/master/learning-validator">Hibernate Validator æ ¡éªŒæœ€ä½³å®è·µç¤ºä¾‹ä»£ç </a></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://juejin.im/post/5dafcdcb6fb9a04ddc6258f9">å¦‚ä½•ä¼˜é›…çš„åšæ•°æ®æ ¡éªŒ-Hibernate Validator è¯¦ç»†ä½¿ç”¨è¯´æ˜ </a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hibernate Validator æ ¡éªŒ</tag>
      
      <tag>æ ¡éªŒç»Ÿä¸€å¼‚å¸¸å¤„ç†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hexo è‡ªå®šä¹‰æ–‡ç«  url åœ°å€</title>
    <link href="/hexo-custom-article-url.html"/>
    <url>/hexo-custom-article-url.html</url>
    
    <content type="html"><![CDATA[<p>ç¬”è€…åˆæ¬¡é€šè¿‡ hexo æ­å»ºåšå®¢æ—¶ï¼Œå¯¹ hexo ä¸å¤ªäº†è§£ï¼Œåæ¥å‘ç°ä¸­æ–‡æ ‡é¢˜çš„æ–‡ç«  URL ä¼šè½¬ä¹‰æˆ<code>http://nullpointer.pw/2018/09/17/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%B3%E9%94%AE%E8%AF%8D%E9%AB%98%E4%BA%AE.html</code> ç±»ä¼¼æ¨¡æ ·ï¼Œï¼Œï¼Œå½“æ ‡é¢˜æ¯”è¾ƒé•¿æ—¶ï¼ŒURL å°±ä¼šå¾ˆé•¿ï¼Œhexo é»˜è®¤çš„ URL æ˜¯<code>:year/:month/:title</code>ï¼Œä¸ºäº†å‡å° URL é•¿åº¦ï¼Œäºæ˜¯ç¬”è€…åšäº†ä¸€ä»¶æ¯”è¾ƒå‚»ç¼ºçš„äº‹æƒ…ï¼Œå°† URL ä¿®æ”¹æˆäº†åªæœ‰æ ‡é¢˜ï¼Œè¿™ä¹Ÿé€ æˆå¦‚ä»Š repo åˆ—è¡¨æ–‡ä»¶è¿‡å¤šï¼ŒåŒæ—¶ä¹Ÿå¹¶æœªè§£å†³ä¸­æ–‡æ ‡é¢˜è½¬ä¹‰çš„é—®é¢˜ï¼Œå› æ­¤éœ€è¦è‡ªå®šä¹‰æ–‡ç«  URLã€‚</p><a id="more"></a><h2 id="è‡ªå®šä¹‰æ–‡ç« -URL"><a href="#è‡ªå®šä¹‰æ–‡ç« -URL" class="headerlink" title="è‡ªå®šä¹‰æ–‡ç«  URL"></a>è‡ªå®šä¹‰æ–‡ç«  URL</h2><p>å…ˆè¯´è¯´ä¸­æ–‡è½¬ä¹‰ URL çš„æ–¹å¼ï¼Œé¦–å…ˆéœ€è¦ä¿®æ”¹ hexo æ ¹ç›®å½•ä¸‹çš„_config.yml æ–‡ä»¶ï¼Œ</p><figure class="highlight yml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yml"><span class="hljs-comment">#permalink: :year/:month/:title/</span><br><span class="hljs-attr">permalink:</span> <span class="hljs-string">:year/:month/:urlname.html</span><br><span class="hljs-attr">permalink_defaults:</span><br>  <span class="hljs-attr">urlname:</span> <span class="hljs-string">index</span><br></code></pre></div></td></tr></table></figure><p>å°†åŸæ°¸ä¹…é“¾æ¥ permalink ä¸­çš„*:title* æ›¿æ¢ä¸ºä¸º urlname.html ï¼ŒåŒæ—¶åœ¨ permalink_defaults å¢åŠ  urlname å±æ€§ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡åœ¨æ–‡ç« å†…å®¹çš„ Formatter é…ç½®æ–‡ç« çš„ URL é“¾æ¥åœ°å€ï¼Œç¬”è€…ä¹‹å‰ä¿®æ”¹è¿‡ä¸€æ¬¡æ°¸ä¹…é“¾æ¥æ ¼å¼ï¼Œåªä¿ç•™äº†æ ‡é¢˜å³ï¼š<code>permalink: :title.html</code>ï¼Œç°åœ¨ä¿®æ”¹ä¸ºäº† <code>permalink: :urlname.html</code> ,æœ¬æ–‡æ–‡ç« é…ç½®å¦‚ä¸‹å›¾ï¼Œ<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200126164057.png">  </p><p>æœ¬æ–‡æœ€ç»ˆçš„ URL åœ°å€å°±æ˜¯ï¼š<code>http://nullpointer.pw/hexo-custom-article-url.html</code>  </p><h2 id="ä¿®æ”¹æ–‡ç« æ¨¡æ¿"><a href="#ä¿®æ”¹æ–‡ç« æ¨¡æ¿" class="headerlink" title="ä¿®æ”¹æ–‡ç« æ¨¡æ¿"></a>ä¿®æ”¹æ–‡ç« æ¨¡æ¿</h2><p>ä¿®æ”¹ post.md</p><figure class="highlight yml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> &#123;&#123; <span class="hljs-string">title</span> &#125;&#125;<br><span class="hljs-attr">date:</span> &#123;&#123; <span class="hljs-string">date</span> &#125;&#125;<br><span class="hljs-attr">urlname:</span> <br><span class="hljs-attr">tags:</span><br><span class="hljs-bullet">-</span> <span class="hljs-number">1</span><br><span class="hljs-attr">categories:</span><br><span class="hljs-bullet">-</span> <span class="hljs-number">2</span><br><span class="hljs-meta">---</span><br></code></pre></div></td></tr></table></figure><p>è¿™æ ·é€šè¿‡å‘½ä»¤ <code>hexo new xxxxxx</code>å‘½ä»¤æ–°å»ºçš„åšå®¢æ–‡ç« ä¸­å°±è‡ªåŠ¨å¸¦æœ‰è¿™ä¸ªå±æ€§ã€‚</p><h2 id="å…¼å®¹æ—§æ–‡ç« -URL"><a href="#å…¼å®¹æ—§æ–‡ç« -URL" class="headerlink" title="å…¼å®¹æ—§æ–‡ç«  URL"></a>å…¼å®¹æ—§æ–‡ç«  URL</h2><p>å› ä¸ºæ—§çš„æ–‡ç« å¯èƒ½å·²ç»è¢«æœç´¢å¼•æ“æ”¶å½•ï¼Œå¦‚æœç›´æ¥ç²—æš´ä¿®æ”¹å°±ä¼šé€ æˆæ”¶å½•çš„ç»“æœå‡ºç° 404 çš„æƒ…å†µï¼Œè¿˜æœ‰é˜…è¯»æ•°ç»Ÿè®¡ä¸€èˆ¬ä¹Ÿæ˜¯æ ¹æ®æ–‡ç«  URL æ¥åšçš„ï¼Œç¬”è€…ä¹‹å‰ä¹Ÿæœ‰è¿‡å› ä¸ºä¿®æ”¹æ–‡ç«  URL é€ æˆæ‰€æœ‰æ–‡ç« é˜…è¯»æ•°å½’é›¶çš„é­é‡ã€‚</p><p>æ€»ä¹‹ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çœ‹åˆ°çš„æƒ…å†µï¼›</p><p>æ‰€ä»¥ä¸ºäº†ä¿æŒæ—§çš„æ–‡ç«  URL ä¸å˜ï¼Œéœ€è¦å¯¹æ‰€æœ‰æ—§æ–‡ç« åŒæ ·å¢åŠ è¿™ä¸ª urlname å±æ€§ï¼Œå±æ€§çš„å€¼è®¾ç½®ä¸ºå½“å‰æ–‡ç« çš„æ–‡ä»¶åå³å¯ã€‚æ¯”å¦‚ <code>http://nullpointer.pw/å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ SpringDataElasticSearch å…³é”®è¯é«˜äº®.html</code>è¿™ç¯‡æ–‡ç« ä¸ºäº†ä¸æ”¹å˜åŸ URL åœ°å€ï¼Œåœ¨ md æ–‡ä»¶ä¸­ä¿®æ”¹ä¸ºï¼š</p><figure class="highlight yml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yml"><span class="hljs-meta">---</span><br><span class="hljs-attr">title:</span> <span class="hljs-string">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹</span> <span class="hljs-string">SpringDataElasticSearch</span> <span class="hljs-string">å…³é”®è¯é«˜äº®</span><br><span class="hljs-attr">tags:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">SpringDataElasticSearch</span> <span class="hljs-string">é«˜äº®</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">SpringDataElasticSearch</span> <span class="hljs-string">å…³é”®è¯é«˜äº®</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">ElasticsearchTemplate</span> <span class="hljs-string">ä½¿ç”¨</span> <br><span class="hljs-attr">categories:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">ElasticSearch</span><br><span class="hljs-attr">date:</span> <span class="hljs-number">2018-09-17 21:27:03</span><br><span class="hljs-attr">urlname:</span> <span class="hljs-string">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹</span> <span class="hljs-string">SpringDataElasticSearch</span> <span class="hljs-string">å…³é”®è¯é«˜äº®</span><br><span class="hljs-meta">---</span><br></code></pre></div></td></tr></table></figure><p>ç¬”è€…æ”¹äº†å¥½ä¸€ä¼šå„¿æ‰æ”¹å®Œæ‰€æœ‰æ–‡ç« ï¼Œè¿˜å¥½æ–‡ç« ä¸æ˜¯å¾ˆå¤šã€‚æ–‡ç« ç‰¹åˆ«å¤šçš„åšä¸»ï¼Œææ€•åªèƒ½å†™ä¸ªè„šæœ¬æ‰¹é‡ä¿®æ”¹äº†ã€‚</p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>å¯ä»¥è‡ªå®šä¹‰æ–‡ç«  URL çš„å¥½å¤„å¤šå¤šï¼Œç¬¬ä¸€ä¸ªæ˜¯å‡å° URL é•¿åº¦ï¼Œä¾¿äºæœç´¢å¼•æ“æ”¶å½•ï¼Œä¹Ÿæ–¹ä¾¿è‡ªå·±åœ¨å…¶ä»–åœ°æ–¹ç›´æ¥å¼•ç”¨ï¼Œä¸ä¼šå‡ºç°ç±»ä¼¼ä¸€ä¸²ä¹±ç  URL çš„å°´å°¬æƒ…å†µï¼›</p><p>å¦å¤–ç”±äºæ–‡ç«  URL ä¸æ–‡ç« æ ‡é¢˜å…³ç³»ä¸æ˜¯ç‰¹åˆ«ç´§å¯†ï¼Œä¸ä¼šé€ æˆä¿®æ”¹æ ‡é¢˜å¯¼è‡´ URL æ”¹å˜çš„çª˜å†µï¼Œå¯ä»¥åæœŸä¿®æ”¹ä¸é€‚å½“çš„æ ‡é¢˜ã€‚</p><p>å¥½å¤„å¤šå¤šï¼Œå¸Œæœ›å¯¹ä½ æœ‰ç”¨~</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://printempw.github.io/hexo-posts-in-subfolder/">https://printempw.github.io/hexo-posts-in-subfolder/</a></li><li><a href="https://blog.csdn.net/jingbin_/article/details/80617210">https://blog.csdn.net/jingbin_/article/details/80617210</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo-ä¿®æ”¹æ°¸ä¹…é“¾æ¥</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¿…çŸ¥å¿…ä¼šä¹‹æµç¨‹å›¾</title>
    <link href="/flow-chart-draw.html"/>
    <url>/flow-chart-draw.html</url>
    
    <content type="html"><![CDATA[<p>æµç¨‹å›¾åœ¨å„è¡Œå„ä¸šéƒ½æœ‰æ‰€åº”ç”¨ï¼Œå°¤å…¶å¹¿æ³›åº”ç”¨ä¸æŠ€æœ¯è®¾è®¡ï¼Œäº§å“è®¾è®¡ã€‚ç”»å¥½æµç¨‹å›¾ï¼Œå¯ä»¥è®©åˆ«äººèƒ½å¤Ÿå¾ˆè½»æ¾åœ°ç†è§£ä¸šåŠ¡ï¼Œç‰¹åˆ«æ˜¯é‡åˆ°æ¯”è¾ƒå¤æ‚çš„ä¸šåŠ¡æ—¶ï¼Œç”¨è¨€è¯­è§£é‡Šå¯èƒ½éœ€è¦èŠ±è´¹ä¸€ä¸Šåˆç”šè‡³ä¸€å¤©ï¼Œä½†æ˜¯ç”¨å›¾å»è¡¨ç¤ºå¯èƒ½åªéœ€è¦ 1 ä¸ªå°æ—¶ã€‚ä¸å¤šè¯´ï¼Œç›´å¥”ä¸»é¢˜ã€‚</p><a id="more"></a><h2 id="é¢„å¤‡çŸ¥è¯†"><a href="#é¢„å¤‡çŸ¥è¯†" class="headerlink" title="é¢„å¤‡çŸ¥è¯†"></a>é¢„å¤‡çŸ¥è¯†</h2><p>çœ‹äº†ç½‘ä¸Šçš„ä¸€äº›å…³äºæµç¨‹å›¾ç»˜åˆ¶çš„èµ„æ–™ï¼Œç»„ä»¶å¤ªå¤šï¼Œç»„ä»¶å«ä¹‰çš„è§£é‡Šå¦‚åŒæœºç¿»ï¼Œæ²¡æœ‰å…·ä½“å®ä¾‹ï¼Œè®©äººæ— ä»ä¸‹æ‰‹ï¼Œçœ‹å¾—ä»¤äººå¤´å¤§ã€‚å…¶å®å¤§å¯ä¸å¿…å­¦ä¹ æ‰€æœ‰ç»„ä»¶ï¼Œå› ä¸ºå¸¸ç”¨çš„å°±åªæœ‰é‚£å‡ ä¸ªç»„ä»¶ï¼ŒæŒæ¡åŸºæœ¬çš„ç»„ä»¶ä½¿ç”¨ï¼Œä»¥åå¯ä»¥çœ‹æƒ…å†µé€æ¸æ‰©å±•ã€‚</p><p>é¦–å…ˆçœ¼ç†Ÿä¸€ä¸‹å‡ ä¸ªå¸¸ç”¨çš„æµç¨‹å›¾åŸºæœ¬ç»„ä»¶ï¼š<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200114192225.png">  </p><p>å†çœ‹ä¸€ä¸‹æµç¨‹å›¾çš„ç»“æ„æ„æˆï¼š<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200114203419.png">  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200114203447.png">  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200114203509.png">  </p><p>å¸¸ç”¨çš„æµç¨‹å›¾å°±æ˜¯é¡ºåºç»“æ„ä¸é€‰æ‹©ç»“æ„äºŒè€…ç»“åˆçš„ç»“æ„ã€‚åœ¨ç»˜åˆ¶æµç¨‹å›¾çš„è¿‡ç¨‹ä¸­è¿˜éœ€è¦æ³¨æ„å¦‚ä¸‹å‡ ç‚¹ï¼Œæ­¤å¤„å¼•ç”¨å‚è€ƒå†…å®¹ï¼š</p><blockquote><p>ï¼ˆ1ï¼‰ç»˜åˆ¶æµç¨‹å›¾æ—¶ï¼Œä¸ºäº†æé«˜æµç¨‹å›¾çš„é€»è¾‘æ€§ï¼Œåº”éµå¾ªä»å·¦åˆ°å³ã€ä»ä¸Šåˆ°ä¸‹çš„é¡ºåºæ’åˆ—ã€‚</p><p>ï¼ˆ2ï¼‰ç»˜åˆ¶æµç¨‹å›¾æ—¶ï¼Œä¸ºäº†æé«˜æµç¨‹å›¾çš„é€»è¾‘æ€§ï¼Œåº”éµå¾ªä»å·¦åˆ°å³ã€ä»ä¸Šåˆ°ä¸‹çš„é¡ºåºæ’åˆ—ã€‚ä¸€ä¸ªæµç¨‹ä»å¼€å§‹ç¬¦å¼€å§‹ï¼Œä»¥ç»“æŸç¬¦ç»“æŸã€‚å¼€å§‹ç¬¦å·åªèƒ½å‡ºç°ä¸€æ¬¡ï¼Œè€Œç»“æŸç¬¦å·å¯å‡ºç°å¤šæ¬¡ã€‚è‹¥æµç¨‹è¶³å¤Ÿæ¸…æ™°ï¼Œå¯çœç•¥å¼€å§‹ã€ç»“æŸç¬¦å·ã€‚</p><p>ï¼ˆ3ï¼‰è±å½¢ä¸ºåˆ¤æ–­ç¬¦å·ï¼Œå¿…é¡»è¦æœ‰â€œæ˜¯å’Œå¦ï¼ˆæˆ–Yå’ŒNï¼‰â€ä¸¤ç§å¤„ç†ç»“æœï¼Œæ„æ€æ˜¯è¯´ï¼Œè±å½¢åˆ¤æ–­æ¡†ä¸€å®šéœ€è¦æœ‰ä¸¤æ¡ç®­å¤´æµå‡ºï¼›ä¸”åˆ¤æ–­ç¬¦å·çš„ä¸Šä¸‹ç«¯æµå…¥æµå‡ºä¸€èˆ¬ç”¨â€œæ˜¯ï¼ˆæˆ–Yï¼‰â€ï¼Œå·¦å³ç«¯æµå…¥æµå‡ºç”¨â€œå¦ï¼ˆæˆ–Yï¼‰â€ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200122211333.png">  </p><p>ï¼ˆ4ï¼‰åŒä¸€æµç¨‹å›¾å†…ï¼Œç¬¦å·å¤§å°éœ€è¦ä¿æŒä¸€è‡´ï¼ŒåŒæ—¶è¿æ¥çº¿ä¸èƒ½äº¤å‰ï¼Œè¿æ¥çº¿ä¸èƒ½æ— æ•…å¼¯æ›²ã€‚</p><p>ï¼ˆ5ï¼‰æµç¨‹å¤„ç†å…³ç³»ä¸ºå¹¶è¡Œå…³ç³»çš„ï¼Œéœ€è¦å°†æµç¨‹æ”¾åœ¨åŒä¸€é«˜åº¦ã€‚</p><p>ï¼ˆ6ï¼‰å¿…è¦æ—¶åº”é‡‡ç”¨æ ‡æ³¨ï¼Œä»¥æ­¤æ¥æ¸…æ™°åœ°è¯´æ˜æµç¨‹ï¼Œæ ‡æ³¨è¦ç”¨ä¸“é—¨çš„æ ‡æ³¨ç¬¦å·ã€‚</p><p>ï¼ˆ7ï¼‰å¤„ç†æµç¨‹é¡»ä»¥å•ä¸€å…¥å£å’Œå•ä¸€å‡ºå£ç»˜åˆ¶ï¼ŒåŒä¸€è·¯å¾„çš„æŒ‡ç¤ºç®­å¤´åº”åªæœ‰ä¸€ä¸ªã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200122211353.png">  </p><p>ï¼ˆ8ï¼‰åŒä¸€è·¯å¾„çš„æŒ‡ç¤ºç®­å¤´åº”åªæœ‰ä¸€ä¸ªã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200122211407.png">  </p><p>ï¼ˆ9ï¼‰æµç¨‹å›¾ä¸­ï¼Œå¦‚æœæœ‰å‚è€ƒå…¶ä»–å·²ç»å®šä¹‰çš„æµç¨‹ï¼Œä¸éœ€é‡å¤ç»˜åˆ¶ï¼Œç›´æ¥ç”¨å·²å®šä¹‰æµç¨‹ç¬¦å·å³å¯ã€‚</p></blockquote><p>ä»¥ä¸Šä¸ºéœ€è¦å‚¨å¤‡çš„åŸºç¡€æµç¨‹å›¾çŸ¥è¯†ï¼Œå‚è€ƒåœ°å€ï¼š<a href="http://www.woshipm.com/zhichang/2329530.html">ç”»äº†å¤šå¹´çš„æµç¨‹å›¾ï¼Œä½ çœŸçš„ç”»è§„èŒƒäº†å—ï¼Ÿ</a></p><h2 id="å·¥å…·å‡†å¤‡"><a href="#å·¥å…·å‡†å¤‡" class="headerlink" title="å·¥å…·å‡†å¤‡"></a>å·¥å…·å‡†å¤‡</h2><p>æ‰€è°“å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œç»˜åˆ¶æµç¨‹å›¾éœ€è¦è¶æ‰‹çš„å…µå™¨ï¼Œæˆ‘æ¨èä¸¤ä¸ªåœ¨çº¿ç»˜åˆ¶çš„ç½‘ç«™ã€‚</p><ul><li><a href="https://www.processon.com/i/58490e6ce4b0d594ec5b4ce3">ProcessOn</a></li><li><a href="https://www.draw.io/">Draw.io</a></li></ul><p>draw.io æä¾›äº†æ¡Œé¢ç‰ˆï¼Œç›®å‰æˆ‘ä½¿ç”¨çš„å°±æ˜¯è¿™ä¸ªï¼Œ processOn å…è´¹ç‰ˆæœ‰æ•°é‡é™åˆ¶ï¼Œä¸è¿‡ä¸€èˆ¬ä¹Ÿå¤Ÿç”¨äº†ã€‚</p><h2 id="ä¸šåŠ¡è¯´æ˜"><a href="#ä¸šåŠ¡è¯´æ˜" class="headerlink" title="ä¸šåŠ¡è¯´æ˜"></a>ä¸šåŠ¡è¯´æ˜</h2><p>ä»¥ä¸‹ç¬”è€…å°±ä»¥æœ¬äººå‰æ®µæ—¶é—´å¼€å‘çš„æŠ½å¥–ç³»ç»Ÿå®è·µç»˜åˆ¶æŠ€æœ¯æµç¨‹å›¾ï¼Œä»¥ä¾›å‚è€ƒã€‚</p><p>éœ€æ±‚å°±æ˜¯å¼€å‘ä¸€ä¸ªæ˜¥èŠ‚ç”¨çš„æŠ½å¥–ç³»ç»Ÿï¼Œä»£ç å®ç°ä¸Šè¿˜æ˜¯ä¸éš¾ï¼Œä½†æ˜¯æ­¥éª¤è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œç”»æµç¨‹å›¾ä¸€ä¸ªåŸå› æ˜¯å¸®åŠ©è‡ªå·±ç†æ¸…ä¸šåŠ¡è®¾è®¡ä¸šåŠ¡ï¼Œå¦ä¸€ä¸ªåŸå› å°±æ˜¯å¯ä»¥ç›´æ¥å°†æµç¨‹å›¾æä¾›ç»™å¯¹åº”çš„æµ‹è¯•ï¼Œä»è€Œè¾¾åˆ°é’ˆå¯¹æ¯ä¸ªæ­¥éª¤è¿›è¡Œæµ‹è¯•çš„ç›®çš„ã€‚</p><h2 id="æµç¨‹å›¾å®è·µç»˜åˆ¶"><a href="#æµç¨‹å›¾å®è·µç»˜åˆ¶" class="headerlink" title="æµç¨‹å›¾å®è·µç»˜åˆ¶"></a>æµç¨‹å›¾å®è·µç»˜åˆ¶</h2><p>æµç¨‹å›¾çš„ç»˜åˆ¶è§„åˆ™å¦‚ä¸Šæ–‡å‚è€ƒä¸­çš„è§„åˆ™è¿›è¡Œï¼Œå¤„ç†ç»„ä»¶åªæœ‰ä¸€ä¸ªè¾“å…¥ä¸€ä¸ªè¾“å‡ºï¼Œè±å½¢åˆ¤å®šå¿…å®šæœ‰ä¸¤ä¸ªè¾“å‡ºï¼Œå·¦å³ç«¯æµå‡ºä»£è¡¨å¦å®šï¼Œä¸åŒæµç¨‹ä½¿ç”¨å­æµç¨‹ç»„ä»¶è¿›è¡Œå¼•ç”¨ï¼Œè¿æ¥çº¿æ— äº¤å‰ç­‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200122212251.png">  </p><p>ç¬”è€…ä½¿ç”¨Draw.ioç»˜åˆ¶æœ¬å›¾ï¼Œä½†æ˜¯å¸¸ç”¨çš„ç»„ä»¶åˆ†æ•£äºä¸åŒçš„åˆ†ç±»ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œç¬”è€…å°†å¸¸ç”¨çš„å‡ ä¸ªåŸºæœ¬ç»„ä»¶æ”¾åˆ°ä¾¿ç¬ºæœ¬åˆ†ç±»ã€‚è¿™ä¸ªåˆ†ç±»å¯ä»¥è¿›è¡Œå¯¼å…¥å¯¼å‡ºï¼Œè¿™é‡Œåˆ†äº«æˆ‘çš„å¯¼å‡ºå†…å®¹ï¼Œå¯ä»¥ç›´æ¥æ‹·è´å‡ºæ¥ç²˜è´´ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œç„¶ååœ¨ä¾¿ç¬ºæœ¬ä¸­å¯¼å…¥å³å¯ã€‚  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200122213527.png">  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200122213410.png"></p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mxlibrary</span>&gt;</span>[&#123;&quot;xml&quot;:&quot;jVFBDsIgEHwN14bCxbOtevIRRNZCAkJgtfT3QkEbD008kOzM7IQZIHyw6RKEV1cnwRB+InwIzmGdbBrAGMKoloSPhDGaD2HnHbVfVepFgAf+Y2DV8BLmCZWpRMTFNEKhzbHGnvCjFFFBcdIMZqURohe3sjfnBpmLSvgCbZpKpU7eZRdRBGzXQEBIu1FXquW8gLOAYckrs5ao6sahtqEK9KSaizdOxIqnr3PrnYdW/QO3J161nx94Aw==&quot;,&quot;w&quot;:80,&quot;h&quot;:30,&quot;aspect&quot;:&quot;fixed&quot;,&quot;title&quot;:&quot;å¼€å§‹/ç»“æŸ&quot;&#125;,&#123;&quot;xml&quot;:&quot;jVBLDsIgED3N7CnEC9hqVx6CyKSQgDQw2vb2TgvauGjigmTmfch7A6oNc5/0aG/RoAd1AdWmGKlMYW7Re5DCGVAdSCn4gbwesM3GilEnfNA/BlkML+2fWJACZFp8BSwFjtU1oM5GZ4urU/AyWUeYR31fdRM3YKz+holwPky0QTVOjzEgpYUlkzNkq0KU1MKiG2y1nSqmc9mHr3Xvx0Ot+Fn3U27cz6Xf&quot;,&quot;w&quot;:100,&quot;h&quot;:50,&quot;aspect&quot;:&quot;fixed&quot;,&quot;title&quot;:&quot;å¤„ç†&quot;&#125;,&#123;&quot;xml&quot;:&quot;jZA9DsIwDIVP4z1NFmZa6MTECQK16kgJqVL37/aEJlB1qMQQ6fl7dvRsUKWb66A7uvkGLagLqDJ4z0m5uURrQQrTgKpAShEfyOuBW6yu6HTAF/8zINPAqO2AiSTQ82IzCOTdY+hBnScyjPdOPz/OFDNHRuxi6KqIMn+FgXE+jLOinKVG75DDElsm0zCljlNKLAhNS7xnuk91+5vcdosir/cttzOu3u7Kbw==&quot;,&quot;w&quot;:80,&quot;h&quot;:80,&quot;aspect&quot;:&quot;fixed&quot;,&quot;title&quot;:&quot;åˆ¤å®š&quot;&#125;,&#123;&quot;xml&quot;:&quot;jZJRbsMgDIZPwzsF7QKla/cy7aEnoIkXUJ0QgdMkO/0coKs2qdIiRbK/3z8xdoQ2/XKKdnTvoQUU+lVoE0OgEvWLAUShpG+FPgilJL9CHZ+ou6zK0UYY6D8GVQw3ixMUUkCiFStIzo5bOMbQQEpC72fnCc6jbTY8c+/MHPXc/GHH4cU21y6GaWg/JkI/QOWtTQ6270pOPsNAR9t7XBm8Ad6AfGOrcPZf2aRqbgKGmLvRMj/MLfpuYNbwTYHFfaIYrvCn1JjtCI9450PY+tnXa0MkWJ6OLqM6txOEHiiuXDL7llytkGW80oHvXLW9VGZTybsf62MRHNRd3NPHzrP265f4Bg==&quot;,&quot;w&quot;:100,&quot;h&quot;:50,&quot;aspect&quot;:&quot;fixed&quot;,&quot;title&quot;:&quot;å­æµç¨‹&quot;&#125;,&#123;&quot;xml&quot;:&quot;jVJRasMwDD2N/12bHWDLln4NdgUzi9jMiYqstsntp0VJm7AVZjBIT3pPkmXjm348Ujild4xQjH8zviFEVqsfGyjFOJuj8a/GOSvXuPZB9DBH7SkQDPwfglPCJZQzKKJA5aksAAzxmQiv4g04CPgSQ03wI3AQJ3FfFrMy4Rc0WJBmqm9bK0ciKgqxg4d9ztDS5BGwB6ZJUq45ctKMJx3FJshd4j1GUALny14+VHW7m9ytwgdmKezstJdZGRXP9AlL0vb5Vt74N48DdcC/eGJshrpD8zJW9750Td/+iW8=&quot;,&quot;w&quot;:50,&quot;h&quot;:50,&quot;aspect&quot;:&quot;fixed&quot;,&quot;title&quot;:&quot;è™šçº¿&quot;&#125;]<span class="hljs-tag">&lt;/<span class="hljs-name">mxlibrary</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h2 id="æµç¨‹å›¾å¯¼å‡º"><a href="#æµç¨‹å›¾å¯¼å‡º" class="headerlink" title="æµç¨‹å›¾å¯¼å‡º"></a>æµç¨‹å›¾å¯¼å‡º</h2><p>æœ¬å›¾é€šè¿‡æ¡Œé¢ç‰ˆå®¢æˆ·ç«¯ Draw.io ç»˜åˆ¶ï¼Œç»˜åˆ¶é€šè¿‡å¯¼å‡ºåŠŸèƒ½å¯¼å‡ºï¼Œå¯¼å‡ºæ–¹æ³•ï¼šå…ˆ ctrl + a é€‰ä¸­æ‰€æœ‰ç»„ä»¶ï¼Œé€‰æ‹©æ–‡ä»¶-å¯¼å‡ºä¸ºæ–‡ä»¶-pngï¼Œè®¾ç½®è¾¹æ¡†å®½åº¦ï¼Œå‹¾é€‰ ä»…æ‰€é€‰å†…å®¹ï¼Œå³å¯å¯¼å‡ºPNGå›¾ç‰‡ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200122212857.png">  </p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><ul><li><a href="http://www.woshipm.com/zhichang/2329530.html">ç”»äº†å¤šå¹´çš„æµç¨‹å›¾ï¼Œä½ çœŸçš„ç”»è§„èŒƒäº†å—ï¼Ÿ</a></li><li><a href="http://www.chanpin100.com/article/105363">æ·±å…¥æµ…å‡ºä¸ºä½ è§£è¯»å››ç±»ã€Œæµç¨‹å›¾ã€ï¼Œé™„æ‘©æ‹œ/ofoæ¡ˆä¾‹åˆ†æ</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å·¥å…·ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æµç¨‹å›¾ç»˜åˆ¶</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java8 æ—¶é—´ API å…¨é›†åˆ</title>
    <link href="/Java8%E6%97%B6%E9%97%B4API%E5%85%A8%E9%9B%86%E5%90%88.html"/>
    <url>/Java8%E6%97%B6%E9%97%B4API%E5%85%A8%E9%9B%86%E5%90%88.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Java 8 å·²ç»é¢ä¸–å¾ˆé•¿æ—¶é—´ï¼Œç›®å‰è¿ Java 13ã€Java 14 éƒ½å·²ç»å‡ºæ¥äº†ï¼Œä½†è‡ªå·±å¯¹äº Java8 ä¸­çš„ä¸€äº› API ç”¨æ³•è¿˜ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œä»Šå¹´æ‰ç®—å…¨é¢åˆ‡æ¢åˆ° Java8ã€‚åœ¨æ—¥å¸¸å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸å¯é¿å…åœ°ä¼šä½¿ç”¨åˆ° Java 8 çš„æ–°æ—¶é—´ APIï¼Œæ¯”å¦‚ LocalDateTimeã€LocalDate ç­‰ï¼Œæ”¾å¼ƒä½¿ç”¨éš¾ç”¨çš„ Dateï¼›ä½†æ˜¯æ¯æ¬¡éœ€è¦è¿›è¡Œè½¬æ¢æ“ä½œæ—¶ï¼Œæ€»æ˜¯éœ€è¦é‡å¤å» Google æœç´¢ï¼Œç´¢æ€§ä¸€æ¬¡æ€§è¿‡ä¸€éæ‰€æœ‰çš„æ—¶é—´ APIï¼Œæ€»ç»“ä¸€äº›å¸¸ç”¨çš„è½¬æ¢æ–¹æ³•ï¼Œæ¯”å¦‚æ—¶é—´æˆ³ä¸ LocalDateTime äº’è½¬ï¼ŒDate ä¸ LocalDateTime äº’è½¬ã€‚</p><a id="more"></a><h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test1</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> DateTimeFormatter DATE_TIME_FORMATTER = DateTimeFormatter.ofPattern(<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> DateTimeFormatter TIME_FORMATTER = DateTimeFormatter.ofPattern(<span class="hljs-string">&quot;HH:mm:ss&quot;</span>);<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> DateTimeFormatter MONTH_DAY_FORMATTER = DateTimeFormatter.ofPattern(<span class="hljs-string">&quot;MM-dd&quot;</span>);<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> DateTimeFormatter YEAR_FORMATTER = DateTimeFormatter.ofPattern(<span class="hljs-string">&quot;yyyy&quot;</span>);<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> DateTimeFormatter YEAR_MONTH_FORMATTER = DateTimeFormatter.ofPattern(<span class="hljs-string">&quot;yyyy-MM&quot;</span>);<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-comment">// é€šç”¨æ–¹æ³•</span><br>        <span class="hljs-comment">// plus/plusXXX  å½“å‰æ—¥æœŸæˆ–æ—¶é—´åŠ ä¸Šä¸€æ®µ (å¹´/æœˆ/å‘¨/æ—¥/å°æ—¶/åˆ†é’Ÿ) æ—¥æœŸæˆ–æ—¶é—´</span><br>        <span class="hljs-comment">// minus/minusXXX  å½“å‰æ—¥æœŸæˆ–æ—¶é—´å‡å»ä¸€æ®µ (å¹´/æœˆ/å‘¨/æ—¥/å°æ—¶/åˆ†é’Ÿ) æ—¥æœŸæˆ–æ—¶é—´</span><br>        <span class="hljs-comment">// isBefore è¦æ¯”è¾ƒçš„æ—¥æœŸæˆ–æ—¶é—´æ˜¯å¦åœ¨å½“å‰å¯¹è±¡ä¹‹å‰</span><br>        <span class="hljs-comment">// isAfter  è¦æ¯”è¾ƒçš„æ—¥æœŸæˆ–æ—¶é—´æ˜¯å¦åœ¨å½“å‰å¯¹è±¡ä¹‹å</span><br>        <span class="hljs-comment">// parse é€šè¿‡å­—ç¬¦ä¸²åˆ›å»ºæ—¥æœŸæˆ–æ—¶é—´</span><br>        <span class="hljs-comment">// format å°†æ—¥æœŸæˆ–æ—¶é—´æ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²</span><br><br>        System.out.println(<span class="hljs-string">&quot;--------LocalDate---------&quot;</span>);<br>        <span class="hljs-comment">//  æ—¥æœŸ</span><br>        LocalDate today = LocalDate.now();<br>        System.out.println(<span class="hljs-string">&quot;å½“å‰æ—¥æœŸï¼š&quot;</span> + today);<br>        System.out.println(<span class="hljs-string">&quot;å½“å‰æ—¥æœŸåŠ ä¸Š 3 å¤©ï¼š&quot;</span> + today.plusDays(<span class="hljs-number">3</span>));<br>        System.out.println(<span class="hljs-string">&quot;å½“å‰æ—¥æœŸå‡å» 3 å¤©ï¼š&quot;</span> + today.minusDays(<span class="hljs-number">3</span>));<br><br>        System.out.println(<span class="hljs-string">&quot;å¹´ï¼š&quot;</span> + today.getYear());<br>        System.out.println(<span class="hljs-string">&quot;æœˆ (EN)ï¼š&quot;</span> + today.getMonth());<br>        System.out.println(<span class="hljs-string">&quot;æœˆ (1-12)ï¼š&quot;</span> + today.getMonthValue());<br><br>        System.out.println(<span class="hljs-string">&quot;å½“å‘¨ç¬¬å‡ å¤©ï¼š&quot;</span> + today.getDayOfWeek());<br>        System.out.println(<span class="hljs-string">&quot;å½“æœˆç¬¬å‡ å¤©ï¼š&quot;</span> + today.getDayOfMonth());<br>        System.out.println(<span class="hljs-string">&quot;å½“å¹´ç¬¬å‡ å¤©ï¼š&quot;</span> + today.getDayOfYear());<br>        System.out.println(<span class="hljs-string">&quot;æ˜¯å¦é—°å¹´ï¼š&quot;</span> + today.isLeapYear());<br>        System.out.println(<span class="hljs-string">&quot;å½“æœˆå…±å¤šå°‘å¤©ï¼š&quot;</span> + today.lengthOfMonth());<br>        System.out.println(<span class="hljs-string">&quot;å½“å¹´å…±å¤šå°‘å¤©ï¼š&quot;</span> + today.lengthOfYear());<br><br>        LocalDate nextDay = today.plusDays(<span class="hljs-number">1</span>);<br>        Period until = today.until(nextDay);<br>        System.out.println(<span class="hljs-string">&quot;today-nextDay é—´éš”å¤©æ•°: &quot;</span> + until.getDays());<br><br>        System.out.println(<span class="hljs-string">&quot;isBeforeï¼š&quot;</span> + today.isBefore(nextDay));<br>        System.out.println(<span class="hljs-string">&quot;isAfterï¼š &quot;</span> + today.isAfter(nextDay));<br><br>        LocalDate parseDate = LocalDate.parse(<span class="hljs-string">&quot;2020-01-24&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;parseDateï¼š&quot;</span> + parseDate);<br><br>        System.out.println(<span class="hljs-string">&quot;--------LocalDateTime---------&quot;</span>);<br>        <span class="hljs-comment">// æ—¥æœŸæ—¶é—´</span><br>        LocalDateTime nowLocalDateTime = LocalDateTime.now();<br>        System.out.println(<span class="hljs-string">&quot;å½“å‰æ—¶é—´ï¼š&quot;</span> + nowLocalDateTime.format(DATE_TIME_FORMATTER));<br>        System.out.println(<span class="hljs-string">&quot;å½“å‰æ—¶é—´åŠ ä¸Š 3 å°æ—¶ï¼š&quot;</span> + nowLocalDateTime.plusHours(<span class="hljs-number">3</span>));<br>        System.out.println(<span class="hljs-string">&quot;å½“å‰æ—¶é—´å‡å» 3 å°æ—¶ï¼š&quot;</span> + nowLocalDateTime.minusHours(<span class="hljs-number">3</span>));<br><br>        System.out.println(<span class="hljs-string">&quot;å¹´ï¼š&quot;</span> + nowLocalDateTime.getYear());<br>        System.out.println(<span class="hljs-string">&quot;æœˆ (EN)ï¼š&quot;</span> + nowLocalDateTime.getMonth());<br>        System.out.println(<span class="hljs-string">&quot;æœˆ (1-12)ï¼š&quot;</span> + nowLocalDateTime.getMonthValue());<br>        System.out.println(<span class="hljs-string">&quot;æœˆ (1-12)ï¼š&quot;</span> + nowLocalDateTime.getMonthValue());<br><br>        LocalDateTime nextDayNow = nowLocalDateTime.plusDays(<span class="hljs-number">1</span>);<br>        System.out.println(<span class="hljs-string">&quot;isBeforeï¼š&quot;</span> + nowLocalDateTime.isBefore(nextDayNow));<br>        System.out.println(<span class="hljs-string">&quot;isAfterï¼š&quot;</span> + nowLocalDateTime.isAfter(nextDayNow));<br><br>        LocalDateTime parseDateTime = LocalDateTime.parse(<span class="hljs-string">&quot;2020-01-21 18:05:35&quot;</span>, DATE_TIME_FORMATTER);<br>        System.out.println(<span class="hljs-string">&quot;parseDateTimeï¼š&quot;</span> + parseDateTime);<br><br>        System.out.println(<span class="hljs-string">&quot;--------LocalTime---------&quot;</span>);<br>        <span class="hljs-comment">// æ—¶é—´</span><br>        LocalTime localTime = LocalTime.now(Clock.systemDefaultZone());<br>        System.out.println(<span class="hljs-string">&quot;å½“å‰æ—¶é—´ï¼š&quot;</span> + localTime.format(TIME_FORMATTER));<br><br>        System.out.println(<span class="hljs-string">&quot;--------MonthDay---------&quot;</span>);<br>        <span class="hljs-comment">// æœˆå¤©</span><br>        MonthDay monthDay = MonthDay.now();<br>        System.out.println(<span class="hljs-string">&quot;å½“å‰æœˆå¤©ï¼š&quot;</span> + monthDay.format(MONTH_DAY_FORMATTER));<br><br>        System.out.println(<span class="hljs-string">&quot;--------Year---------&quot;</span>);<br>        <span class="hljs-comment">// å¹´</span><br>        Year year = Year.now();<br>        System.out.println(<span class="hljs-string">&quot;å½“å‰å¹´ï¼š&quot;</span> + year.format(YEAR_FORMATTER));<br><br>        System.out.println(<span class="hljs-string">&quot;--------YearMonth---------&quot;</span>);<br>        <span class="hljs-comment">// å¹´æœˆ</span><br>        YearMonth yearMonth = YearMonth.now();<br>        System.out.println(<span class="hljs-string">&quot;å½“å‰å¹´æœˆï¼š&quot;</span> + yearMonth.format(YEAR_MONTH_FORMATTER));<br><br>        System.out.println(<span class="hljs-string">&quot;--------DayOfWeek---------&quot;</span>);<br>        <span class="hljs-comment">// æ˜ŸæœŸ</span><br>        DayOfWeek dayOfWeek = DayOfWeek.from(LocalDateTime.now());<br>        System.out.println(<span class="hljs-string">&quot;å½“å‰æ˜ŸæœŸç¬¬å‡ å¤©ï¼š&quot;</span> + dayOfWeek.getValue());<br><br>        System.out.println(<span class="hljs-string">&quot;--------Month---------&quot;</span>);<br>        <span class="hljs-comment">// æœˆä»½</span><br>        Month month = Month.from(LocalDate.now());<br>        System.out.println(<span class="hljs-string">&quot;å½“å¹´ç¬¬å‡ æœˆ&quot;</span> + month.getValue());<br>        System.out.println(<span class="hljs-string">&quot;å½“æœˆå¤©æ•°ï¼š&quot;</span> + month.length(Year.now().isLeap()));<br><br>        System.out.println(<span class="hljs-string">&quot;--------clock---------&quot;</span>);<br>        <span class="hljs-comment">// æ—¶é’Ÿå¯¹è±¡</span><br>        Clock clock = Clock.systemDefaultZone();<br>        System.out.println(<span class="hljs-string">&quot;å½“å‰æ—¶é—´æ—¶é—´æˆ³ï¼š&quot;</span> + clock.millis());<br><br>        System.out.println(<span class="hljs-string">&quot;--------duration---------&quot;</span>);<br>        <span class="hljs-comment">// åŸºäºæ—¶é—´çš„æ—¶é—´åŒºé—´ï¼ˆå•ä½ï¼šå°æ—¶ã€åˆ†é’Ÿã€æ¯«ç§’ã€ç§’ã€çº³ç§’ç­‰ï¼‰</span><br>        Duration duration = Duration.between(nowLocalDateTime, nowLocalDateTime.plusHours(<span class="hljs-number">2</span>));<br>        System.out.println(<span class="hljs-string">&quot;ç§’ï¼š&quot;</span> + duration.getSeconds());<br>        System.out.println(<span class="hljs-string">&quot;æ¯«ç§’ï¼š&quot;</span> + duration.toMillis());<br>        System.out.println(<span class="hljs-string">&quot;åˆ†é’Ÿï¼š&quot;</span> + duration.toMinutes());<br>        System.out.println(<span class="hljs-string">&quot;å°æ—¶ï¼š&quot;</span> + duration.toHours());<br>        System.out.println(<span class="hljs-string">&quot;å¤©ï¼š&quot;</span> + duration.toDays());<br><br>        System.out.println(<span class="hljs-string">&quot;--------period---------&quot;</span>);<br>        <span class="hljs-comment">//  åŸºäºæ—¥æœŸçš„æ—¶é—´åŒºé—´ï¼ˆå•ä½ï¼šå¹´ã€æœˆã€æ—¥ï¼‰</span><br>        Period period = Period.between(LocalDate.now(), LocalDate.now()<br>                .plusYears(<span class="hljs-number">1</span>)<br>                .plusMonths(<span class="hljs-number">2</span>)<br>                .plusDays(<span class="hljs-number">3</span>));<br>        System.out.println(<span class="hljs-string">&quot;å¤©ï¼š&quot;</span> + period.getDays());<br>        System.out.println(<span class="hljs-string">&quot;æœˆï¼š&quot;</span> + period.getMonths());<br>        System.out.println(<span class="hljs-string">&quot;å¹´ï¼š&quot;</span> + period.getYears());<br>        System.out.println(<span class="hljs-string">&quot;æ€»æœˆæ•°ï¼š&quot;</span> + period.toTotalMonths());<br><br>        System.out.println(<span class="hljs-string">&quot;--------Instant---------&quot;</span>);<br>        <span class="hljs-comment">// åœ¨æ—¶é—´çº¿ä¸Šçš„ç¬é—´ç‚¹</span><br>        Instant instant = Instant.now();<br>        System.out.println(<span class="hljs-string">&quot;æ¯«ç§’ï¼š&quot;</span> + instant.toEpochMilli());<br><br>        System.out.println(<span class="hljs-string">&quot;--------å®ç”¨æ–¹æ³•---------&quot;</span>);<br>        <span class="hljs-comment">// æŒ‡å®šæ—¥æœŸçš„å‡Œæ™¨ 00:00:00</span><br>        LocalDateTime todayStartTime = today.atStartOfDay();<br>        System.out.println(<span class="hljs-string">&quot;æŒ‡å®šæ—¥æœŸçš„å¼€å§‹æ—¶é—´ï¼š&quot;</span> + todayStartTime.format(DATE_TIME_FORMATTER));<br>        <span class="hljs-comment">// æˆ–è€…</span><br>        LocalDateTime todayStart = LocalDateTime.of(today, LocalTime.MIN);<br>        System.out.println(<span class="hljs-string">&quot;æŒ‡å®šæ—¥æœŸçš„å¼€å§‹æ—¶é—´: &quot;</span> + todayStart.format(DATE_TIME_FORMATTER));<br><br>        <span class="hljs-comment">// æŒ‡å®šæ—¥æœŸçš„å‡Œæ™¨ 23:59:59</span><br>        LocalDateTime todayEnd = LocalDateTime.of(today, LocalTime.MAX);<br>        System.out.println(<span class="hljs-string">&quot;æŒ‡å®šæ—¥æœŸçš„ç»“æŸæ—¶é—´ï¼š&quot;</span> + todayEnd.format(DATE_TIME_FORMATTER));<br><br>        <span class="hljs-comment">// æ¯«ç§’æ—¶é—´æˆ³è½¬ LocalDateTime</span><br>        System.out.println(<span class="hljs-string">&quot;æ¯«ç§’æ—¶é—´æˆ³è½¬ LocalDateTimeï¼š&quot;</span> + LocalDateTime.ofInstant(Instant.ofEpochMilli(<span class="hljs-number">1579646281991L</span>), ZoneOffset.ofHours(<span class="hljs-number">8</span>)).toString());<br>        <span class="hljs-comment">// LocalDateTime è½¬æ—¶é—´æˆ³</span><br>        System.out.println(<span class="hljs-string">&quot;LocalDateTime è½¬æ—¶é—´æˆ³ï¼š&quot;</span> + nowLocalDateTime.toInstant(ZoneOffset.ofHours(<span class="hljs-number">8</span>)).toEpochMilli());<br><br>        <span class="hljs-comment">// LocalDateTime è½¬ yyyy-MM-dd HH:mm:ss æ ¼å¼ String</span><br>        System.out.println(<span class="hljs-string">&quot;LocalDateTime è½¬ yyyy-MM-dd HH:mm:ss æ ¼å¼ Stringï¼š&quot;</span> + LocalDateTime.now().format(DATE_TIME_FORMATTER));<br>        <span class="hljs-comment">// yyyy-MM-dd HH:mm:ss æ ¼å¼ String è½¬ LocalDateTime</span><br>        LocalDateTime parseLocalDateTime = LocalDateTime.parse(<span class="hljs-string">&quot;2020-01-22 23:59:59&quot;</span>, DATE_TIME_FORMATTER);<br>        System.out.println(<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss æ ¼å¼ String è½¬ LocalDateTimeï¼š&quot;</span> + parseLocalDateTime);<br><br>        <span class="hljs-comment">// Date è½¬ LocalDateTime</span><br>        Date nowDate = <span class="hljs-keyword">new</span> Date();<br>        LocalDateTime date2LocalTime = LocalDateTime.ofInstant(nowDate.toInstant(), ZoneOffset.ofHours(<span class="hljs-number">8</span>));<br>        System.out.println(<span class="hljs-string">&quot;Date è½¬ LocalDateTimeï¼š&quot;</span> + date2LocalTime);<br><br>        <span class="hljs-comment">// LocalDateTime è½¬ Date</span><br>        Date localDateTime2Date = Date.from(nowLocalDateTime.toInstant(ZoneOffset.ofHours(<span class="hljs-number">8</span>)));<br>        System.out.println(<span class="hljs-string">&quot;LocalDateTime è½¬ Dateï¼š&quot;</span> + localDateTime2Date);<br>      <br>      <span class="hljs-comment">// LocalDateè½¬LocalDateTime</span><br>      LocalDateTime localDate2LocalDateTime = LocalDateTime.of(today, LocalTime.parse(<span class="hljs-string">&quot;00:00:00&quot;</span>));<br><br>      <span class="hljs-comment">// LocalDateTimeè½¬LocalDate</span><br>      LocalDate localDateTime2LocalDate = nowLocalDateTime.toLocalDate();<br><br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">--------LocalDate---------<br>å½“å‰æ—¥æœŸï¼š2020-01-22<br>å½“å‰æ—¥æœŸåŠ ä¸Š 3 å¤©ï¼š2020-01-25<br>å½“å‰æ—¥æœŸå‡å» 3 å¤©ï¼š2020-01-19<br>å¹´ï¼š2020<br>æœˆ (EN)ï¼šJANUARY<br>æœˆ (1-12)ï¼š1<br>å½“å‘¨ç¬¬å‡ å¤©ï¼šWEDNESDAY<br>å½“æœˆç¬¬å‡ å¤©ï¼š22<br>å½“å¹´ç¬¬å‡ å¤©ï¼š22<br>æ˜¯å¦é—°å¹´ï¼š<span class="hljs-literal">true</span><br>å½“æœˆå…±å¤šå°‘å¤©ï¼š31<br>å½“å¹´å…±å¤šå°‘å¤©ï¼š366<br>today-nextDay é—´éš”å¤©æ•°: 1<br>isBeforeï¼š<span class="hljs-literal">true</span><br>isAfterï¼š <span class="hljs-literal">false</span><br>parseDateï¼š2020-01-24<br>--------LocalDateTime---------<br>å½“å‰æ—¶é—´ï¼š2020-01-22 07:06:13<br>å½“å‰æ—¶é—´åŠ ä¸Š 3 å°æ—¶ï¼š2020-01-22T10:06:13.979<br>å½“å‰æ—¶é—´å‡å» 3 å°æ—¶ï¼š2020-01-22T04:06:13.979<br>å¹´ï¼š2020<br>æœˆ (EN)ï¼šJANUARY<br>æœˆ (1-12)ï¼š1<br>æœˆ (1-12)ï¼š1<br>isBeforeï¼š<span class="hljs-literal">true</span><br>isAfterï¼š<span class="hljs-literal">false</span><br>parseDateTimeï¼š2020-01-21T18:05:35<br>--------LocalTime---------<br>å½“å‰æ—¶é—´ï¼š07:06:13<br>--------MonthDay---------<br>å½“å‰æœˆå¤©ï¼š01-22<br>--------Year---------<br>å½“å‰å¹´ï¼š2020<br>--------YearMonth---------<br>å½“å‰å¹´æœˆï¼š2020-01<br>--------DayOfWeek---------<br>å½“å‰æ˜ŸæœŸç¬¬å‡ å¤©ï¼š3<br>--------Month---------<br>å½“å¹´ç¬¬å‡ æœˆ 1<br>å½“æœˆå¤©æ•°ï¼š31<br>--------clock---------<br>å½“å‰æ—¶é—´æ—¶é—´æˆ³ï¼š1579647973982<br>--------duration---------<br>ç§’ï¼š7200<br>æ¯«ç§’ï¼š7200000<br>åˆ†é’Ÿï¼š120<br>å°æ—¶ï¼š2<br>å¤©ï¼š0<br>--------period---------<br>å¤©ï¼š3<br>æœˆï¼š2<br>å¹´ï¼š1<br>æ€»æœˆæ•°ï¼š14<br>--------Instant---------<br>æ¯«ç§’ï¼š1579647973983<br>--------å®ç”¨æ–¹æ³•---------<br>æŒ‡å®šæ—¥æœŸçš„å¼€å§‹æ—¶é—´ï¼š2020-01-22 00:00:00<br>æŒ‡å®šæ—¥æœŸçš„å¼€å§‹æ—¶é—´: 2020-01-22 00:00:00<br>æŒ‡å®šæ—¥æœŸçš„ç»“æŸæ—¶é—´ï¼š2020-01-22 23:59:59<br>æ¯«ç§’æ—¶é—´æˆ³è½¬ LocalDateTimeï¼š2020-01-22T06:38:01.991<br>LocalDateTime è½¬æ—¶é—´æˆ³ï¼š1579647973979<br>LocalDateTime è½¬ yyyy-MM-dd HH:mm:ss æ ¼å¼ Stringï¼š2020-01-22 07:06:13<br>yyyy-MM-dd HH:mm:ss æ ¼å¼ String è½¬ LocalDateTimeï¼š2020-01-22T23:59:59<br>Date è½¬ LocalDateTimeï¼š2020-01-22T07:06:13.984<br>LocalDateTime è½¬ Dateï¼šWed Jan 22 07:06:13 CST 2020<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="http://www.172u.top/JDK1.8cn/">åœ¨çº¿ JDK8 ä¸­æ–‡æ–‡æ¡£ </a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LocalDateTimeè½¬æ—¶é—´æˆ³</tag>
      
      <tag>æ—¶é—´æˆ³è½¬LocalDateTime</tag>
      
      <tag>Dateè½¬LocalDateTime</tag>
      
      <tag>LocalDateTimeè½¬Date</tag>
      
      <tag>LocalDateTimeè½¬LocalDate</tag>
      
      <tag>LocalDateè½¬LocalDateTime</tag>
      
      <tag>LocalDateTimeè½¬String</tag>
      
      <tag>Stringè½¬LocalDateTime</tag>
      
      <tag>Java8è·å–å‡Œæ™¨æ—¶é—´</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mapstructæœ€ä½³å®è·µ</title>
    <link href="/mapstruct%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html"/>
    <url>/mapstruct%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æŒ‰ç…§æ—¥å¸¸å¼€å‘ä¹ æƒ¯ï¼Œå¯¹äºä¸åŒé¢†åŸŸå±‚ä½¿ç”¨ä¸åŒJavaBeanå¯¹è±¡ä¼ è¾“æ•°æ®ï¼Œé¿å…ç›¸äº’å½±å“ï¼Œå› æ­¤åŸºäºæ•°æ®åº“å®ä½“å¯¹è±¡Userè¡ç”Ÿå‡ºæ¯”å¦‚UserDtoã€UserVoç­‰å¯¹è±¡ï¼Œäºæ˜¯åœ¨ä¸åŒå±‚ä¹‹é—´è¿›è¡Œæ•°æ®ä¼ è¾“æ—¶ï¼Œä¸å¯é¿å…åœ°éœ€è¦å°†è¿™äº›å¯¹è±¡è¿›è¡Œäº’ç›¸è½¬æ¢æ“ä½œã€‚</p><p>å¸¸è§çš„è½¬æ¢æ–¹å¼æœ‰ï¼š</p><ul><li>è°ƒç”¨getter/setteræ–¹æ³•è¿›è¡Œå±æ€§èµ‹å€¼</li><li>è°ƒç”¨BeanUtil.copyPropertieè¿›è¡Œåå°„å±æ€§èµ‹å€¼</li></ul><p>ç¬¬ä¸€ç§æ–¹å¼ä¸å¿…è¯´ï¼Œå±æ€§å¤šäº†å°±éœ€è¦å†™ä¸€å¤§å¨getter/setterä»£ç ã€‚ç¬¬äºŒç§æ–¹å¼æ¯”ç¬¬ä¸€ç§æ–¹å¼è¦ç®€ä¾¿å¾ˆå¤šï¼Œä½†æ˜¯å‘å·¨å¤šï¼Œæ¯”å¦‚sourcesä¸targetå†™åï¼Œéš¾ä»¥å®šä½æŸä¸ªå­—æ®µåœ¨å“ªé‡Œè¿›è¡Œçš„èµ‹å€¼ï¼ŒåŒæ—¶å› ä¸ºç”¨åˆ°åå°„ï¼Œå¯¼è‡´æ€§èƒ½ä¹Ÿä¸ä½³ã€‚</p><p>é‰´äºæ­¤ï¼Œä»Šå¤©å†™ä¸€å†™ç¬¬ä¸‰ç§å¯¹è±¡è½¬æ¢æ–¹å¼ï¼Œæœ¬æ–‡ä½¿ç”¨çš„æ˜¯ MapStruct å·¥å…·è¿›è¡Œè½¬æ¢ï¼ŒMapStruct åŸç†ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨ä»£ç ç¼–è¯‘é˜¶æ®µç”Ÿæˆå¯¹åº”çš„èµ‹å€¼ä»£ç ï¼Œåº•å±‚åŸç†è¿˜æ˜¯è°ƒç”¨getter/setteræ–¹æ³•ï¼Œä½†æ˜¯è¿™æ˜¯ç”±å·¥å…·æ›¿æˆ‘ä»¬å®Œæˆï¼ŒMapStructåœ¨ä¸å½±å“æ€§èƒ½çš„æƒ…å†µä¸‹ï¼Œè§£å†³äº†å‰é¢ä¸¤ç§æ–¹å¼å¼Šç«¯ï¼Œå¾ˆèµ~</p><a id="more"></a><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p>ä¸ºäº†è®²è§£ MapStruct å·¥å…·çš„ä½¿ç”¨ï¼Œæœ¬æ–‡ä½¿ç”¨å¸¸è§çš„ User ç±»ä»¥åŠå¯¹åº” UserDto å¯¹è±¡æ¥æ¼”ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@Accessors(chain = true)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String password; <span class="hljs-comment">// å¯†ç </span><br>    <span class="hljs-keyword">private</span> Integer sex;  <span class="hljs-comment">// æ€§åˆ«</span><br>    <span class="hljs-keyword">private</span> LocalDate birthday; <span class="hljs-comment">// ç”Ÿæ—¥</span><br>    <span class="hljs-keyword">private</span> LocalDateTime createTime; <span class="hljs-comment">// åˆ›å»ºæ—¶é—´</span><br>    <span class="hljs-keyword">private</span> String config; <span class="hljs-comment">// å…¶ä»–æ‰©å±•ä¿¡æ¯ï¼Œä»¥JSONæ ¼å¼å­˜å‚¨</span><br>  <span class="hljs-keyword">private</span> String test; <span class="hljs-comment">// æµ‹è¯•å­—æ®µ</span><br>&#125;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@Accessors(chain = true)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserVo</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String username;<br>    <span class="hljs-keyword">private</span> String password;<br>    <span class="hljs-keyword">private</span> Integer gender;<br>    <span class="hljs-keyword">private</span> LocalDate birthday;<br>    <span class="hljs-keyword">private</span> String createTime;<br>    <span class="hljs-keyword">private</span> List&lt;UserConfig&gt; config;<br>  <span class="hljs-keyword">private</span> String test; <span class="hljs-comment">// æµ‹è¯•å­—æ®µ</span><br>    <span class="hljs-meta">@Data</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserConfig</span> </span>&#123;<br>        <span class="hljs-keyword">private</span> String field1;<br>        <span class="hljs-keyword">private</span> Integer field2;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„è§‚å¯Ÿè¿™ä¸¤ä¸ªç±»çš„åŒºåˆ«ã€‚</p><h2 id="ä¸€ã€MapStruct-é…ç½®ä»¥åŠåŸºç¡€ä½¿ç”¨"><a href="#ä¸€ã€MapStruct-é…ç½®ä»¥åŠåŸºç¡€ä½¿ç”¨" class="headerlink" title="ä¸€ã€MapStruct é…ç½®ä»¥åŠåŸºç¡€ä½¿ç”¨"></a>ä¸€ã€MapStruct é…ç½®ä»¥åŠåŸºç¡€ä½¿ç”¨</h2><p>é¡¹ç›®ä¸­å¼•å…¥ MapStruct çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mapstruct<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mapstruct<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3.1.Final<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mapstruct<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mapstruct-processor<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3.1.Final<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>å› ä¸ºé¡¹ç›®ä¸­çš„å¯¹è±¡è½¬æ¢æ“ä½œåŸºæœ¬éƒ½ä¸€æ ·ï¼Œå› æ­¤æŠ½å–é™¤äº†ä¸€ä¸ªè½¬æ¢åŸºç±»ï¼Œä¸åŒå¯¹è±¡å¦‚æœåªæ˜¯ç®€å•è½¬æ¢å¯ä»¥ç›´æ¥ç»§æ‰¿è¯¥åŸºç±»ï¼Œè€Œæ— éœ€è¦†å†™åŸºç±»ä»»ä½•æ–¹æ³•ï¼Œå³åªéœ€è¦ä¸€ä¸ªç©ºç±»å³å¯ã€‚å¦‚æœå­ç±»è¦†å†™äº†åŸºç±»çš„æ–¹æ³•ï¼Œåˆ™åŸºç±»ä¸Šçš„ <strong>@Mapping</strong> ä¼šå¤±æ•ˆã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@MapperConfig</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BaseMapping</span>&lt;<span class="hljs-title">SOURCE</span>, <span class="hljs-title">TARGET</span>&gt; </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ˜ å°„åŒåå±æ€§</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Mapping(target = &quot;createTime&quot;, dateFormat = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span><br>    <span class="hljs-function">TARGET <span class="hljs-title">sourceToTarget</span><span class="hljs-params">(SOURCE var1)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åå‘ï¼Œæ˜ å°„åŒåå±æ€§</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@InheritInverseConfiguration(name = &quot;sourceToTarget&quot;)</span><br>    <span class="hljs-function">SOURCE <span class="hljs-title">targetToSource</span><span class="hljs-params">(TARGET var1)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ˜ å°„åŒåå±æ€§ï¼Œé›†åˆå½¢å¼</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@InheritConfiguration(name = &quot;sourceToTarget&quot;)</span><br>    <span class="hljs-function">List&lt;TARGET&gt; <span class="hljs-title">sourceToTarget</span><span class="hljs-params">(List&lt;SOURCE&gt; var1)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åå‘ï¼Œæ˜ å°„åŒåå±æ€§ï¼Œé›†åˆå½¢å¼</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@InheritConfiguration(name = &quot;targetToSource&quot;)</span><br>    <span class="hljs-function">List&lt;SOURCE&gt; <span class="hljs-title">targetToSource</span><span class="hljs-params">(List&lt;TARGET&gt; var1)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ˜ å°„åŒåå±æ€§ï¼Œé›†åˆæµå½¢å¼</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function">List&lt;TARGET&gt; <span class="hljs-title">sourceToTarget</span><span class="hljs-params">(Stream&lt;SOURCE&gt; stream)</span></span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åå‘ï¼Œæ˜ å°„åŒåå±æ€§ï¼Œé›†åˆæµå½¢å¼</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function">List&lt;SOURCE&gt; <span class="hljs-title">targetToSource</span><span class="hljs-params">(Stream&lt;TARGET&gt; stream)</span></span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å®ç° User ä¸ UserVo å¯¹è±¡çš„è½¬æ¢å™¨</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.mapstruct.Mapper;<br><span class="hljs-keyword">import</span> org.mapstruct.Mapping;<br><br><span class="hljs-meta">@Mapper(componentModel = &quot;spring&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserMapping</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">BaseMapping</span>&lt;<span class="hljs-title">User</span>, <span class="hljs-title">UserVo</span>&gt; </span>&#123;<br><br>    <span class="hljs-meta">@Mapping(target = &quot;gender&quot;, source = &quot;sex&quot;)</span><br>    <span class="hljs-meta">@Mapping(target = &quot;createTime&quot;, dateFormat = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function">UserVo <span class="hljs-title">sourceToTarget</span><span class="hljs-params">(User var1)</span></span>;<br><br>    <span class="hljs-meta">@Mapping(target = &quot;sex&quot;, source = &quot;gender&quot;)</span><br>    <span class="hljs-meta">@Mapping(target = &quot;password&quot;, ignore = true)</span><br>    <span class="hljs-meta">@Mapping(target = &quot;createTime&quot;, dateFormat = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function">User <span class="hljs-title">targetToSource</span><span class="hljs-params">(UserVo var1)</span></span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">default</span> List&lt;UserConfig&gt; <span class="hljs-title">strConfigToListUserConfig</span><span class="hljs-params">(String config)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> JSON.parseArray(config, UserConfig.class);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">default</span> String <span class="hljs-title">listUserConfigToStrConfig</span><span class="hljs-params">(List&lt;UserConfig&gt; list)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> JSON.toJSONString(list);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æœ¬æ–‡ç¤ºä¾‹ä½¿ç”¨çš„æ˜¯ Spring çš„æ–¹å¼ï¼Œ@Mapper æ³¨è§£çš„ componentModel å±æ€§å€¼ä¸º springï¼Œä¸è¿‡åº”è¯¥å¤§å¤šæ•°éƒ½ç”¨çš„æ­¤æ¨¡å¼è¿›è¡Œå¼€å‘ã€‚</p><p>@Mappingç”¨äºé…ç½®å¯¹è±¡çš„æ˜ å°„å…³ç³»ï¼Œç¤ºä¾‹ä¸­ User å¯¹è±¡æ€§åˆ«å±æ€§åä¸º sexï¼Œè€ŒUserVoå¯¹è±¡æ€§åˆ«å±æ€§åä¸ºgenderï¼Œå› æ­¤éœ€è¦é…ç½® target ä¸ source å±æ€§ã€‚</p><p>password å­—æ®µä¸åº”è¯¥è¿”å›åˆ°å‰å°ï¼Œå¯ä»¥é‡‡å–ä¸¤ç§æ–¹å¼ä¸è¿›è¡Œè½¬æ¢ï¼Œç¬¬ä¸€ç§å°±æ˜¯åœ¨voå¯¹è±¡ä¸­ä¸å‡ºç°passwordå­—æ®µï¼Œç¬¬äºŒç§å°±æ˜¯åœ¨@Mappingä¸­è®¾ç½®è¯¥å­—æ®µ ignore = trueã€‚</p><p>MapStruct æä¾›äº†æ—¶é—´æ ¼å¼åŒ–çš„å±æ€§ <strong>dataFormat</strong>ï¼Œæ”¯æŒDateã€LocalDateã€LocalDateTimeç­‰æ—¶é—´ç±»å‹ä¸Stringçš„è½¬æ¢ã€‚ç¤ºä¾‹ä¸­birthday å±æ€§ä¸º LocalDate ç±»å‹ï¼Œå¯ä»¥æ— éœ€æŒ‡å®šdataFormatè‡ªåŠ¨å®Œæˆè½¬æ¢ï¼Œè€ŒLocalDateTimeç±»å‹é»˜è®¤ä½¿ç”¨çš„æ˜¯ISOæ ¼å¼æ—¶é—´ï¼Œåœ¨å›½å†…å¾€å¾€ä¸ç¬¦åˆéœ€æ±‚ï¼Œå› æ­¤éœ€è¦æ‰‹åŠ¨æŒ‡å®šä¸€ä¸‹ dataFormatã€‚</p><h2 id="äºŒã€è‡ªå®šä¹‰å±æ€§ç±»å‹è½¬æ¢æ–¹æ³•"><a href="#äºŒã€è‡ªå®šä¹‰å±æ€§ç±»å‹è½¬æ¢æ–¹æ³•" class="headerlink" title="äºŒã€è‡ªå®šä¹‰å±æ€§ç±»å‹è½¬æ¢æ–¹æ³•"></a>äºŒã€è‡ªå®šä¹‰å±æ€§ç±»å‹è½¬æ¢æ–¹æ³•</h2><p>ä¸€èˆ¬å¸¸ç”¨çš„ç±»å‹å­—æ®µè½¬æ¢ MapStructéƒ½èƒ½æ›¿æˆ‘ä»¬å®Œæˆï¼Œä½†æ˜¯æœ‰ä¸€äº›æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„å¯¹è±¡ç±»å‹ï¼ŒMapStructå°±ä¸èƒ½è¿›è¡Œå­—æ®µè½¬æ¢ï¼Œè¿™å°±éœ€è¦æˆ‘ä»¬ç¼–å†™å¯¹åº”çš„ç±»å‹è½¬æ¢æ–¹æ³•ï¼Œç¬”è€…ä½¿ç”¨çš„æ˜¯JDK8ï¼Œæ”¯æŒæ¥å£ä¸­çš„é»˜è®¤æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨è½¬æ¢å™¨ä¸­æ·»åŠ è‡ªå®šä¹‰ç±»å‹è½¬æ¢æ–¹æ³•ã€‚</p><p>ç¤ºä¾‹ä¸­Userå¯¹è±¡çš„configå±æ€§æ˜¯ä¸€ä¸ªJSONå­—ç¬¦ä¸²ï¼ŒUserVoå¯¹è±¡ä¸­æ˜¯List<UserConfig>ç±»å‹çš„ï¼Œè¿™éœ€è¦å®ç°JSONå­—ç¬¦ä¸²ä¸å¯¹è±¡çš„äº’è½¬ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">default</span> List&lt;UserConfig&gt; <span class="hljs-title">strConfigToListUserConfig</span><span class="hljs-params">(String config)</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> JSON.parseArray(config, UserConfig.class);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">default</span> String <span class="hljs-title">listUserConfigToStrConfig</span><span class="hljs-params">(List&lt;UserConfig&gt; list)</span> </span>&#123;<br>  <span class="hljs-keyword">return</span> JSON.toJSONString(list);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¦‚æœæ˜¯ JDK8ä»¥ä¸‹çš„ï¼Œä¸æ”¯æŒé»˜è®¤æ–¹æ³•ï¼Œå¯ä»¥å¦å¤–å®šä¹‰ä¸€ä¸ª è½¬æ¢å™¨ï¼Œç„¶åå†å½“å‰è½¬æ¢å™¨çš„ @Mapper ä¸­é€šè¿‡ uses = XXX.class è¿›è¡Œå¼•ç”¨ã€‚</p><p>å®šä¹‰å¥½æ–¹æ³•ä¹‹åï¼ŒMapStructå½“åŒ¹é…åˆ°åˆé€‚ç±»å‹çš„å­—æ®µæ—¶ï¼Œä¼šè°ƒç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„è½¬æ¢æ–¹æ³•è¿›è¡Œè½¬æ¢ã€‚</p><h2 id="ä¸‰ã€å•å…ƒæµ‹è¯•"><a href="#ä¸‰ã€å•å…ƒæµ‹è¯•" class="headerlink" title="ä¸‰ã€å•å…ƒæµ‹è¯•"></a>ä¸‰ã€å•å…ƒæµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Slf4j</span><br><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MapStructTest</span> </span>&#123;<br><br>  <span class="hljs-meta">@Resource</span><br>  <span class="hljs-keyword">private</span> UserMapping userMapping;<br><br>  <span class="hljs-meta">@Test</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tetDomain2DTO</span><span class="hljs-params">()</span> </span>&#123;<br>    User user = <span class="hljs-keyword">new</span> User()<br>      .setId(<span class="hljs-number">1L</span>)<br>      .setUsername(<span class="hljs-string">&quot;zhangsan&quot;</span>)<br>      .setSex(<span class="hljs-number">1</span>)<br>      .setPassword(<span class="hljs-string">&quot;abc123&quot;</span>)<br>      .setCreateTime(LocalDateTime.now())<br>      .setBirthday(LocalDate.of(<span class="hljs-number">1999</span>, <span class="hljs-number">9</span>, <span class="hljs-number">27</span>))<br>      .setConfig(<span class="hljs-string">&quot;[&#123;\&quot;field1\&quot;:\&quot;Test Field1\&quot;,\&quot;field2\&quot;:500&#125;]&quot;</span>);<br>    UserVo userVo = userMapping.sourceToTarget(user);<br>    log.info(<span class="hljs-string">&quot;User: &#123;&#125;&quot;</span>, user);<br>    <span class="hljs-comment">//        User: User(id=1, username=zhangsan, password=abc123, sex=1, birthday=1999-09-27, createTime=2020-01-17T17:46:20.316, config=[&#123;&quot;field1&quot;:&quot;Test Field1&quot;,&quot;field2&quot;:500&#125;])</span><br>    log.info(<span class="hljs-string">&quot;UserVo: &#123;&#125;&quot;</span>, userVo);<br>    <span class="hljs-comment">//        UserVo: UserVo(id=1, username=zhangsan, gender=1, birthday=1999-09-27, createTime=2020-01-17 17:46:20, config=[UserVo.UserConfig(field1=Test Field1, field2=500)])</span><br>  &#125;<br><br>  <span class="hljs-meta">@Test</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testDTO2Domain</span><span class="hljs-params">()</span> </span>&#123;<br>    UserConfig userConfig = <span class="hljs-keyword">new</span> UserConfig();<br>    userConfig.setField1(<span class="hljs-string">&quot;Test Field1&quot;</span>);<br>    userConfig.setField2(<span class="hljs-number">500</span>);<br><br>    UserVo userVo = <span class="hljs-keyword">new</span> UserVo()<br>      .setId(<span class="hljs-number">1L</span>)<br>      .setUsername(<span class="hljs-string">&quot;zhangsan&quot;</span>)<br>      .setGender(<span class="hljs-number">2</span>)<br>      .setCreateTime(<span class="hljs-string">&quot;2020-01-18 15:32:54&quot;</span>)<br>      .setBirthday(LocalDate.of(<span class="hljs-number">1999</span>, <span class="hljs-number">9</span>, <span class="hljs-number">27</span>))<br>      .setConfig(Collections.singletonList(userConfig));<br>    User user = userMapping.targetToSource(userVo);<br>    log.info(<span class="hljs-string">&quot;UserVo: &#123;&#125;&quot;</span>, userVo);<br>    <span class="hljs-comment">//        UserVo: UserVo(id=1, username=zhangsan, gender=2, birthday=1999-09-27, createTime=2020-01-18 15:32:54, config=[UserVo.UserConfig(field1=Test Field1, field2=500)])</span><br>    log.info(<span class="hljs-string">&quot;User: &#123;&#125;&quot;</span>, user);<br>    <span class="hljs-comment">//        User: User(id=1, username=zhangsan, password=null, sex=2, birthday=1999-09-27, createTime=2020-01-18T15:32:54, config=[&#123;&quot;field1&quot;:&quot;Test Field1&quot;,&quot;field2&quot;:500&#125;])</span><br>  &#125;<br></code></pre></div></td></tr></table></figure><h2 id="å››ã€å¸¸è§é—®é¢˜"><a href="#å››ã€å¸¸è§é—®é¢˜" class="headerlink" title="å››ã€å¸¸è§é—®é¢˜"></a>å››ã€å¸¸è§é—®é¢˜</h2><ol><li>å½“ä¸¤ä¸ªå¯¹è±¡å±æ€§ä¸ä¸€è‡´æ—¶ï¼Œæ¯”å¦‚Userå¯¹è±¡ä¸­æŸä¸ªå­—æ®µä¸å­˜åœ¨ä¸UserVoå½“ä¸­æ—¶ï¼Œåœ¨ç¼–è¯‘æ—¶ä¼šæœ‰è­¦å‘Šæç¤ºï¼Œå¯ä»¥åœ¨@Mappingä¸­é…ç½® ignore = trueï¼Œå½“å­—æ®µè¾ƒå¤šæ—¶ï¼Œå¯ä»¥ç›´æ¥åœ¨@Mapperä¸­è®¾ç½®unmappedTargetPolicyå±æ€§æˆ–è€…unmappedSourcePolicyå±æ€§ä¸º ReportingPolicy.IGNOREå³å¯ã€‚</li><li>å¦‚æœé¡¹ç›®ä¸­ä¹ŸåŒæ—¶ä½¿ç”¨åˆ°äº† Lombokï¼Œä¸€å®šè¦æ³¨æ„ Lombokçš„ç‰ˆæœ¬è¦ç­‰äºæˆ–è€…é«˜äº<strong>1.18.10</strong>ï¼Œå¦åˆ™ä¼šæœ‰ç¼–è¯‘ä¸é€šè¿‡çš„æƒ…å†µå‘ç”Ÿï¼Œç¬”è€…æ‰è¿›è¿™ä¸ªå‘å¾ˆä¹…æ‰çˆ¬äº†å‡ºæ¥ï¼Œå¸Œæœ›å„ä½ä¸è¦é‡å¤è¸©å‘ã€‚</li></ol><h2 id="ä»£ç ä¸‹è½½"><a href="#ä»£ç ä¸‹è½½" class="headerlink" title="ä»£ç ä¸‹è½½"></a>ä»£ç ä¸‹è½½</h2><p>æœ¬æ–‡æ¶‰åŠä»£ç å·²ä¸Šä¼ åˆ° Githubï¼Œä»¥ä¾›å‚è€ƒã€‚</p><ul><li><a href="https://github.com/Mosiki/learning-modules/tree/master/learning-mapstruct">mapstructæœ€ä½³å®è·µç¤ºä¾‹ä»£ç </a></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://mapstruct.org/documentation/stable/reference/html/">å®˜æ–¹æ–‡æ¡£ï¼šhttps://mapstruct.org/documentation/stable/reference/html/</a></li><li><a href="https://mapstruct.org/faq/">å®˜æ–¹FAQï¼šhttps://mapstruct.org/faq/</a></li><li><a href="https://github.com/mapstruct/mapstruct-examples">å®˜æ–¹Exampleï¼šhttps://github.com/mapstruct/mapstruct-examples</a></li><li><a href="http://www.kailing.pub/MapStruct1.3/index.html">æœºç¿»ä¸­æ–‡ç‰ˆæ–‡æ¡£ï¼šhttp://www.kailing.pub/MapStruct1.3/index.html</a></li><li><a href="https://www.cnblogs.com/javaguide/p/11861749.html">5ç§å¸¸è§Beanæ˜ å°„å·¥å…·çš„æ€§èƒ½æ¯”å¯¹ï¼šhttps://www.cnblogs.com/javaguide/p/11861749.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mapstructè‡ªå®šä¹‰ç±»å‹è½¬æ¢</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®åº“ä¸åº”ç”¨æœåŠ¡å™¨æ—¶é—´ä¸åŒæ­¥è¸©å‘è®°</title>
    <link href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%97%B6%E9%97%B4%E4%B8%8D%E5%90%8C%E6%AD%A5%E8%B8%A9%E5%9D%91%E8%AE%B0.html"/>
    <url>/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%97%B6%E9%97%B4%E4%B8%8D%E5%90%8C%E6%AD%A5%E8%B8%A9%E5%9D%91%E8%AE%B0.html</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸šåŠ¡è¯´æ˜"><a href="#ä¸šåŠ¡è¯´æ˜" class="headerlink" title="ä¸šåŠ¡è¯´æ˜"></a>ä¸šåŠ¡è¯´æ˜</h2><p>è¿™æ ·ä¸€ä¸ªä¸šåŠ¡åœºæ™¯ï¼Œæœ‰ä¸€ä¸ªæŠ½å¥–æ´»åŠ¨ï¼ŒæŠ½å¥–æ´»åŠ¨ä¸­å¦‚æœå®Œæˆä¸€æ¬¡åˆ†äº«çš„ä»»åŠ¡ï¼Œå°±ä¼šå¢åŠ ä¸€æ¬¡æŠ½å¥–æœºä¼šã€‚<br>å‰ç«¯åˆ¤æ–­ç”¨æˆ·åˆ†äº«æˆåŠŸåï¼Œä¼šè°ƒç”¨ä¸€æ¬¡ä¿å­˜åˆ†äº«è®°å½•çš„æ¥å£ï¼Œå°†åˆ†äº«è®°å½•å…¥åº“ã€‚<br>å®Œæˆåï¼Œå‰ç«¯ä¼šè°ƒç”¨è·å–è°ƒç”¨æŸ¥è¯¢ã€æ´»åŠ¨ä»»åŠ¡å¯å®Œæˆæ¬¡æ•°ã€‘æ¥å£ï¼Œå¦‚æœä»»åŠ¡å¯å®Œæˆæ¬¡æ•°ä¸º0ï¼Œåˆ™ç½®ç°åˆ†äº«æŒ‰é’®ã€‚</p><a id="more"></a><p><a href="http://nullpointer.pw/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%97%B6%E9%97%B4%E4%B8%8D%E5%90%8C%E6%AD%A5%E8%B8%A9%E5%9D%91%E8%AE%B0.html">æœ¬æ–‡åŸæ–‡é“¾æ¥åœ°å€: http://nullpointer.pw/æ•°æ®åº“ä¸åº”ç”¨æœåŠ¡å™¨æ—¶é—´ä¸åŒæ­¥è¸©å‘è®°.html</a></p><p>å¦‚å›¾æ‰€ç¤ºï¼š<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200108202842.png"></p><h2 id="å®šä½é—®é¢˜"><a href="#å®šä½é—®é¢˜" class="headerlink" title="å®šä½é—®é¢˜"></a>å®šä½é—®é¢˜</h2><p>æµ‹è¯•ç»™æˆ‘æäº†ä¸€ä¸ª BUGï¼Œåœ¨<strong>æµ‹è¯•ç¯å¢ƒ</strong>ï¼Œå®Œæˆåˆ†äº«ä»»åŠ¡åï¼Œé‡æ–°è°ƒç”¨ã€æ´»åŠ¨ä»»åŠ¡å¯å®Œæˆæ¬¡æ•°ã€‘åï¼Œå‘ç°æ¥å£è¿”å›å¯å®Œæˆæ¬¡æ•°ä»ç„¶æ˜¯ 1ï¼Œ<br>ä½†æ˜¯è¿‡äº†å¥½å‡ åˆ†é’Ÿåï¼Œé‡æ–°è¿›å…¥æ´»åŠ¨é¡µï¼Œæ¥å£è¿”å›äº†å¯å®Œæˆæ¬¡æ•°ä¸º 0ï¼Œåˆ†äº«æŒ‰é’®ä¹Ÿå·²ç»ç½®ç°ä¸å¯ç‚¹å‡»ã€‚</p><p>è¿™å°±å¾ˆå¥‡æ€ªäº†ï¼Œä¸€å¼€å§‹æ€€ç–‘æ˜¯ç¼“å­˜çš„é—®é¢˜ï¼Œç»“æœå¹¶ä¸æ˜¯ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒè¿œç¨‹ Debug åå‘ç°ï¼Œæ¯æ¬¡åˆ†äº«æˆåŠŸåï¼ŒæŸ¥è¯¢æ•°æ®åº“åˆ†äº«ä»»åŠ¡çš„å®Œæˆæ¬¡æ•°ç«Ÿç„¶æ²¡æœ‰æŸ¥è¯¢åˆ°æ•°æ®ï¼Œ<br>è€Œæ•°æ®ä¸­ç¡®å®å­˜åœ¨äº†åˆ†äº«çš„è®°å½•ï¼Œå°†æŸ¥è¯¢ SQL å’ŒæŸ¥è¯¢å‚æ•°å–å‡ºæ¥æ”¾åˆ° Navicat ä¸­ä¸€æŸ¥ï¼Œç»“æœæ˜¯å› ä¸ºæ—¶é—´åŒºé—´ç­›é€‰æ‰äº†åˆ†äº«çš„é‚£æ¡è®°å½•ã€‚<br>SQL å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> t_share_record <span class="hljs-keyword">where</span> uid <span class="hljs-operator">=</span> &quot;1234567&quot; <span class="hljs-keyword">and</span> activity_id <span class="hljs-operator">=</span> <span class="hljs-number">38867247</span><br> <span class="hljs-keyword">and</span> create_time <span class="hljs-keyword">between</span> <span class="hljs-string">&#x27;2020-01-08 00:00:00&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;2020-01-08 19:18:29&#x27;</span> <br></code></pre></div></td></tr></table></figure><p>è€Œæ•°æ®åº“ä¸­çš„é‚£æ¡åˆ†äº«è®°å½•çš„create_time æ˜¯  <strong>2020-01-08 19:19:21</strong>ï¼Œ è¿™æ¡è®°å½•ä¸åœ¨ç­›é€‰çš„æ—¶é—´åŒºé—´å†…ï¼Œå› è€Œè¢«è¿‡æ»¤æ‰äº†ã€‚</p><h2 id="é—®é¢˜åŸå› "><a href="#é—®é¢˜åŸå› " class="headerlink" title="é—®é¢˜åŸå› "></a>é—®é¢˜åŸå› </h2><p>æ—¶åºå›¾å¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200112145944.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œåˆ†äº«ä¿å­˜è®°å½•ä¸ºç¬¬ 8 æ­¥ï¼Œä½†æ˜¯é‡æ–°æŸ¥è¯¢ä»»åŠ¡å¯å®Œæˆæ¥å£æ˜¯ç¬¬ 10 æ­¥ï¼Œä½†ç›®å‰çš„æƒ…å†µåˆ™æ˜¯ï¼Œç¬¬10æ­¥ä¸­æŸ¥è¯¢æ—¶çš„æ—¶é—´ç«Ÿç„¶è¦æ—©äºç¬¬ 8 æ­¥æ•°æ®å…¥åº“çš„æ—¶é—´ã€‚éš¾é“æ’å…¥æ•°æ®ç«Ÿç„¶è¦è¿™ä¹ˆä¹…ï¼Ÿä¹Ÿä¸è‡³äºè€—è´¹è¿‘ä¸€åˆ†é’Ÿå§ï¼</p><p>äºæ˜¯æ€€ç–‘æ˜¯æ•°æ®åº“æ—¶é—´é—®é¢˜ï¼Œåœ¨MySQLæ‰§è¡ŒæŸ¥è¯¢å‘½ä»¤</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> now();<br></code></pre></div></td></tr></table></figure><p>ç„¶åï¼Œåœ¨éƒ¨ç½²åº”ç”¨çš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œå‘½ä»¤</p><figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">date<br></code></pre></div></td></tr></table></figure><p>æŸ¥çœ‹ç»“æœï¼Œæœç„¶äºŒè€…æ—¶é—´ç›¸å·®äº†è¿‘ä¸€åˆ†é’Ÿã€‚æœ€ç»ˆçš„åŸå› å°±æ˜¯ï¼šå› ä¸ºæ•°æ®åº“å’Œåº”ç”¨æœåŠ¡å™¨ä¸åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œè€Œå…¶ä»–æµ‹è¯•äººå‘˜ä¿®æ”¹äº†åº”ç”¨æœåŠ¡å™¨çš„æ—¶é—´ï¼Œå¯¼è‡´ä¸¤ä¸ªæœåŠ¡å™¨æ—¶é—´ä¸ä¸€è‡´ä»è€Œå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚æƒ³åˆ°è¿™é‡Œï¼Œé©¬ä¸Šå‘è¿ç»´ç¡®è®¤çº¿ä¸ŠæœåŠ¡å™¨æ—¶é—´ä¸æ•°æ®åº“æ—¶é—´æ˜¯å¦åŒæ­¥ï¼Œè¿˜å¥½ï¼Œå›ç­”æˆ‘çš„æ˜¯åŒæ­¥çš„ï¼Œå¿ƒé‡Œçš„çŸ³å¤´ç®—æ”¾ä¸‹äº†ã€‚</p><h2 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h2><p>æŸ¥çœ‹æ’å…¥åˆ†äº«è®°å½•çš„ Mybatis ä¸­XMLå¦‚ä¸‹</p><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql">insert into t_share_record(uid, activity_id, create_time) values(#&#123;uid&#125;, #&#123;activityId&#125;, now())<br></code></pre></div></td></tr></table></figure><p>è¿™æ ·å†™æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯æ ¹æ®æ—¶é—´æ®µç­›é€‰æ•°æ®æ—¶ï¼Œæ—¶é—´åŒºé—´å´åˆæ˜¯ä»åº”ç”¨æœåŠ¡å™¨ç”Ÿæˆä¼ é€’å‚æ•°ä¼ å…¥SQLçš„ï¼ŒMybatis ä¸­XMLå¦‚ä¸‹ï¼š</p><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql">SELECT * from t_share_record where uid = #&#123;uid&#125; and activity_id = #&#123;activityId&#125;<br> and create_time between #&#123;beginTime&#125; and #&#123;endTime&#125;<br></code></pre></div></td></tr></table></figure><p>ä¸ºäº†é¿å…ä»¥ä¸Šè¿™ç§å› ä¸ºåº”ç”¨æœåŠ¡å™¨ä¸æ•°æ®åº“æ—¶é—´ä¸ä¸€è‡´å¯¼è‡´çš„é—®é¢˜ï¼Œè¿™é‡Œçš„SQLç­›é€‰æ—¶é—´çš„ç»“æŸæ—¶é—´ä¹Ÿé€šè¿‡æ•°æ®åº“æœåŠ¡å™¨è·å–ã€‚</p><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql">SELECT * from t_share_record where uid = #&#123;uid&#125; and activity_id = #&#123;activityId&#125;<br> and create_time between #&#123;beginTime&#125; and now()<br></code></pre></div></td></tr></table></figure><p>å½“ç„¶ï¼Œä¸ºäº†é˜²æ­¢å‡ºç°æ›´å¤šç±»ä¼¼çš„é—®é¢˜ï¼Œåº”ç”¨æœåŠ¡å™¨ä¸æ•°æ®åº“æœåŠ¡å™¨çš„æ—¶é—´ä¸€å®šè¦é€šè¿‡æ—¶é—´åŒæ­¥è®¾ç½®ä¿æŒå®Œå…¨ä¸€è‡´æ‰æ˜¯æœ€åˆç†çš„ã€‚</p><p>å¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è§£å†³æ•°æ®åº“ä¸åº”ç”¨æœåŠ¡å™¨æ—¶é—´ä¸åŒæ­¥å¯¼è‡´çš„é—®é¢˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2019å¹´ç»ˆæ€»ç»“</title>
    <link href="/2019%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93.html"/>
    <url>/2019%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93.html</url>
    
    <content type="html"><![CDATA[<p>æ¥æ­å·ä¸è¶³ä¸€å¹´ï¼Œæˆ‘å°±æ‹¥æœ‰äº† M å‹å‘å‹ï¼Œä¸çŸ¥é“è¯¥å–œè¿˜æ˜¯å¿§ï¼Œä»Šå¤©ä¸ºè¿™è‹¦é€¼çš„ä¸€å¹´ç”»ä¸Šå¥å·ï¼Œå¸Œæœ› 2020 å¹´èƒ½ä¸å¦‚æ­¤è‹¦é€¼å§ï¼æœ¬æ¥è®¡åˆ’ç€ 2019 å¹´ 12 æœˆ 29 æ—¥å†™å®Œçš„å¹´ç»ˆæ€»ç»“ï¼Œè‡ªå·±æ‹–æ‹–æ‹‰æ‹‰æåˆ°ä»Šå¤©æ‰ç®—å†™å®Œã€‚</p><a id="more"></a><p>ä¸‰æœˆä»½ä»åŒ—äº¬ç¦»å¼€ï¼Œæœ¬æ„æ˜¯è·³å‡ºè‡ªå·±çš„èˆ’é€‚åŒºï¼Œæ­å·ä»Šå¹´å´è¿˜æ²¡æœ‰ä¸‹è¿‡é›ªï¼Œå€’æ˜¯æœ€è¿‘æ€»æ˜¯æ·…æ·…æ²¥æ²¥åœ°ä¸‹å°é›¨ï¼Œç»™äººæ¹¿å†·æ¹¿å†·çš„æ„Ÿè§‰ï¼Œæ¥åˆ°æ­å·å‘ç°è¿™è¾¹çš„ç¯å¢ƒæœç„¶è®©æˆ‘å¾ˆä¸èˆ’é€‚ã€‚  </p><p>ä¸ä»…ä»…æ˜¯æ°”å€™ç¯å¢ƒã€‚ã€‚ã€‚  </p><p>ä¸è¿‡ï¼Œæ¥äº†æ­å·ç¡®å®è®©è‡ªå·±èº«ä¸Šçš„ç¼ºç‚¹æš´éœ²å‡ºæ¥ï¼Œåœ¨æ–°çš„å…¬å¸å·¥ä½œæ—¶ï¼Œä¹Ÿå‘ç°äº†è‡ªå·±æŸäº›èƒ½åŠ›çš„æ¬ ç¼ºï¼Œæœç„¶æœ€è®©è‡ªå·±å®³æ€•çš„å°±æ˜¯è‡ªå·±æœ€è–„å¼±çš„åœ°æ–¹ï¼Œæ‰¾åˆ°è‡ªå·±çš„ä¸è¶³å¹¶å»åŠªåŠ›æå‡æ”¹è¿›ï¼Œæˆ–è®¸æ˜¯æˆ‘æ¥åšå‡ºæ¥æ­å·è¿™ä¸ªé€‰æ‹©ï¼Œå”¯ä¸€å€¼å¾—æ¬¢å–œä¹‹å¤„å§ï¼</p><h2 id="æŠ€æœ¯"><a href="#æŠ€æœ¯" class="headerlink" title="æŠ€æœ¯"></a>æŠ€æœ¯</h2><p>å°±æˆ‘ä¸ªäººæœ¬èº«è€Œè¨€ï¼Œå­¦ä¹ æ–°çš„ä¸œè¥¿èƒ½å­¦ä¸‹å»çš„åŸºæœ¬ä¸Šæ˜¯æˆ‘ä¸å¾—ä¸å­¦çš„ï¼Œè¿˜æœ‰å°±æ˜¯æˆ‘çœŸçš„ç‰¹åˆ«æ„Ÿå…´è¶£çš„ã€‚è¿™çœ‹ç€å¥½åƒé—®é¢˜ä¸å¤§ï¼Ÿä¸å¾—ä¸å­¦çš„å¤§éƒ¨åˆ†éƒ½æ˜¯å·¥ä½œä¸­éœ€è¦ç”¨åˆ°çš„ï¼Œè¿˜æœ‰éœ€è¦æ•™å¯¼åˆ«äººçš„ï¼Œå­¦äº†å°±èƒ½æ´¾ä¸Šç”¨åœºï¼Œæ•ˆæœæœ€å¥½ã€‚ä½†æ˜¯äº‹å®æ˜¯ï¼Œèƒ½é©¬ä¸Šå­¦ä¼šå¹¶ä¸”èƒ½åº”ç”¨çš„æŠ€æœ¯ï¼Œå¤ªè¿‡äºæµ®äºè¡¨é¢ï¼Œè€Œè¿™äº›æŠ€æœ¯æ›´æ·±å±‚é¢çš„ä¸œè¥¿æ‰æ˜¯ç²¾é«“æ‰€åœ¨ï¼Œè€Œè‡ªå·±å´å¾€å¾€æ€»æ˜¯å¿½ç•¥äº†è¿™ä¸€ç‚¹ï¼Œ</p><p>åœ¨æŸäº›æ—¶åˆ»ï¼Œè™šå¼±çš„å†…åŠŸè®©æˆ‘ä¸å ªä¸€å‡»ã€‚</p><p>æ¥å¹´éœ€æ²‰ä¸‹å¿ƒæ¥ï¼Œå­¦ä¹ æ›´æ·±å±‚æ¬¡ï¼Œ<strong>ç›¸ä¿¡åˆ»æ„ç»ƒä¹ ï¼Œæ²¡æœ‰ä»€ä¹ˆæ˜¯å­¦ä¸ä¼šçš„ã€‚</strong></p><h2 id="æ—¶é—´ç®¡ç†"><a href="#æ—¶é—´ç®¡ç†" class="headerlink" title="æ—¶é—´ç®¡ç†"></a>æ—¶é—´ç®¡ç†</h2><p>ä»ä»Šå¹´ 9 æœˆä»½å¼€å§‹ï¼Œå½¢æˆäº†æ¯æ—¥æ€»ç»“çš„ä¹ æƒ¯ï¼Œä»ä¸€å¼€å§‹çš„æµæ°´è´¦åˆ°é€æ¸æ·»åŠ è‡ªå·±çš„æ€è€ƒï¼Œç›®å‰ä¹Ÿè¿ç»­äº†ä¸€ç™¾å¤šå¤©ã€‚åœ¨åšæ€»ç»“çš„è¿‡ç¨‹ä¸­å‘ç°è‡ªå·±åœ¨å¾ˆå¤šæ—¶å€™ï¼Œæ— æ³•æƒ³èµ·ä»Šå¤©ç©¶ç«Ÿåšäº†å“ªäº›å·¥ä½œã€ä»Šå¤©å‘ç”Ÿäº†å“ªäº›æœ‰è¶£çš„äº‹æƒ…ï¼Œä»Šå¤©å­¦åˆ°äº†å“ªäº›çŸ¥è¯†ï¼Œåªèƒ½ä¸ºè‡ªå·±åˆä¸€å¤©çš„ç¢Œç¢Œæ— ä¸ºåœ°è’åºŸè€Œè‡ªè´£</p><p>æ— æ—¶æ— åˆ»ï¼Œä¸°å¯Œçš„äº’è”ç½‘æ€»æ˜¯åœ¨æ¶ˆè´¹ç€æ³¨æ„åŠ›ï¼Œä¸€ä¸å°å¿ƒåŠä¸ªå°æ—¶ï¼Œä¸€ä¸ªå°æ—¶å°±è¿‡å»äº†ï¼Œè€Œæ‰‹å¤´å¾ˆæ€¥çš„äº‹æƒ…å´ä¸æ¯«æ²¡æœ‰è¿›å±•ï¼Œè¿™ä¹Ÿæ˜¯é€ æˆè‡ªå·±æ¯æ—¥è’åºŸçš„ç½ªé­ç¥¸é¦–ã€‚</p><p>äºæ˜¯ï¼Œè‡ªå·±ä¾¿å¼€å§‹å°è¯•ä¸Šç­æˆ–è€…å­¦ä¹ å¼€å¯ç•ªèŒ„é—¹é’Ÿï¼Œè¢«åŠ¨æ‰“æ–­æ€»æ˜¯ä¸å¯é¿å…ï¼Œä½†ç¡®å®æœ‰æ•ˆåœ°æ§åˆ¶äº†è‡ªå·±çš„æ³¨æ„åŠ›ï¼Œèƒ½è®©è‡ªå·±ä¸“æ³¨åšäº‹ï¼›</p><p>ä»¥å‰ä¸Šç­è‡ªå·±æ€»æ˜¯æˆ´ç€è€³æœºå¬éšæœºç®—æ³•æ¨èçš„æ­Œæ›²ï¼Œå°è¯•ç•ªèŒ„é—¹é’Ÿä¹‹åï¼Œå‘ç°æ­Œæ›²ä¹Ÿä¼šè®©è‡ªå·±çš„æ³¨æ„åŠ›æ¼‚ç§»ï¼Œäºæ˜¯ä¾¿ä¸å†å¬æ­Œæ›²ï¼Œè€Œæ˜¯æ”¹å¬å¤§è‡ªç„¶ç™½å™ªå£°ï¼ŒåŠ ä¸Šå¥³æœ‹å‹é€çš„ SONY é™å™ªè€³æœºä¸»åŠ¨é™å™ªæ•ˆæœï¼Œå¯¹å¤–ç•ŒæŠ—å¹²æ‰°èƒ½åŠ›ä¹Ÿå˜å¼ºå¾ˆå¤šã€‚</p><p>é€šè¿‡ç•ªèŒ„é—¹é’Ÿï¼Œæ‰¾åˆ°äº†è‡ªå·±æœ€é«˜æ•ˆçš„æ—¶é—´æ®µï¼Œä¹Ÿæ˜¯æ„å¤–çš„æ”¶è·ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20191229203900.png"></p><p>æ³¨æ„åŠ›å¾—åˆ°äº†ä¸€å®šçš„æ§åˆ¶ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸å¤Ÿï¼Œå› ä¸ºè¿˜æ˜¯ä¼šæœ‰å¤§æŠŠçš„ç©ºé—²æ—¶é—´è¢«ç™½ç™½æµªè´¹æ‰ã€‚æ²¡æœ‰äº§å‡ºï¼Œæ˜¯ä¸€ä»¶è®©æˆ‘æ„Ÿè§‰å¾ˆç—›è‹¦çš„äº‹æƒ…ï¼Œç‰¹åˆ«æ˜¯æ¯å‘¨å†™å‘¨æŠ¥çš„æ—¶å€™ï¼Œç—›æ„Ÿå°¤ç”šã€‚</p><p>äºæ˜¯ï¼Œæˆ‘è¸ä¸Šäº†å­¦ä¹  GTD çš„é“è·¯ï¼Œå®‰æ’å¥½ä¸‹ä¸€æ—¥çš„ä»»åŠ¡ï¼Œå°½é‡åˆ©ç”¨å¥½æ¯ä¸€å—æ—¶é—´ï¼Œä¸è¿‡è¿˜æ²¡å®è·µå¤ªä¹…ï¼Œç°åœ¨ä¾¿ä¸å¤šè¨€ã€‚</p><h2 id="ä¹ æƒ¯"><a href="#ä¹ æƒ¯" class="headerlink" title="ä¹ æƒ¯"></a>ä¹ æƒ¯</h2><p>åšæŒä¸¤å¹´å¤šå†™åšå®¢çš„ä¹ æƒ¯ï¼Œå¯èƒ½å› ä¸ºä»åŒ—äº¬ç¦»å¼€ï¼Œä¹ æƒ¯ä¹Ÿè¢«é—è½åœ¨äº†åŒ—äº¬å§ï¼ä»Šå¹´åªæ›´æ–°äº† 6 ç¯‡åšå®¢ï¼Œè¿˜æ°´äº†å‡ ç¯‡éæŠ€æœ¯ç±»æ–‡ç« ï¼Œå’Œå»å¹´ 20 å‡ ç¯‡çœŸçš„å·®è¿œäº†ã€‚å…¶å®è‡ªå·±åšå®¢é€‰é¢˜çš„ list å·²ç»è¢«æ‹‰å¾—å¾ˆé•¿äº†ï¼Œè‡ªå·±å´æ€»æ˜¯æ‰¾æ¥å£æ²¡æ—¶é—´æ‡’ç™Œå‘ä½œæ‹–å»¶ç—‡å‘ä½œä¸å»å†™ï¼Œæ¥å¹´ GTD è¦å®è·µèµ·æ¥ï¼Œå¥½ä¹ æƒ¯åº”è¯¥ä¸€ç›´ä¿æŒä¸‹å»ã€‚</p><h2 id="æ”¶è·"><a href="#æ”¶è·" class="headerlink" title="æ”¶è·"></a>æ”¶è·</h2><p>æ¥æ­å·ä¸æ»¡ä¸€å¹´ï¼Œå‘é™…çº¿åç§»äº†ä¸€å…¬åˆ†ï¼ŒçœŸçš„å¥½æ‚²ä¼¤ï¼Œç”šè‡³æœ‰ç‚¹ä¸å¤ªæ•¢ç…§é•œå­ï¼æ±‚æ¨èæŠ¤å‘å…»å‘æ´—å‘éœ²~</p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>æŠ¢ç¥¨çœŸçš„æŒºéš¾çš„ï¼Œæˆ‘ç°åœ¨æ‰æ„Ÿè§‰åˆ°ã€‚ç¦»å®¶å¤ªè¿œæœºç¥¨åˆè´µï¼Œå®³æ€•æœ€åä¸€å¤©ä¸èƒ½èµ¶å›æ¥ä¸Šç­ï¼Œæå‰æŠ¢ç¥¨ä¹Ÿæ˜¯ç§’æ²¡ï¼Œè¿™æ˜¯åœ¨åœ¨åŒ—äº¬ä»æœªæœ‰è¿‡çš„çƒ¦æ¼ã€‚</p><h2 id="ç«‹-Flag"><a href="#ç«‹-Flag" class="headerlink" title="ç«‹ Flag"></a>ç«‹ Flag</h2><p>Flag è¿˜æ˜¯ä¸€å®šè¦ç«‹çš„ï¼Œä¸‡ä¸€éƒ½å®ç°äº†å‘¢ï¼ğŸ˜à½²</p><ol><li>æ¢å¤æ¯æœˆå†™ 2 ç¯‡åšå®¢çš„ä¹ æƒ¯</li><li>æ—©ç¡æ—©èµ· 240 å¤©ï¼Œç•ªèŒ„æ•°é‡ 25 ä¸ª/å‘¨</li><li>è¯»å®Œã€Šé‡æ„ã€‹ã€ŠJava8 å®æˆ˜ã€‹ã€ŠSpring å®æˆ˜ã€‹ã€ŠSpring æºç æ·±åº¦è§£æã€‹ã€Šé¢†åŸŸé©±åŠ¨è®¾è®¡ã€‹</li><li>è¯»å®Œã€Šæå®šã€‹ã€Šæ€è€ƒï¼Œå¿«ä¸æ…¢ã€‹ã€Šç¨€ç¼ºã€‹ã€Šä¸‡å†åäº”å¹´ã€‹ã€ŠåŸåˆ™ã€‹</li></ol><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200103214813.png"></p>]]></content>
    
    
    
    <tags>
      
      <tag>å¹´ç»ˆæ€»ç»“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>easypoiå¯¼å…¥Excelæœ€ä½³å®è·µ</title>
    <link href="/easypoi%E5%AF%BC%E5%85%A5Excel%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html"/>
    <url>/easypoi%E5%AF%BC%E5%85%A5Excel%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸€ç›´ä»¥æ¥ï¼Œä½¿ç”¨EasyPOIåšäº†ä¸å°‘å¯¼å…¥å¯¼å‡ºçš„éœ€æ±‚ï¼Œä½†æ˜¯æ¯æ¬¡åšå®Œéƒ½æ˜¯ä¸´æ—¶å»çœ‹å®˜æ–¹æ–‡æ¡£ç°å­¦ç°ç”¨ï¼Œæ­£å·§æœ€è¿‘æœ‹å‹é‡åˆ°è¿™ä¹ˆä¸ªéœ€æ±‚ï¼Œç”¨åˆ°äº†EasyPOIæ¥å®Œæˆå¯¼å…¥ï¼Œæˆ‘ä¹Ÿæ­£å¥½æ•´ç†æ•´ç†EasyPOIçš„å¯¼å…¥ç”¨æ³•ã€‚</p><a id="more"></a><h2 id="æ›´æ–°æ—¥å¿—"><a href="#æ›´æ–°æ—¥å¿—" class="headerlink" title="æ›´æ–°æ—¥å¿—"></a>æ›´æ–°æ—¥å¿—</h2><blockquote><p>2020-12-10æ›´æ–°ï¼šè¯„è®ºä¸­æœ‰äººè¯´ï¼šå“¥ï¼Œä¸ºæ¯›æˆ‘çš„æ•°æ®æ ¡éªŒæ²¡ç”Ÿæ•ˆï¼Œå®Œå…¨å’Œä½ çš„ä¸€æ¯›ä¸€æ ·å•Šï¼Œè¿™ç§æƒ…å†µå¯ä»¥è€ƒè™‘æ‰‹åŠ¨å¼•å…¥ä¸€ä¸‹ hibernate-validator ä¾èµ–ï¼Œæœ€æ–°ç‰ˆçš„springbootä¸­è²Œä¼¼ç§»é™¤æ‰äº†ã€‚ç¬¬äºŒä¸ªå¯ä»¥è€ƒè™‘æ˜¯å¦æ˜¯åœ¨ VerifyHandler å®ç°ç±»ä¸­åšäº†éæ ¡éªŒç±»çš„æ“ä½œï¼Œæ¯”å¦‚å…¥åº“æ“ä½œï¼Œeasypoi ä¼šé¦–å…ˆé€šè¿‡æ³¨è§£æ ¡éªŒï¼Œå†è°ƒç”¨ VerifyHandler çš„æ ¡éªŒæ–¹æ³•ï¼Œå³ä½¿æ³¨è§£æ ¡éªŒä¸é€šè¿‡ï¼ŒVerifyHandler ç±»çš„æ–¹æ³•è¿˜æ˜¯ä¼šæ‰§è¡Œçš„ï¼Œéæ ¡éªŒç±»çš„æ“ä½œæ”¾åˆ°ExcelImportUtil æ–¹æ³•è°ƒç”¨å¤„ï¼Œå› ä¸ºå¯¼å…¥ç»“æœgetList()æ‰æ˜¯å…¨éƒ¨é€šè¿‡æ ¡éªŒçš„æ•°æ®ã€‚</p></blockquote><hr><p>éœ€æ±‚æ˜¯è¿™æ ·çš„ï¼šç°åœ¨è¦åœ¨åå°å¯¼å…¥ç”¨æˆ·çš„ç®€å†ï¼Œç®€å†çš„æ ¼å¼æ˜¯è¿™æ ·å­çš„ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20191223194318.png"></p><p>ä¸€ä¸ªäººæœ‰å¤šä¸ªå±æ€§ï¼ŒæŸäº›å±æ€§å¦‚ç”³è¯·èŒä½ã€è–ªèµ„æ˜¯å•ä¸€å±æ€§ï¼Œå³åªä¼šæœ‰ä¸€ä¸ªå€¼ï¼›æŸäº›å±æ€§å¦‚å·¥ä½œç»å†ã€æ•™è‚²ç»å†ã€è·å¥–æƒ…å†µæ˜¯ä¸€ç»„å±æ€§ï¼Œå¯èƒ½ä¼šæœ‰å¤šç»„å€¼ã€‚ç°åœ¨è¦å°†è¿™æ‰¹ç®€å†æ•°æ®å¯¼å…¥åˆ°åº“ä¸­ã€‚</p><h2 id="é›¶ã€æ–‡ä»¶å‡†å¤‡ï¼š"><a href="#é›¶ã€æ–‡ä»¶å‡†å¤‡ï¼š" class="headerlink" title="é›¶ã€æ–‡ä»¶å‡†å¤‡ï¼š"></a>é›¶ã€æ–‡ä»¶å‡†å¤‡ï¼š</h2><ul><li><p><a href="https://github.com/Mosiki/learning-modules/tree/master/learning-easypoi/src/main/resources/excel">ç¤ºä¾‹Excelä»¥åŠç¤ºä¾‹Excel2</a></p></li><li><p>åŠ å…¥ EasyPOI çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.afterturn<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>easypoi-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.2.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h2 id="ä¸€ã€å®šä¹‰EasyPOIå¯¼å…¥å®ä½“ç±»"><a href="#ä¸€ã€å®šä¹‰EasyPOIå¯¼å…¥å®ä½“ç±»" class="headerlink" title="ä¸€ã€å®šä¹‰EasyPOIå¯¼å…¥å®ä½“ç±»"></a>ä¸€ã€å®šä¹‰EasyPOIå¯¼å…¥å®ä½“ç±»</h2></li></ul><p>é¦–å…ˆå®šä¹‰ä¸€ä¸ª EasyPOI å®ä½“ç±»ï¼Œå•ä¸ªå±æ€§ä½¿ç”¨ <code>@Excel</code>æ³¨è§£å£°æ˜ï¼Œname å±æ€§éœ€è¦ä¸Excelä¸­çš„è¡¨å¤´ä¿æŒä¸€è‡´ï¼Œæ¯”å¦‚ <code>å§“å*</code>ä¸­çš„ * å·å°±ä¸èƒ½çœç•¥æ‰ï¼ˆ2021å¹´04æœˆ15æ—¥æ›´æ–°ï¼šè¿™é‡Œå¯èƒ½ä¼šè¯¯å¯¼ï¼Œè¡¨ç¤ºçš„æ„æ€æ˜¯éœ€è¦ä¿è¯ name å±æ€§ä¸ Excel ä¸­çš„åˆ—åä¿æŒä¸€æ ·ï¼Œçœ‹åˆ—åæœ‰æ²¡æœ‰ * ï¼Œæ²¡æœ‰çš„è¯å°±ä¸è¦åŠ ã€‚ã€‚ã€‚ï¼‰ã€‚ä¸€å¯¹å¤šå…³ç³»ä½¿ç”¨ <code>@Collection</code> æ³¨è§£å£°æ˜ï¼Œname æ˜¯æœ€ä¸Šæ–¹çš„è¡¨å¤´ï¼Œå¯¹åº”çš„é›†åˆå…ƒç´ ç±»å‹éœ€è¦å¦å¤–å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™é‡Œå› ä¸ºç¯‡å¹…é—®é¢˜ï¼Œåªå±•ç¤ºä¸€ä¸ªå·¥ä½œç»å†ä»¥åŠæ•™è‚²ç»å†å¯¹åº”çš„é›†åˆå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TalentUserInputEntity</span></span>&#123;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å§“å*&quot;)</span><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ€§åˆ«*&quot;)</span><br>    <span class="hljs-keyword">private</span> Integer gender;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ‰‹æœºå·*&quot;)</span><br>    <span class="hljs-keyword">private</span> String phone;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å¼€å§‹å·¥ä½œæ—¶é—´*&quot;)</span><br>    <span class="hljs-keyword">private</span> Date workTime;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ°‘æ—*&quot;)</span><br>    <span class="hljs-keyword">private</span> String national;<br><br>    <span class="hljs-meta">@Excel(name = &quot;è¯­è¨€æ°´å¹³*&quot;)</span><br>    <span class="hljs-keyword">private</span> String languageProficiency;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å‡ºç”Ÿæ—¥æœŸ*&quot;)</span><br>    <span class="hljs-keyword">private</span> Date birth;<br><br>    <span class="hljs-meta">@Excel(name = &quot;èŒä½*&quot;)</span><br>    <span class="hljs-keyword">private</span> String jobsName;<br><br>    <span class="hljs-meta">@Excel(name = &quot;èŒä½ç±»å‹*&quot;)</span><br>    <span class="hljs-keyword">private</span> String categoryName;<br><br>    <span class="hljs-meta">@Excel(name = &quot;è–ªèµ„*&quot;)</span><br>    <span class="hljs-keyword">private</span> Integer salary;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å·¥ä½œåœ°ç‚¹*&quot;)</span><br>    <span class="hljs-keyword">private</span> String workArea;<br><br>    <span class="hljs-meta">@ExcelCollection(name = &quot;å·¥ä½œç»å†*&quot;)</span><br>    <span class="hljs-keyword">private</span> List&lt;ExperienceInputEntity&gt; experienceList;<br><br>    <span class="hljs-meta">@ExcelCollection(name = &quot;æ•™è‚²ç»å†*&quot;)</span><br>    <span class="hljs-keyword">private</span> List&lt;EducationInputEntity&gt; educationList;<br><br>    <span class="hljs-meta">@ExcelCollection(name = &quot;è·å¥–æƒ…å†µ&quot;)</span><br>    <span class="hljs-keyword">private</span> List&lt;AwardsInputEntity&gt; awardList;<br><br>    <span class="hljs-meta">@ExcelCollection(name = &quot;æŠ€èƒ½è¯ä¹¦&quot;)</span><br>    <span class="hljs-keyword">private</span> List&lt;PunishmentInputEntity&gt; punishmentList;<br><br>    <span class="hljs-meta">@Excel(name = &quot;ç‰¹é•¿&quot;)</span><br>    <span class="hljs-keyword">private</span> String specialty;<br>&#125;<br><br><span class="hljs-comment">// å·¥ä½œç»å†å¯¹è±¡</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExperienceInputEntity</span> </span>&#123;<br>    <span class="hljs-meta">@Excel(name = &quot;å…¬å¸åç§°*&quot;)</span><br>    <span class="hljs-keyword">private</span> String companyName;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ‰€åœ¨è¡Œä¸š*&quot;)</span><br>    <span class="hljs-keyword">private</span> String industry;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å¼€å§‹æ—¶é—´*&quot;)</span><br>    <span class="hljs-keyword">private</span> Date beginTime;<br><br>    <span class="hljs-meta">@Excel(name = &quot;ç»“æŸæ—¶é—´*&quot;)</span><br>    <span class="hljs-keyword">private</span> Date finishTime;<br><br>    <span class="hljs-meta">@Excel(name = &quot;èŒä½åç§°*&quot;)</span><br>    <span class="hljs-keyword">private</span> String jobTitle;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ‰€å±éƒ¨é—¨*&quot;)</span><br>    <span class="hljs-keyword">private</span> String department;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å·¥ä½œå†…å®¹*&quot;)</span><br>    <span class="hljs-keyword">private</span> String description;<br>&#125;<br><span class="hljs-comment">// æ•™è‚²ç»å†å¯¹è±¡</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EducationInputEntity</span> </span>&#123;<br>    <span class="hljs-meta">@Excel(name = &quot;å­¦æ ¡*&quot;)</span><br>    <span class="hljs-keyword">private</span> String schoolName;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å­¦å†*&quot;)</span><br>    <span class="hljs-keyword">private</span> Integer record;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å¼€å§‹å¹´ä»½*&quot;)</span><br>    <span class="hljs-keyword">private</span> Date beginTime;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ¯•ä¸šå¹´ä»½*&quot;)</span><br>    <span class="hljs-keyword">private</span> Date finishTime;<br><br>    <span class="hljs-meta">@Excel(name = &quot;ä¸“ä¸š*&quot;)</span><br>    <span class="hljs-keyword">private</span> String profession;<br>&#125;<br><span class="hljs-comment">// çœç•¥å…¶ä»–</span><br></code></pre></div></td></tr></table></figure><h2 id="äºŒã€EasyPOIåŸºç¡€å¯¼å…¥"><a href="#äºŒã€EasyPOIåŸºç¡€å¯¼å…¥" class="headerlink" title="äºŒã€EasyPOIåŸºç¡€å¯¼å…¥"></a>äºŒã€EasyPOIåŸºç¡€å¯¼å…¥</h2><p>è¿™é‡Œä¸ºæ–¹ä¾¿æ¼”ç¤ºï¼Œç›´æ¥å°†å¯¼å…¥ç»“æœè½¬æˆJSONæ‰“å°è¾“å‡ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;/upload&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">upload</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;file&quot;)</span> MultipartFile multipartFile)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>  ImportParams params = <span class="hljs-keyword">new</span> ImportParams();<br>  params.setHeadRows(<span class="hljs-number">2</span>);<br>  <span class="hljs-comment">// params.setTitleRows(0);</span><br>  List&lt;TalentUserInputEntity&gt; result = ExcelImportUtil.importExcel(multipartFile.getInputStream(),<br>                                                                   TalentUserInputEntity.class, params);<br>  System.out.println(JSONUtil.toJsonStr(result));<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>è¿™é‡Œéœ€è¦æ³¨æ„è¡¨å¤´çš„è¡Œæ•°è®¾ç½®ä¸€å®šè¦æ­£ç¡®ï¼å¦åˆ™é›†åˆæ•°æ®å°†æ— æ³•è¯»å–ï¼Œå¯ä»¥é€šè¿‡WPSæˆ–è€…officeæŸ¥çœ‹å®é™…è¡¨å¤´æ‰€å ç”¨çš„è¡Œæ•°ï¼Œä¸€å®šè¦åŒºåˆ†è¡¨å¤´ä¸æ ‡é¢˜çš„åŒºåˆ«ï¼Œè¡¨å¤´æ˜¯åˆ—åç§°ï¼Œæ ‡é¢˜æ˜¯è¡¨å¤´ä¸Šé¢çš„æ–‡å­—ï¼Œæœ¬æ–‡ç¤ºä¾‹æ–‡ä»¶ä¸­æ²¡æœ‰æ ‡é¢˜ï¼Œæ‰€ä»¥setTitleRowsä¸º0</strong>  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20191224062255.png"></p><h2 id="ä¸‰ã€å€¼æ›¿æ¢"><a href="#ä¸‰ã€å€¼æ›¿æ¢" class="headerlink" title="ä¸‰ã€å€¼æ›¿æ¢"></a>ä¸‰ã€å€¼æ›¿æ¢</h2><p>ä½¿ç”¨ postman æˆ–è€… Talend API Tester ç­‰å·¥å…·è¿›è¡Œä¸Šä¼  <code>ç¤ºä¾‹æ–‡ä»¶.xlsx</code>ï¼Œç»“æœæ§åˆ¶å°è¾“å‡ºäº†å¼‚å¸¸ï¼Œå¼‚å¸¸å¦‚ä¸‹ï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">java<span class="hljs-selector-class">.lang</span><span class="hljs-selector-class">.NumberFormatException</span>: For <span class="hljs-selector-tag">input</span> string: <span class="hljs-string">&quot;ç”·&quot;</span><br>...<br>cn<span class="hljs-selector-class">.afterturn</span><span class="hljs-selector-class">.easypoi</span><span class="hljs-selector-class">.exception</span><span class="hljs-selector-class">.excel</span><span class="hljs-selector-class">.ExcelImportException</span>: Excel å€¼è·å–å¤±è´¥<br></code></pre></div></td></tr></table></figure><p>åŸå› æ˜¯å› ä¸ºæ•°æ®åº“ä¸­æ€§åˆ«å­—æ®µç±»å‹ä¸º Integer ç±»å‹çš„ï¼Œæ‰€ä»¥å¯¼å…¥å¯¹è±¡ä¹Ÿè®¾ç½®æˆäº† Integerï¼Œè€Œ Excel ä¸­å¡«å†™çš„æ˜¯ç”·/å¥³æ±‰å­—ï¼Œè‡ªç„¶å°±å‡ºé”™äº†ï¼Œè¿™é‡Œå°±éœ€è¦ä½¿ç”¨ easypoi çš„ replace æ–¹å¼æ¥æ›¿æ¢æœ€ç»ˆå€¼ï¼Œä¿®æ”¹ <code>gender</code> å­—æ®µä¸Šçš„æ³¨è§£ä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">// replaceæ ¼å¼ä¸º &quot;æ›¿æ¢å‰çš„å€¼_æ›¿æ¢åçš„å€¼&quot;</span><br><span class="hljs-meta">@Excel(name = &quot;æ€§åˆ«*&quot;, replace = &#123;&quot;ç”·_0&quot;, &quot;å¥³_1&quot;&#125;)</span><br><span class="hljs-keyword">private</span> Integer gender;<br></code></pre></div></td></tr></table></figure><p>åŒç†ï¼Œè–ªèµ„ç±»å‹å’Œæ•™è‚²ç»å†ä¸­çš„å­¦å†éœ€è¦æ›¿æ¢éœ€è¦çš„å€¼</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Excel(name = &quot;è–ªèµ„*&quot;, replace = &#123;&quot;3Kä»¥ä¸‹_1&quot;, &quot;3K-5K_2&quot;, &quot;5K-10K_3&quot;, &quot;10K-20K_4&quot;, &quot;20K-50K_5&quot;, &quot;50Kä»¥ä¸Š_6&quot;&#125;)</span><br><span class="hljs-keyword">private</span> Integer salary;<br><br><span class="hljs-meta">@Excel(name = &quot;å­¦å†*&quot;, replace =&#123;&quot;åˆä¸­åŠä»¥ä¸‹_1&quot;,&quot;ä¸­ä¸“_2&quot;,&quot;é«˜ä¸­_3&quot;,&quot;å¤§ä¸“_4&quot;,&quot;æœ¬ç§‘_5&quot;,&quot;ç¡•å£«_6&quot;,&quot;åšå£«_7&quot;&#125;)</span><br><span class="hljs-keyword">private</span> Integer record;<br></code></pre></div></td></tr></table></figure><p>å†é‡æ–°å°è¯•å¯¼å…¥ï¼Œæ§åˆ¶å°è¾“å‡ºäº†å¯¼å…¥çš„JSONå†…å®¹</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">[<br>    &#123;<br>        <span class="hljs-attr">&quot;experienceList&quot;</span>: [<br>            &#123;<br>                <span class="hljs-attr">&quot;finishTime&quot;</span>: <span class="hljs-number">1571673600000</span>,<br>                <span class="hljs-attr">&quot;companyName&quot;</span>: <span class="hljs-string">&quot;ç§‘æŠ€å…¬å¸1&quot;</span>,<br>                <span class="hljs-attr">&quot;jobTitle&quot;</span>: <span class="hljs-string">&quot;è¿è¥&quot;</span>,<br>                <span class="hljs-attr">&quot;description&quot;</span>: <span class="hljs-string">&quot;è¿è¥æ–¹æ¡ˆå¤„ç†&quot;</span>,<br>                <span class="hljs-attr">&quot;industry&quot;</span>: <span class="hljs-string">&quot;äº’è”ç½‘&quot;</span>,<br>                <span class="hljs-attr">&quot;beginTime&quot;</span>: <span class="hljs-number">1546358400000</span>,<br>                <span class="hljs-attr">&quot;department&quot;</span>: <span class="hljs-string">&quot;è¿è¥éƒ¨&quot;</span><br>            &#125;,<br>            &#123;<br>                <span class="hljs-attr">&quot;finishTime&quot;</span>: <span class="hljs-number">1571673600000</span>,<br>                <span class="hljs-attr">&quot;companyName&quot;</span>: <span class="hljs-string">&quot;è´¢åŠ¡å…¬å¸&quot;</span>,<br>                <span class="hljs-attr">&quot;jobTitle&quot;</span>: <span class="hljs-string">&quot;ä¼šè®¡&quot;</span>,<br>                <span class="hljs-attr">&quot;description&quot;</span>: <span class="hljs-string">&quot;å®¡è®¡&quot;</span>,<br>                <span class="hljs-attr">&quot;industry&quot;</span>: <span class="hljs-string">&quot;è´¢åŠ¡&quot;</span>,<br>                <span class="hljs-attr">&quot;beginTime&quot;</span>: <span class="hljs-number">1574179200000</span>,<br>                <span class="hljs-attr">&quot;department&quot;</span>: <span class="hljs-string">&quot;ä¼šè®¡éƒ¨&quot;</span><br>            &#125;<br>        ],<br>        <span class="hljs-attr">&quot;gender&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">&quot;languageProficiency&quot;</span>: <span class="hljs-string">&quot;è‹±è¯­å››çº§&quot;</span>,<br>        <span class="hljs-attr">&quot;jobsName&quot;</span>: <span class="hljs-string">&quot;é”€å”®&quot;</span>,<br>        <span class="hljs-attr">&quot;educationList&quot;</span>: [<br>            &#123;<br>                <span class="hljs-attr">&quot;profession&quot;</span>: <span class="hljs-string">&quot;è®¡ç®—æœº&quot;</span>,<br>                <span class="hljs-attr">&quot;finishTime&quot;</span>: <span class="hljs-number">1530374400000</span>,<br>                <span class="hljs-attr">&quot;record&quot;</span>: <span class="hljs-number">5</span>,<br>                <span class="hljs-attr">&quot;beginTime&quot;</span>: <span class="hljs-number">1409500800000</span>,<br>                <span class="hljs-attr">&quot;schoolName&quot;</span>: <span class="hljs-string">&quot;å±±ä¸œå¤§å­¦&quot;</span><br>            &#125;,<br>            &#123;<br>                <span class="hljs-attr">&quot;profession&quot;</span>: <span class="hljs-string">&quot;è®¡ç®—æœº&quot;</span>,<br>                <span class="hljs-attr">&quot;finishTime&quot;</span>: <span class="hljs-number">1593532800000</span>,<br>                <span class="hljs-attr">&quot;record&quot;</span>: <span class="hljs-number">6</span>,<br>                <span class="hljs-attr">&quot;beginTime&quot;</span>: <span class="hljs-number">1409500800000</span>,<br>                <span class="hljs-attr">&quot;schoolName&quot;</span>: <span class="hljs-string">&quot;å±±ä¸œå¤§å­¦&quot;</span><br>            &#125;<br>        ],<br>        <span class="hljs-attr">&quot;birth&quot;</span>: <span class="hljs-number">851097600000</span>,<br>        <span class="hljs-attr">&quot;salary&quot;</span>: <span class="hljs-number">4</span>,<br>        <span class="hljs-attr">&quot;workTime&quot;</span>: <span class="hljs-number">1549900800000</span>,<br>        <span class="hljs-attr">&quot;categoryName&quot;</span>: <span class="hljs-string">&quot;é”€å”®&quot;</span>,<br>        <span class="hljs-attr">&quot;phone&quot;</span>: <span class="hljs-string">&quot;13122223333&quot;</span>,<br>        <span class="hljs-attr">&quot;workArea&quot;</span>: <span class="hljs-string">&quot;æµ™æ±Ÿçœé‡‘åå¸‚ä¹‰ä¹Œå¸‚&quot;</span>,<br>        <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;å¼ æ— å¿Œ&quot;</span>,<br>        <span class="hljs-attr">&quot;national&quot;</span>: <span class="hljs-string">&quot;æ±‰æ—&quot;</span>,<br>        <span class="hljs-attr">&quot;punishmentList&quot;</span>: [<br>            &#123;&#125;,<br>            &#123;&#125;<br>        ],<br>        <span class="hljs-attr">&quot;awardList&quot;</span>: [<br>            &#123;<br>                <span class="hljs-attr">&quot;date&quot;</span>: <span class="hljs-number">1530374400000</span>,<br>                <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;å›½å®¶å¥–å­¦é‡‘&quot;</span>,<br>                <span class="hljs-attr">&quot;description&quot;</span>: <span class="hljs-string">&quot;å›½å®¶ä¸€çº§å¥–å­¦é‡‘&quot;</span><br>            &#125;,<br>            &#123;&#125;<br>        ]<br>    &#125;,<br>    &#123;<br>        <span class="hljs-attr">&quot;specialty&quot;</span>: <span class="hljs-string">&quot;ç‰¹é•¿å°±æ˜¯å¤ªå¤šç‰¹é•¿&quot;</span>,<br>        <span class="hljs-attr">&quot;experienceList&quot;</span>: [<br>            &#123;<br>                <span class="hljs-attr">&quot;finishTime&quot;</span>: <span class="hljs-number">1571673600000</span>,<br>                <span class="hljs-attr">&quot;companyName&quot;</span>: <span class="hljs-string">&quot;ç§‘æŠ€å…¬å¸1&quot;</span>,<br>                <span class="hljs-attr">&quot;jobTitle&quot;</span>: <span class="hljs-string">&quot;javaå¼€å‘&quot;</span>,<br>                <span class="hljs-attr">&quot;description&quot;</span>: <span class="hljs-string">&quot;code&quot;</span>,<br>                <span class="hljs-attr">&quot;industry&quot;</span>: <span class="hljs-string">&quot;äº’è”ç½‘&quot;</span>,<br>                <span class="hljs-attr">&quot;beginTime&quot;</span>: <span class="hljs-number">1546358400000</span>,<br>                <span class="hljs-attr">&quot;department&quot;</span>: <span class="hljs-string">&quot;å¼€å‘éƒ¨é—¨&quot;</span><br>            &#125;<br>        ],<br>        <span class="hljs-attr">&quot;gender&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">&quot;languageProficiency&quot;</span>: <span class="hljs-string">&quot;è‹±è¯­å…«çº§&quot;</span>,<br>        <span class="hljs-attr">&quot;jobsName&quot;</span>: <span class="hljs-string">&quot;java&quot;</span>,<br>        <span class="hljs-attr">&quot;educationList&quot;</span>: [<br>            &#123;<br>                <span class="hljs-attr">&quot;profession&quot;</span>: <span class="hljs-string">&quot;è®¡ç®—æœº&quot;</span>,<br>                <span class="hljs-attr">&quot;finishTime&quot;</span>: <span class="hljs-number">1530374400000</span>,<br>                <span class="hljs-attr">&quot;record&quot;</span>: <span class="hljs-number">5</span>,<br>                <span class="hljs-attr">&quot;beginTime&quot;</span>: <span class="hljs-number">1409500800000</span>,<br>                <span class="hljs-attr">&quot;schoolName&quot;</span>: <span class="hljs-string">&quot;å®‰å¾½å¤§å­¦&quot;</span><br>            &#125;<br>        ],<br>        <span class="hljs-attr">&quot;birth&quot;</span>: <span class="hljs-number">851097600000</span>,<br>        <span class="hljs-attr">&quot;salary&quot;</span>: <span class="hljs-number">4</span>,<br>        <span class="hljs-attr">&quot;workTime&quot;</span>: <span class="hljs-number">1549900800000</span>,<br>        <span class="hljs-attr">&quot;categoryName&quot;</span>: <span class="hljs-string">&quot;å¼€å‘&quot;</span>,<br>        <span class="hljs-attr">&quot;phone&quot;</span>: <span class="hljs-string">&quot;18311111111&quot;</span>,<br>        <span class="hljs-attr">&quot;workArea&quot;</span>: <span class="hljs-string">&quot;æµ™æ±Ÿçœé‡‘åå¸‚ä¹‰ä¹Œå¸‚&quot;</span>,<br>        <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;å¼ å°å‡¡&quot;</span>,<br>        <span class="hljs-attr">&quot;national&quot;</span>: <span class="hljs-string">&quot;æ±‰æ—&quot;</span>,<br>        <span class="hljs-attr">&quot;punishmentList&quot;</span>: [<br>            &#123;<br>                <span class="hljs-attr">&quot;date&quot;</span>: <span class="hljs-number">1530374400000</span>,<br>                <span class="hljs-attr">&quot;description&quot;</span>: <span class="hljs-string">&quot;æŠ€èƒ½æ²¡æœ‰&quot;</span><br>            &#125;<br>        ],<br>        <span class="hljs-attr">&quot;awardList&quot;</span>: [<br>            &#123;<br>                <span class="hljs-attr">&quot;date&quot;</span>: <span class="hljs-number">1530374400000</span>,<br>                <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;å›½å®¶å¥–å­¦é‡‘&quot;</span>,<br>                <span class="hljs-attr">&quot;description&quot;</span>: <span class="hljs-string">&quot;å›½å®¶ä¸€çº§å¥–å­¦é‡‘&quot;</span><br>            &#125;<br>        ]<br>    &#125;,<br>    <span class="hljs-comment">// çœç•¥å…¶ä»–...</span><br>]<br></code></pre></div></td></tr></table></figure><h2 id="å››ã€å¯¼å…¥ä¹‹åŸºç¡€æ ¡éªŒ"><a href="#å››ã€å¯¼å…¥ä¹‹åŸºç¡€æ ¡éªŒ" class="headerlink" title="å››ã€å¯¼å…¥ä¹‹åŸºç¡€æ ¡éªŒ"></a>å››ã€å¯¼å…¥ä¹‹åŸºç¡€æ ¡éªŒ</h2><p>ç°åœ¨äº§å“éœ€è¦å¯¹å¯¼å…¥çš„Excelè¿›è¡Œæ ¡éªŒï¼Œä¸åˆæ³•çš„Excelä¸å…è®¸å…¥åº“ï¼Œéœ€è¦è¿”å›å…·ä½“çš„é”™è¯¯ä¿¡æ¯ç»™å‰ç«¯ï¼Œæç¤ºç»™ç”¨æˆ·ï¼Œé”™è¯¯ä¿¡æ¯ä¸­éœ€è¦åŒ…å«è¡Œå·ä»¥åŠå¯¹åº”çš„é”™è¯¯ã€‚</p><p>å› ä¸º EasyPOI æ”¯æŒ Hibernate Validator ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨å°±å¯ä»¥äº†ï¼Œå› ä¸ºè¦å°†é”™è¯¯ä¿¡æ¯ä»¥åŠé”™è¯¯è¡Œå·è¿”å›ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ° EasyPOI çš„é«˜çº§ç”¨æ³•ï¼Œå®ç° <code>IExcelDataModel</code>ä¸ <code>IExcelModel</code>æ¥å£ï¼Œ<code>IExcelDataModel</code>è´Ÿè´£è®¾ç½®è¡Œå·ï¼Œ<code>IExcelModel</code> è´Ÿè´£è®¾ç½®é”™è¯¯ä¿¡æ¯ã€‚</p><p>ä¿®æ”¹å¯¼å…¥å®ä½“ç±»ï¼Œå¢åŠ å­—æ®µ <code>rowNum</code> ä¸ <code>errorMsg</code>ä»¥åŠå¢åŠ æ ¡éªŒæ³¨è§£ã€‚</p><p>å¦‚æœä½¿ç”¨åˆ°äº† @Pattern æ³¨è§£ï¼Œåˆ™å­—æ®µç±»å‹å¿…é¡»æ˜¯ <strong>String</strong> ç±»å‹ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæœ¬æ–‡ä¸­çš„åŸ <code>Integer</code> ç±»å‹çš„ <code>gender</code> ä¿®æ”¹æˆä¸º <code>String</code> ç±»å‹çš„ <code>genderStr</code>ï¼Œ<code>record</code> å­—æ®µä¹Ÿä¿®æ”¹ä¸ºäº† String ç±»å‹çš„ <code>recordStr</code>ç­‰ç­‰ã€‚åŒç†å¦‚æœæ ¡éªŒ Date ç±»å‹å­—æ®µï¼Œå…ˆå°†ç±»å‹æ”¹æˆStringï¼Œæ­£åˆ™è¡¨è¾¾å¼å‚è€ƒä¸‹æ–‡å†™æ³•ã€‚</p><p><strong>è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œå¦‚æœ@Excelæ³¨è§£ä¸­è®¾ç½®äº† <code>replace</code> å±æ€§ï¼Œåˆ™Hibernate Validator æ ¡éªŒçš„æ˜¯æ›¿æ¢åçš„å€¼</strong></p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TalentUserInputEntity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IExcelDataModel</span>, <span class="hljs-title">IExcelModel</span> </span>&#123;<br>    <span class="hljs-comment">// æ—¶é—´æ ¼å¼æ ¡éªŒæ­£åˆ™</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String DATE_REGEXP = <span class="hljs-string">&quot;(Mon|Tue|Wed|Thu|Fri|Sat|Sun)( )(Dec|Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov)( )\\d&#123;2&#125;( )(00:00:00)( )(CST)( )\\d&#123;4&#125;&quot;</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è¡Œå·</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> rowNum;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é”™è¯¯æ¶ˆæ¯</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String errorMsg;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å§“å*&quot;)</span><br>    <span class="hljs-meta">@NotBlank(message = &quot;[å§“å]ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ€§åˆ«*&quot;, replace = &#123;&quot;ç”·_0&quot;, &quot;å¥³_1&quot;&#125;)</span><br>    <span class="hljs-meta">@Pattern(regexp = &quot;[01]&quot;, message = &quot;æ€§åˆ«é”™è¯¯&quot;)</span><br>    <span class="hljs-keyword">private</span> String genderStr;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ‰‹æœºå·*&quot;)</span><br>    <span class="hljs-keyword">private</span> String phone;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å¼€å§‹å·¥ä½œæ—¶é—´*&quot;)</span><br>    <span class="hljs-meta">@Pattern(regexp = DATE_REGEXP, message = &quot;[å¼€å§‹å·¥ä½œæ—¶é—´]æ—¶é—´æ ¼å¼é”™è¯¯&quot;)</span><br>    <span class="hljs-keyword">private</span> String workTimeStr;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ°‘æ—*&quot;)</span><br>    <span class="hljs-meta">@NotBlank(message = &quot;[æ°‘æ—]ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> String national;<br><br>    <span class="hljs-meta">@Excel(name = &quot;è¯­è¨€æ°´å¹³*&quot;)</span><br>    <span class="hljs-meta">@NotBlank(message = &quot;[è¯­è¨€æ°´å¹³]ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> String languageProficiency;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å‡ºç”Ÿæ—¥æœŸ*&quot;)</span><br>    <span class="hljs-meta">@Pattern(regexp = DATE_REGEXP, message = &quot;[å‡ºç”Ÿæ—¥æœŸ]æ—¶é—´æ ¼å¼é”™è¯¯&quot;)</span><br>    <span class="hljs-keyword">private</span> String birthStr;<br><br>    <span class="hljs-meta">@Excel(name = &quot;èŒä½*&quot;)</span><br>    <span class="hljs-meta">@NotBlank(message = &quot;[èŒä½]ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> String jobsName;<br><br>    <span class="hljs-meta">@Excel(name = &quot;èŒä½ç±»å‹*&quot;)</span><br>    <span class="hljs-meta">@NotBlank(message = &quot;[èŒä½ç±»å‹]ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> String categoryName;<br><br>    <span class="hljs-meta">@Excel(name = &quot;è–ªèµ„*&quot;, replace = &#123;&quot;3Kä»¥ä¸‹_1&quot;, &quot;3K-5K_2&quot;, &quot;5K-10K_3&quot;, &quot;10K-20K_4&quot;, &quot;20K-50K_5&quot;, &quot;50Kä»¥ä¸Š_6&quot;&#125;)</span><br>    <span class="hljs-meta">@Pattern(regexp = &quot;[123456]&quot;, message = &quot;è–ªèµ„ä¿¡æ¯é”™è¯¯&quot;)</span><br>    <span class="hljs-keyword">private</span> String salaryStr;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å·¥ä½œåœ°ç‚¹*&quot;)</span><br>    <span class="hljs-meta">@NotBlank(message = &quot;[å·¥ä½œåœ°ç‚¹]ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> String workArea;<br><br>    <span class="hljs-meta">@ExcelCollection(name = &quot;å·¥ä½œç»å†*&quot;)</span><br>    <span class="hljs-keyword">private</span> List&lt;ExperienceInputEntity&gt; experienceList;<br><br>    <span class="hljs-meta">@ExcelCollection(name = &quot;æ•™è‚²ç»å†*&quot;)</span><br>    <span class="hljs-keyword">private</span> List&lt;EducationInputEntity&gt; educationList;<br><br>    <span class="hljs-meta">@ExcelCollection(name = &quot;è·å¥–æƒ…å†µ&quot;)</span><br>    <span class="hljs-keyword">private</span> List&lt;AwardsInputEntity&gt; awardList;<br><br>    <span class="hljs-meta">@ExcelCollection(name = &quot;æŠ€èƒ½è¯ä¹¦&quot;)</span><br>    <span class="hljs-keyword">private</span> List&lt;PunishmentInputEntity&gt; punishmentList;<br><br>    <span class="hljs-meta">@Excel(name = &quot;ç‰¹é•¿&quot;)</span><br>    <span class="hljs-keyword">private</span> String specialty;<br>&#125;<br><br><span class="hljs-comment">// å·¥ä½œç»å†</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExperienceInputEntity</span> </span>&#123;<br>    <span class="hljs-meta">@Excel(name = &quot;å…¬å¸åç§°*&quot;)</span><br>    <span class="hljs-keyword">private</span> String companyName;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ‰€åœ¨è¡Œä¸š*&quot;)</span><br>    <span class="hljs-keyword">private</span> String industry;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å¼€å§‹æ—¶é—´*&quot;)</span><br>    <span class="hljs-meta">@Pattern(regexp = DATE_REGEXP, message = &quot;[å·¥ä½œç»å†][å¼€å§‹æ—¶é—´]æ—¶é—´æ ¼å¼é”™è¯¯&quot;)</span><br>    <span class="hljs-keyword">private</span> String beginTimeStr;<br><br>    <span class="hljs-meta">@Excel(name = &quot;ç»“æŸæ—¶é—´*&quot;)</span><br>    <span class="hljs-meta">@Pattern(regexp = DATE_REGEXP, message = &quot;[å·¥ä½œç»å†][ç»“æŸæ—¶é—´]æ—¶é—´æ ¼å¼é”™è¯¯&quot;)</span><br>    <span class="hljs-keyword">private</span> String finishTimeStr;<br><br>    <span class="hljs-meta">@Excel(name = &quot;èŒä½åç§°*&quot;)</span><br>    <span class="hljs-keyword">private</span> String jobTitle;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ‰€å±éƒ¨é—¨*&quot;)</span><br>    <span class="hljs-keyword">private</span> String department;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å·¥ä½œå†…å®¹*&quot;)</span><br>    <span class="hljs-keyword">private</span> String description;<br>&#125;<br><br><span class="hljs-comment">// æ•™è‚²ç»å†</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EducationInputEntity</span> </span>&#123;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å­¦æ ¡*&quot;)</span><br>    <span class="hljs-keyword">private</span> String schoolName;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å­¦å†*&quot;, replace = &#123;&quot;åˆä¸­åŠä»¥ä¸‹_1&quot;, &quot;ä¸­ä¸“_2&quot;, &quot;é«˜ä¸­_3&quot;, &quot;å¤§ä¸“_4&quot;, &quot;æœ¬ç§‘_5&quot;, &quot;ç¡•å£«_6&quot;, &quot;åšå£«_7&quot;&#125;)</span><br>    <span class="hljs-meta">@Pattern(regexp = &quot;[1234567]&quot;, message = &quot;å­¦å†ä¿¡æ¯é”™è¯¯&quot;)</span><br>    <span class="hljs-keyword">private</span> String recordStr;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å¼€å§‹å¹´ä»½*&quot;)</span><br>    <span class="hljs-meta">@Pattern(regexp = DATE_REGEXP, message = &quot;[æ•™è‚²ç»å†][å¼€å§‹å¹´ä»½]æ—¶é—´æ ¼å¼é”™è¯¯&quot;)</span><br>    <span class="hljs-keyword">private</span> String beginTimeStr;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ¯•ä¸šå¹´ä»½*&quot;)</span><br>    <span class="hljs-meta">@Pattern(regexp = DATE_REGEXP, message = &quot;[æ•™è‚²ç»å†][æ¯•ä¸šå¹´ä»½]æ—¶é—´æ ¼å¼é”™è¯¯&quot;)</span><br>    <span class="hljs-keyword">private</span> String finishTimeStr;<br><br>    <span class="hljs-meta">@Excel(name = &quot;ä¸“ä¸š*&quot;)</span><br>    <span class="hljs-keyword">private</span> String profession;<br>&#125;<br><span class="hljs-comment">// å…¶ä»–çœç•¥...</span><br></code></pre></div></td></tr></table></figure><p>ä¿®æ”¹å®Œå®ä½“ç±»åï¼Œä¿®æ”¹å¯¼å…¥å¤„çš„ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@PostMapping(&quot;/upload&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">upload</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;file&quot;)</span> MultipartFile multipartFile)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>  ImportParams params = <span class="hljs-keyword">new</span> ImportParams();<br>  <span class="hljs-comment">// è¡¨å¤´è®¾ç½®ä¸º2è¡Œ</span><br>  params.setHeadRows(<span class="hljs-number">2</span>);<br>  <span class="hljs-comment">// æ ‡é¢˜è¡Œè®¾ç½®ä¸º0è¡Œï¼Œé»˜è®¤æ˜¯0ï¼Œå¯ä»¥ä¸è®¾ç½®</span><br>  params.setTitleRows(<span class="hljs-number">0</span>);<br>  <span class="hljs-comment">// å¼€å¯Excelæ ¡éªŒ</span><br>  params.setNeedVerfiy(<span class="hljs-keyword">true</span>);<br>  ExcelImportResult&lt;TalentUserInputEntity&gt; result = ExcelImportUtil.importExcelMore(multipartFile.getInputStream(),<br>                                                                                    TalentUserInputEntity.class, params);<br>  System.out.println(<span class="hljs-string">&quot;æ˜¯å¦æ ¡éªŒå¤±è´¥: &quot;</span> + result.isVerfiyFail());<br>  System.out.println(<span class="hljs-string">&quot;æ ¡éªŒå¤±è´¥çš„é›†åˆ:&quot;</span> + JSONObject.toJSONString(result.getFailList()));<br>  System.out.println(<span class="hljs-string">&quot;æ ¡éªŒé€šè¿‡çš„é›†åˆ:&quot;</span> + JSONObject.toJSONString(result.getList()));<br>  <span class="hljs-keyword">for</span> (TalentUserInputEntity entity : result.getFailList()) &#123;<br>    String msg = <span class="hljs-string">&quot;ç¬¬&quot;</span> + entity.getRowNum() + <span class="hljs-string">&quot;è¡Œçš„é”™è¯¯æ˜¯ï¼š&quot;</span> + entity.getErrorMsg();<br>    System.out.println(msg);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ï¼Œæˆ‘åŸºäºæ­£ç¡®çš„Excelå¦å­˜ä¸€ä»½ä¸ªåˆ«å­—æ®µæœ‰è¯¯çš„ ç¤ºä¾‹Excel2 å¹¶ä¸Šä¼ ï¼Œè§£æç»“æœä¸ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20191224221916.png"></p><p>è¿™é‡Œè´´å‡ºéƒ¨åˆ†æ ¡éªŒå¤±è´¥é›†åˆæ•°æ®ï¼Œå¯ä»¥çœ‹åˆ°ç¬¬50è¡Œå’Œ61è¡Œæ˜¯åŸExcelä¸­é”™è¯¯çš„æ•°æ®ï¼Œä¹Ÿå·²ç»æ‰“å°äº†å‡ºæ¥ï¼Œä½†æ˜¯æ•™è‚²ç»å†ä¸­çš„æ•™è‚²æ°´å¹³ä¹Ÿæ˜¯é”™è¯¯çš„ï¼Œå´æ²¡è¢«æ‰“å°å‡ºæ¥ï¼ŒæŸ¥çœ‹æºç å‘ç°ï¼ŒEasyPOI å¯¹ Collection ä¸­çš„å¯¹è±¡å¹¶æ²¡æœ‰è¿›è¡Œæ ¡éªŒï¼Œæˆ‘ä»¬åœ¨ä¸‹æ–‡ä¸­è§£å†³ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20191224221513.png"></p><h2 id="äº”ã€å¯¼å…¥å€¼è‡ªå®šä¹‰æ ¡éªŒä¹‹é‡å¤å€¼æ ¡éªŒ"><a href="#äº”ã€å¯¼å…¥å€¼è‡ªå®šä¹‰æ ¡éªŒä¹‹é‡å¤å€¼æ ¡éªŒ" class="headerlink" title="äº”ã€å¯¼å…¥å€¼è‡ªå®šä¹‰æ ¡éªŒä¹‹é‡å¤å€¼æ ¡éªŒ"></a>äº”ã€å¯¼å…¥å€¼è‡ªå®šä¹‰æ ¡éªŒä¹‹é‡å¤å€¼æ ¡éªŒ</h2><p>ä¸Šæ–‡æ‰€ä½œçš„æ ¡éªŒåªæ˜¯ä¸€äº›åŸºæœ¬çš„æ ¡éªŒï¼Œå¯èƒ½ä¼šæœ‰è¯¸å¦‚Excelä¸­é‡å¤è¡Œæ ¡éªŒï¼ŒExcelä¸­æ•°æ®ä¸æ•°æ®åº“é‡å¤æ ¡éªŒç­‰ç­‰ã€‚è¿™ç§æ ¡éªŒå°±æ— æ³•é€šè¿‡ Hibernate Validator æ¥å®Œæˆï¼Œåªèƒ½å†™ä»£ç æ¥å®ç°æ ¡éªŒé€»è¾‘äº†ã€‚</p><p>é¦–å…ˆä»ç®€å•çš„Excelæ•°æ®ä¸æ•°æ®åº“å€¼é‡å¤æ ¡éªŒå¼€å§‹ã€‚ä¸ºäº†ä¾¿äºæ¼”ç¤ºï¼Œå°±ä¸å¼•å…¥æ•°æ®åº“äº†ï¼Œç›´æ¥Mockä¸€äº›æ•°æ®ç”¨æ¥åˆ¤æ–­æ˜¯å¦é‡å¤ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MockTalentDataService</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;TalentUser&gt; talentUsers = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>    <span class="hljs-keyword">static</span> &#123;<br>        TalentUser u1 = <span class="hljs-keyword">new</span> TalentUser(<span class="hljs-number">1L</span>, <span class="hljs-string">&quot;å‡Œé£&quot;</span>, <span class="hljs-string">&quot;18311342567&quot;</span>);<br>        TalentUser u2 = <span class="hljs-keyword">new</span> TalentUser(<span class="hljs-number">2L</span>, <span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>, <span class="hljs-string">&quot;18512343567&quot;</span>);<br>        TalentUser u3 = <span class="hljs-keyword">new</span> TalentUser(<span class="hljs-number">3L</span>, <span class="hljs-string">&quot;æå››&quot;</span>, <span class="hljs-string">&quot;18902343267&quot;</span>);<br>        talentUsers.add(u1);<br>        talentUsers.add(u2);<br>        talentUsers.add(u3);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¡éªŒæ˜¯å¦é‡å¤</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">checkForDuplicates</span><span class="hljs-params">(String name, String phone)</span> </span>&#123;<br>        <span class="hljs-comment">// å§“åä¸æ‰‹æœºå·ç›¸ç­‰ä¸ªæ•°ä¸ç­‰äº0åˆ™ä¸ºé‡å¤</span><br>        <span class="hljs-keyword">return</span> talentUsers.stream().anyMatch(e -&gt; e.getName().equals(name) &amp;&amp; e.getPhone().equals(phone));<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­Mockæ•°æ®ä¸­ ID ä¸º 1 çš„æ•°æ®ä¸ç¤ºä¾‹Excel2 ä¸­çš„æ•°æ®æ˜¯é‡å¤çš„ã€‚<br>EasyPOI æä¾›äº†æ ¡éªŒçš„æ¥å£ï¼Œè¿™éœ€è¦æˆ‘ä»¬è‡ªå·±å†™ä¸€ä¸ªç”¨äºæ ¡éªŒçš„ç±»ã€‚åœ¨è¿™ä¸ªç±»ä¸­ï¼Œå¯ä»¥å¯¹å¯¼å…¥æ—¶çš„æ¯ä¸€è¡Œæ•°æ®è¿›è¡Œæ ¡éªŒï¼Œæ¡†æ¶é€šè¿‡ ExcelVerifyHandlerResult å¯¹è±¡æ¥åˆ¤æ–­æ˜¯å¦æ ¡éªŒé€šè¿‡ï¼Œæ ¡éªŒä¸é€šè¿‡éœ€è¦ä¼ é€’ ErrorMsgã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TalentImportVerifyHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IExcelVerifyHandler</span>&lt;<span class="hljs-title">TalentUserInputEntity</span>&gt; </span>&#123;<br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> MockTalentDataService mockTalentDataService;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ExcelVerifyHandlerResult <span class="hljs-title">verifyHandler</span><span class="hljs-params">(TalentUserInputEntity inputEntity)</span> </span>&#123;<br>        StringJoiner joiner = <span class="hljs-keyword">new</span> StringJoiner(<span class="hljs-string">&quot;,&quot;</span>);<br>        <span class="hljs-comment">// æ ¹æ®å§“åä¸æ‰‹æœºå·åˆ¤æ–­æ•°æ®æ˜¯å¦é‡å¤</span><br>        String name = inputEntity.getName();<br>        String phone = inputEntity.getPhone();<br>        <span class="hljs-comment">// mock æ•°æ®åº“</span><br>        <span class="hljs-keyword">boolean</span> duplicates = mockTalentDataService.checkForDuplicates(name, phone);<br>        <span class="hljs-keyword">if</span> (duplicates) &#123;<br>            joiner.add(<span class="hljs-string">&quot;æ•°æ®ä¸æ•°æ®åº“æ•°æ®é‡å¤&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span> (joiner.length() != <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ExcelVerifyHandlerResult(<span class="hljs-keyword">false</span>, joiner.toString());<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ExcelVerifyHandlerResult(<span class="hljs-keyword">true</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¿®æ”¹æ ¡éªŒå¤„ä»£ç ï¼Œè®¾ç½®æ ¡éªŒç±»å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Resource</span><br><span class="hljs-keyword">private</span> TalentImportVerifyHandler talentImportVerifyHandler;<br><br><span class="hljs-meta">@PostMapping(&quot;/upload&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">upload</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;file&quot;)</span> MultipartFile multipartFile)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>  ImportParams params = <span class="hljs-keyword">new</span> ImportParams();<br>  <span class="hljs-comment">// è¡¨å¤´è®¾ç½®ä¸º2è¡Œ</span><br>  params.setHeadRows(<span class="hljs-number">2</span>);<br>  <span class="hljs-comment">// æ ‡é¢˜è¡Œè®¾ç½®ä¸º0è¡Œï¼Œé»˜è®¤æ˜¯0ï¼Œå¯ä»¥ä¸è®¾ç½®</span><br>  params.setTitleRows(<span class="hljs-number">0</span>);<br>  <span class="hljs-comment">// å¼€å¯Excelæ ¡éªŒ</span><br>  params.setNeedVerfiy(<span class="hljs-keyword">true</span>);<br>  params.setVerifyHandler(talentImportVerifyHandler);<br>  ExcelImportResult&lt;TalentUserInputEntity&gt; result = ExcelImportUtil.importExcelMore(multipartFile.getInputStream(),<br>                                                                                    TalentUserInputEntity.class, params);<br>  System.out.println(<span class="hljs-string">&quot;æ˜¯å¦æ ¡éªŒå¤±è´¥: &quot;</span> + result.isVerfiyFail());<br>  System.out.println(<span class="hljs-string">&quot;æ ¡éªŒå¤±è´¥çš„é›†åˆ:&quot;</span> + JSONObject.toJSONString(result.getFailList()));<br>  System.out.println(<span class="hljs-string">&quot;æ ¡éªŒé€šè¿‡çš„é›†åˆ:&quot;</span> + JSONObject.toJSONString(result.getList()));<br>  <span class="hljs-keyword">for</span> (TalentUserInputEntity entity : result.getFailList()) &#123;<br>    <span class="hljs-keyword">int</span> line = entity.getRowNum() + <span class="hljs-number">1</span>;<br>    String msg = <span class="hljs-string">&quot;ç¬¬&quot;</span> + line + <span class="hljs-string">&quot;è¡Œçš„é”™è¯¯æ˜¯ï¼š&quot;</span> + entity.getErrorMsg();<br>    System.out.println(msg);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¸Šä¼  ç¤ºä¾‹Excel2 æ–‡ä»¶æµ‹è¯•ï¼Œç»“æœè¾“å‡ºï¼š  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20191228134843.png"></p><p>è€Œç¬¬ä¸ƒè¡Œçš„æ•°æ®æ­£æ˜¯ä¸Mockä¸­çš„æ•°æ®ç›¸é‡å¤çš„ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20191228134936.png"></p><h2 id="å…­ã€å¯¼å…¥å€¼è‡ªå®šä¹‰æ ¡éªŒä¹‹Collectionå¯¹è±¡æ ¡éªŒ"><a href="#å…­ã€å¯¼å…¥å€¼è‡ªå®šä¹‰æ ¡éªŒä¹‹Collectionå¯¹è±¡æ ¡éªŒ" class="headerlink" title="å…­ã€å¯¼å…¥å€¼è‡ªå®šä¹‰æ ¡éªŒä¹‹Collectionå¯¹è±¡æ ¡éªŒ"></a>å…­ã€å¯¼å…¥å€¼è‡ªå®šä¹‰æ ¡éªŒä¹‹Collectionå¯¹è±¡æ ¡éªŒ</h2><p>ä¸Šæ–‡ä¸­è¿˜æœ‰ä¸€ä¸ªå¾…è§£å†³çš„é—®é¢˜ï¼Œå°±æ˜¯Collectionä¸­çš„å¯¹è±¡æ·»åŠ äº†Hibernate Validator æ³¨è§£æ ¡éªŒä½†æ˜¯å¹¶æœªç”Ÿæ•ˆçš„é—®é¢˜ï¼Œç°åœ¨å°±æ¥è§£å†³ä¸€ä¸‹ã€‚ä¸Šä¸€æ­¥ä¸­å®ç°äº†å¯¼å…¥å¯¹è±¡çš„æ ¡éªŒç±»ï¼Œæ ¡éªŒç±»ä¼šæ ¡éªŒExcelä¸­çš„æ¯ä¸€æ¡æ•°æ®ï¼Œ é‚£æˆ‘æ˜¯ä¸æ˜¯å¯ä»¥ç›´æ¥åœ¨æ ¡éªŒç±»ä¸­æ ¡éªŒCollectionä¸­å¯¹è±¡äº†å‘¢ï¼Ÿå®è·µè¯æ˜è¡Œä¸é€šï¼Œå› ä¸ºè¿™ä¸ªæ ¡éªŒç±»çš„verifyHandleræ–¹æ³•åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œæ‰€ä»¥Collectionä¸­åªæœ‰ä¸€æ¡è®°å½•ã€‚æ—¢ç„¶è¿™é‡Œè¡Œä¸é€šçš„è¯ï¼Œå°±åªèƒ½å¯¹å¯¼å…¥ç»“æœå†è¿›è¡Œæ ¡éªŒäº†ã€‚</p><p>å› ä¸ºCollectionä¸­çš„æ•°æ®EasyPOIæ ¡éªŒä¸åˆ°ï¼Œæ‰€ä»¥æœ‰é—®é¢˜çš„æ•°æ®ä¹Ÿå¯èƒ½ä¼šè¢«æ¡†æ¶æ”¾åˆ°result.getList()ä¸­è€Œä¸æ˜¯result.getFailList() ä¸­ï¼Œä¸ºäº†æ ¡éªŒéœ€è¦å°†ä¸¤ä¸ªé›†åˆåˆå¹¶ä¸ºä¸€ä¸ªé›†åˆï¼Œä½¿ç”¨ EasyPOI è‡ªå¸¦çš„å·¥å…·ç±» PoiValidationUtil è¿›è¡Œæ ¡éªŒ Collection ä¸­çš„å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Resource</span><br><span class="hljs-keyword">private</span> TalentImportVerifyHandler talentImportVerifyHandler;<br><br><span class="hljs-meta">@PostMapping(&quot;/upload&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">upload</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;file&quot;)</span> MultipartFile multipartFile)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>  ImportParams params = <span class="hljs-keyword">new</span> ImportParams();<br>  <span class="hljs-comment">// è¡¨å¤´è®¾ç½®ä¸º2è¡Œ</span><br>  params.setHeadRows(<span class="hljs-number">2</span>);<br>  <span class="hljs-comment">// æ ‡é¢˜è¡Œè®¾ç½®ä¸º0è¡Œï¼Œé»˜è®¤æ˜¯0ï¼Œå¯ä»¥ä¸è®¾ç½®</span><br>  params.setTitleRows(<span class="hljs-number">0</span>);<br>  <span class="hljs-comment">// å¼€å¯Excelæ ¡éªŒ</span><br>  params.setNeedVerfiy(<span class="hljs-keyword">true</span>);<br>  params.setVerifyHandler(talentImportVerifyHandler);<br>  ExcelImportResult&lt;TalentUserInputEntity&gt; result = ExcelImportUtil.importExcelMore(multipartFile.getInputStream(),<br>                                                                                    TalentUserInputEntity.class, params);<br>  System.out.println(<span class="hljs-string">&quot;æ˜¯å¦æ ¡éªŒå¤±è´¥: &quot;</span> + result.isVerfiyFail());<br>  System.out.println(<span class="hljs-string">&quot;æ ¡éªŒå¤±è´¥çš„é›†åˆ:&quot;</span> + JSONObject.toJSONString(result.getFailList()));<br>  System.out.println(<span class="hljs-string">&quot;æ ¡éªŒé€šè¿‡çš„é›†åˆ:&quot;</span> + JSONObject.toJSONString(result.getList()));<br><br>  <span class="hljs-comment">// åˆå¹¶ç»“æœé›†</span><br>  List&lt;TalentUserInputEntity&gt; resultList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>  resultList.addAll(result.getFailList());<br>  resultList.addAll(result.getList());<br>  <span class="hljs-keyword">for</span> (TalentUserInputEntity inputEntity : resultList) &#123;<br>    StringJoiner joiner = <span class="hljs-keyword">new</span> StringJoiner(<span class="hljs-string">&quot;,&quot;</span>);<br>    joiner.add(inputEntity.getErrorMsg());<br>    <span class="hljs-comment">// æ ¡éªŒCollectionçš„å…ƒç´ </span><br>    inputEntity.getExperienceList().forEach(e -&gt; verify(joiner, e));<br>    inputEntity.getEducationList().forEach(e -&gt; verify(joiner, e));<br>    inputEntity.getAwardList().forEach(e -&gt; verify(joiner, e));<br>    inputEntity.getPunishmentList().forEach(e -&gt; verify(joiner, e));<br>    inputEntity.setErrorMsg(joiner.toString());<br>  &#125;<br><br>  <span class="hljs-keyword">for</span> (TalentUserInputEntity entity : result.getFailList()) &#123;<br>    <span class="hljs-keyword">int</span> line = entity.getRowNum() + <span class="hljs-number">1</span>;<br>    String msg = <span class="hljs-string">&quot;ç¬¬&quot;</span> + line + <span class="hljs-string">&quot;è¡Œçš„é”™è¯¯æ˜¯ï¼š&quot;</span> + entity.getErrorMsg();<br>    System.out.println(msg);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">verify</span><span class="hljs-params">(StringJoiner joiner, Object object)</span> </span>&#123;<br>  String validationMsg = PoiValidationUtil.validation(object, <span class="hljs-keyword">null</span>);<br>  <span class="hljs-keyword">if</span> (StringUtils.isNotEmpty(validationMsg)) &#123;<br>    joiner.add(validationMsg);<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¸Šä¼  ç¤ºä¾‹Excel2 ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20191228145220.png"></p><h2 id="ä¸ƒã€å¯¼å…¥å€¼è‡ªå®šä¹‰æ ¡éªŒä¹‹Excelé‡å¤è¡Œæ ¡éªŒ"><a href="#ä¸ƒã€å¯¼å…¥å€¼è‡ªå®šä¹‰æ ¡éªŒä¹‹Excelé‡å¤è¡Œæ ¡éªŒ" class="headerlink" title="ä¸ƒã€å¯¼å…¥å€¼è‡ªå®šä¹‰æ ¡éªŒä¹‹Excelé‡å¤è¡Œæ ¡éªŒ"></a>ä¸ƒã€å¯¼å…¥å€¼è‡ªå®šä¹‰æ ¡éªŒä¹‹Excelé‡å¤è¡Œæ ¡éªŒ</h2><p>ä¸Šæ–‡ä¸­å¯¹Excelä¸­æ•°æ®ä¸æ•°æ®åº“æ•°æ®è¿›è¡Œé‡å¤æ ¡éªŒï¼Œå¯æœ‰äº›éœ€æ±‚æ˜¯è¦æ±‚æ•°æ®åº“åœ¨å…¥åº“å‰éœ€è¦å¯¹Excelçš„çš„é‡å¤è¡Œè¿›è¡Œæ ¡éªŒã€‚è¿™éœ€è¦åœ¨æ ¡éªŒç±»ä¸­å®Œæˆï¼Œä½†æ ¡éªŒç±»ä¸­å¹¶æ²¡æœ‰å…¨éƒ¨è¡Œçš„æ•°æ®ï¼Œè¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿåšä¸»çš„åšæ³•æ˜¯å°†å¯¼å…¥çš„æ•°æ®æ”¾åˆ° ThreadLocal ä¸­è¿›è¡Œæš‚å­˜ï¼Œä»è€Œè¾¾åˆ°åœ¨æ ¡éªŒç±»ä¸­æ ¡éªŒExcelé‡å¤è¡Œçš„ç›®çš„ã€‚<strong>ThreadLocalä½¿ç”¨æ³¨æ„å®Œä¹‹åä¸€å®šè¦åŠæ—¶æ¸…ç†ï¼</strong></p><p>é¦–å…ˆå®šä¹‰ä»€ä¹ˆå«é‡å¤è¡Œï¼Œå®Œå…¨ç›¸åŒçš„ä¸¤è¡Œæ˜¯é‡å¤è¡Œï¼Œæœ¬æ–‡ä¸­è®¾å®šname ä¸ phone ç›¸åŒçš„è¡Œä¸ºé‡å¤è¡Œï¼Œç”±äºåªéœ€è¦æ¯”è¾ƒè¿™ä¸¤ä¸ªå­—æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡å†™å¯¼å…¥å¯¹è±¡çš„equalsä¸hashCodeæ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TalentUserInputEntity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IExcelDataModel</span>, <span class="hljs-title">IExcelModel</span> </span>&#123;<br>    <span class="hljs-comment">// æ—¶é—´æ ¼å¼æ ¡éªŒæ­£åˆ™</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String DATE_REGEXP = <span class="hljs-string">&quot;(Mon|Tue|Wed|Thu|Fri|Sat|Sun)( )(Dec|Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov)( )\\d&#123;2&#125;( )(00:00:00)( )(CST)( )\\d&#123;4&#125;&quot;</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è¡Œå·</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> rowNum;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é”™è¯¯æ¶ˆæ¯</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String errorMsg;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å§“å*&quot;)</span><br>    <span class="hljs-meta">@NotBlank(message = &quot;[å§“å]ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ€§åˆ«*&quot;, replace = &#123;&quot;ç”·_0&quot;, &quot;å¥³_1&quot;&#125;)</span><br>    <span class="hljs-meta">@Pattern(regexp = &quot;[01]&quot;, message = &quot;æ€§åˆ«é”™è¯¯&quot;)</span><br>    <span class="hljs-keyword">private</span> String genderStr;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ‰‹æœºå·*&quot;)</span><br>    <span class="hljs-meta">@Pattern(regexp = &quot;[0-9]&#123;11&#125;&quot;, message = &quot;æ‰‹æœºå·ä¸æ­£ç¡®&quot;)</span><br>    <span class="hljs-keyword">private</span> String phone;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å¼€å§‹å·¥ä½œæ—¶é—´*&quot;)</span><br>    <span class="hljs-meta">@Pattern(regexp = DATE_REGEXP, message = &quot;[å¼€å§‹å·¥ä½œæ—¶é—´]æ—¶é—´æ ¼å¼é”™è¯¯&quot;)</span><br>    <span class="hljs-keyword">private</span> String workTimeStr;<br><br>    <span class="hljs-meta">@Excel(name = &quot;æ°‘æ—*&quot;)</span><br>    <span class="hljs-meta">@NotBlank(message = &quot;[æ°‘æ—]ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> String national;<br><br>    <span class="hljs-meta">@Excel(name = &quot;è¯­è¨€æ°´å¹³*&quot;)</span><br>    <span class="hljs-meta">@NotBlank(message = &quot;[è¯­è¨€æ°´å¹³]ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> String languageProficiency;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å‡ºç”Ÿæ—¥æœŸ*&quot;)</span><br>    <span class="hljs-meta">@Pattern(regexp = DATE_REGEXP, message = &quot;[å‡ºç”Ÿæ—¥æœŸ]æ—¶é—´æ ¼å¼é”™è¯¯&quot;)</span><br>    <span class="hljs-keyword">private</span> String birthStr;<br><br>    <span class="hljs-meta">@Excel(name = &quot;èŒä½*&quot;)</span><br>    <span class="hljs-meta">@NotBlank(message = &quot;[èŒä½]ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> String jobsName;<br><br>    <span class="hljs-meta">@Excel(name = &quot;èŒä½ç±»å‹*&quot;)</span><br>    <span class="hljs-meta">@NotBlank(message = &quot;[èŒä½ç±»å‹]ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> String categoryName;<br><br>    <span class="hljs-meta">@Excel(name = &quot;è–ªèµ„*&quot;, replace = &#123;&quot;3Kä»¥ä¸‹_1&quot;, &quot;3K-5K_2&quot;, &quot;5K-10K_3&quot;, &quot;10K-20K_4&quot;, &quot;20K-50K_5&quot;, &quot;50Kä»¥ä¸Š_6&quot;&#125;)</span><br>    <span class="hljs-meta">@Pattern(regexp = &quot;[123456]&quot;, message = &quot;è–ªèµ„ä¿¡æ¯é”™è¯¯&quot;)</span><br>    <span class="hljs-keyword">private</span> String salaryStr;<br><br>    <span class="hljs-meta">@Excel(name = &quot;å·¥ä½œåœ°ç‚¹*&quot;)</span><br>    <span class="hljs-meta">@NotBlank(message = &quot;[å·¥ä½œåœ°ç‚¹]ä¸èƒ½ä¸ºç©º&quot;)</span><br>    <span class="hljs-keyword">private</span> String workArea;<br><br>    <span class="hljs-meta">@ExcelCollection(name = &quot;å·¥ä½œç»å†*&quot;)</span><br>    <span class="hljs-keyword">private</span> List&lt;ExperienceInputEntity&gt; experienceList;<br><br>    <span class="hljs-meta">@ExcelCollection(name = &quot;æ•™è‚²ç»å†*&quot;)</span><br>    <span class="hljs-keyword">private</span> List&lt;EducationInputEntity&gt; educationList;<br><br>    <span class="hljs-meta">@ExcelCollection(name = &quot;è·å¥–æƒ…å†µ&quot;)</span><br>    <span class="hljs-keyword">private</span> List&lt;AwardsInputEntity&gt; awardList;<br><br>    <span class="hljs-meta">@ExcelCollection(name = &quot;æŠ€èƒ½è¯ä¹¦&quot;)</span><br>    <span class="hljs-keyword">private</span> List&lt;PunishmentInputEntity&gt; punishmentList;<br><br>    <span class="hljs-meta">@Excel(name = &quot;ç‰¹é•¿&quot;)</span><br>    <span class="hljs-keyword">private</span> String specialty;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">equals</span><span class="hljs-params">(Object o)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> == o) <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>        <span class="hljs-keyword">if</span> (o == <span class="hljs-keyword">null</span> || getClass() != o.getClass()) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        TalentUserInputEntity that = (TalentUserInputEntity) o;<br>        <span class="hljs-keyword">return</span> Objects.equals(name, that.name) &amp;&amp;<br>                Objects.equals(phone, that.phone);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> Objects.hash(name, phone);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¿®æ”¹æ ¡éªŒç±»ä»£ç ï¼Œå®ç°é‡å¤è¡Œçš„æ ¡éªŒé€»è¾‘</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TalentImportVerifyHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IExcelVerifyHandler</span>&lt;<span class="hljs-title">TalentUserInputEntity</span>&gt; </span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ThreadLocal&lt;List&lt;TalentUserInputEntity&gt;&gt; threadLocal = <span class="hljs-keyword">new</span> ThreadLocal&lt;&gt;();<br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> MockTalentDataService mockTalentDataService;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ExcelVerifyHandlerResult <span class="hljs-title">verifyHandler</span><span class="hljs-params">(TalentUserInputEntity inputEntity)</span> </span>&#123;<br>        StringJoiner joiner = <span class="hljs-keyword">new</span> StringJoiner(<span class="hljs-string">&quot;,&quot;</span>);<br>        <span class="hljs-comment">// æ ¹æ®å§“åä¸æ‰‹æœºå·åˆ¤æ–­æ•°æ®æ˜¯å¦é‡å¤</span><br>        String name = inputEntity.getName();<br>        String phone = inputEntity.getPhone();<br>        <span class="hljs-comment">// mock æ•°æ®åº“</span><br>        <span class="hljs-keyword">boolean</span> duplicates = mockTalentDataService.checkForDuplicates(name, phone);<br>        <span class="hljs-keyword">if</span> (duplicates) &#123;<br>            joiner.add(<span class="hljs-string">&quot;æ•°æ®ä¸æ•°æ®åº“æ•°æ®é‡å¤&quot;</span>);<br>        &#125;<br><br>        List&lt;TalentUserInputEntity&gt; threadLocalVal = threadLocal.get();<br>        <span class="hljs-keyword">if</span> (threadLocalVal == <span class="hljs-keyword">null</span>) &#123;<br>            threadLocalVal = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        &#125;<br><br>        threadLocalVal.forEach(e -&gt; &#123;<br>            <span class="hljs-keyword">if</span> (e.equals(inputEntity)) &#123;<br>                <span class="hljs-keyword">int</span> lineNumber = e.getRowNum() + <span class="hljs-number">1</span>;<br>                joiner.add(<span class="hljs-string">&quot;æ•°æ®ä¸ç¬¬&quot;</span> + lineNumber + <span class="hljs-string">&quot;è¡Œé‡å¤&quot;</span>);<br>            &#125;<br>        &#125;);<br>        <span class="hljs-comment">// æ·»åŠ æœ¬è¡Œæ•°æ®å¯¹è±¡åˆ°ThreadLocalä¸­</span><br>        threadLocalVal.add(inputEntity);<br>        threadLocal.set(threadLocalVal);<br>        <span class="hljs-keyword">if</span> (joiner.length() != <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ExcelVerifyHandlerResult(<span class="hljs-keyword">false</span>, joiner.toString());<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ExcelVerifyHandlerResult(<span class="hljs-keyword">true</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> ThreadLocal&lt;List&lt;TalentUserInputEntity&gt;&gt; getThreadLocal() &#123;<br>        <span class="hljs-keyword">return</span> threadLocal;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç”±äºæ ¡éªŒç±»ä¸­ä½¿ç”¨äº†ThreadLocalï¼Œå› æ­¤éœ€è¦åŠæ—¶é‡Šæ”¾ï¼Œä¿®æ”¹å¯¼å…¥å¤„çš„ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Resource</span><br><span class="hljs-keyword">private</span> TalentImportVerifyHandler talentImportVerifyHandler;<br><br><span class="hljs-meta">@PostMapping(&quot;/upload&quot;)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">upload</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(&quot;file&quot;)</span> MultipartFile multipartFile)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>  ExcelImportResult&lt;TalentUserInputEntity&gt; result;<br>  <span class="hljs-keyword">try</span> &#123;<br>    ImportParams params = <span class="hljs-keyword">new</span> ImportParams();<br>    <span class="hljs-comment">// è¡¨å¤´è®¾ç½®ä¸º2è¡Œ</span><br>    params.setHeadRows(<span class="hljs-number">2</span>);<br>    <span class="hljs-comment">// æ ‡é¢˜è¡Œè®¾ç½®ä¸º0è¡Œï¼Œé»˜è®¤æ˜¯0ï¼Œå¯ä»¥ä¸è®¾ç½®</span><br>    params.setTitleRows(<span class="hljs-number">0</span>);<br>    <span class="hljs-comment">// å¼€å¯Excelæ ¡éªŒ</span><br>    params.setNeedVerfiy(<span class="hljs-keyword">true</span>);<br>    params.setVerifyHandler(talentImportVerifyHandler);<br>    result = ExcelImportUtil.importExcelMore(multipartFile.getInputStream(),<br>                                             TalentUserInputEntity.class, params);<br>  &#125; <span class="hljs-keyword">finally</span> &#123;<br>    <span class="hljs-comment">// æ¸…é™¤threadLocal é˜²æ­¢å†…å­˜æ³„æ¼</span><br>    ThreadLocal&lt;List&lt;TalentUserInputEntity&gt;&gt; threadLocal = talentImportVerifyHandler.getThreadLocal();<br>    <span class="hljs-keyword">if</span> (threadLocal != <span class="hljs-keyword">null</span>) &#123;<br>      threadLocal.remove();<br>    &#125;<br>  &#125;<br>  System.out.println(<span class="hljs-string">&quot;æ˜¯å¦æ ¡éªŒå¤±è´¥: &quot;</span> + result.isVerfiyFail());<br>  System.out.println(<span class="hljs-string">&quot;æ ¡éªŒå¤±è´¥çš„é›†åˆ:&quot;</span> + JSONObject.toJSONString(result.getFailList()));<br>  System.out.println(<span class="hljs-string">&quot;æ ¡éªŒé€šè¿‡çš„é›†åˆ:&quot;</span> + JSONObject.toJSONString(result.getList()));<br><br>  <span class="hljs-comment">// åˆå¹¶ç»“æœé›†</span><br>  List&lt;TalentUserInputEntity&gt; resultList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>  resultList.addAll(result.getFailList());<br>  resultList.addAll(result.getList());<br>  <span class="hljs-keyword">for</span> (TalentUserInputEntity inputEntity : resultList) &#123;<br>    StringJoiner joiner = <span class="hljs-keyword">new</span> StringJoiner(<span class="hljs-string">&quot;,&quot;</span>);<br>    joiner.add(inputEntity.getErrorMsg());<br>    <span class="hljs-comment">// æ ¡éªŒCollectionçš„å…ƒç´ </span><br>    inputEntity.getExperienceList().forEach(e -&gt; verify(joiner, e));<br>    inputEntity.getEducationList().forEach(e -&gt; verify(joiner, e));<br>    inputEntity.getAwardList().forEach(e -&gt; verify(joiner, e));<br>    inputEntity.getPunishmentList().forEach(e -&gt; verify(joiner, e));<br>    inputEntity.setErrorMsg(joiner.toString());<br>  &#125;<br><br>  <span class="hljs-keyword">for</span> (TalentUserInputEntity entity : result.getFailList()) &#123;<br>    <span class="hljs-keyword">int</span> line = entity.getRowNum() + <span class="hljs-number">1</span>;<br>    String msg = <span class="hljs-string">&quot;ç¬¬&quot;</span> + line + <span class="hljs-string">&quot;è¡Œçš„é”™è¯¯æ˜¯ï¼š&quot;</span> + entity.getErrorMsg();<br>    System.out.println(msg);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">verify</span><span class="hljs-params">(StringJoiner joiner, Object object)</span> </span>&#123;<br>  String validationMsg = PoiValidationUtil.validation(object, <span class="hljs-keyword">null</span>);<br>  <span class="hljs-keyword">if</span> (StringUtils.isNotEmpty(validationMsg)) &#123;<br>    joiner.add(validationMsg);<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¯¼å…¥ç¤ºä¾‹Excel2ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20191228155741.png"></p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†å¯¼å…¥çš„å¤§éƒ¨åˆ†éœ€æ±‚ã€‚</p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><ul><li><a href="https://github.com/Mosiki/learning-modules">ç¤ºä¾‹ä»£ç </a></li></ul><p>è¿™ç¯‡åšå®¢èŠ±è´¹äº†æˆ‘ä¸å°‘æ—¶é—´æ¥å†™ï¼Œæ–‡ä¸­çš„ä»£ç ä¹Ÿä¸Šä¼ åˆ°äº†GitHubä¸Šï¼Œå¹¶ä¸”åœ¨å†™æ–‡ç« çš„åŒæ—¶ï¼Œå­¦ä¹ äº†ä¸€ä¸‹Git tag çš„ä½¿ç”¨ï¼Œè¯»è€…å¯ä»¥åœ¨ GitHub çš„åˆ†æ”¯åˆ‡æ¢å¯ä»¥åˆ‡æ¢åˆ°ä¸åŒtagçœ‹ä»£ç ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20191228154341.png"></p>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>easypoiå¯¼å…¥Excel</tag>
      
      <tag>easypoiå¯¼å…¥Excelæ—¶é—´æ ¼å¼æ ¡éªŒ</tag>
      
      <tag>easypoiå¯¼å…¥Collectionæ ¡éªŒ</tag>
      
      <tag>easypoiå¯¼å…¥é‡å¤è¡Œæ ¡éªŒ</tag>
      
      <tag>easypoiå¯¼å…¥é‡å¤å€¼æ ¡éªŒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ParallelsDesktopå®‰è£…ç²¾ç®€ç‰ˆç³»ç»Ÿ</title>
    <link href="/ParallelsDesktop%E5%AE%89%E8%A3%85%E7%B2%BE%E7%AE%80%E7%89%88%E7%B3%BB%E7%BB%9F.html"/>
    <url>/ParallelsDesktop%E5%AE%89%E8%A3%85%E7%B2%BE%E7%AE%80%E7%89%88%E7%B3%BB%E7%BB%9F.html</url>
    
    <content type="html"><![CDATA[<p>åˆ†äº«ä¸€ä¸ªè™šæ‹Ÿæœºå®‰è£…ç²¾ç®€ç‰ˆ Windows10 ç³»ç»Ÿçš„æ–¹æ³•ï¼Œåªå ç”¨ 5G å­˜å‚¨ç©ºé—´å¤§å°çš„å®Œæ•´ç‰ˆ win10 ç³»ç»Ÿå“¦ï¼Œä¸è¦å®‰è£…é‚£äº›åƒåœ¾é˜‰å‰²è¿‡çš„win7æˆ–è€…xpç³»ç»Ÿäº†ï¼Œwin10 ä¹Ÿå¯ä»¥å ç”¨è¿™ä¹ˆå°çš„ç©ºé—´å“¦~</p><p>ç”¨äº† Mac è¿™ä¹ˆä¹…ï¼Œæ„Ÿè§‰å¼€å‘ç¡®å®ç”¨ Mac æ›´æ–¹ä¾¿æ›´å‹å¥½ä¸€äº›ï¼Œä½†æ˜¯æœ‰æ—¶å€™å°±ä¼šç”¨åˆ° Windows ç³»ç»Ÿï¼Œæ¯”å¦‚éœ€è¦ç”¨åˆ° XShell ä¹‹ç±» win ä¸Šç‹¬æœ‰çš„è½¯ä»¶ã€‚è¿™æ—¶å€™åœ¨ Mac ä¸Šå®‰ä¸€ä¸ª Windows è™šæ‹Ÿæœºå°±å¾ˆæœ‰ç”¨å¤„äº†ã€‚å³ä½¿æ˜¯ Windows ç”µè„‘ï¼Œåšä¸€äº›æ•æ„Ÿæ“ä½œå®¹æ˜“ä¸­æ¯’æ—¶å€™ï¼ˆæ¯”å¦‚ä½œæ­»ç©ç©ç—…æ¯’ä¹‹ç±»çš„ï¼‰ï¼Œä¹Ÿæœ€å¥½éš”ç¦»ç³»ç»Ÿåœ¨è™šæ‹Ÿæœºé‡Œé¼“æ£ã€‚</p><p>åœ¨ Mac ä¸Š Parallels Desktop å®‰è£…çš„è™šæ‹Ÿæœºå…¨å±åï¼Œå’ŒMacç³»ç»Ÿæ— ç¼åˆ‡æ¢ï¼Œå°±æ˜¯èˆ’æœ~</p><p>å•¥ï¼Ÿä½ è¿˜é—®æˆ‘æœ‰ä»€ä¹ˆç”¨ï¼Ÿå¦‚æœä½ ä¹°ä¸ª 128 GB å­˜å‚¨çš„ Mac å°±çŸ¥é“æœ‰æ²¡æœ‰ç”¨äº†ã€‚ï¼ˆæˆ‘çš„ 256 ä¹Ÿä¸å¤Ÿç”¨ï¼Œå› æ­¤é¼“æ£å‡ºè¿™ä¹ˆä¸ªæ–¹æ³•æ¥ï¼‰</p><a id="more"></a><p>Windows ç³»ç»Ÿå¾ˆå ç©ºé—´ï¼Œæ–°å®‰è£…çš„ç³»ç»ŸåŠ¨è¾„å ç”¨ 40G - 60G å­˜å‚¨ç©ºé—´ï¼Œå¦‚æœå®‰è£…åˆ°è™šæ‹Ÿæœºä¸­ï¼Œå°±æ˜¾å¾—ä¸æ˜¯é‚£ä¹ˆåˆ’ç®—äº†ã€‚ï¼ˆåœ¨è™šæ‹Ÿæœºä¸­å®‰è¿‡åŸç‰ˆé•œåƒçš„åŒå­¦ï¼Œå¯¹äºè™šæ‹Ÿæœºå ç”¨ç©ºé—´çš„å¤§å°ï¼Œè‚¯å®šæ·±æœ‰ä½“ä¼šï¼‰</p><p>åŸç‰ˆé•œåƒçš„ ISO æ–‡ä»¶ä¸€èˆ¬éƒ½è¦ 13G ä»¥ä¸Šï¼Œäºæ˜¯æˆ‘åœ¨ è¿œæ™¯è®ºå› æ‰¾åˆ°ä¸€ä¸ªå¤§ç¥ç²¾ç®€è¿‡çš„ Win10 ESD é•œåƒï¼Œåªç²¾ç®€äº†æ— ç”¨çš„ä¸€äº›æœåŠ¡ï¼Œæ— æ†ç»‘ï¼Œé•œåƒåŒ…ä»… 1G å¤§å°ï¼Œå®‰è£…åä¹Ÿä»…å ç”¨ 4G ç©ºé—´ï¼ŒçœŸé¦™ï¼</p><p>å¦‚æœä½ ä¸çŸ¥é“æˆ‘å¨å¨çš„æ˜¯ä»€ä¹ˆï¼Œå°±ä¸ç”¨ç»§ç»­å¾€ä¸‹çœ‹äº†ï¼Œä»¥ä¸‹ä»¥ Parallels Desktop è™šæ‹Ÿæœºä¸¾ä¾‹ï¼Œå…¶ä»–è™šæ‹Ÿæœºæ¯”å¦‚ Vmware Fusion ä¹‹ç±»çš„è¯·è§¦ç±»æ—é€šã€‚</p><h2 id="å®‰è£…å‡†å¤‡"><a href="#å®‰è£…å‡†å¤‡" class="headerlink" title="å®‰è£…å‡†å¤‡"></a>å®‰è£…å‡†å¤‡</h2><p>å‡ ä¹æ‰€æœ‰çš„è™šæ‹Ÿæœºè½¯ä»¶å®‰è£…æ—¶ï¼Œåªæ”¯æŒ ISO æ–‡ä»¶ï¼Œä½†æ˜¯ä¸€èˆ¬å°è£…çš„ç³»ç»Ÿéƒ½æ˜¯ ESD WIM ä¹‹ç±»çš„é•œåƒæ ¼å¼ï¼ŒSoï¼Œéœ€è¦è½¬æ¢æˆ ISO æ ¼å¼ã€‚</p><p>æˆ‘è¿™é‡Œç»™å‡ºè½¬æ¢å¥½çš„å¤§ç¥ç²¾ç®€çš„é•œåƒ ISO æ–‡ä»¶ï¼Œç”¨äº†ä¸€å¹´å¤šäº†ï¼Œå¾ˆç¨³å®šï¼Œå’ŒåŸç‰ˆé•œåƒæ²¡æœ‰ä»»ä½•å·®åˆ«ï¼Œå ç”¨ç©ºé—´ç›¸å¯¹åŸç‰ˆé•œåƒå°‘çš„ä¸æ˜¯ä¸€ç‚¹åŠç‚¹ã€‚è‹¥æƒ³è¦è‡ªå·±å°è£… ISOï¼Œè§æ–‡æœ«å‚è€ƒé“¾æ¥ã€‚</p><p><a href="https://pan.baidu.com/s/12mMWCCqRuREJC-2RM4gZ8g"><strong>Win10ç²¾ç®€ç‰ˆ ISO é•œåƒä»¥åŠå¼•å¯¼é•œåƒä¸‹è½½</strong></a>    æå–ç : <strong>vcmq</strong></p><p>ç½‘ç›˜å†…æœ‰ä¸¤ä¸ª ISO æ–‡ä»¶ï¼Œ<strong>WePE_64_V2.0.iso</strong> ä¸ºå¼•å¯¼é•œåƒï¼Œ<strong>win10.iso</strong> ä¸ºç³»ç»Ÿé•œåƒã€‚</p><p>ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°ã€‚</p><h2 id="å®‰è£…å¼•å¯¼é•œåƒ"><a href="#å®‰è£…å¼•å¯¼é•œåƒ" class="headerlink" title="å®‰è£…å¼•å¯¼é•œåƒ"></a>å®‰è£…å¼•å¯¼é•œåƒ</h2><ol><li>æ–°å»ºè™šæ‹Ÿæœºï¼Œé€‰æ‹© <strong>WePE_64_V2.0.iso</strong> è¿™ä¸ªå¼•å¯¼é•œåƒï¼Œå¯èƒ½ä¼šæœ‰å¦‚ä¸‹ä¹‹ç±»çš„æç¤ºï¼Œæ— è§†è·³è¿‡å³å¯ã€‚</li></ol><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190912215326.png"></p><ol start="2"><li><p>é€‰æ‹©ç³»ç»Ÿç±»å‹ä¸º win10</p></li><li><p>è¿™é‡Œéšä¾¿é€‰ä¸€ä¸ªå°±è¡Œ</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190912215506.png"></p></li><li><p>é€‰æ‹©ä¿å­˜ä½ç½®ä»¥åŠè®¾ç½®è™šæ‹Ÿæœºåç§°</p></li><li><p>å…³é—­è®¾å®šï¼Œç»§ç»­å®‰è£…è™šæ‹Ÿæœºï¼Œç›´åˆ°å¼€æœºè¿›å…¥ PE å¼•å¯¼ç³»ç»Ÿ</p></li></ol><h2 id="å®‰è£…-win10"><a href="#å®‰è£…-win10" class="headerlink" title="å®‰è£… win10"></a>å®‰è£… win10</h2><ol><li><p>é…ç½®è™šæ‹Ÿæœºè¿æ¥çš„é•œåƒä¸º <strong>win10.iso</strong></p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190912220349.png"></p></li><li><p>æ‰“å¼€å¼•å¯¼ç³»ç»Ÿå†…å·¦ä¸‹è§’çš„åˆ†åŒºå·¥å…· DiskGeniusï¼Œå³é”®ç¡¬ç›˜é€‰æ‹©å»ºç«‹æ–°åˆ†åŒºï¼ˆè¿™é‡Œçš„å¤§å°æ˜¯ä¸å‡†ç¡®çš„ï¼Œä¸ç”¨ç†ä¼šï¼‰ï¼Œç¡®å®šä¹‹åï¼Œé€‰æ‹©ä¿å­˜æ›´æ”¹ï¼Œç„¶åæ ¼å¼åŒ–é€‰æ˜¯ï¼ˆæ”¾å¿ƒä¸ä¼šå½±å“ä½ çš„å®¿ä¸»æœºç¯å¢ƒï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190912220905.png"></p></li><li><p>æ“ä½œå®Œå¦‚å›¾æ‰€ç¤ºï¼ˆæˆ‘çš„æ˜¯ 256Gï¼Œè¿™é‡Œä¹Ÿæ˜¾ç¤ºçš„æ˜¯ 256GBï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190912221112.png"></p></li><li><p>æ‰“å¼€ Windows å®‰è£…å™¨ï¼Œé€‰æ‹© win10 é•œåƒï¼ˆåœ¨DVD é©±åŠ¨å™¨å†…ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190912221241.png"></p></li><li><p>é€‰æ‹©å¼€å§‹å®‰è£…ï¼Œç„¶åç‚¹ç¡®å®šï¼Œç­‰å¾…å®‰è£…ï¼Œå®‰è£…å®Œéœ€è¦æ‰‹åŠ¨åœ¨å¼€å§‹èœå•ä¸­æ‰‹åŠ¨é‡å¯ã€‚</p></li><li><p>é‡å¯åï¼Œç³»ç»Ÿè‡ªåŠ¨è¿›è¡Œ win10ç³»ç»Ÿ çš„åŠ è½½ï¼Œç¨ç­‰ä¸€ä¼šå„¿å³å¯</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190912221809.png"></p></li></ol><h2 id="æ”¶å°¾å·¥ä½œ"><a href="#æ”¶å°¾å·¥ä½œ" class="headerlink" title="æ”¶å°¾å·¥ä½œ"></a>æ”¶å°¾å·¥ä½œ</h2><ol><li><p>é€‰æ‹©æ¡Œé¢ä¸Šçš„ç³»ç»Ÿæ¿€æ´»å·¥å…·ï¼Œç›´æ¥é€‰æ‹©æ¿€æ´»å³å¯ã€‚</p></li><li><p>è¿™æ—¶å€™å…¨å±è™šæ‹Ÿæœºï¼Œä¼šå‘ç°åˆ†è¾¨ç‡ä¸æ˜¯æœ€ä½³çš„ï¼Œå› ä¸ºä½ éœ€è¦å®‰è£…ä¸€ä¸‹è™šæ‹Ÿæœºå·¥å…·ï¼Œé€€å‡ºå…¨å±</p></li></ol><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190912224112.png"></p><ol start="3"><li><p>é€‰æ‹©å®‰è£… Parallels Tools</p></li><li><p>è¿›å…¥æˆ‘çš„ç”µè„‘ï¼ŒDVDé©±åŠ¨å™¨ï¼Œè¿è¡Œ Autorun æ–‡ä»¶è¿›è¡Œå®‰è£…ï¼Œå®‰è£…å®Œé€‰æ‹©é‡å¯ç³»ç»Ÿ</p></li></ol><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190912222617.png"></p><ol start="3"><li><p>é‡å¯åï¼Œé€‰æ‹©æœ€å¤§åŒ–ï¼ˆè€Œä¸æ˜¯èåˆæ¨¡å¼ï¼‰  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190912222847.png"></p></li><li><p>ç¨ç­‰ä¸€ä¼šï¼Œè™šæ‹Ÿæœºä¼šè‡ªåŠ¨è°ƒæ•´åˆ†è¾¨ç‡åˆ°è‡ªé€‚åº”ã€‚ç³»ç»Ÿä¹Ÿä¼šæˆåŠŸæ¿€æ´»ï¼Œæ¡Œé¢æ¿€æ´»è½¯ä»¶ä¼šè‡ªåŠ¨æ¶ˆå¤±ã€‚</p></li><li><p>å®Œæˆï¼</p></li></ol><h2 id="äº®ç‚¹"><a href="#äº®ç‚¹" class="headerlink" title="äº®ç‚¹"></a>äº®ç‚¹</h2><p>çœ‹ä¸€ä¸‹è™šæ‹Ÿæœºå ç”¨å§å˜¿å˜¿~</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190912223211.png"></p><p>å¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©å§~</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://jingyan.baidu.com/article/1876c85261a7f5890b137683.html">https://jingyan.baidu.com/article/1876c85261a7f5890b137683.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å·¥å…·ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ParallelsDesktopå®‰è£…ç²¾ç®€ç‰ˆç³»ç»Ÿ</tag>
      
      <tag>Vmvareå®‰è£…ç²¾ç®€ç‰ˆç³»ç»Ÿ</tag>
      
      <tag>ç²¾ç®€ç‰ˆwin10ç³»ç»Ÿ</tag>
      
      <tag>è™šæ‹Ÿæœºå®‰è£…esdæ ¼å¼ç³»ç»Ÿé•œåƒ</tag>
      
      <tag>è™šæ‹Ÿæœºå®‰è£…wimæ ¼å¼ç³»ç»Ÿé•œåƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå†…å­˜åˆ†é¡µå·¥å…·ç±»</title>
    <link href="/Java%E5%86%85%E5%AD%98%E5%88%86%E9%A1%B5%E5%B7%A5%E5%85%B7%E7%B1%BB.html"/>
    <url>/Java%E5%86%85%E5%AD%98%E5%88%86%E9%A1%B5%E5%B7%A5%E5%85%B7%E7%B1%BB.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å·¥ä½œè¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°åŸºäºå†…å­˜æ•°æ®è¿›è¡Œåˆ†é¡µå¤„ç†çš„æƒ…å†µï¼Œä¾‹å¦‚æ‰¹é‡æ›´æ–°æ•°æ®åº“æ—¶ï¼Œé›†åˆè¿‡å¤§éœ€è¦åˆ†æ‰¹æ›´æ–°çš„æƒ…å†µï¼Œè¿˜æœ‰ä¾‹å¦‚å¯¹ç¼“å­˜ä¸­çš„é›†åˆæ•°æ®è¿›è¡Œåˆ†é¡µè·å–è¿™ç§æƒ…å†µã€‚<br>æœ¬æ–‡æä¾›äº†é€šç”¨çš„å†…å­˜åˆ†é¡µå·¥å…·ï¼Œå‚è€ƒäº†ç½‘ç»œä¸Šçš„ä¸€äº›ä»£ç ï¼Œä¸»è¦åŸºäº <strong>subList()</strong> æ–¹æ³•å®ç°ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼å·¥å…·ç±»æºç åœ¨æœ¬æ–‡åº•éƒ¨ã€‚</p><a id="more"></a><h2 id="ä¼˜åŒ–å‰"><a href="#ä¼˜åŒ–å‰" class="headerlink" title="ä¼˜åŒ–å‰"></a>ä¼˜åŒ–å‰</h2><p>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹æ­£å¸¸å¦‚æœè¦å®ç°è¿™äº›éœ€æ±‚çš„è¯ï¼Œä»£ç çš„å®ç°æ˜¯æ€ä¹ˆæ ·çš„</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">// åˆ†é¡µè¿›è¡Œæ‰¹é‡æ›´æ–°</span><br><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">batchUpdateStudent</span><span class="hljs-params">(List&lt;Student&gt; students)</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> limit = <span class="hljs-number">100</span>;<br>    <span class="hljs-keyword">int</span> size = students.size();<br>    <span class="hljs-keyword">int</span> m = size / limit;<br>    <span class="hljs-keyword">int</span> n = size % limit;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++) &#123;<br>        List&lt;Student&gt; list = students.subList((i - <span class="hljs-number">1</span>) * limit, i * limit);<br>        studentDao.batchUpdate(list);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (n != <span class="hljs-number">0</span>) &#123;<br>        List&lt;Student&gt; list = students.subList(m * limit, students.size());<br>        studentDao.batchUpdate(list);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// åˆ†é¡µè·å–æ•°æ®</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Student&gt; <span class="hljs-title">pageStudents</span><span class="hljs-params">(Integer page, Integer pageSize)</span> </span>&#123;<br>    <span class="hljs-keyword">if</span> (page &lt; <span class="hljs-number">1</span>) &#123;<br>        page = <span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">int</span> start = (page - <span class="hljs-number">1</span>) * pageSize;<br>    <span class="hljs-keyword">int</span> limit = page * pageSize;<br><br>    <span class="hljs-comment">// ä»ç¼“å­˜ä¸­è·å–å…¨é‡æ•°æ®</span><br>    List&lt;Student&gt; students = studentCache.getStudents();<br>    <span class="hljs-keyword">if</span> (CollectionUtils.isEmpty(students)) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>    &#125;<br>    <span class="hljs-keyword">if</span> (limit &gt; students.size()) &#123;<br>        limit = students.size();<br>    &#125;<br>    <span class="hljs-keyword">return</span> students.subList(start, limit), students.size();<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¯ä»¥çœ‹å‡ºæ–¹æ³•çš„ä»£ç æ¯”è¾ƒå†—ä½™ï¼Œå¦‚æœå¤šå¤„éœ€è¦å†…å­˜åˆ†é¡µï¼Œé‡å¤ä»£ç ä¸å¯é¿å…ä¼šæœ‰å¾ˆå¤šï¼</p><h2 id="ä¼˜åŒ–å"><a href="#ä¼˜åŒ–å" class="headerlink" title="ä¼˜åŒ–å"></a>ä¼˜åŒ–å</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">// åˆ†é¡µè¿›è¡Œæ‰¹é‡æ›´æ–°</span><br><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">batchUpdateStudent</span><span class="hljs-params">(List&lt;Student&gt; students)</span> </span>&#123;<br>RAMPager&lt;Student&gt; pager = <span class="hljs-keyword">new</span> RAMPager&lt;&gt;(students, <span class="hljs-number">100</span>);<br><span class="hljs-comment">// æ–¹å¼ä¸€ï¼šä½¿ç”¨è¿­ä»£å™¨</span><br>Iterator&lt;List&lt;Student&gt;&gt; iterator = pager.iterator();<br><span class="hljs-keyword">while</span> (iterator.hasNext()) &#123;<br>studentDao.batchUpdate(iterator.next());<br>&#125;<br><br><span class="hljs-comment">// æ–¹å¼äºŒï¼šä½¿ç”¨ç´¢å¼•</span><br><span class="hljs-comment">//for (int i = 1; i &lt;= pager.getPageCount(); i++) &#123;</span><br><span class="hljs-comment">//studentDao.batchUpdate(pager.page(i));</span><br><span class="hljs-comment">//&#125;</span><br>&#125;<br><br><span class="hljs-comment">// åˆ†é¡µè·å–æ•°æ®</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Student&gt; <span class="hljs-title">pageStudents</span><span class="hljs-params">(Integer page, Integer pageSize)</span> </span>&#123;<br><span class="hljs-comment">// ä»ç¼“å­˜ä¸­è·å–å…¨é‡æ•°æ®</span><br>List&lt;Student&gt; students = studentCache.getStudents();<br>RAMPager&lt;Student&gt; pager = <span class="hljs-keyword">new</span> RAMPager&lt;&gt;(students, pageSize);<br><span class="hljs-keyword">return</span> pager.page(page);<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ³¨ï¼šå¦‚æœåªæ˜¯åˆ†é¡µï¼Œè€Œä¸éœ€è¦å…³æ³¨é¡µç ï¼Œä½¿ç”¨è¿­ä»£å™¨å³å¯ï¼›</p><h2 id="å·¥å…·ç±»æºç "><a href="#å·¥å…·ç±»æºç " class="headerlink" title="å·¥å…·ç±»æºç "></a>å·¥å…·ç±»æºç </h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.Arrays;<br><span class="hljs-keyword">import</span> java.util.Iterator;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ç±»åç§°ï¼šRAMPager</span><br><span class="hljs-comment"> * ç±»æè¿°ï¼šå†…å­˜åˆ†é¡µå·¥å…·</span><br><span class="hljs-comment"> * åˆ›å»ºäººï¼šWeJan</span><br><span class="hljs-comment"> * åˆ›å»ºæ—¶é—´ï¼š2019å¹´07æœˆ22æ—¥ 13:43</span><br><span class="hljs-comment"> * Version: 1.1</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RAMPager</span>&lt;<span class="hljs-title">T</span>&gt; </span>&#123;<br>    <span class="hljs-keyword">private</span> List&lt;T&gt; data;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> pageSize;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> data     åŸå§‹æ•°æ®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> pageSize æ¯é¡µæ¡æ•°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">RAMPager</span><span class="hljs-params">(List&lt;T&gt; data, <span class="hljs-keyword">int</span> pageSize)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.data = data;<br>        <span class="hljs-keyword">this</span>.pageSize = pageSize;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–æŸé¡µæ•°æ®ï¼Œä»ç¬¬1é¡µå¼€å§‹</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> pageNum ç¬¬å‡ é¡µ</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> åˆ†é¡µæ•°æ®</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;T&gt; <span class="hljs-title">page</span><span class="hljs-params">(<span class="hljs-keyword">int</span> pageNum)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (pageNum &lt; <span class="hljs-number">1</span>) &#123;<br>            pageNum = <span class="hljs-number">1</span>;<br>        &#125;<br>        <span class="hljs-keyword">int</span> from = (pageNum - <span class="hljs-number">1</span>) * pageSize;<br>        <span class="hljs-keyword">int</span> to = Math.min(pageNum * pageSize, data.size());<br>        <span class="hljs-keyword">if</span> (from &gt; to) &#123;<br>            from = to;<br>        &#125;<br>        <span class="hljs-keyword">return</span> data.subList(from, to);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–æ€»é¡µæ•°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getPageCount</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (pageSize == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> data.size() % pageSize == <span class="hljs-number">0</span> ? (data.size() / pageSize) : (data.size() / pageSize + <span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å…ƒç´ è¿­ä»£å™¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> Iterator&lt;List&lt;T&gt;&gt; iterator() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Itr();<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Itr</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Iterator</span>&lt;<span class="hljs-title">List</span>&lt;<span class="hljs-title">T</span>&gt;&gt; </span>&#123;<br>        <span class="hljs-keyword">int</span> page = <span class="hljs-number">1</span>;<br><br>        Itr() &#123;<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasNext</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">return</span> page &lt;= getPageCount();<br>        &#125;<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;T&gt; <span class="hljs-title">next</span><span class="hljs-params">()</span> </span>&#123;<br>            <span class="hljs-keyword">int</span> i = page;<br>            <span class="hljs-keyword">if</span> (i &gt; getPageCount())<br>                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br><br>            page = i + <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">return</span> RAMPager.<span class="hljs-keyword">this</span>.page(i);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        List&lt;Integer&gt; list = Arrays.asList(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>);<br>        System.out.println(<span class="hljs-string">&quot;åŸå§‹æ•°æ®æ˜¯ï¼š&quot;</span> + list);<br><br>        <span class="hljs-keyword">int</span> pageSize = <span class="hljs-number">2</span>;<br>        System.out.println(<span class="hljs-string">&quot;æ¯é¡µå¤§å°æ˜¯ï¼š&quot;</span> + pageSize);<br><br>        RAMPager&lt;Integer&gt; pager = <span class="hljs-keyword">new</span> RAMPager&lt;&gt;(list, pageSize);<br>        System.out.println(<span class="hljs-string">&quot;æ€»é¡µæ•°æ˜¯: &quot;</span> + pager.getPageCount());<br><br>        System.out.println(<span class="hljs-string">&quot;&lt;- - - - - - - - - - - - - -&gt;&quot;</span>);<br><br>        <span class="hljs-comment">// æ— éœ€æ„ŸçŸ¥é¡µç æƒ…å†µä¸‹ä½¿ç”¨</span><br>        Iterator&lt;List&lt;Integer&gt;&gt; iterator = pager.iterator();<br>        <span class="hljs-keyword">while</span> (iterator.hasNext()) &#123;<br>            List&lt;Integer&gt; next = iterator.next();<br>            System.out.println(<span class="hljs-string">&quot;next: &quot;</span> + next);<br>        &#125;<br><br>        System.out.println(<span class="hljs-string">&quot;&lt;- - - - - - - - - - - - - -&gt;&quot;</span>);<br>        <span class="hljs-comment">// éœ€è¦æŒ‡å®šé¡µç æƒ…å†µä½¿ç”¨ï¼Œé¡µç ä»ç¬¬ä¸€é¡µå¼€å§‹ï¼Œä¸”å°äºç­‰äºæ€»é¡µæ•°ï¼</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt;= pager.getPageCount(); i++) &#123;<br>            List&lt;Integer&gt; page = pager.page(i);<br>            System.out.println(<span class="hljs-string">&quot;ç¬¬ &quot;</span> + i + <span class="hljs-string">&quot; é¡µæ•°æ®æ˜¯:&quot;</span> + page);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>å¸Œæœ›å¯¹ä½ æœ‰ç”¨~</p>]]></content>
    
    
    <categories>
      
      <category>å®ç”¨ä»£ç ç‰‡æ®µ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javaå†…å­˜åˆ†é¡µå·¥å…·ç±»</tag>
      
      <tag>javaå†…å­˜åˆ†é¡µ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mysqlæ—¥æœŸåˆ†ç»„æ— æ•°æ®æŸ¥è¯¢å¡«å……0</title>
    <link href="/Mysql%E6%97%A5%E6%9C%9F%E5%88%86%E7%BB%84%E6%97%A0%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E5%A1%AB%E5%85%850.html"/>
    <url>/Mysql%E6%97%A5%E6%9C%9F%E5%88%86%E7%BB%84%E6%97%A0%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E5%A1%AB%E5%85%850.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™ç¯‡æ–‡ç« æ ‡é¢˜ä¸å¥½å–ã€‚ã€‚ã€‚(ä¸»è¦æ˜¯ç”Ÿæˆè¿ç»­çš„æ—¥æœŸ)ï¼Œæœ¬æ–‡å…³é”®ç‚¹æœ‰ï¼šMysql è·å–æŒ‡å®šæ—¶é—´æ®µå†…çš„æ‰€æœ‰æ—¥æœŸåˆ—è¡¨ï¼Œ<br>Mysql æŒ‰ç…§æ—¥æœŸåˆ†ç»„æŸ¥è¯¢æ²¡æœ‰æ•°æ®çš„æ—¥æœŸä¹Ÿä¸€å¹¶æŸ¥è¯¢å‡ºæ¥ã€‚</p><a id="more"></a><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>äº§å“æå‡ºä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦å±•ç¤ºè¿™æ ·çš„ä¸€å¼ æŠ˜çº¿å›¾ï¼Œç”¨æ¥åæ˜ æŒ‡å®šæ—¶é—´æ®µå†…ç½‘ç«™æ³¨å†Œç”¨æˆ·çš„å¢åŠ è¶‹åŠ¿ï¼Œäºæ˜¯éœ€è¦åç«¯çš„ JSON å·¥ç¨‹å¸ˆç»™å‡ºå¯¹åº”çš„æ¥å£ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190509213309.png"></p><h2 id="ç–å¿½å¤§æ„"><a href="#ç–å¿½å¤§æ„" class="headerlink" title="ç–å¿½å¤§æ„"></a>ç–å¿½å¤§æ„</h2><p>å…·ä½“çš„è¡¨ç»“æ„å’Œæ•°æ®æ˜¯è¿™æ ·çš„</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190509214326.png"></p><p>JSON å·¥ç¨‹å¸ˆä¸åŠ æ€ç´¢ï¼Œå±•å¼€äº† CRUD å¤§æ³•ï¼Œé¡ºæ‰‹å†™ä¸‹äº†ä¸€ä¸ª SQLï¼Œä¸åˆ°5åˆ†é’Ÿï¼Œæ¥å£å®Œæ´»ï¼Œæµ‹éƒ½æ²¡æµ‹è¯•ç›´æ¥ç»™åˆ°äº†å‰ç«¯å¼€å‘ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-type">date</span>(t.create_time) <span class="hljs-keyword">as</span> `<span class="hljs-type">date</span>`,<br>       <span class="hljs-built_in">count</span>(t.id)  <span class="hljs-keyword">as</span> num<br><span class="hljs-keyword">from</span> t_user t<br><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> `<span class="hljs-type">date</span>`;<br></code></pre></div></td></tr></table></figure><p>å‰ç«¯æ‹¿åˆ°æ•°æ®åå¼€å§‹ç»˜å›¾ï¼Œç»“æœç”»çš„å›¾å®Œå…¨ä¸å¯¹å•Šï¼Œå› ä¸ºæ—¶é—´ä¸æ˜¯è¿ç»­çš„ã€‚äºæ˜¯åé¦ˆåˆ°äº† JSON å·¥ç¨‹å¸ˆè¿™é‡Œã€‚</p><p>JSON å·¥ç¨‹å¸ˆä¸€æƒ³ï¼Œå“å“Ÿï¼Œæ²¡è€ƒè™‘æ‰æŸå¤©æ²¡æœ‰æ•°æ®çš„æƒ…å†µï¼Œåˆ†ç»„æŸ¥è¯¢çš„è¯ï¼Œè‚¯å®šç¼ºå°‘è¿™ä¸€å¤©çš„æ•°æ®çš„ã€‚  </p><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc"><span class="hljs-code">+------------+</span>-----+<br>|    date    | num |<br><span class="hljs-code">+------------+</span>-----+<br>| 2019-05-06 |  2  |<br><span class="hljs-code">+------------+</span>-----+<br>| 2019-05-08 |  2  |<br><span class="hljs-code">+------------+</span>-----+<br>| 2019-05-09 |  9  |<br><span class="hljs-code">+------------+</span>-----+<br></code></pre></div></td></tr></table></figure><p>æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯å³ä½¿æŸå¤©æ²¡æœ‰æ•°æ®ï¼Œä¹Ÿå¡«å……ä¸€ä¸ª 0 ä½œä¸ºè®°å½•å€¼ã€‚</p><h2 id="ä¿®æ­£æŸ¥è¯¢æ•°æ®"><a href="#ä¿®æ­£æŸ¥è¯¢æ•°æ®" class="headerlink" title="ä¿®æ­£æŸ¥è¯¢æ•°æ®"></a>ä¿®æ­£æŸ¥è¯¢æ•°æ®</h2><p>æ‰¾åˆ°äº†é—®é¢˜å°±å¥½åŠäº†ï¼Œæ‹äº†ä¸€ä¸‹é€»è¾‘åˆ†æˆäº†ä¸¤æ­¥</p><h3 id="ä¸€ã€æ‹¿åˆ°æ‰€æœ‰æ—¥æœŸ"><a href="#ä¸€ã€æ‹¿åˆ°æ‰€æœ‰æ—¥æœŸ" class="headerlink" title="ä¸€ã€æ‹¿åˆ°æ‰€æœ‰æ—¥æœŸ"></a>ä¸€ã€æ‹¿åˆ°æ‰€æœ‰æ—¥æœŸ</h3><p><strong>2019å¹´09æœˆ12æ—¥æ›´æ–°</strong></p><p>æ„Ÿè°¢è¯„è®ºåŒºä¸­ @ä¸€ä¸ªå°å¯çˆ±ï¼ˆæ„Ÿè§‰æ˜¯ä¸ªæœ‰è¶£çš„äººå“ˆå“ˆï¼‰æå‡ºçš„æ–¹æ³•ï¼Œäºæ˜¯æˆ‘å°±æ¥æ›´æ–°ä¸€ä¸‹æœ¬æ–‡äº†ã€‚æœ€å¥½çš„æ–¹å¼æ˜¯åœ¨ Java ä»£ç ä¸­å¤„ç†ç”Ÿæˆè¿ç»­çš„æ—¥æœŸï¼Œç„¶ååˆ›å»ºä¸€ä¸ª map å¯¹è±¡ï¼Œåˆå§‹åŒ–æ‰€æœ‰çš„é”®å€¼å¯¹çš„å€¼ä¸º 0ï¼Œç„¶åéå†æŸ¥è¯¢å‡ºæ¥çš„æŒ‰ç…§æ—¥æœŸä½œä¸º keyï¼Œä¹‹åè¿›è¡Œ put è¦†ç›–é»˜è®¤å€¼å³å¯ã€‚</p><p>æä¾›ä¸€ä¸ª<strong>ç”Ÿæˆè¿ç»­æ—¥æœŸ</strong>çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Set&lt;String&gt; <span class="hljs-title">getBetweenDate</span><span class="hljs-params">(String start, String end)</span> </span>&#123;<br>  LocalDate startDate = LocalDate.parse(start);<br>  LocalDate endDate = LocalDate.parse(end);<br>  <span class="hljs-keyword">long</span> between = ChronoUnit.DAYS.between(startDate, endDate);<br>  <span class="hljs-keyword">if</span> (between &lt; <span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-keyword">return</span> Stream.of(start, end).collect(Collectors.toSet());<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> Stream.iterate(startDate, e -&gt; e.plusDays(<span class="hljs-number">1</span>))<br>    .limit(between + <span class="hljs-number">1</span>)<br>    .map(LocalDate::toString)<br>    .collect(Collectors.toSet());<br>&#125;<br><br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>  Set&lt;String&gt; days = BaseTest.getBetweenDate(<span class="hljs-string">&quot;2019-08-29&quot;</span>, <span class="hljs-string">&quot;2019-09-02&quot;</span>);<br>  log.info(<span class="hljs-string">&quot;&#123;&#125;&quot;</span>, days);<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="äºŒã€æŒ‰ç…§æ—¥æœŸåˆ†ç»„æŸ¥è¯¢"><a href="#äºŒã€æŒ‰ç…§æ—¥æœŸåˆ†ç»„æŸ¥è¯¢" class="headerlink" title="äºŒã€æŒ‰ç…§æ—¥æœŸåˆ†ç»„æŸ¥è¯¢"></a>äºŒã€æŒ‰ç…§æ—¥æœŸåˆ†ç»„æŸ¥è¯¢</h2><p><strong>åŸæ¥çš„æ–‡ç« å¯èƒ½ä¼šé€ æˆè¯¯è§£ï¼Œå·²æ›´æ–°æ‰</strong><br>æŒ‰ç…§æ—¥æœŸåˆ†ç»„æŸ¥è¯¢ï¼Œéå†æŸ¥è¯¢ç»“æœï¼Œè¦†ç›–ç¬¬ä¸€æ­¥é‡Œçš„æ—¶é—´mapçš„å€¼å³å¯ã€‚</p><p>ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight asciidoc"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs asciidoc"><span class="hljs-code">+------------+</span>-----+<br>|    date    | num |<br><span class="hljs-code">+------------+</span>-----+<br>| 2019-05-03 |  0  |<br><span class="hljs-code">+------------+</span>-----+<br>| 2019-05-04 |  0  |<br><span class="hljs-code">+------------+</span>-----+<br>| 2019-05-05 |  0  |<br><span class="hljs-code">+------------+</span>-----+<br>| 2019-05-06 |  2  |<br><span class="hljs-code">+------------+</span>-----+<br>| 2019-05-07 |  0  |<br><span class="hljs-code">+------------+</span>-----+<br>| 2019-05-08 |  2  |<br><span class="hljs-code">+------------+</span>-----+<br>| 2019-05-09 |  9  |<br><span class="hljs-code">+------------+</span>-----+<br></code></pre></div></td></tr></table></figure><p>é¡ºåˆ©è¾¾åˆ°äº†ç›®çš„ï¼Œæ”¶å·¥ï¼</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><p><a href="https://www.cnblogs.com/zhengguangpan/p/10308886.html">https://www.cnblogs.com/zhengguangpan/p/10308886.html</a></p></li><li><p><a href="https://blog.csdn.net/Dai_Aixy/article/details/83144619">https://blog.csdn.net/Dai_Aixy/article/details/83144619</a></p></li><li><p><a href="https://www.cnblogs.com/dennyzhangdd/p/8073181.html">https://www.cnblogs.com/dennyzhangdd/p/8073181.html</a></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åˆ†ç»„æŸ¥è¯¢æ— æ•°æ®å¡«å……0</tag>
      
      <tag>è·å–æŒ‡å®šæ—¶é—´æ®µå†…çš„æ—¶é—´æ—¥æœŸåˆ—è¡¨</tag>
      
      <tag>javaç”Ÿæˆè¿ç»­æ—¥æœŸ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebMagicæºç é˜…è¯»ä¹‹Scheduler</title>
    <link href="/WebMagic%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E4%B9%8BScheduler.html"/>
    <url>/WebMagic%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E4%B9%8BScheduler.html</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡æ˜¯ WebMagic æºç é˜…è¯»ç¬¬ä¸‰ç¯‡ï¼Œç‰ˆæœ¬ä¾ç„¶æ˜¯ <code>version-0.0.1</code> çš„ tagã€‚ä½œè€…å¯¹äº Scheduler çš„æè¿°æ˜¯å¦‚ä¸‹ï¼š</p><blockquote><p>åŒ…å«urlç®¡ç†å’Œè°ƒåº¦çš„æ¥å£ã€‚åŒ…æ‹¬urlæŠ“å–é˜Ÿåˆ—ï¼Œurlå»é‡ç­‰åŠŸèƒ½ã€‚</p></blockquote><a id="more"></a><h2 id="é˜…è¯»Scheduleræºç "><a href="#é˜…è¯»Scheduleræºç " class="headerlink" title="é˜…è¯»Scheduleræºç "></a>é˜…è¯»Scheduleræºç </h2><p>Scheduler æ˜¯ä¸€ä¸ªæ¥å£ç±»ï¼Œæºç ä¸­å®ç°æœ‰ä¸‰ä¸ªï¼Œåˆ†åˆ«æ˜¯  <img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181226064924.png"></p><p>é»˜è®¤ Spider ä½¿ç”¨ <code>QueueScheduler</code></p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">// é»˜è®¤ä½¿ç”¨åŸºäºå†…å­˜çš„é˜Ÿåˆ—</span><br><span class="hljs-keyword">private</span> Scheduler scheduler = <span class="hljs-keyword">new</span> QueueScheduler();<br></code></pre></div></td></tr></table></figure><p>Scheduler æ¥å£åªæœ‰ä¸¤ä¸ªæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * åŠ å…¥ä¸€ä¸ªå¾…æŠ“å–çš„é“¾æ¥</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> request å¾…æŠ“å–çš„é“¾æ¥</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> task å®šä¹‰çš„ä»»åŠ¡ï¼Œä»¥æ»¡è¶³å•Schedulerå¤šTaskçš„æƒ…å†µ</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">push</span><span class="hljs-params">(Request request,Task task)</span></span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * è¿”å›ä¸‹ä¸€ä¸ªè¦æŠ“å–çš„é“¾æ¥</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> task å®šä¹‰çš„ä»»åŠ¡ï¼Œä»¥æ»¡è¶³å•Schedulerå¤šTaskçš„æƒ…å†µ</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> ä¸‹ä¸€ä¸ªè¦æŠ“å–çš„é“¾æ¥</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Request <span class="hljs-title">poll</span><span class="hljs-params">(Task task)</span></span>;<br></code></pre></div></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œåˆ†æå¸¸ç”¨çš„çš„ä¸¤ä¸ªå®ç°ç±» QueueScheduler å’Œ RedisScheduler </p><h2 id="QueueScheduler"><a href="#QueueScheduler" class="headerlink" title="QueueScheduler"></a>QueueScheduler</h2><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190116061228.png"></p><p>çº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—å®ç°è¯·æ±‚çš„ç”Ÿäº§æ¶ˆè´¹å…³ç³»ï¼Œpush å’Œ poll éƒ½æ˜¯åŒæ­¥æ–¹æ³•ï¼ŒåŒæ—¶å› ä¸º LinkedBlockingQueue çš„é•¿åº¦æ˜¯ Integer.MAX_VALUEï¼Œå¦‚æœé˜Ÿåˆ—è¿‡é•¿ï¼Œä¼šå‡ºç° OOM çš„æƒ…å†µã€‚</p><h2 id="RedisScheduler"><a href="#RedisScheduler" class="headerlink" title="RedisScheduler"></a>RedisScheduler</h2><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190116062241.png"></p><p>æºç ä¸­ä½¿ç”¨ Redis çš„ list ç»“æ„åš URL é˜Ÿåˆ—ï¼Œé€šè¿‡ rpush æ–¹æ³•ï¼Œå°†æ–°çš„ URL æ”¾å…¥é˜Ÿåˆ—å³è¾¹ï¼Œé€šè¿‡ lpop ä»é˜Ÿåˆ—å·¦ä¾§å¼¹å‡ºä¸€ä¸ªå¾…æŠ“å–çš„ URL ã€‚</p><p>ä½¿ç”¨äº† Redis çš„æœ‰åºé›†åˆè¿›è¡Œ URL å»é‡ï¼ŒåŸç†æ˜¯ï¼š<br>å¦‚æœ url æ˜¯æœ‰åºé›†å’Œçš„æˆå‘˜ï¼Œè¿”å› url çš„æ’åã€‚ å¦‚æœ url ä¸æ˜¯æœ‰åºé›†å’Œçš„æˆå‘˜ï¼Œè¿”å› nullã€‚zrank æ–¹æ³•å‚æ•°å¦‚ä¸‹ï¼š<br><code>zrank(æœ‰åºé›†åˆçš„key, æˆå‘˜åç§°)</code></p><p>å½“æˆåŠŸæ·»åŠ  URL åˆ°é˜Ÿåˆ—ï¼Œè°ƒç”¨ zadd æ–¹æ³•å°† URL æ”¾å…¥æœ‰åºé›†åˆå½“ä¸­ï¼Œä¾¿äºåç»­ URL åˆ¤é‡ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>åŠŸåŠ›ä¸è¶³ï¼Œå°šä¸”çœ‹ä¸å‡ºè¿™éƒ¨åˆ†æºç çš„ä¸è¶³ä¹‹å¤„ï¼Œåªçœ‹åˆ° RedisScheduler ä¸­ jedis é‡Šæ”¾èµ„æºçš„æ“ä½œæœªæ”¾åˆ° final ä¸­ï¼Œæœ‰æ‰€éšæ‚£ã€‚</p><h2 id="è”ç³»"><a href="#è”ç³»" class="headerlink" title="è”ç³»"></a>è”ç³»</h2><p>ç‹¬è¡Œçš„è·¯æ€»æ˜¯å­¤ç‹¬çš„ï¼Œå¸Œæœ›èƒ½æ‰¾åˆ°ä¸€äº›å°ä¼™ä¼´å…±åŒè¿›æ­¥~<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181226212444.png"></p><p>QQ ç¾¤å·:967808880</p>]]></content>
    
    
    <categories>
      
      <category>æºç é˜…è¯»</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æºç è§£æ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebMagicæºç é˜…è¯»ä¹‹Spider</title>
    <link href="/WebMagic%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E4%B9%8BSpider.html"/>
    <url>/WebMagic%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E4%B9%8BSpider.html</url>
    
    <content type="html"><![CDATA[<p>æ€»æ˜¯è§‰å¾—è‡ªå·±å¹³æ—¶æ€»æ˜¯åœ¨å†™é€»è¾‘ä»£ç ï¼Œäºæ˜¯å­¦ä¹ è®¾è®¡æ¨¡å¼ï¼Œä½†æ˜¯åˆè§‰å¾—æ— å¤„å¯æ–½å±•ï¼Œå¯¹äºå¦‚ä½•æé«˜è‡ªå·±çš„ç¼–ç èƒ½åŠ›æ€»æ˜¯å›°æƒ‘ï¼Œä¹Ÿæ›¾çœ‹äº†ä¸€äº›æºç ï¼Œä½†æ€»å› ä¸ºéš¾åº¦å¤ªå¤§è€Œä¸äº†äº†ä¹‹ã€‚å› ä¸ºå¤§å¤šæ•°çš„å¼€æºæ¡†æ¶æºç éšç€ç‰ˆæœ¬çš„æ›´è¿­ï¼Œéš¾åº¦è¶Šå‘ä¸Šå‡æºç æ„ˆå‘æ™¦æ¶©éš¾æ‡‚ï¼Œä½†æºç è¿˜æ˜¯ä¸èƒ½ä¸è¯»ï¼Œæ‰€ä»¥è§‰å¾—ä»æœ€ç®€å•çš„æºç å¼€å§‹è¯»èµ·å§ï¼Œå› ä¸ºå·¥ä½œä¸­ï¼Œç”¨åˆ°äº† WebMagic æ¡†æ¶ï¼Œäºæ˜¯å†³å®šä»å®ƒå¼€å§‹ï¼Œä¸ºäº†é™ä½é˜…è¯»éš¾åº¦ï¼Œæˆ‘é€‰æ‹©äº†ç¬¬ä¸€ä¸ª tag ç‰ˆæœ¬çš„æºç å¼€å§‹é˜…è¯»ï¼Œä»æ˜“å…¥éš¾ï¼Œç”±æµ…å…¥æ·±ï¼Œå¸Œæœ›è‡ªå·± 2019 å¹´ä»£ç èƒ½åŠ›èƒ½æœ‰æ‰€æå‡!</p><a id="more"></a><h2 id="ä¸‹è½½æºç "><a href="#ä¸‹è½½æºç " class="headerlink" title="ä¸‹è½½æºç "></a>ä¸‹è½½æºç </h2><p>é¦–å…ˆåœ¨ IDEA ä¸ŠæŠŠ WebMagic çš„æºç  clone åˆ°æœ¬åœ°<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190115211258.png"></p><p>ç„¶å checkout ç¬¬ä¸€ä¸ªç‰ˆæœ¬çš„ tag<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190115211432.png"></p><p>åœ¨å¯¹è¯æ¡†ä¸­ï¼Œä½¿ç”¨æ™ºèƒ½æç¤ºå¿«æ·é”®å±•ç¤ºå‡ºæ‰€æœ‰çš„ tagï¼Œé»˜è®¤å¿«æ·é”®æ˜¯ <code>ctrl(command) + ç©ºæ ¼</code>ï¼Œå› ä¸ºå¯èƒ½ä¼šå’Œè¾“å…¥æ³•å†²çªï¼Œæˆ‘ä¿®æ”¹æˆäº† <code>command + ;</code><br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190115211528.png"></p><p>æˆ‘é€‰æ‹©äº† <code>version-0.1.0</code> ç‰ˆæœ¬ï¼Œç„¶ååŸºäºè¿™ä¸ª tagï¼Œåˆ›å»ºäº†è‡ªå·±çš„æœ¬åœ°åˆ†æ”¯ï¼Œä¾¿äºåœ¨ä¸Šé¢è¿›è¡Œæ·»åŠ æ³¨é‡Šç­‰æ“ä½œã€‚</p><h2 id="é˜…è¯»-Spider-æºç "><a href="#é˜…è¯»-Spider-æºç " class="headerlink" title="é˜…è¯» Spider æºç "></a>é˜…è¯» Spider æºç </h2><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181226210950.png"><br>å‚è§å®˜ç½‘æ¶æ„å›¾ï¼ŒSpider è¿™ä¸ªç»„ä»¶æ˜¯ WebMagic æ¡†æ¶çš„æ ¸å¿ƒæ‰€åœ¨ï¼ŒåŒæ—¶ä¹Ÿæ˜¯çˆ¬è™«çš„å…¥å£ç±»ï¼ŒSpider å°†å„å¤§ç»„ä»¶ä¸²è”èµ·æ¥ï¼Œå…±åŒå·¥ä½œã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181226064624.png"></p><p>Spider å®ç°äº† Task å’Œ Runnable æ¥å£ï¼ŒTask æä¾›äº†ä¸¤ä¸ªæ¥å£æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯ getSite()ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ getUUID()ï¼Œçˆ¬è™«è¿è¡Œæ—¶ï¼Œå°†çˆ¬è™«è‡ªèº«å¼•ç”¨ä¼ é€’åˆ°å„ä¸ªç»„ä»¶è¿›è¡Œå¤„ç†ã€‚</p><p>ä¸€èˆ¬ä½¿ç”¨ WebMagic æ—¶ï¼Œé€šè¿‡ Spider.create() æ–¹æ³•åˆ›å»ºçˆ¬è™«ï¼Œåˆ›å»ºæ—¶å¯ä»¥æŒ‡å®š Downloaderã€Schedulerã€PageProcessorã€Pipeline è¿™å‡ ä¸ªç»„ä»¶ï¼Œä½œè€…å°†è¿™å››ä¸ªç»„ä»¶æŠ½è±¡æˆäº†æ¥å£ï¼Œæ–¹ä¾¿æ‰©å±•ï¼Œå…¶ä¸­ PageProcessor æ˜¯å¿…é¡»æŒ‡å®šçš„ç»„ä»¶ï¼Œå…¶ä»–çš„ç»„ä»¶ WebMagic æä¾›äº†å¯¹åº”çš„é»˜è®¤å€¼ã€‚</p><p>Spider ç±»ä¸»è¦æ ¸å¿ƒæ˜¯ run æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// é€šè¿‡ AtomicInteger çš„ CAS ä¹è§‚é”ä¿è¯å¤šçº¿ç¨‹ä¸‹ï¼Œçˆ¬è™«åªä¼šå¯åŠ¨ä¸€æ¬¡</span><br>    <span class="hljs-comment">// å¦‚æœçˆ¬è™«çŠ¶æ€å½“å‰çŠ¶æ€æ˜¯ STAT_INITï¼Œåˆ™æ›´æ–°æˆ STAT_RUNNINGï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸</span><br>    <span class="hljs-keyword">if</span> (!stat.compareAndSet(STAT_INIT, STAT_RUNNING)) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalStateException(<span class="hljs-string">&quot;Spider is already running!&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// æ·»åŠ å¯åŠ¨ URL</span><br>    <span class="hljs-keyword">if</span> (startUrls != <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-keyword">for</span> (String startUrl : startUrls) &#123;<br>            scheduler.push(<span class="hljs-keyword">new</span> Request(startUrl), <span class="hljs-keyword">this</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// ä»é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªè¯·æ±‚</span><br>    Request request = scheduler.poll(<span class="hljs-keyword">this</span>);<br><br>    <span class="hljs-comment">// æ·»åŠ ç®¡é“å¤„ç†ï¼Œå¦‚æœä¸ºç©ºæ·»åŠ ï¼Œè¾“å‡ºåˆ°æ§åˆ¶å°</span><br>    <span class="hljs-keyword">if</span> (pipelines.isEmpty()) &#123;<br>        pipelines.add(<span class="hljs-keyword">new</span> ConsolePipeline());<br>    &#125;<br>    <span class="hljs-comment">//single thread</span><br>    <span class="hljs-keyword">if</span> (executorService==<span class="hljs-keyword">null</span>)&#123;<br>        <span class="hljs-comment">// é»˜è®¤å•çº¿ç¨‹</span><br>        <span class="hljs-comment">// å¾ªç¯è°ƒåº¦æ‰€æœ‰çš„ Request</span><br>        <span class="hljs-keyword">while</span> (request != <span class="hljs-keyword">null</span>) &#123;<br>            processRequest(request);<br>            request = scheduler.poll(<span class="hljs-keyword">this</span>);<br>        &#125;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// å¦‚æœå·²ç»è°ƒç”¨ Spider.thread(n) æ–¹æ³•åˆ™èµ°è¿™ä¸ªåˆ†æ”¯</span><br>        <span class="hljs-comment">//multi thread</span><br>        <span class="hljs-comment">// åˆå§‹åŒ–æ´»è·ƒçº¿ç¨‹æ•°é‡ä¸º 0ï¼Œå½“çˆ¬è™«çº¿ç¨‹å¯åŠ¨åï¼Œå¦‚æœæ´»è·ƒçº¿ç¨‹å˜æˆ 0 æ—¶ï¼Œè·³å‡ºæ­»å¾ªç¯</span><br>        <span class="hljs-keyword">final</span> AtomicInteger threadAlive = <span class="hljs-keyword">new</span> AtomicInteger(<span class="hljs-number">0</span>);<br>        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>            <span class="hljs-keyword">if</span> (request == <span class="hljs-keyword">null</span>) &#123;<br>                <span class="hljs-comment">//when no request found but some thread is alive, sleep a while.</span><br>                <span class="hljs-keyword">try</span> &#123;<br>                    Thread.sleep(<span class="hljs-number">100</span>);<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">final</span> Request requestFinal = request;<br>                <span class="hljs-comment">// æ‰§è¡Œçº¿ç¨‹ä¹‹å‰å¯¹æ´»è·ƒçº¿ç¨‹æ•°è¿›è¡ŒåŸå­æ€§è‡ªå¢æ“ä½œ</span><br>                threadAlive.incrementAndGet();<br>                executorService.execute(<span class="hljs-keyword">new</span> Runnable() &#123;<br>                    <span class="hljs-meta">@Override</span><br>                    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                        processRequest(requestFinal);<br>                        <span class="hljs-comment">// å¤„ç†å®Œè¯·æ±‚ä¹‹åå¯¹æ´»è·ƒçº¿ç¨‹æ•°è¿›è¡ŒåŸå­æ€§è‡ªå‡æ“ä½œ</span><br>                        threadAlive.decrementAndGet();<br>                    &#125;<br>                &#125;);<br>            &#125;<br>            <span class="hljs-comment">// å¾ªç¯ä»é˜Ÿåˆ—ä¸­å–æ–°çš„å¾…æŠ“å– URL</span><br>            request = scheduler.poll(<span class="hljs-keyword">this</span>);<br><br>            <span class="hljs-comment">// å½“æ´»è·ƒçº¿ç¨‹æ•°ä¸º 0ï¼Œè¯´æ˜é˜Ÿåˆ—å·²ç»ä¸ºç©ºäº†</span><br>            <span class="hljs-keyword">if</span> (threadAlive.get() == <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-comment">// ä¸ºäº†ä¿é™©èµ·è§ï¼Œå†é‡è¯•è·å–ä¸€ä¸‹è¯·æ±‚</span><br>                request = scheduler.poll(<span class="hljs-keyword">this</span>);<br>                <span class="hljs-comment">// å¦‚æœä¾ç„¶ä¸º nullï¼Œåˆ™è·³å‡º while å¾ªç¯</span><br>                <span class="hljs-keyword">if</span> (request == <span class="hljs-keyword">null</span>) &#123;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// å…³é—­çº¿ç¨‹æ± </span><br>        executorService.shutdown();<br>    &#125;<br>    <span class="hljs-comment">// å½“æ‰€æœ‰è¯·æ±‚æŠ“å–å®Œæ¯•ï¼Œå³æ´»è·ƒçº¿ç¨‹æ•°é‡å˜æˆ 0 æ—¶ï¼Œä¿®æ”¹çˆ¬è™«çŠ¶æ€ä¸ºå·²åœæ­¢</span><br>    stat.compareAndSet(STAT_RUNNING, STAT_STOPPED);<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä»æºç ä¸­çœ‹åˆ°ï¼Œå¯¹äºå¤šçº¿ç¨‹å…±äº«èµ„æºæ´»è·ƒçº¿ç¨‹æ•°çš„å¤„ç†ï¼Œä½¿ç”¨åˆ°äº† Integer çš„åŸå­ç±» AtomicIntegerï¼Œä¿è¯æ´»è·ƒçº¿ç¨‹æ•°é‡åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ç»Ÿè®¡ç»“æœçš„æ­£ç¡®æ€§ã€‚</p><p>ä½œè€…å°†å››å¤§ç»„ä»¶æŠ½è±¡æˆäº†æ¥å£ï¼Œé¢å‘æ¥å£ç¼–ç¨‹ï¼Œæ–¹ä¾¿æ‰©å±•ï¼Œå¾ˆå€¼å¾—å­¦ä¹ ã€‚</p><p>å› ä¸ºæ˜¯åˆå§‹ç‰ˆæœ¬ï¼Œä¸å¯é¿å…çš„ä¼šæœ‰ä¸€äº›æ˜æ˜¾çš„ Bug å­˜åœ¨ï¼Œæ¯”å¦‚åœ¨ page ç±»çš„ <code>addTargetRequests</code> æ–¹æ³•ä¸­åº”è¯¥ç”¨ <code>continue</code>ï¼Œä½†æ˜¯é”™ç”¨äº† <code>break</code>çš„æƒ…å†µï¼Œæ‰€ä»¥åˆå§‹ç‰ˆæœ¬æºç é˜…è¯»å®Œæˆåï¼Œéœ€è¦è¯»è¯»æ–°ä¸€äº›ç‰ˆæœ¬çš„æºç ã€‚</p><h2 id="è”ç³»"><a href="#è”ç³»" class="headerlink" title="è”ç³»"></a>è”ç³»</h2><p>ç‹¬è¡Œçš„è·¯æ€»æ˜¯å­¤ç‹¬çš„ï¼Œå¸Œæœ›èƒ½æ‰¾åˆ°ä¸€äº›å°ä¼™ä¼´å…±åŒè¿›æ­¥å“ˆå“ˆ~<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181226212444.png"></p><p>QQ ç¾¤å·:967808880</p>]]></content>
    
    
    <categories>
      
      <category>æºç é˜…è¯»</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æºç è§£æ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2018å¹´ç»ˆæ€»ç»“</title>
    <link href="/2018%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93.html"/>
    <url>/2018%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93.html</url>
    
    <content type="html"><![CDATA[<p>ä¸å»å¹´ä¸€æ ·ï¼Œå·²ç„¶ 2018 å¹´å°¾ï¼Œå…¨å›½å¤šæ•°åŸå¸‚å‡ ä¹éƒ½å¤§å¤§å°å°åœ°è½è¿‡å‡ åœºé›ªï¼›åŒ—äº¬ï¼Œå´æ— åŠç‚¹ä¸‹é›ªçš„å¾å…†ï¼Œåˆé›ªåº”è¯¥ä¹Ÿè¦æ‹–å»¶åˆ°æ˜å¹´å¼€æ˜¥ä¹‹åäº†å§ï¼<br>ä¸å»å¹´ä¸€æ ·ï¼Œç«‹ä¸‹çš„ç›®æ ‡é™¤äº†ç»§ç»­åšæŒå†™åšå®¢ä¹‹å¤–ï¼Œå…¶ä»–å…¨éƒ¨è¢«æŠ›è¯¸è„‘åï¼›å¦‚æœä¸æ˜¯æŠŠå†™åšå®¢è¿™ä¸ªç›®æ ‡è¿›è¡Œäº†é‡åŒ–ï¼Œå¼ºè¿«ç€è‡ªå·±å»æ‰§è¡Œï¼Œæ€•æ˜¯æ‰€æœ‰çš„ç›®æ ‡éƒ½åªæ˜¯æœ‰å§‹æ— ç»ˆç½¢äº†ï¼</p><a id="more"></a><h2 id="ä½“éªŒÂ·çªç ´"><a href="#ä½“éªŒÂ·çªç ´" class="headerlink" title="ä½“éªŒÂ·çªç ´"></a>ä½“éªŒÂ·çªç ´</h2><p>ä» 2017 å¹´å§‹ï¼Œä¸€ç›´ä»¥æ¥ï¼Œè®°å½•æ¯å¤©æ—¶é—´æ”¯å‡ºçš„ä¹ æƒ¯éƒ½åœ¨ä¿æŒç€ï¼Œä½†æ˜¯ç›®å‰å¯¹äºè‡ªå·±çš„ä½œç”¨å¹¶ä¸å¤§ï¼›ä¹Ÿä»…ä»…æ˜¯å¹´åº•è¿™ä¸ªæ—¶å€™ï¼Œéœ€è¦å†™å¹´ç»ˆæ€»ç»“çš„æ—¶å€™ï¼Œçœ‹ä¸€çœ¼å…¨å¹´æ—¶é—´ç»Ÿè®¡çš„åˆ†å¸ƒæƒ…å†µï¼Œè®©è‡ªå·±åæ‚”æœªèƒ½çæƒœå…‰é˜´è€Œå·²ã€‚<br>å€ŸåŠ©äº APP è®°å½•æ—¶é—´çš„ä¾¿åˆ©æ€§ï¼Œè™½ç„¶ä¸€å¤©çš„æ—¶é—´èƒ½åœ¨ 5 åˆ†é’Ÿå†…å…¨éƒ¨è®°å½•å®Œæ¯•ï¼Œä½†æ˜¯æœ‰æ—¶å€™ä¹Ÿä¼šæƒ³ï¼Œè®°è¿™ä¸ªå¯¹è‡ªå·±åˆ°åº•æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ  </p><p>ä¹Ÿè®¸é‡å˜æˆ–è®¸èƒ½äº§ç”Ÿè´¨å˜å§ï¼æŸ³æ¯”æ­‡å¤«å‡ åå¹´å¦‚ä¸€æ—¥çš„è®°å½•ï¼Œä¸–äººä¹Ÿä¸æ˜¯æ²¡æœ‰å¼„æ¸…ä»–è®°å½•æ—¶é—´åˆ°åº•æœ‰ä»€ä¹ˆç”¨å—ï¼Ÿå…¶ä¸­çš„å¦™å¤„å¯èƒ½ä¹Ÿåªæœ‰æŸ³æ¯”æ­‡å¤«è‡ªå·±çŸ¥é“å§ï¼</p><p>çŸ¥é“è‡ªå·±ç”Ÿå‘½æµé€çš„æ‰€æœ‰æ—¶é—´ï¼Œèƒ½è®©è‡ªå·±å˜å¾—æ›´åŠ è‡ªå¾‹ï¼Œå…¶å®è¿™æ ·å°±è¶³å¤Ÿäº†ï¼</p><p>å¹´ä¸­ï¼Œå’Œå¥³æœ‹å‹ä¸€èµ·å»çœ‹äº†ä¸€æ¬¡æˆ¿å­ï¼Œå½“æ—¶å°±å†³å®šåœ¨é‚£é‡Œä¹°ï¼Œåšä»€ä¹ˆå†³å®šéƒ½å¾ˆå¿«ï¼Œä¹°æˆ¿è¿™ä»¶äº‹ä¹Ÿä¸ä¾‹å¤–ã€‚<br>ä¹°ä¹‹å‰è§‰å¾—è‡ªå·±æ˜¯åˆšéœ€ï¼Œä¹°äº†ä¹‹åï¼Œå…¶å®ä¹°ä¸ä¹°ä¹Ÿå¹¶éé‚£ä¹ˆé‡è¦ã€‚<br>ä½†æ˜¯ç»“å©šçš„è¯ï¼Œæˆ¿å­è¿˜æ˜¯è¦æœ‰çš„ï¼Œå°±è¿™æ ·ä¸Šè½¦äº†ï¼Œ2 å¹´åæ‰èƒ½äº¤æˆ¿ï¼Œç›®å‰çš„ä½“éªŒå°±æ˜¯å¦‚æœä¸æ˜¯æ¯ä¸ªæœˆé“¶è¡Œè¦ä»å¡é‡Œæ‰£é™¤æˆ¿è´·ï¼Œæˆ‘éƒ½å¿«å¿˜äº†è‡ªå·±ä¹Ÿç®—æ˜¯ä¹°è¿‡æˆ¿çš„äººäº†ğŸ˜‚ã€‚</p><h2 id="å®¶åº­Â·ç”Ÿæ´»"><a href="#å®¶åº­Â·ç”Ÿæ´»" class="headerlink" title="å®¶åº­Â·ç”Ÿæ´»"></a>å®¶åº­Â·ç”Ÿæ´»</h2><p>å’Œæœ‹å‹å‡ºå»åƒé¥­çš„æ—¶å€™ï¼Œæ€»æ˜¯ä¼šæ„Ÿå¹æˆ‘ä»¬æ´»çš„æœ‰ç‚¹åƒè¡Œå°¸èµ°è‚‰ï¼Œé™¤äº†ä¸Šç­ï¼Œå›å®¶ï¼Œå‡ ä¹æ²¡æœ‰å…¶ä»–çš„äº‹æƒ…å»åšï¼Œä¸åƒé‚£äº›åœ¨å¹¿åœºè·³è¡—èˆï¼Œç©æ»‘æ¿ï¼Œç©æ‘„å½±çš„äººæ´»çš„æœ‰è¶£ï¼Œæ€»æ˜¯ä¼šæ„Ÿå¹è¿™æ‰æ˜¯ç”Ÿæ´»ï¼</p><p>å»å¹´ä¹Ÿæ€»æ˜¯è¢«å¥³æœ‹å‹æ‹‰ç€å»åŒ—äº¬çš„å„å¤§æ™¯ç‚¹å…¬å›­ç©ï¼Œä½†ä¹Ÿåªæ˜¯èµ°é©¬è§‚èŠ±åœ°æ¸¸è§ˆï¼Œä»Šå¹´ç´¢æ€§å°±æ²¡æœ‰å†å»è¿‡é‚£äº›åœ°æ–¹äº†ï¼Œäººå¯¹äºæ‰¾ä¸åˆ°ä¹è¶£çš„äº‹æƒ…ä¸€ç›´æ˜¯æŠ—æ‹’çš„ã€‚äºæ˜¯å›½åº†è·‘åˆ°ä¸Šæµ·ç©äº†å‡ æ—¥ï¼Œé™¤äº†è¿ªå£«å°¼ï¼Œä¹Ÿå¹¶æœªè§‰å¾—ä¸Šæµ·æ›´æœ‰è¶£ã€‚</p><p><strong>ä¹Ÿè¯¥å»æ‰¾åˆ°å¹¶ä¸”å»åšä¸€ä»¶æœ‰æ„ä¹‰æœ‰æ„æ€çš„äº‹æƒ…äº†ã€‚</strong></p><h2 id="å¥åº·Â·èº«ä½“"><a href="#å¥åº·Â·èº«ä½“" class="headerlink" title="å¥åº·Â·èº«ä½“"></a>å¥åº·Â·èº«ä½“</h2><p>æƒ³èµ·ä»Šå¹´å°è±¡æœ€æ·±çš„ä¸€ä»¶äº‹ï¼Œ<a href="https://www.zhihu.com/question/305280080">å¦‚ä½•çœ‹å¾…å¹´ä»… 25 å²çš„å¤§ç–† DJI å‘˜å·¥æˆ–å› è¿‡åŠ³è€ŒçŒæ­»å®¶ä¸­ï¼Ÿ</a>ï¼Œä»…ä»… 25 å²è€Œå·²ï¼è¿™ç§æƒ…å†µå‘ç”Ÿåœ¨äº†åŒé¾„äººçš„èº«ä¸Šï¼ŒçœŸçš„æ˜¯å¤ªå¯æ€•äº†ï¼è¿™ä»¶äº‹æƒ…ä¹Ÿç»™è‡ªå·±æ•²å“äº†è­¦é’Ÿï¼Œä¿æŠ¤å¥½è‡ªå·±çš„èº«ä½“å¾ˆé‡è¦ã€‚  </p><p><strong>ä¿è¯å¥åº·çš„ä½œæ¯ï¼Œè§„å¾‹çš„é¥®é£Ÿï¼Œåˆç†çš„è¿åŠ¨ï¼Œå¾ˆæœ‰å¿…è¦ã€‚</strong></p><p>è™½ç„¶ä¸åŠ ç­ï¼Œä½†æ˜¯æˆ‘ååœ¨ç”µè„‘å‰æ—¶é—´å¹¶ä¸æ¯”åŠ ç­çš„äººå°‘ï¼Œå¥åº·çš„ä½œæ¯ï¼Œè§„å¾‹çš„é¥®é£Ÿï¼Œè¿™ä¸¤ç‚¹éƒ½æœ‰åšåˆ°ï¼Œæ—©ç¡æ—©èµ·ï¼Œä¸€æ—¥ä¸‰é¤ï¼Œåªæ˜¯ç¼ºä¹ä¸€äº›è¿åŠ¨ã€‚</p><h2 id="å­¦ä¹ Â·æˆé•¿"><a href="#å­¦ä¹ Â·æˆé•¿" class="headerlink" title="å­¦ä¹ Â·æˆé•¿"></a>å­¦ä¹ Â·æˆé•¿</h2><p>ä¸€ç›´æ‰¾ä¸åˆ°å­¦ä¹ ä¸ç”Ÿæ´»ä¹‹é—´çš„å¹³è¡¡ç‚¹ï¼Œå­¦ä¹ çš„æ—¶å€™ï¼ŒæŠµæŠ—å­¦ä¹ ä¹‹å¤–çš„ä»»ä½•äº‹æƒ…ï¼›ä¸å­¦ä¹ çš„æ—¶å€™ï¼Œæ€€æœ‰æ·±æ·±çš„è´Ÿç½ªæ„Ÿï¼Œä½†æ˜¯å­¦ä¹ æ•ˆç‡æ€»æ²¡æœ‰æœŸæœ›çš„é‚£æ ·é«˜ã€‚</p><p>åˆç†å®‰æ’å¥½å­¦ä¹ ä¸ä¼‘é—²çš„å…³ç³»ï¼Œåˆæ˜¯ä¸€é¡¹éœ€è¦è‡ªæˆ‘å­¦ä¹ æå‡ä¹‹å¤„ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181031131423.png"><br>è‡ªç„¶ç åŒæ‹¼æ‰“å­—æ³•ï¼Œæ˜¯çœ‹åˆ°çŸ¥ä¹ä¸Šä¸€åå¤§ V æ¨èå­¦ä¹ çš„æŠ€èƒ½ï¼ŒèŠ±äº†ä¸åˆ° 3 ä¸ªå°æ—¶å°±èƒ½åŸºæœ¬æŒæ¡ã€‚<br>æ¯”å¦‚è¦æ‰“å‡ºâ€œä¸­å›½â€è¿™ä¸¤ä¸ªå­—ï¼Œå¦‚æœä½¿ç”¨å…¨æ‹¼çš„è¯ï¼Œéœ€è¦è¾“å…¥ zhonggoï¼Œ è‡³å°‘éœ€è¦æ•² 8 ä¸‹é”®ç›˜ï¼Œè€Œç”¨åŒæ‹¼ï¼Œåªéœ€è¦è¾“å…¥ vsgoï¼ŒåŠ ä¸Šç©ºæ ¼é€‰æ‹©åªéœ€è¦ 5 ä¸‹ã€‚<br>åŒæ‹¼ä¹Ÿæ²¡æœ‰äº”ç¬”æ‰“å­—é‚£æ ·éš¾ä»¥å­¦ä¹ ï¼Œå¯¹è‡ªå·±çš„å¥½å¤„è¿˜æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œå°‘æ•²å‡»é”®ç›˜ä¹Ÿæ˜¯ä¿æŠ¤äº†è‡ªå·±çš„æ‰‹æŒ‡å¤´ã€‚</p><p>ä¹‹å‰ä¸€ç›´çº ç»“çœ‹ä¹¦çš„æ•°é‡ï¼Œå›«å›µåæ£åœ°çœ‹äº†ä¸€äº›ä¹¦ï¼Œçœ‹å®Œçš„æ—¶å€™å‡ ä¹å·²ç»å¿˜äº†è¿™æœ¬ä¹¦åˆ°åº•è®²äº†äº›ä»€ä¹ˆï¼Œä¹°çš„ kindle ç°åœ¨å·²ç»æ”¾åœ¨è§’è½é»˜é»˜åƒç°ä¸­â€¦â€¦</p><p>ä»Šå¹´æ²¡æœ‰ç”¨ kindle çœ‹ä¹¦ï¼Œè€Œæ˜¯ä¹°äº†ä¸€äº›ç»å…¸çš„æŠ€æœ¯å®ä½“ä¹¦æ¥çœ‹ï¼Œçœ‹ä¹¦çš„æ•ˆæœä¹Ÿæ¯”ç”¨ kindle çœ‹çš„æ•ˆæœè¦å¥½ï¼Œkindle è¿˜æ˜¯æ›´é€‚åˆçœ‹å°è¯´é¸¡æ±¤åŠ±å¿—ä¹¦è¿™ç±»ä¹¦å§ï¼</p><h2 id="å·¥ä½œÂ·äº‹ä¸š"><a href="#å·¥ä½œÂ·äº‹ä¸š" class="headerlink" title="å·¥ä½œÂ·äº‹ä¸š"></a>å·¥ä½œÂ·äº‹ä¸š</h2><p>æœ€è¿‘è¿™ä¸¤å¹´ï¼Œé€æ¸è§‰å¾—è‡ªå·±çš„æŠ€æœ¯æå‡é€Ÿåº¦å˜å¾—ç›¸å½“æ…¢äº†ï¼Œä»Šå¹´ä¸€å¹´ï¼Œåœ¨è„‘æµ·é‡Œèƒ½é©¬ä¸Šæƒ³èµ·æ¥çš„å°±æ˜¯å­¦ä¹ äº† ESï¼Œæ­äº†ä¸ªå…¬å¸å…¬ç”¨æœç´¢å·¥ç¨‹æä¾›ç½‘ç«™çš„æœç´¢ï¼Œå…¶ä»–çš„å‡ ä¹å°±æƒ³ä¸èµ·æ¥äº†ï¼›<br>å­¦ä¹ äº† Spring Cloud ç›¸å…³æŠ€æœ¯ï¼Œä½†æ˜¯æ²¡æœ‰çœŸæ­£åœ°å»å®è·µåº”ç”¨è¿‡ï¼Œéƒ½å¿«é—å¿˜äº†ğŸ˜‚ï¼Œå¸Œæœ›èƒ½æœ‰æœºä¼šå®è·µå§ï¼›<br>æœ€è¿‘åšæ—§å•ä½“é¡¹ç›®çš„é‡æ„ä¸ºåˆ†å¸ƒå¼åº”ç”¨çš„å·¥ä½œï¼Œè€ƒè™‘åˆ°éœ€è¦å¹³è¡¡è¿ç§»ä¸å›¢é˜ŸæŠ€æœ¯ï¼Œä¿å®ˆåœ°ä½¿ç”¨äº† Dubbo æ¥å®ç°ï¼Œåšä¹‹å‰è§‰å¾—å¾ˆç®€å•å•Šï¼Œå°±æ˜¯æŠŠä¹‹å‰ä»£ç è¿ç§»è¿‡æ¥ï¼Œæ”¹æ”¹å°±è¡Œäº†ï¼Œåšçš„æ—¶å€™æ‰å‘ç°ï¼Œå¦‚æœè¦æŒ‰ç…§æˆ‘æœŸæœ›ä¸­çš„é¡¹ç›®è§„èŒƒ/ä»£ç è´¨é‡å»åšï¼Œå‡ ä¹å°±åˆæ˜¯é‡å†™äº†ä¸€åŠä»£ç ï¼Œåˆç»™è‡ªå·±åŸ‹äº†ä¸ªå‘ã€‚<br>ç›®å‰ä¹Ÿåªæœ‰è‡ªå·±åœ¨åšï¼Œå¸Œæœ›æ¥å¹´èƒ½æœ‰ä¸€ä¸ªå¹¶è‚©æˆ˜æ–—çš„ä¼™ä¼´ï¼Œæ¯•ç«Ÿåªæœ‰è‡ªå·±åœ¨æ‘¸ç´¢ç€è¡Œè¿›ï¼Œè¿˜æ˜¯å¾ˆæ…¢çš„ã€‚</p><h2 id="2019è¦åšçš„äº‹æƒ…"><a href="#2019è¦åšçš„äº‹æƒ…" class="headerlink" title="2019è¦åšçš„äº‹æƒ…"></a>2019è¦åšçš„äº‹æƒ…</h2><p>é‡åŒ–è‡ªå·±çš„ç›®æ ‡ï¼Œå¤„ç†å¥½ç”Ÿæ´»ä¸å­¦ä¹ çš„å¹³è¡¡å…³ç³»ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>å¹´ç»ˆæ€»ç»“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dubboè‡ªå®šä¹‰å¼‚å¸¸ä¼ é€’ä¿¡æ¯ä¸¢å¤±é—®é¢˜è§£å†³</title>
    <link href="/dubbo%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8%E4%BC%A0%E9%80%92%E4%BF%A1%E6%81%AF%E4%B8%A2%E5%A4%B1%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3.html"/>
    <url>/dubbo%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8%E4%BC%A0%E9%80%92%E4%BF%A1%E6%81%AF%E4%B8%A2%E5%A4%B1%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3.html</url>
    
    <content type="html"><![CDATA[<p>ç›®å‰è®¡åˆ’å¯¹å·²æœ‰çš„å•ä½“é¡¹ç›®è¿›è¡Œç»„ç»‡æ¶æ„æ‹†åˆ†ï¼Œè°ƒç ”äº†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸ç”¨ä¸­é—´ä»¶ Dubbo å’Œ Spring Cloudï¼Œé€‰æ‹©äº† Dubboï¼Œå¯ä»¥å¯¹å½“å‰ç°æœ‰é¡¹ç›®è¿›è¡Œå¹³æ»‘å‡çº§æ”¹é€ ã€‚ä½†æ˜¯ä¸€å¼€å§‹å°±é‡åˆ°äº†éº»çƒ¦ï¼Œè‡ªå®šä¹‰å¼‚å¸¸åœ¨ä¼ é€’çš„è¿‡ç¨‹ä¸­å˜æˆäº† RuntimeExceptionï¼Œç»Ÿä¸€å¼‚å¸¸å¤„ç† <strong>GlobalExceptionHandler</strong> æ— æ³•è·å–å¼‚å¸¸ä¿¡æ¯ã€‚</p><a id="more"></a><h2 id="é—®é¢˜é‡ç°"><a href="#é—®é¢˜é‡ç°" class="headerlink" title="é—®é¢˜é‡ç°"></a>é—®é¢˜é‡ç°</h2><p>é¡¹ç›®è¿›è¡Œç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼ŒæŠ½å–äº†ä¸€ä¸ªé€šç”¨å¼‚å¸¸ <strong>ServiceException</strong>ï¼Œæ­¤å¼‚å¸¸æ˜¯éå—æ£€å¼‚å¸¸ï¼Œå³ç»§æ‰¿äº RuntimeExceptionã€‚è°ƒç ”æ—¶å‘ç°å¦‚æœæœåŠ¡æä¾›æ–¹å³ provider æŠ›å‡ºäº† <strong>ServiceException</strong> å¼‚å¸¸ï¼Œconsumer æœåŠ¡æ¶ˆè´¹æ–¹å°±ä¼šæ”¶åˆ°ä¸€ä¸ª RuntimeException å¼‚å¸¸ï¼Œè€Œ <strong>ServiceException</strong> å¼‚å¸¸çš„å†…å®¹è¢«åŒ…å«åœ¨äº† RuntimeException çš„å¼‚å¸¸å †æ ˆä¸­</p><figure class="highlight ada"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ada">[Request processing failed; nested <span class="hljs-keyword">exception</span> <span class="hljs-keyword">is</span> java.lang.RuntimeException: io.github.mosiki.common.<span class="hljs-keyword">exception</span>.ServiceException: missing_required_parameters<br>io.github.mosiki.common.<span class="hljs-keyword">exception</span>.ServiceException: missing_required_parameters<br><span class="hljs-keyword">at</span> io.github.mosiki.provider.HelloService.sayHello(HelloService.java:<span class="hljs-number">20</span>)<br><span class="hljs-keyword">at</span> com.alibaba.dubbo.common.bytecode.Wrapper1.invokeMethod(Wrapper1.java)<br></code></pre></div></td></tr></table></figure><p>è€Œæˆ‘çš„ç»Ÿä¸€å¼‚å¸¸å¤„ç†æ˜¯è¿™æ ·çš„ï¼Œåªå¤„ç† <code>ServiceException</code> ä»¥åŠ <code>Exception</code>ï¼Œå› æ­¤å°±æ— æ³•è·å–åˆ°åŸå§‹å¼‚å¸¸çš„ä¿¡æ¯äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Slf4j</span><br><span class="hljs-meta">@RestControllerAdvice</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GlobalExceptionHandler</span> </span>&#123;<br><br>    <span class="hljs-meta">@ExceptionHandler(ServiceException.class)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Result <span class="hljs-title">handlerServiceException</span><span class="hljs-params">(ServiceException ex)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> Result.failure(ex.getCode(), ex.getMessage());<br>    &#125;<br><br>    <span class="hljs-meta">@ExceptionHandler(&#123;Exception.class&#125;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Result <span class="hljs-title">handlerException</span><span class="hljs-params">(Exception ex)</span> </span>&#123;<br>        log.error(<span class="hljs-string">&quot;å‘ç”ŸæœªçŸ¥å¼‚å¸¸ï¼š&#123;&#125;&quot;</span>, ex);<br>        <span class="hljs-keyword">return</span> Result.failure(HttpStatus.INTERNAL_SERVER_ERROR.value(), <span class="hljs-string">&quot;æœåŠ¡å™¨æ‰“äº†ä¸ªå°ç›¹å„¿~è¯·ç¨å€™å†è¯•&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è®¿é—®æ¥å£å°†è¿”å›å¦‚ä¸‹ï¼Œå¼‚å¸¸ä¸­åŸæœ‰ä¿¡æ¯ä¸¢å¤±ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181211061411.png"></p><p>ä¸Šç½‘æœç´¢å‘ç°ï¼Œè¿™æ˜¯å› ä¸º dubbo çš„å¼‚å¸¸å¤„ç†ç±» <code>com.alibaba.dubbo.rpc.filter.ExceptionFilter </code> è¿›è¡Œå¤„ç†åçš„ç»“æœï¼ŒDebug ä¹‹åç¡®å®å¦‚æ­¤ï¼Œdubbo åœ¨æ­¤è¿›è¡Œäº†è½¬æ¢ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181211062145.png"></p><h2 id="é—®é¢˜è§£å†³ä¹‹é“"><a href="#é—®é¢˜è§£å†³ä¹‹é“" class="headerlink" title="é—®é¢˜è§£å†³ä¹‹é“"></a>é—®é¢˜è§£å†³ä¹‹é“</h2><p>ç°åœ¨æˆ‘æƒ³è¦ provider æŠŠè‡ªå®šä¹‰çš„å¼‚å¸¸åŸå°ä¸åŠ¨çš„æŠ›ç»™ consumer è¿›è¡Œå¤„ç†ï¼Œäºæ˜¯æœ‰äº†å¦‚ä¸‹æ€è·¯ï¼š</p><ol><li>ç¦ç”¨ provider çš„ ExceptionFilter</li><li>è®© GlobalExceptionHandler å¤„ç† consumer çš„å¼‚å¸¸</li></ol><p>æŒ‰ç…§æ­¤æ€è·¯åšå°±å¾ˆç®€å•äº†ï¼Œç½‘ä¸Šå¤§å¤šæ–‡ç« çš„åŠæ³•éƒ½æ¯”è¾ƒéº»çƒ¦ï¼Œæœ‰ç”¨ AOP å¤„ç†çš„ï¼Œç”šè‡³è¿˜æœ‰è®©è‡ªå·±ä¿®æ”¹ç¼–è¯‘æºç ä¸Šä¼ ç§æœçš„-_-||ï¼Œæœ¬æ–‡ç»™å‡ºæ¯”è¾ƒç®€ä¾¿çš„æ–¹æ³•ï¼Œæä¾›å‚è€ƒã€‚</p><h2 id="ç¦ç”¨providerçš„ExceptionFilter"><a href="#ç¦ç”¨providerçš„ExceptionFilter" class="headerlink" title="ç¦ç”¨providerçš„ExceptionFilter"></a>ç¦ç”¨providerçš„ExceptionFilter</h2><p>ä¿®æ”¹ provider çš„é…ç½®ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨ yml é…ç½®æ–‡ä»¶ï¼Œå…¶ä»–ç±»å‹å¦‚ xml/properties ä¹ŸåŒç†ï¼Œè®¾ç½® provider çš„ filter ä¸º <strong>-exception</strong>ï¼Œè¿™æ ·å¼‚å¸¸å°±ä¸ä¼šè¢«å¤„ç†è€Œæ˜¯ç›´æ¥æŠ›å‡ºäº†ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yml"><span class="hljs-attr">dubbo:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">provider</span><br>  <span class="hljs-attr">protocol:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">dubbo</span><br>    <span class="hljs-attr">port:</span> <span class="hljs-number">20100</span><br>  <span class="hljs-attr">registry:</span><br>    <span class="hljs-attr">address:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:2181</span><br>    <span class="hljs-attr">protocol:</span> <span class="hljs-string">zookeeper</span><br>  <span class="hljs-attr">provider:</span><br>    <span class="hljs-attr">filter:</span> <span class="hljs-string">-exception</span><br></code></pre></div></td></tr></table></figure><h2 id="GlobalExceptionHandleræ•è·ServiceException"><a href="#GlobalExceptionHandleræ•è·ServiceException" class="headerlink" title="GlobalExceptionHandleræ•è·ServiceException"></a>GlobalExceptionHandleræ•è·ServiceException</h2><p>åªæ˜¯ç¦ç”¨äº† provider çš„ ExceptionHandler è¿˜ä¸èƒ½å®Œå…¨è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ï¼Œè®¿é—®æ¥å£ï¼Œprovider æŠ›å‡ºå¼‚å¸¸ consumer æ­£ç¡®æ¥æ”¶ä¸º <strong>ServiceException</strong>ã€‚</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-attr">[Request processing failed; nested exception is io.github.mosiki.common.exception.ServiceException: missing_required_parameters]</span> <span class="hljs-selector-tag">with</span> <span class="hljs-selector-tag">root</span> <span class="hljs-selector-tag">cause</span><br><br><span class="hljs-selector-tag">io</span><span class="hljs-selector-class">.github</span><span class="hljs-selector-class">.mosiki</span><span class="hljs-selector-class">.common</span><span class="hljs-selector-class">.exception</span><span class="hljs-selector-class">.ServiceException</span>: <span class="hljs-selector-tag">missing_required_parameters</span><br><span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">io</span><span class="hljs-selector-class">.github</span><span class="hljs-selector-class">.mosiki</span><span class="hljs-selector-class">.provider</span><span class="hljs-selector-class">.HelloService</span><span class="hljs-selector-class">.sayHello</span>(<span class="hljs-selector-tag">HelloService</span><span class="hljs-selector-class">.java</span><span class="hljs-selector-pseudo">:20)</span> ~<span class="hljs-selector-attr">[na:na]</span><br><span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.alibaba</span><span class="hljs-selector-class">.dubbo</span><span class="hljs-selector-class">.common</span><span class="hljs-selector-class">.bytecode</span><span class="hljs-selector-class">.Wrapper1</span><span class="hljs-selector-class">.invokeMethod</span>(<span class="hljs-selector-tag">Wrapper1</span><span class="hljs-selector-class">.java</span>) ~<span class="hljs-selector-attr">[na:na]</span><br></code></pre></div></td></tr></table></figure><p>æˆ‘ä»¬å¤„ç†ä¸€ä¸‹ GlobalExceptionHandlerã€‚</p><p>SpringBoot ä¸»è¦è¿™ä¸ªå¯åŠ¨ç±»çš„ä½ç½®å’Œå…¨å±€å¼‚å¸¸å¤„ç†å™¨çš„ä½ç½®ï¼Œä¸€å®šè¦ä¿è¯å¼‚å¸¸å¤„ç†å™¨åœ¨å¯åŠ¨ç±»çš„åŒçº§åŒ…æˆ–è€…åœ¨å¯åŠ¨ç±»çš„å­åŒ…å½“ä¸­ï¼Œå¦åˆ™å¼‚å¸¸å¤„ç†å™¨å°†ä¸ç”Ÿæ•ˆï¼<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181211060804.png"></p><h2 id="æ•ˆæœå±•ç¤º"><a href="#æ•ˆæœå±•ç¤º" class="headerlink" title="æ•ˆæœå±•ç¤º"></a>æ•ˆæœå±•ç¤º</h2><p>ä»¥ä¸Šä¸¤æ­¥å®Œæˆåï¼Œé‡å¯æœåŠ¡ï¼Œè®¿é—®æ¥å£æµ‹è¯•ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181211061223.png"></p><p>æ‹¿åˆ°äº† provider æŠ›å‡ºçš„åŸå§‹è‡ªå®šä¹‰å¼‚å¸¸ï¼Œå¦‚æ­¤é—®é¢˜å°±è§£å†³äº†ã€‚</p><h2 id="ä»£ç ä¸‹è½½"><a href="#ä»£ç ä¸‹è½½" class="headerlink" title="ä»£ç ä¸‹è½½"></a>ä»£ç ä¸‹è½½</h2><ul><li><a href="https://github.com/Mosiki/dubbo-exception-example-parent">https://github.com/Mosiki/dubbo-exception-example-parent</a></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://blog.csdn.net/yangzaizi/article/details/80638306">https://blog.csdn.net/yangzaizi/article/details/80638306</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>dubboè‡ªå®šä¹‰å¼‚å¸¸</tag>
      
      <tag>dubboå¼‚å¸¸å †æ ˆè¢«åƒ</tag>
      
      <tag>dubboå¤„ç†è‡ªå®šä¹‰å¼‚å¸¸é—®é¢˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>IDEAè¿œç¨‹ä»“åº“ç‰ˆæœ¬å›æ»š</title>
    <link href="/IDEA%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%E7%89%88%E6%9C%AC%E5%9B%9E%E6%BB%9A.html"/>
    <url>/IDEA%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93%E7%89%88%E6%9C%AC%E5%9B%9E%E6%BB%9A.html</url>
    
    <content type="html"><![CDATA[<p>ä½¿ç”¨ git è¿›è¡Œé¡¹ç›®çš„ç‰ˆæœ¬æ§åˆ¶æ—¶ï¼Œè‚¯å®šä¼šé‡åˆ°å›æ»šç‰ˆæœ¬çš„æƒ…å†µï¼Œå›æ»šæœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯æœ¬åœ°ä»“åº“å›æ»šï¼Œå¦å¤–ä¸€ç§æ˜¯è¿œç¨‹ä»“åº“å›æ»šã€‚ä»¥ä¸‹è¯¦ç»†è®²è§£ä¸¤ç§å›æ»šæ–¹å¼ï¼Œæœ¬æ–‡ä¸»è¦è®²è§£è¿œç¨‹å›æ»šï¼Œä»¥åŠå¸¸è§ä½¿ç”¨è¯¯åŒºã€‚</p><a id="more"></a><h2 id="æœ¬åœ°ä»“åº“å›æ»š"><a href="#æœ¬åœ°ä»“åº“å›æ»š" class="headerlink" title="æœ¬åœ°ä»“åº“å›æ»š"></a>æœ¬åœ°ä»“åº“å›æ»š</h2><p>æœ¬åœ°å›æ»šå°±å¾ˆç®€å•ï¼Œåªæ˜¯è¦æ’¤é”€ commit ä¿¡æ¯å³å¯ã€‚å¯ä»¥ç›´æ¥ä½¿ç”¨ <strong>Reset HEAD</strong>è¿›è¡Œå›æ»šã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181202183824.png"></p><p>HEAD^ æ˜¯è¿˜åŸåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼ŒHEAD^^ æ˜¯è¿˜åŸåˆ°ä¸Šä¸Šä¸€ä¸ªç‰ˆæœ¬ã€‚<br>Reset Type æœ‰ä¸‰ç§ï¼š</p><p>mixed é»˜è®¤æ–¹å¼ï¼Œåªä¿ç•™æºç ï¼Œå›é€€commitå’Œindexä¿¡æ¯<br>soft å›é€€åˆ°æŸä¸ªç‰ˆæœ¬ï¼Œåªå›é€€äº†commitçš„ä¿¡æ¯ï¼Œä¸ä¼šæ¢å¤åˆ°index fileä¸€çº§ã€‚å¦‚æœè¿˜è¦æäº¤ï¼Œç›´æ¥commit<br>hard å½»åº•å›é€€ï¼Œæœ¬åœ°æºç ä¹Ÿä¼šå˜æˆä¸Šä¸€ä¸ªç‰ˆæœ¬å†…å®¹</p><h2 id="é”™è¯¯çš„è¿œç¨‹ä»“åº“å›æ»šæ–¹å¼"><a href="#é”™è¯¯çš„è¿œç¨‹ä»“åº“å›æ»šæ–¹å¼" class="headerlink" title="é”™è¯¯çš„è¿œç¨‹ä»“åº“å›æ»šæ–¹å¼"></a>é”™è¯¯çš„è¿œç¨‹ä»“åº“å›æ»šæ–¹å¼</h2><p>è¿œç¨‹ä»“åº“ä»£ç å›æ»šï¼Œå¦‚æœä¸Š Google ä¸Šä¸€æœï¼ŒåŸºæœ¬å‡ºæ¥çš„ç­”æ¡ˆéƒ½æ˜¯ä½¿ç”¨ <strong>Reset HEAD</strong> åŠ ä¸Š <strong>git push -f</strong> å¼ºåˆ¶æäº¤çš„æ–¹å¼ã€‚</p><p>æˆ‘æœ¬åœ°æµ‹è¯•äº†ä¸€ä¸‹ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªäººåŒæ—¶åœ¨è¿™æ¡åˆ†æ”¯ä¸Šå¼€å‘ï¼Œå…¶ä¸­ä¸€ä¸ªäºº å° A å¦‚æœä½¿ç”¨è¿™ç§æ–¹å¼è¿›è¡Œå›æ»šäº†è¿œç¨‹ä»“åº“ä»£ç ï¼Œå¦å¤–ä¸€ä¸ªäºº å° B æ­¤æ—¶æœ¬åœ°è¿˜æ˜¯å›æ»šä¹‹å‰çš„ä»£ç ï¼Œå° B é‚£é‡Œå°±ä¼šå‡ºç°æœ¬åœ°ä»£ç ç‰ˆæœ¬é«˜äºè¿œç¨‹åˆ†æ”¯ç‰ˆæœ¬çš„æƒ…å†µï¼Œæ­¤æ—¶è‹¥å° B è¿›è¡Œäº† push æ“ä½œï¼Œä¹‹å‰å° A å›æ»šçš„ä»£ç å°±åˆä¼šè¢«æ¨é€åˆ°è¿œç¨‹çš„ä»“åº“äº†ã€‚é™¤éå° B åœ¨å›æ»šåï¼Œå°†å…¶æœ¬åœ°ä»“åº“çš„ç‰ˆæœ¬ä¹Ÿè¿›è¡Œå›æ»šã€‚æ‰èƒ½ä¿è¯ä¸ä¼šæŠŠå›æ»šçš„ä»£ç é‡æ–° push å›è¿œç¨‹ä»“åº“ï¼Œä½†æ˜¯å¦‚æœå¼€å‘äººå‘˜å¤šï¼Œå°±æ— æ³•ä¿è¯æ‰€æœ‰å¼€å‘äººå‘˜çš„æœ¬åœ°åˆ†æ”¯éƒ½å›æ»šï¼</p><p><strong>å› æ­¤ï¼Œä¸è¦ä½¿ç”¨ git push -f è¿™ç§æ–¹å¼æ¥å¼ºåˆ¶å›æ»šè¿œç¨‹ä»“åº“ä»£ç ï¼</strong></p><h2 id="æ­£ç¡®çš„è¿œç¨‹ä»“åº“å›æ»šæ–¹å¼"><a href="#æ­£ç¡®çš„è¿œç¨‹ä»“åº“å›æ»šæ–¹å¼" class="headerlink" title="æ­£ç¡®çš„è¿œç¨‹ä»“åº“å›æ»šæ–¹å¼"></a>æ­£ç¡®çš„è¿œç¨‹ä»“åº“å›æ»šæ–¹å¼</h2><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181202173041.png"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œç°åœ¨éœ€è¦å°†è¿œç¨‹ä»“åº“å›æ»šåˆ° dev-103 è¿™æ¬¡æäº¤ç‚¹ã€‚</p><p>é€‰ä¸­ <strong>dev-103</strong> è¿™ä¸€è¡Œï¼Œå³é”®é€‰æ‹© Revert<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181202190206.png"></p><p>è¿™é‡Œæç¤ºéœ€è¦ commit</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181202190327.png"></p><p>commit ä¹‹åï¼Œpush åˆ°è¿œç¨‹ä»“åº“ä¸­ã€‚æœ€ç»ˆç»“æœå¦‚ä¸‹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181202190438.png"></p><p>æ–°å¢äº†ä¸€æ¡æäº¤è®°å½•ï¼ŒæŸ¥çœ‹ä»£ç å·²ç»è¢«å›æ»šäº†<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181202190551.png"></p><p>å…¶ä»–å¼€å‘äººå‘˜å¦‚æœè¿›è¡Œäº† pullï¼Œå…¶æœ¬åœ°ä»“åº“ä¹Ÿè¢«æ­£ç¡®å›æ»šåˆ°äº† dev-103 æäº¤ç‚¹ï¼Œå°±æ— éœ€å†æ‹…å¿ƒå›æ»šçš„ä»£ç åˆè¢«é‡æ–° push åˆ°è¿œç¨‹ä»“åº“å•¦ã€‚</p><p>æå®šï¼Œæ”¶å·¥ï¼</p>]]></content>
    
    
    <categories>
      
      <category>å·¥å…·ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Gitè¿œç¨‹ä»“åº“å›æ»š</tag>
      
      <tag>Gitæœ¬åœ°ä»“åº“å›æ»š</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ESæœç´¢ç»“æœè°ƒä¼˜</title>
    <link href="/ES%E6%90%9C%E7%B4%A2%E7%BB%93%E6%9E%9C%E8%B0%83%E4%BC%98.html"/>
    <url>/ES%E6%90%9C%E7%B4%A2%E7%BB%93%E6%9E%9C%E8%B0%83%E4%BC%98.html</url>
    
    <content type="html"><![CDATA[<p>è‡ªä»ä½¿ç”¨ ElasticSearch é‡æ„äº†ä¸»ç«™çš„æœç´¢é¡¹ç›®ä¹‹åï¼Œä¹‹ååˆé™†ç»­æ¥å…¥äº†å…¶ä»–ä¸¤ä¸ªé¡¹ç›®ï¼Œç›®å‰ä½¿ç”¨ SpringBoot æ–¹å¼è·‘äº†ä¸€ä¸ªä¼ªé›†ç¾¤ï¼Œä¸»ç«™ä½¿ç”¨çš„æ—¶å€™ï¼Œæ¯”è¾ƒç¨³å®šï¼Œæ²¡æœ‰äººåé¦ˆè¯´æœ‰é—®é¢˜ã€‚</p><p>ä½†æ–°æ¥å…¥çš„ä¸€ä¸ªç«™ç‚¹å•†åŠ¡åé¦ˆè¯´ï¼Œæœç´¢ä¸å¤Ÿå‡†ç¡®ï¼Œå®Œå…¨åŒ¹é…çš„å…³é”®è¯ä¸æ˜¯æ’åœ¨æœç´¢ç»“æœåˆ—è¡¨é¦–ä½ï¼Œè·‘åˆ°æœç´¢ä¸Šå»çœ‹äº†ä¸€çœ¼ï¼Œç¡®å®å®Œå…¨åŒ¹é…çš„ç»“æœåˆ†æ•°ä¸æ˜¯æœ€é«˜çš„ï¼Œå¯¼è‡´æ²¡æœ‰æ’åœ¨ç»“æœé¦–ä½ï¼Œä»Šå¤©å°±æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><a id="more"></a><h2 id="é»˜è®¤åŒ¹é…æŸ¥è¯¢"><a href="#é»˜è®¤åŒ¹é…æŸ¥è¯¢" class="headerlink" title="é»˜è®¤åŒ¹é…æŸ¥è¯¢"></a>é»˜è®¤åŒ¹é…æŸ¥è¯¢</h2><p>å…ˆçœ‹çœ‹æˆ‘ä¹‹å‰å†™çš„æŸ¥è¯¢ä»£ç ç‰‡æ®µï¼Œ</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">MultiMatchQueryBuilder matchQuery = QueryBuilders.multiMatchQuery(query.getQueryString(), <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;author&quot;</span>);<br>boolQuery.must(matchQuery);<br></code></pre></div></td></tr></table></figure><p>è¿™ç§å†™æ³•ï¼Œå®Œå…¨æ²¡æœ‰å¯¹æœç´¢ç»“æœçš„å¹³åˆ†è¿›è¡Œå¹²æ‰°ï¼Œåªæ˜¯æŒ‰ç…§ ES çš„é»˜è®¤åˆ†è¯è®¡ç®—åŒ¹é…åº¦çš„ç»“æœã€‚</p><h2 id="æƒé‡æŸ¥è¯¢"><a href="#æƒé‡æŸ¥è¯¢" class="headerlink" title="æƒé‡æŸ¥è¯¢"></a>æƒé‡æŸ¥è¯¢</h2><p>æˆ‘å°è¯•äº†ä½¿ç”¨æƒé‡æŸ¥è¯¢ï¼Œå³æå‡æŸäº›å­—æ®µçš„æƒé‡ï¼Œä½†æ˜¯è®¾ç½®ä¹‹åï¼Œç»“æœåè€Œæ›´åŠ ä¸å°½å¦‚äººæ„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">boolQuery.should(QueryBuilders.matchQuery(<span class="hljs-string">&quot;name&quot;</span>, queryString).boost(<span class="hljs-number">3.0f</span>));<br>boolQuery.should(QueryBuilders.matchQuery(<span class="hljs-string">&quot;author&quot;</span>, queryString).boost(<span class="hljs-number">1.f</span>));<br></code></pre></div></td></tr></table></figure><p>è¿™æ ·è¿›è¡ŒæŸ¥è¯¢ä¹‹åï¼Œå¦‚æœæƒ³è¦æŸ¥è¯¢ä½œè€…ï¼Œä½†æ˜¯ä½œå“åç§°çš„æƒé‡æ›´é«˜äº›ï¼Œæ‰€ä»¥å®Œå…¨åŒ¹é…çš„ä½œè€…ä¹Ÿè¢«æ’åœ¨äº†åé¢ã€‚</p><h2 id="æœ€ä½³å­—æ®µæŸ¥è¯¢"><a href="#æœ€ä½³å­—æ®µæŸ¥è¯¢" class="headerlink" title="æœ€ä½³å­—æ®µæŸ¥è¯¢"></a>æœ€ä½³å­—æ®µæŸ¥è¯¢</h2><p>çœ‹äº†å®˜æ–¹åšå®¢å’Œä¸€ç¯‡åšå®¢æ–‡ç« ï¼Œå‘ç° <code>multi-match-query</code> çš„é«˜çº§æŸ¥è¯¢æ–¹å¼ã€‚</p><blockquote><p><code>multi_match</code> å¤šåŒ¹é…æŸ¥è¯¢çš„ç±»å‹æœ‰å¤šç§ï¼Œå…¶ä¸­çš„ä¸‰ç§æ°å·§ä¸ <a href="https://www.elastic.co/guide/cn/elasticsearch/guide/cn/_single_query_string.html#know-your-data">äº†è§£æˆ‘ä»¬çš„æ•°æ®</a> ä¸­ä»‹ç»çš„ä¸‰ä¸ªåœºæ™¯å¯¹åº”ï¼Œå³ï¼š <code>best_fields</code> ã€ <code>most_fields</code> å’Œ <code>cross_fields</code> ï¼ˆæœ€ä½³å­—æ®µã€å¤šæ•°å­—æ®µã€è·¨å­—æ®µï¼‰ã€‚</p></blockquote><p>è¿™é‡Œæˆ‘ä»¬æƒ³è¦æœç´¢æ—¶ï¼Œå®Œå…¨åŒ¹é…çš„å…³é”®å­—æ’åæ›´é å‰ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨æœ€ä½³å­—æ®µ <strong>best_fields</strong> è¿›è¡ŒæŸ¥è¯¢</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">MultiMatchQueryBuilder multiMatchQuery = QueryBuilders<br>                    .multiMatchQuery(queryString, <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;author&quot;</span>)<br>                    .type(MultiMatchQueryBuilder.Type.BEST_FIELDS)<br>                    .tieBreaker(<span class="hljs-number">0.1f</span>); <br>boolQuery.must(multiMatchQuery);<br></code></pre></div></td></tr></table></figure><p>é¦–å…ˆè®¾ç½® type ä¸º <strong>BEST_FIELDS</strong>ï¼Œå…¶æ¬¡ï¼Œæˆ‘ä»¬æƒ³è¦å®Œå…¨åŒ¹é…çš„åˆ†æ•°é«˜ç‚¹ï¼Œé‚£ä¹ˆå°±è®©æ²¡æœ‰å®Œå…¨åŒ¹é…çš„åˆ†æ–‡æ¡£è¯„åˆ†ä½å³å¯ï¼Œæˆ‘è¿™é‡Œä¹˜ä»¥äº† 0.1 çš„ç³»æ•°ï¼Œç³»æ•°çš„èŒƒå›´æ˜¯ 0-1 ä¹‹é—´ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181128181959.png"></p><p>åŠ ä¸Šäº†ç³»æ•°ä¹‹åï¼Œä¸å®Œå…¨åŒ¹é…çš„æ–‡æ¡£è¯„åˆ†å°±è¢«æ‹‰å¼€äº†ï¼Œå°±è¾¾åˆ°äº†æˆ‘çš„æœ€ç»ˆç›®çš„ã€‚</p><h2 id="æœ€ä½³å­—æ®µä¼˜åŒ–"><a href="#æœ€ä½³å­—æ®µä¼˜åŒ–" class="headerlink" title="æœ€ä½³å­—æ®µä¼˜åŒ–"></a>æœ€ä½³å­—æ®µä¼˜åŒ–</h2><p><strong>2019å¹´01æœˆ19æ—¥08:01:31 æ›´æ–°</strong><br>é€šè¿‡ä¸Šä¸€æ­¥ä¼˜åŒ–ï¼Œå·²ç»æå‡äº†å®Œå…¨åŒ¹é…æ–‡æ¡£çš„è¯„åˆ†ï¼Œä½†æ˜¯è¿˜ä¸è¶³ä»¥æ‹‰å¼€è¯„åˆ†<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181128181959.png"></p><p>ç°åœ¨æ˜¯ä½œå“åç§°/ä½œè€…ä¸¤ä¸ªå­—æ®µéƒ½å­˜åœ¨ç›¸åŒçš„å€¼ï¼Œä½†æ˜¯æƒ³è®©ä½œå“åç§°å­—æ®µçš„æƒé‡æ›´é«˜ç‚¹ï¼Œå³æœç´¢ç›¸åŒå€¼çš„æ—¶å€™ï¼Œä¼˜å…ˆæœç´¢å‡ºä½œå“åä¸ºè¯¥å€¼çš„æ•°æ®<br>æœ€ç»ˆä¼˜åŒ–ç»“æœï¼š<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190119080610.png"></p><p>ä»£ç å®ç°ï¼š  </p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testHighlightQuery</span><span class="hljs-params">()</span> </span>&#123;<br>    BookQuery query = <span class="hljs-keyword">new</span> BookQuery();<br>    query.setQueryString(<span class="hljs-string">&quot;ç©¿è¶Š&quot;</span>);<br><br>    <span class="hljs-comment">// å¤åˆæŸ¥è¯¢</span><br>    BoolQueryBuilder boolQuery = QueryBuilders.boolQuery();<br><br>    PageRequest pageRequest = PageRequest.of(query.getPage() - <span class="hljs-number">1</span>, query.getSize());<br>    NativeSearchQueryBuilder queryBuilder = <span class="hljs-keyword">new</span> NativeSearchQueryBuilder()<br>            .withQuery(boolQuery)<br>            .withHighlightFields(<br>                    <span class="hljs-keyword">new</span> HighlightBuilder.Field(<span class="hljs-string">&quot;name&quot;</span>).preTags(<span class="hljs-string">&quot;&lt;span style=\&quot;color:red\&quot;&gt;&quot;</span>).postTags(<span class="hljs-string">&quot;&lt;/span&gt;&quot;</span>),<br>                    <span class="hljs-keyword">new</span> HighlightBuilder.Field(<span class="hljs-string">&quot;author&quot;</span>).preTags(<span class="hljs-string">&quot;&lt;span style=\&quot;color:red\&quot;&gt;&quot;</span>).postTags(<span class="hljs-string">&quot;&lt;/span&gt;&quot;</span>))<br>            .withPageable(pageRequest);<br><br>    <span class="hljs-comment">// ä»¥ä¸‹ä¸ºæŸ¥è¯¢æ¡ä»¶, ä½¿ç”¨ must query è¿›è¡ŒæŸ¥è¯¢ç»„åˆ</span><br><span class="hljs-comment">//        MultiMatchQueryBuilder matchQuery = QueryBuilders.multiMatchQuery(query.getQueryString(), &quot;name&quot;, &quot;intro&quot;, &quot;author&quot;);</span><br><span class="hljs-comment">//        boolQuery.must(matchQuery);</span><br>    String queryString = query.getQueryString();<br>    <span class="hljs-comment">// æœ€ä½³å­—æ®µ  + é™ä½é™¤äº†nameä¹‹å¤–å­—æ®µçš„æƒé‡ç³»æ•°</span><br>    MatchQueryBuilder nameQuery = QueryBuilders.matchQuery(<span class="hljs-string">&quot;name&quot;</span>, queryString);<br>    MatchQueryBuilder authorQuery = QueryBuilders.matchQuery(<span class="hljs-string">&quot;author&quot;</span>, queryString).boost(<span class="hljs-number">0.8f</span>);<br>    DisMaxQueryBuilder disMaxQueryBuilder = QueryBuilders.disMaxQuery().add(nameQuery).add(authorQuery);<br>    queryBuilder.withQuery(disMaxQueryBuilder);<br><br>    NativeSearchQuery searchQuery = queryBuilder.build();<br>    Page&lt;Book&gt; books = elasticsearchTemplate.queryForPage(searchQuery, Book.class, extResultMapper);<br><br>    books.forEach(e -&gt; log.info(<span class="hljs-string">&quot;&#123;&#125;&quot;</span>, e));<br>    <span class="hljs-comment">// &lt;span style=&quot;color:red&quot;&gt;ç©¿è¶Š&lt;/span&gt;å°é“äºº</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¸»è¦é€šè¿‡ <code>QueryBuilders.disMaxQuery</code> ç»“åˆ <code>boost</code> å¯¹éæ ¸å¿ƒå­—æ®µé™ä½æƒé‡æ¥å®Œæˆ</p><h2 id="èµ„æºä¸‹è½½"><a href="#èµ„æºä¸‹è½½" class="headerlink" title="èµ„æºä¸‹è½½"></a>èµ„æºä¸‹è½½</h2><ul><li><a href="https://github.com/Mosiki/SpringDataElasticSearchQuickStartExample">https://github.com/Mosiki/SpringDataElasticSearchQuickStartExample</a></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://www.cnblogs.com/yjf512/p/4897294.html">https://www.cnblogs.com/yjf512/p/4897294.html</a></li><li><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/cn/_best_fields.html#dis-max-query">dis_max æŸ¥è¯¢</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ElasticSearchå®Œå…¨åŒ¹é…ç»“æœè°ƒä¼˜</tag>
      
      <tag>esæŸ¥è¯¢è°ƒä¼˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>githubä»£ç cloneåŠ é€Ÿ</title>
    <link href="/github%E4%BB%A3%E7%A0%81clone%E5%8A%A0%E9%80%9F.html"/>
    <url>/github%E4%BB%A3%E7%A0%81clone%E5%8A%A0%E9%80%9F.html</url>
    
    <content type="html"><![CDATA[<p>è¿™é˜µå­æƒ³çœ‹çœ‹å¼€æºé¡¹ç›® MyBatis çš„æºç ï¼Œç»“æœä½¿ç”¨ git çš„ clone å‘½ä»¤æ€ä¹ˆä¹Ÿ clone ä¸ä¸‹æ¥ï¼Œæˆ‘ä»¥ä¸ºæ˜¯ç½‘é€Ÿæ…¢ï¼Œä¸Š Google ä¸€æœï¼ŒåŸæ¥ Github çš„åŸŸåè¢« DNS æ±¡æŸ“äº†ï¼Œæˆ‘è¯´å‘¢æ€ä¹ˆè®¿é—® Github ä¸€ç›´éƒ½å¾ˆæ…¢ï¼ŒçŸ¥é“äº†é—®é¢˜åŸå› å°±è§£å†³æ‰è¿™ä¸ªæ¶å¿ƒçš„é—®é¢˜</p><a id="more"></a><h2 id="å†å†æ›´æ–°"><a href="#å†å†æ›´æ–°" class="headerlink" title="å†å†æ›´æ–°"></a>å†å†æ›´æ–°</h2><p>å®‰è£…æ²¹çŒ´ä»¥åŠåŠ é€Ÿè„šæœ¬</p><p>æ²¹çŒ´å®‰è£…: <a href="https://www.tampermonkey.net/">https://www.tampermonkey.net/</a></p><p>æ²¹çŒ´è„šæœ¬ï¼š<a href="https://greasyfork.org/scripts/398278-github-%E9%95%9C%E5%83%8F%E8%AE%BF%E9%97%AE-%E5%8A%A0%E9%80%9F%E4%B8%8B%E8%BD%BD">https://greasyfork.org/scripts/398278-github-%E9%95%9C%E5%83%8F%E8%AE%BF%E9%97%AE-%E5%8A%A0%E9%80%9F%E4%B8%8B%E8%BD%BD</a></p><p>ç›´æ¥è®¿é—®GitHubæŸ¥çœ‹æ•ˆæœã€‚å¦‚ä¸‹å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20200421154536.png"></p><p><del>ä¸ä¸Šä¸€æ¬¡åŒç†ï¼Œè¿™æ¬¡ä¹Ÿä½¿ç”¨çš„æ˜¯åå‘ä»£ç†è¾¾åˆ°åŠ é€Ÿçš„ç›®çš„ï¼Œåªä¸è¿‡è¿™æ¬¡ä½¿ç”¨çš„åŸŸåéç¬”è€…æä¾›çš„ã€‚ä½¿ç”¨æ–¹æ³•ï¼š<code>https://github.com.cnpmjs.org/ç”¨æˆ·å/ä»“åº“å</code><br>å¦‚ï¼š<code>https://github.com.cnpmjs.org/apache/skywalking</code>ï¼Œåˆ™cloneåœ°å€ä¸ºï¼š<code>http://github-mirror.bugkiller.org/apache/skywalking.git</code></del></p><h2 id="å†æ¬¡æ›´æ–°"><a href="#å†æ¬¡æ›´æ–°" class="headerlink" title="å†æ¬¡æ›´æ–°"></a>å†æ¬¡æ›´æ–°</h2><p>å‘ç°å¦å¤–ä¸€ç§æ–¹å¼å¯ä»¥å®ç°åŠ é€Ÿçš„æ–¹å¼ï¼Œå³é€šè¿‡ä¸€å°æœåŠ¡å™¨ï¼ˆå¯ä»¥æ˜¯éå›½å¤–æœåŠ¡å™¨ï¼‰é€šè¿‡nginxåå‘ä»£ç†GitHubï¼Œç„¶åç›´æ¥è®¿é—®ä»£ç†åçš„åœ°å€å³å¯ã€‚è¿™ç§æ–¹å¼é€‚åˆä¸‹è½½ä»£ç çš„zipåŒ…æˆ–è€…ä»“åº“é‡Œçš„releasesæ–‡ä»¶ï¼Œæ¯”å¦‚<code>https://xxxx.domain.com/Mosiki/github/archive/master.zip</code>ã€‚</p><p>å…·ä½“åå‘ä»£ç†çš„é…ç½®è¯»è€…å¯ä»¥è‡ªè¡ŒæŸ¥æ‰¾æ•™ç¨‹ã€‚</p><p>è¿™é‡Œç»™å‡ºå…è´¹çš„æœåŠ¡ï¼Œä½†æ˜¯æ¯æ—¥ä¼šæœ‰ä¸Šé™é™åˆ¶ï¼Œå¯èƒ½ä¼šå‡ºç°æ— æ³•ä½¿ç”¨çš„æƒ…å†µï¼Œè¯»è€…æœ€å¥½è‡ªå·±æ­å»ºä»£ç†æœåŠ¡ã€‚</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">https</span>://<span class="hljs-selector-tag">git</span><span class="hljs-selector-class">.vcmq</span><span class="hljs-selector-class">.workers</span><span class="hljs-selector-class">.dev</span>/<br></code></pre></div></td></tr></table></figure><p>å¯ä»¥å‚è€ƒ <a href="https://mashiro.best/archives/cloudflare-worker/">æ­¤æ–‡ç« </a> è‡ªè¡Œæ­å»ºä»£ç†æœåŠ¡</p><h2 id="æ›´æ–°ä¸€ä¸‹"><a href="#æ›´æ–°ä¸€ä¸‹" class="headerlink" title="æ›´æ–°ä¸€ä¸‹"></a>æ›´æ–°ä¸€ä¸‹</h2><p>2019å¹´09æœˆ03æ—¥æ›´æ–°ï¼š</p><p>æœ€è¿‘å‘ç°ç”¨ hosts æ–¹å¼ä¸å¤ªå¥½ä½¿äº†ï¼Œå¦‚æœæ”¹ hosts çš„æ–¹å¼ä¹Ÿä¸èµ·ä½œç”¨çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªç»æ‹›äº†ã€‚</p><p>æ­¥éª¤ä¸€ï¼šfork ä½ æƒ³è¦ clone çš„åº“</p><p>æ­¥éª¤äºŒï¼šç™»å½•<a href="https://gitee.com/">ç äº‘</a>ï¼Œç™»å½•æˆåŠŸåï¼Œç‚¹å‡»ç½‘é¡µå³ä¸Šè§’åŠ å·ï¼Œé€‰æ‹© <strong>ä» GitHub å¯¼å…¥ä»“åº“</strong></p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190903223934.png"></p><p>è¿™ä¸ªè¿‡ç¨‹ç äº‘ä¼šè®©ä½ å» GitHub æˆæƒæ‹‰å–ä½ çš„ä»“åº“ï¼Œé€‰æ‹©åŒæ„å°±è¡Œäº†ã€‚</p><p>æ­¥éª¤ä¸‰ï¼šæ‰¾åˆ°ä½ åœ¨ GitHub ä¸­ fork çš„ä»“åº“é€‰æ‹©å¯¼å…¥ï¼Œç­‰å¾…ä¸€ä¼šå„¿å°±è¡Œäº†ï¼Œå¦‚æœä»“åº“è¾ƒå¤§ï¼Œå¯èƒ½å¯¼å…¥ä¼šèŠ±ä¸€äº›æ—¶é—´ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190903224222.png"></p><p>æ­¥éª¤å››ï¼šä½¿ç”¨ç äº‘çš„åœ°å€è¿›è¡Œ clone å³å¯ï¼Œå›½å†…çš„é€Ÿåº¦è¿˜æ˜¯éå¸¸å¿«çš„ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190903224448.png"></p><p>å¤‡æ³¨ï¼šæ­¤æ–¹æ³•åªé€‚ç”¨äºä¸´æ—¶ä¸‹è½½ä»“åº“ï¼Œå¦‚æœè¦æ˜¯æ PR ä»€ä¹ˆçš„ï¼Œè¿˜æ˜¯ä½¿ç”¨æ”¹ hosts æ–¹æ³•æˆ–è€…èµ°ä»£ç†çš„æ–¹å¼å§ã€‚</p><hr><p>2019å¹´06æœˆ16æ—¥æ›´æ–°ä¸€ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190616163736.png"></p><p>çœ‹è¯„è®ºæœ‰äººè¯´ä¸å¥½ä½¿ï¼Œæˆ‘åœ¨ mac ä¸Šæœ¬åœ°æµ‹è¯•äº†ä¸€ä¸‹ï¼ˆæœªå¼€å¯å…¨å±€ä»£ç†ï¼‰ï¼Œçº¢æ¡†ä¹‹ä¸Šæ˜¯æœªæŒ‡å®š hosts çš„ç»“æœï¼Œé€Ÿåº¦å¾ˆæ…¢ï¼Œå¹³å‡ä¸åˆ° <strong>50k/s</strong> çš„é€Ÿåº¦ï¼Œçº¢æ¡†å†…æ˜¯åˆ‡æ¢åˆ°æœ€æ–° host ä¹‹åçš„ç»“æœï¼Œé€Ÿåº¦ä¸€ç›´åœ¨å¢åŠ ï¼Œè¾¾åˆ° <strong>3.25MB/s</strong>ï¼Œæ•ˆæœæ˜¾è€Œæ˜“è§ã€‚</p><p>Tips: å¦‚æœåˆ‡æ¢åˆ°æœ€æ–° hosts åè¿˜æ˜¯å¾ˆæ…¢ï¼Œå¯ä»¥é‡æ–°å¼€ä¸€ä¸ªç»ˆç«¯å°è¯•ï¼Œæˆ–è€…æ–­å¼€å†é‡è¿ä¸€ä¸‹ç½‘ç»œï¼Œå¯èƒ½æ˜¯ hosts è¿˜æœªç”Ÿæ•ˆã€‚ï¼ˆswitch hosts åœ¨ win ä¸‹éœ€è¦ä½¿ç”¨ç®¡ç†å‘˜èº«ä»½æ‰“å¼€ï¼Œmac ä¸‹éœ€è¦è¾“å…¥å¼€æœºå¯†ç è·å¾—æƒé™ï¼‰</p><h2 id="åŠ é€Ÿè®¿é—®"><a href="#åŠ é€Ÿè®¿é—®" class="headerlink" title="åŠ é€Ÿè®¿é—®"></a>åŠ é€Ÿè®¿é—®</h2><p>åœ¨ç½‘ä¸Šæœç´¢ä¸€åœˆï¼Œå¥½å¤šæ–‡ç« ä¸­æé€Ÿçš„æ–¹æ³•å°±æ˜¯ä¿®æ”¹ git çš„ä»£ç†é…ç½®ï¼Œå‰ææ˜¯æœ‰ SS ä¹‹ç±»çš„{ä»£}{ç†}å·¥å…·ï¼Œç„¶è€Œæˆ‘å¼€äº†å…¨å±€{ä»£}{ç†}ï¼Œè®¾ç½®äº† git çš„ä»£ç†é…ç½®ï¼Œclone çš„é€Ÿåº¦è¿˜æ˜¯å¾ˆæ…¢ï¼Œåªèƒ½åˆ° 30kb/sï¼Œå¦‚æœåº“å¤§ç‚¹ï¼Œä¸‹ä¸ªå‡ å¤©å‡ å¤œéƒ½å¯èƒ½ğŸ˜…</p><p>è®¾ç½®ä»£ç†ä¸å¥½ä½¿ï¼Œå°±ç»§ç»­æœç´¢è§£å†³æ–¹æ³•ï¼Œåœ¨ github ä¸Šæ‰¾åˆ°ä¸€ä¸ª issuesï¼Œå…¶ä¸­æä¾›äº† github çš„ hoståˆ—è¡¨ã€‚</p><p><del><a href="#">GitHubä¸­å›½åŠ é€Ÿè®¿é—®</a></del></p><p>éšç€ issue æ‰¾åˆ°äº†ä¸€ä¸ªç”Ÿæˆ hosts çš„ repoï¼Œä½†æ˜¯è¿™ä¸ª repo çš„ hosts å¹¶ä¸æ˜¯æ¯æ—¥æ›´æ–°çš„ï¼Œäºæ˜¯è‡ªå·± fork äº†ä¸€ä»½ï¼Œå†™äº†ä¸ªç®€å• crontabï¼Œæ¯æ—¥æ‰§è¡Œç”Ÿæˆæ›´æ–° hosts æ–‡ä»¶ã€‚</p><p>ä»“åº“åœ°å€ï¼š**<a href="https://github.com/Mosiki/github">https://github.com/Mosiki/github</a>**</p><h2 id="é£Ÿç”¨æ–¹æ³•"><a href="#é£Ÿç”¨æ–¹æ³•" class="headerlink" title="é£Ÿç”¨æ–¹æ³•"></a>é£Ÿç”¨æ–¹æ³•</h2><p>æœ€éº»çƒ¦çš„æ–¹å¼å°±æ˜¯å»æ‰‹åŠ¨ä¿®æ”¹ host æ–‡ä»¶ï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ä¸‹è½½ <a href="https://oldj.github.io/SwitchHosts/">Switch Host</a> è½¯ä»¶è¿›è¡Œ host ä¿®æ”¹ï¼Œè·¨å¹³å°ï¼Œå› ä¸º hosts æ–‡ä»¶æ¯æ—¥éƒ½ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œæ‰€ä»¥éœ€è¦æœ¬åœ°çš„ hosts ä¹Ÿèƒ½è‡ªåŠ¨æ›´æ–°ï¼Œ å¥½åœ¨ SwitchHosts æä¾›äº†è¿œç¨‹ hosts çš„åŠŸèƒ½ã€‚</p><ol><li><p>å¤åˆ¶å¦‚ä¸‹ hosts åœ°å€ï¼ˆæµ‹è¯•å‘ç°GitHubçš„ç½‘å€æœ‰å¯èƒ½è®¿é—®ä¸äº†ï¼Œå› è€Œæ›´æ¢æˆäº†ç äº‘çš„é•œåƒä»“åº“åœ°å€ï¼‰</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">https:<span class="hljs-regexp">//gi</span>tee.com<span class="hljs-regexp">/Mosiki/gi</span>thub<span class="hljs-regexp">/raw/m</span>aster/github_hosts.txt<br></code></pre></div></td></tr></table></figure></li><li><p>æ–°å¢è¿œç¨‹ hosts<br>ç¬”è€…åœ¨ mac ä¸‹æ“ä½œï¼Œwin æ˜¯åŒç†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190404212331.png"></p></li><li><p>è®¾ç½®è‡ªåŠ¨æ›´æ–°<br>é€‰æ‹© 24 å°æ—¶å³å¯ï¼Œç¬¬ä¸€æ¬¡æ·»åŠ çš„æ—¶å€™éœ€è¦æ‰‹åŠ¨ç‚¹å‡»åˆ·æ–°æŒ‰é’®ï¼Œåˆ·æ–°è·å–ä¸€ä¸‹è¿œç¨‹çš„ hosts<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20190404212810.png"><br>æ›´æ–°å®Œæˆä¹‹åç‚¹å‡»ç¡®å®šä¿å­˜å³å¯ã€‚</p></li><li><p>æ‰“å¼€ hosts å¼€å…³<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181124164505.png"><br>å¦‚å›¾è®¾ç½®å®Œï¼ŒæŠŠå¼€å…³æ‰“å¼€å°± Ok äº†ã€‚</p></li></ol><h2 id="æµ‹è¯•Cloneé€Ÿåº¦"><a href="#æµ‹è¯•Cloneé€Ÿåº¦" class="headerlink" title="æµ‹è¯•Cloneé€Ÿåº¦"></a>æµ‹è¯•Cloneé€Ÿåº¦</h2><p>ç”± 30kb/s å˜æˆ 4M/s äº† ğŸ˜‚</p><p>ä¿®æ”¹åï¼Œåœ¨ GitHub çš„ release ä¸­ä¸‹è½½ä¸œè¥¿ä¹Ÿå˜å¿«äº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>github cloneæ…¢è§£å†³</tag>
      
      <tag>github ä¸‹è½½æ…¢è§£å†³</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>IDEAä¹‹Gitåˆ†æ”¯ä»¥åŠStashä½¿ç”¨</title>
    <link href="/IDEA%E4%B9%8BGit%E5%88%86%E6%94%AF%E5%90%88%E5%B9%B6%E4%BB%A5%E5%8F%8AStash%E4%BD%BF%E7%94%A8.html"/>
    <url>/IDEA%E4%B9%8BGit%E5%88%86%E6%94%AF%E5%90%88%E5%B9%B6%E4%BB%A5%E5%8F%8AStash%E4%BD%BF%E7%94%A8.html</url>
    
    <content type="html"><![CDATA[<p>éšç€å…¬å¸å¼€å‘äººå‘˜çš„å¢åŠ ï¼Œä»¥åŠå¤šéœ€æ±‚çš„å¹¶è¡Œå¼€å‘ï¼ŒåŠŸèƒ½ä¸Šçº¿å°±ä¼šç¢æ‰‹ç¢è„šï¼›å®³æ€•è‡ªå·±æ²¡å†™å®Œçš„ä»£ç è¢«åˆ«äººéƒ¨ç½²åˆ°çº¿ä¸Šï¼Œå®³æ€•åˆ«äººä»£ç æ²¡å†™å®Œè¢«è‡ªå·±éƒ¨ç½²åˆ°çº¿ä¸Šï¼›æ€»ä¹‹åŠŸèƒ½ä¸Šçº¿ä¹‹å‰è¿˜è¦å’Œæ‰€æœ‰å¼€å‘æ²Ÿé€šï¼Œèƒ½ä¸èƒ½éƒ¨ç½²ä»£ç ï¼Ÿå¦‚æœåªæ˜¯å‡ ä¸ªäººçš„å›¢é˜Ÿå€’ä¹Ÿæ— å¦¨ï¼Œä½†æ˜¯å¼€å‘äººå‘˜å¤šäº†ï¼Œæ²Ÿé€šæˆæœ¬å°±å¾ˆé«˜äº†ã€‚äºæ˜¯ Git çš„åˆ†æ”¯å°±å‘æŒ¥å®ƒçš„ä½œç”¨äº†ï¼Œæœ¬æ–‡è®²è§£å·¥ä½œä¸­ä½¿ç”¨ IDEA è¿›è¡Œåˆ†æ”¯çš„ç®¡ç†ä»¥åŠåˆå¹¶ï¼Œä»¥åŠå…¶ä»– Git ä½¿ç”¨æŠ€å·§ã€‚</p><a id="more"></a><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><p>ä¸ºäº†æ¼”ç¤ºï¼Œå…ˆç”¨ IDEA åˆ›å»ºä¸€ä¸ªç®€å•å·¥ç¨‹ï¼Œæäº¤åˆ° git è¿œç¨‹ä»“åº“å½“ä¸­ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102171518.png"></p><h2 id="dev-100-åˆ†æ”¯åˆ›å»º"><a href="#dev-100-åˆ†æ”¯åˆ›å»º" class="headerlink" title="dev-100 åˆ†æ”¯åˆ›å»º"></a>dev-100 åˆ†æ”¯åˆ›å»º</h2><p>ç°åœ¨æ¥åˆ°äº†ä¸€ä¸ªç¼–å·ä¸º 100 çš„éœ€æ±‚ï¼Œæˆ‘ä»¬åœ¨ master åŸºç¡€ä¸Šï¼Œåˆ›å»º dev-100 åˆ†æ”¯<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102171616.png">  </p><p>åˆ›å»ºæ–°åˆ†æ”¯ dev-100çš„åŒæ—¶ï¼Œå¹¶åˆ‡æ¢åˆ° dev-100 åˆ†æ”¯ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102171703.png">  </p><h2 id="dev-100-åˆ†æ”¯ä»£ç å¼€å‘"><a href="#dev-100-åˆ†æ”¯ä»£ç å¼€å‘" class="headerlink" title="dev-100 åˆ†æ”¯ä»£ç å¼€å‘"></a>dev-100 åˆ†æ”¯ä»£ç å¼€å‘</h2><p>åœ¨ dev-100 åˆ†æ”¯ç¼–å†™éœ€æ±‚ç¼–å·ä¸º 100 çš„ åŠŸèƒ½ï¼Œä»£ç å®Œæˆåè¿›è¡Œ <code>commit</code> ä»¥åŠ <code>push</code>ï¼ˆ<strong>å¦‚æœè¿™ä¸ªåˆ†æ”¯åªæœ‰ä½ ä¸€ä¸ªäººåœ¨å¼€å‘çš„è¯ï¼Œå°±ä¸ç”¨ <code>push</code> åˆ°è¿œç¨‹åˆ†æ”¯äº†ï¼Œåªéœ€è¦ <code>commit</code> å³å¯</strong>ï¼‰<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102171807.png"></p><h2 id="åˆ†æ”¯åˆå¹¶"><a href="#åˆ†æ”¯åˆå¹¶" class="headerlink" title="åˆ†æ”¯åˆå¹¶"></a>åˆ†æ”¯åˆå¹¶</h2><p>ç°åœ¨æˆ‘ä»¬è¦æŠŠ dev-100 åˆ†æ”¯ä¸Šçš„ä»£ç åˆå¹¶åˆ° master ä¸»åˆ†æ”¯ä¸Š<br>å…ˆåˆ‡æ¢åˆ° master åˆ†æ”¯<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102172230.png"></p><p>åˆå¹¶ dev-100 åˆ†æ”¯åˆ° master åˆ†æ”¯ä¹‹å‰ï¼Œå»ºè®®å…ˆå¯¹ master ä»£ç è¿›è¡Œ pull æ›´æ–°æ“ä½œï¼Œç„¶åå†æ‰§è¡Œ Merge  into Current<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102172650.png"></p><p>å¦‚æœæ²¡æœ‰å†²çªï¼Œdev-100 ä¸­çš„ä»£ç å°±ä¼šè¢«åˆå¹¶åˆ° master åˆ†æ”¯ä¸Šäº†ï¼Œåˆå¹¶æˆåŠŸåï¼Œéœ€è¦ <code>push</code> æ‰èƒ½æ¨é€åˆ°è¿œç¨‹ä»“åº“<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102171807.png"></p><h2 id="å–æ¶ˆåˆ†æ”¯åˆå¹¶"><a href="#å–æ¶ˆåˆ†æ”¯åˆå¹¶" class="headerlink" title="å–æ¶ˆåˆ†æ”¯åˆå¹¶"></a>å–æ¶ˆåˆ†æ”¯åˆå¹¶</h2><p>åˆå¹¶å®Œæˆåï¼Œä½†æ˜¯ç”±äºä¸€äº›é—®é¢˜ï¼Œæˆ‘ä»¬æƒ³è¦å–æ¶ˆæœ¬æ¬¡åˆå¹¶ï¼Œå³é”® gitï¼Œé€‰æ‹© Reset HEAD<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102173946.png"><br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102174125.png"></p><p>HEAD^ æ˜¯è¿˜åŸåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼ŒHEAD^^ æ˜¯è¿˜åŸåˆ°ä¸Šä¸Šä¸€ä¸ªç‰ˆæœ¬ã€‚<br>Reset Type æœ‰ä¸‰ç§ï¼š</p><ul><li>mixed   é»˜è®¤æ–¹å¼ï¼Œåªä¿ç•™æºç ï¼Œå›é€€commitå’Œindexä¿¡æ¯</li><li>soft      å›é€€åˆ°æŸä¸ªç‰ˆæœ¬ï¼Œåªå›é€€äº†commitçš„ä¿¡æ¯ï¼Œä¸ä¼šæ¢å¤åˆ°index fileä¸€çº§ã€‚å¦‚æœè¿˜è¦æäº¤ï¼Œç›´æ¥commit</li><li>hard    å½»åº•å›é€€ï¼Œæœ¬åœ°æºç ä¹Ÿä¼šå˜æˆä¸Šä¸€ä¸ªç‰ˆæœ¬å†…å®¹</li></ul><p>ä¸€èˆ¬ä½¿ç”¨é»˜è®¤çš„ mixed æˆ–è€…ç²—æš´çš„ hard æ–¹å¼ã€‚<br>æˆ‘ä»¬è¿™é‡Œæ˜¯å–æ¶ˆåˆå¹¶ï¼Œæ‰€ä»¥é€‰æ‹© <strong><code>Hard</code></strong> æ–¹å¼ï¼Œå¹¶ä¸”æ˜¯**<code>HEAD^</code>**è¿˜åŸåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ï¼Œå›é€€åæ¢å¤äº†åŸæ¥ master çš„ä»£ç ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102171518.png"></p><h2 id="è§£å†³åˆå¹¶å†²çªé—®é¢˜"><a href="#è§£å†³åˆå¹¶å†²çªé—®é¢˜" class="headerlink" title="è§£å†³åˆå¹¶å†²çªé—®é¢˜"></a>è§£å†³åˆå¹¶å†²çªé—®é¢˜</h2><p>æ¥ä¸‹æ¥æ¼”ç¤ºåˆå¹¶å†²çªï¼Œæ­¤æ—¶æ˜¯åœ¨ master åˆ†æ”¯ï¼Œæˆ‘ä»¬ä¿®æ”¹æ–‡ä»¶ï¼Œå¹¶ commit ä»¥åŠ push åˆ°è¿œç¨‹ä»“åº“ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102174704.png"></p><p>æ­¤æ—¶å†æŠŠ dev-100 åˆ†æ”¯åˆå¹¶åˆ° master åˆ†æ”¯å°±ä¼šæç¤ºå†²çªã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102175031.png"></p><p>åŒå‡»å†²çªæ–‡ä»¶ï¼Œå¤„ç†å†²çªã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102175217.png"><br>å¤„ç†å®Œæˆåï¼Œç‚¹å‡» apply å³å¯ï¼Œå¦‚æœæœ‰å¤šä¸ªå†²çªæ–‡ä»¶ï¼Œéƒ½æŒ‰ç…§è¿™ç§æ–¹å¼å¤„ç†ï¼Œè¿™æ˜¯æˆ‘ä»¬å¤„ç†å®Œå†²çªä¹‹åçš„ä»£ç ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/2018110315412022049329.png"></p><p>dev-100 åˆ†æ”¯å·²ç»è¢«æˆåŠŸåˆå¹¶åˆ° master äº†ï¼Œå°±å¯ä»¥åˆ é™¤äº†ã€‚å¯ä»¥ç›´æ¥åˆ é™¤è¿œç¨‹ dev-100 åˆ†æ”¯ï¼Œåˆ é™¤æ—¶ IDEA ä¼šæç¤ºæ˜¯å¦åŒæ—¶åˆ é™¤æœ¬åœ°çš„ dev-100 åˆ†æ”¯ï¼Œå‹¾é€‰å³å¯ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æŠŠåˆ†æ”¯åˆå¹¶çš„ç»“æœ push åˆ°è¿œç¨‹ä»“åº“ã€‚</p><h2 id="ä»£ç æš‚å­˜ä¹‹git-stash"><a href="#ä»£ç æš‚å­˜ä¹‹git-stash" class="headerlink" title="ä»£ç æš‚å­˜ä¹‹git stash"></a>ä»£ç æš‚å­˜ä¹‹git stash</h2><p>ç¼–å· 100 çš„éœ€æ±‚å®Œæˆä¹‹åï¼Œç°åœ¨æˆ‘ä»¬åˆæ¥åˆ°ä¸€ä¸ªæ–°çš„éœ€æ±‚ï¼Œæ­£åœ¨ dev-101 åˆ†æ”¯è¿›è¡Œå¼€å‘ï¼Œå¼€å‘è¿˜æœªå®Œæˆã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102180114.png"></p><p>çªç„¶çº¿ä¸Šå‡ºç° bugï¼Œéœ€è¦æˆ‘ä»¬ç´§æ€¥è¿›è¡Œä¿®æ”¹ï¼Œäºæ˜¯æˆ‘ä»¬è¦åŸºäºæœ€æ–°çš„ master åˆ†æ”¯æ–°å»ºä¸€ä¸ª bug åˆ†æ”¯ bug-12ï¼Œéœ€è¦å…ˆåˆ‡æ¢åˆ° master åˆ†æ”¯ï¼Œä½†æ˜¯å½“å‰åˆ†æ”¯çš„ä»£ç æ²¡æœ‰commitï¼Œ å¦‚æœç›´æ¥åˆ‡æ¢åˆ° master åˆ†æ”¯çš„è¯ï¼Œdev-101 åˆ†æ”¯ä¸Šçš„æ–°å¢ä»£ç å°±ä¼šè·‘åˆ° master åˆ†æ”¯ï¼Œè€Œä»£ç åˆä¸èƒ½æ­¤æ—¶ commit ï¼Œäºæ˜¯å°±è½®åˆ° stash å‡ºåœºäº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102180427.png"><br>Stash ä¼šä¿å­˜å½“å‰å·¥ä½œè¿›åº¦ï¼Œä¼šæŠŠæš‚å­˜åŒºå’Œå·¥ä½œåŒºçš„æ”¹åŠ¨ä¿å­˜èµ·æ¥ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20181103154120204424605.png"><br>æ·»åŠ å¤‡æ³¨ï¼Œé€‰æ‹© <strong>CREATE STASH</strong>ã€‚ä½ ä¼šå‘ç°å½“å‰å·¥ä½œåŒºå†…çš„ä»£ç è¢«æ¢å¤æˆäº†åŸæ ·ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/2018110315412022049329.png"></p><h2 id="ä»£ç æš‚å­˜è¿˜åŸ"><a href="#ä»£ç æš‚å­˜è¿˜åŸ" class="headerlink" title="ä»£ç æš‚å­˜è¿˜åŸ"></a>ä»£ç æš‚å­˜è¿˜åŸ</h2><p>æ­¤åˆ»åˆ‡æ¢åˆ° master åˆ†æ”¯ï¼Œå¹¶åˆ›å»º bug-12 åˆ†æ”¯è¿›è¡Œä¿®å¤ bugï¼Œä¿®å¤å®Œæˆååˆå¹¶åˆ° master åˆ†æ”¯å¹¶ push åˆ°è¿œç¨‹ä»“åº“ï¼Œä¸Šæ–‡å·²ç»æ¼”ç¤ºå¦‚ä½•åˆå¹¶ï¼Œåœ¨æ­¤ä¸å†èµ˜è¿°ã€‚</p><p>å°† bug-12 ä¸ master åˆå¹¶å®Œæˆä¹‹åï¼Œç°åœ¨è¦æ¥ç€å†™ dev-101 éœ€æ±‚ä»£ç ï¼Œé¦–å…ˆå…ˆåˆ‡æ¢åˆ° dev-101 åˆ†æ”¯ï¼›<br>ä½†æ˜¯ä¹‹å‰çš„ä»£ç å·²ç»è¢«æˆ‘ä»¬æ”¾åˆ°äº† git çš„ stash å½“ä¸­ï¼Œæˆ‘ä»¬ç°åœ¨è¦æŠŠä»£ç è¿˜åŸåˆ°å·¥ä½œåŒºå½“ä¸­ã€‚<br>é€‰æ‹© Unstash Changes<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20181103154120268155941.png"><br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20181103154120276883579.png"><br>é€‰æ‹©ä¹‹å‰ä¿å­˜çš„ï¼ŒåŒæ—¶å‹¾é€‰  Pop stashï¼ˆè¿˜åŸå®Œæˆåï¼Œä¼šè‡ªåŠ¨åˆ é™¤è¿™ä¸ª stashï¼‰ï¼Œç¡®å®šåï¼Œå·¥ä½œåŒºä¹‹å‰å†™çš„ä»£ç å°±åˆå›æ¥äº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20181102180114.png"></p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>Stash åˆ©ç”¨å¥½äº†ï¼Œå°±å¯ä»¥è‡ªå¦‚åˆ‡æ¢åˆ†æ”¯ï¼Œé¢å¯¹çªå¦‚å…¶æ¥çš„éœ€æ±‚ä¹Ÿä¸å¿…çƒ¦æ¼äº†~</p>]]></content>
    
    
    <categories>
      
      <category>å·¥å…·ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>IDEA Gitåˆ†æ”¯åˆå¹¶</tag>
      
      <tag>IDEA ä½¿ç”¨Stash</tag>
      
      <tag>IDEA å¤„ç†åˆ†æ”¯åˆå¹¶å†²çª</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MongoDB æç®€å®è·µå…¥é—¨</title>
    <link href="/MongoDB%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.html"/>
    <url>/MongoDB%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.html</url>
    
    <content type="html"><![CDATA[<p>ä»¥å‰å­¦ä¹  MongoDB æ—¶å€™å‚è€ƒçš„ä¸€ç¯‡æ–‡ç« ï¼Œå†™çš„è›®å¥½çš„ï¼Œå¾ˆé€‚åˆ MongoDB çš„å…¥é—¨å­¦ä¹ ï¼Œé‚è½¬è½½è¿‡æ¥ã€‚</p><a id="more"></a><h1 id="MongoDB-æç®€å®è·µå…¥é—¨"><a href="#MongoDB-æç®€å®è·µå…¥é—¨" class="headerlink" title="MongoDB æç®€å®è·µå…¥é—¨"></a>MongoDB æç®€å®è·µå…¥é—¨</h1><h4 id="1-ä¸ºä»€ä¹ˆç”¨MongoDBï¼Ÿ"><a href="#1-ä¸ºä»€ä¹ˆç”¨MongoDBï¼Ÿ" class="headerlink" title="1. ä¸ºä»€ä¹ˆç”¨MongoDBï¼Ÿ"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#1-%E4%B8%BA%E4%BB%80%E4%B9%88%E7%94%A8mongodb"></a>1. ä¸ºä»€ä¹ˆç”¨MongoDBï¼Ÿ</h4><p>ä¼ ç»Ÿçš„è®¡ç®—æœºåº”ç”¨å¤§å¤šä½¿ç”¨å…³ç³»å‹æ•°æ®åº“æ¥å­˜å‚¨æ•°æ®ï¼Œæ¯”å¦‚å¤§å®¶å¯èƒ½ç†Ÿæ‚‰çš„MySql, Sqliteç­‰ç­‰ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æ•°æ®ä»¥è¡¨æ ¼(table)çš„å½¢å¼å‚¨å­˜èµ·æ¥çš„ã€‚æ•°æ®åº“ç”±ä¸€å¼ å¼ æ’åˆ—æ•´é½çš„è¡¨æ ¼æ„æˆï¼Œå°±å¥½åƒä¸€ä¸ªExcelè¡¨å•ä¸€æ ·ï¼Œæ¯ä¸ªè¡¨æ ¼ä¼šæœ‰è‹¥å¹²åˆ—ï¼Œæ¯”å¦‚ä¸€ä¸ªå­¦ç”Ÿä¿¡æ¯è¡¨ï¼Œå¯èƒ½åŒ…å«å­¦å·ã€å§“åã€æ€§åˆ«ã€å…¥å­¦å¹´ä»½ã€é«˜è€ƒæˆç»©ã€ç±è´¯ç­‰ç­‰ã€‚è€Œè¡¨æ ¼çš„æ¯ä¸€æ’ï¼Œåˆ™æ˜¯ä¸€ä¸ªä¸ªå­¦ç”Ÿçš„å…·ä½“ä¿¡æ¯ã€‚åœ¨ä¼ä¸šçº§åº”ç”¨å’Œå‰äº’è”ç½‘æ—¶ä»£ï¼Œå…³ç³»å‹æ•°æ®åº“å‡ ä¹æ˜¯ä¸äºŒé€‰æ‹©ã€‚å…³ç³»å‹æ•°æ®åº“çš„ç‰¹ç‚¹æ˜¯æœ‰æ•´é½åˆ’ä¸€çš„ç»„ç»‡ï¼Œå¾ˆæ–¹ä¾¿å¯¹æ•°æ®è¿›è¡Œæè¿°ã€æ’å…¥ã€æœç´¢ã€‚</p><p>æƒ³è±¡æœ‰ä¸€ä¸ªä¼ ç»Ÿçš„ç½‘ä¸Šæœè£…å•†åº—å§ï¼Œå®ƒçš„ä¸»è¦çš„æ•°æ®å¯èƒ½æ˜¯å‚¨å­˜åœ¨ä¸€å¼ å«productsçš„è¡¨å•é‡Œï¼Œè¡¨å•å¯èƒ½åŒ…å«è¿™äº›åˆ—ï¼šå•†å“ç¼–å·(ID)ã€åç§°(Name)ã€å•†å®¶(brand)ã€ä¸»ç›®å½•(cate)ã€å­ç›®å½•(sub-cat)ã€é›¶å”®ä»·(price)ã€æ˜¯å¦ä¿ƒé”€(promotion)ç­‰ç­‰ã€‚å¦‚æœæœ‰ä¸€ä¸ªç”¨æˆ·æƒ³è¦æŸ¥æ‰¾æ‰€æœ‰ä»·æ ¼ä½äº300å…ƒçš„æ­£åœ¨ä¿ƒé”€çš„é‹å­çš„ç¼–å·å’Œåç§°ï¼Œåˆ™å¯ä»¥æ‰§è¡Œç±»ä¼¼äºä»¥ä¸‹çš„SQLè¯­å¥ï¼š</p><figure class="highlight n1ql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs n1ql"><span class="hljs-keyword">SELECT</span> ID, name <span class="hljs-keyword">FROM</span> products <span class="hljs-keyword">WHERE</span> cate=<span class="hljs-string">&#x27;shoes&#x27;</span> <span class="hljs-keyword">AND</span> price&lt;<span class="hljs-number">300</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">AND</span> promotion=<span class="hljs-literal">true</span>;<br><br></code></pre></div></td></tr></table></figure><p>SQLå…·å¤‡äº†å¼ºå¤§äº†çš„æ·±åº¦æŸ¥è¯¢èƒ½åŠ›ï¼Œèƒ½æ»¡è¶³å„å¼å„æ ·çš„æŸ¥è¯¢è¦æ±‚ã€‚è€Œå¦‚æœè¦å¯¹æ•°æ®è¿›è¡Œæ·»åŠ å’Œåˆ é™¤ï¼Œæˆæœ¬ä¹Ÿæ˜¯éå¸¸ä½çš„ã€‚è¿™äº›æ˜¯SQLçš„ä¼˜åŠ¿ä¹‹ä¸€ï¼Œ ä½†éšç€äº’è”ç½‘çš„å…´èµ·ä»¥åŠæ•°æ®å½¢å¼çš„å¤šæ ·åŒ–ï¼Œå››å¹³å…«ç¨³çš„SQLè¡¨å•åœ¨ä¸€äº›é¢†åŸŸæ¸æ¸æ˜¾ç°å‡ºå®ƒçš„åŠ£åŠ¿ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ã€‚è€ƒè™‘ä¸€ä¸ªåšå®¢åå°ç³»ç»Ÿï¼Œå¦‚æœæˆ‘ä»¬ç”¨å…³ç³»å‹æ•°æ®åº“ä¸ºæ¯ç¯‡åšå®¢(article)å»ºä¸€ä¸ªè¡¨å•çš„è¯ï¼Œè¿™ä¸ªè¡¨å•å¤§æ¦‚ä¼šåŒ…æ‹¬ä»¥ä¸‹è¿™äº›åˆ—ï¼š</p><table><thead><tr><th>ID</th><th align="center">Title</th><th align="center">Description</th><th align="center">Author</th><th align="center">Content</th><th align="center">Likes</th></tr></thead><tbody><tr><td>A_1</td><td align="center">Title1</td><td align="center">Political Article</td><td align="center">Joe</td><td align="center">Content 1</td><td align="center">12</td></tr><tr><td>A_2</td><td align="center">Title2</td><td align="center">Humorous Story</td><td align="center">Sam</td><td align="center">Content 2</td><td align="center">50</td></tr></tbody></table><p>è¿™æ—¶å€™ç”¨SQLæ•°æ®åº“æ¥å­˜å‚¨æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œä½†å‡å¦‚æˆ‘ä»¬è¦ä½æ¯ç¯‡æ–‡ç« æ·»åŠ è¯„è®ºåŠŸèƒ½ï¼Œä¼šå‘ç°æ¯ç¯‡æ–‡ç« å¯èƒ½è¦å¤šç¯‡è¯„è®ºï¼Œè€Œä¸”è¿™ä¸ªæ•°ç›®æ˜¯åŠ¨æ€å˜åŒ–çš„ï¼Œè€Œä¸”æ¯ç¯‡è¯„è®ºè¿˜åŒ…æ‹¬å¥½å‡ é¡¹å†…å®¹ï¼šè¯„è®ºçš„äººã€è¯„è®ºçš„æ—¶é—´ã€ä»¥åŠè¯„è®ºå†…å®¹ã€‚è¿™æ—¶å€™è¦å°†è¿™äº›å†…å®¹éƒ½å¡è¿›ä¸Šè¿°çš„é‚£ä¸ªè¡¨ï¼Œå°±æ˜¾å¾—å¾ˆå›°éš¾ã€‚é€šå¸¸çš„åšæ³•æ˜¯ä¸ºè¯„è®º(comment)å•ç‹¬å»ºä¸€ä¸ªè¡¨ï¼š</p><table><thead><tr><th>ID</th><th align="center">Author</th><th align="center">Time</th><th align="center">Content</th><th align="center">Article</th></tr></thead><tbody><tr><td>C_1</td><td align="center">Anna</td><td align="center">2014-12-26 08:23</td><td align="center">Really good articles!</td><td align="center">A_1</td></tr><tr><td>C_2</td><td align="center">David</td><td align="center">2014-12-25 09:30</td><td align="center">I like it!</td><td align="center">A_1</td></tr></tbody></table><p>ç±»ä¼¼åœ°ï¼Œæ¯ç¯‡æ–‡ç« å¯èƒ½ä¼šæœ‰è‹¥å¹²æ ‡ç­¾(tags)ã€‚æ ‡ç­¾æœ¬èº«åˆæ˜¯ä¸€ä¸ªè¡¨å•ï¼š</p><table><thead><tr><th>ID</th><th align="center">Category</th><th align="center">Tags</th><th align="center">Content</th><th align="center">Article</th></tr></thead><tbody><tr><td>T_1</td><td align="center">Anna</td><td align="center">2014-12-26 08:23</td><td align="center">Really good articles!</td><td align="center">A_1</td></tr><tr><td>T_2</td><td align="center">David</td><td align="center">2014-12-25 09:30</td><td align="center">I like it!</td><td align="center">A_2</td></tr></tbody></table><p>è€Œåšå®¢çš„è¡¨æ ¼åˆ™è¦é€šè¿‡foreign keyè·Ÿè¿™äº›ç›¸å…³è”çš„è¡¨æ ¼è”ç³»èµ·æ¥(å¯èƒ½è¿˜åŒ…æ‹¬ä½œè€…ã€å‡ºç‰ˆç¤¾ç­‰å…¶å®ƒè¡¨æ ¼)ã€‚è¿™æ ·ä¸€æ¥ï¼Œå½“æˆ‘ä»¬åšæŸ¥è¯¢çš„æ—¶å€™ï¼Œæ¯”å¦‚è¯´ï¼Œâ€œæ‰¾å‡ºè¯„è®ºæ•°ä¸å°‘äº3çš„æ ‡ç­¾ä¸ºâ€˜æ”¿æ²»è¯„è®ºâ€™çš„ä½œè€…ä¸ºSamçš„æ–‡ç« â€ï¼Œå°±ä¼šæ¶‰åŠåˆ°å¤æ‚çš„è·¨è¡¨æŸ¥è¯¢ï¼Œéœ€è¦å¤§é‡ä½¿ç”¨<code>join</code>è¯­å¥ã€‚è¿™ç§è·¨è¡¨æŸ¥è¯¢ä¸ä»…é™ä½äº†æŸ¥è¯¢é€Ÿåº¦ï¼Œè€Œä¸”è¿™äº›è¯­å¥å†™èµ·æ¥ä¹Ÿä¸ç®€å•ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚æœç”¨MongoDBæ•°æ®åº“æ¥å®ç°ï¼Œå¯ä»¥å¦‚ä½•è®¾è®¡æ•°æ®æ¨¡å‹å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œåƒä¸‹é¢è¿™æ ·<a href="http://www.tutorialspoint.com/mongodb/mongodb_data_modeling.htm">[1]</a>ï¼š</p><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less"><span class="hljs-attribute">_id</span>: POST_ID<br>  <span class="hljs-attribute">title</span>: TITLE_OF_POST, <br>  <span class="hljs-attribute">description</span>: POST_DESCRIPTION,<br>  <span class="hljs-attribute">author</span>: POST_BY,<br>  <span class="hljs-attribute">tags</span>: [TAG1, TAG2, TAG3],<br>  <span class="hljs-attribute">likes</span>: TOTAL_LIKES, <br>  <span class="hljs-attribute">comments</span>: [<br>     &#123;<br>        <span class="hljs-attribute">user</span>:<span class="hljs-string">&#x27;COMMENT_BY&#x27;</span>,<br>        <span class="hljs-attribute">message</span>: TEXT,<br>        <span class="hljs-attribute">dateCreated</span>: DATE_TIME,<br>     &#125;,<br>     &#123;<br>        <span class="hljs-attribute">user</span>:<span class="hljs-string">&#x27;COMMENT_BY&#x27;</span>,<br>        <span class="hljs-attribute">message</span>: TEXT,<br>        <span class="hljs-attribute">dateCreated</span>: DATE_TIME,<br>     &#125;<br>  ]<br><br></code></pre></div></td></tr></table></figure><p>åœ¨MongoDBé‡Œï¼Œæ¯ç¯‡åšå®¢æ–‡ç« ä»¥ä¸€ä¸ªæ–‡æ¡£(document)çš„å½¢å¼ä¿å­˜èµ·æ¥ï¼Œè€Œæ–‡æ¡£å†…éƒ¨åŒ…å«äº†å¾ˆå¤šé¡¹ç›®ï¼Œæ¯”å¦‚<code>title tags</code>ç­‰ï¼Œæ¯ä¸€ä¸ªé¡¹ç›®éƒ½æ˜¯<code>key-value</code>çš„å½¢å¼ï¼Œå³æœ‰ä¸€ä¸ªé¡¹ç›®çš„åå­—ï¼Œæ¯”å¦‚<code>title</code>ï¼Œä»¥åŠå®ƒçš„å€¼<code>TITLE_OF_POST</code>ã€‚è€Œé‡è¦çš„æ˜¯ï¼Œä¸€ä¸ª<code>key</code>å¯ä»¥æœ‰å¤šä¸ª<code>values</code>ï¼Œä»–ä»¬ç”¨<code>[]</code>æ‹¬èµ·æ¥ã€‚</p><p>è¿™ç§â€œå®½æ¾â€çš„æ•°æ®å­˜å‚¨å½¢å¼éå¸¸çµæ´»ï¼ŒMongoDBä¸é™åˆ¶æ¯ä¸ª<code>key</code>å¯¹åº”çš„<code>values</code>çš„æ•°ç›®ã€‚æ¯”å¦‚æœ‰çš„æ–‡ç« æ²¡æœ‰è¯„è®ºï¼Œåˆ™å®ƒçš„å€¼å°±æ˜¯ä¸€ä¸ªç©ºé›†ï¼Œå®Œå…¨æ²¡æœ‰é—®é¢˜ï¼›æœ‰çš„æ–‡ç« è¯„è®ºå¾ˆå¤šï¼Œä¹Ÿå¯ä»¥æ— é™åˆ¶åœ°æ’å…¥ã€‚æ›´çµæ´»çš„æ˜¯ï¼ŒMongoDBä¸è¦æ±‚åŒä¸€ä¸ªé›†åˆ(collectionï¼Œç›¸å½“äºSQLçš„table)é‡Œé¢çš„ä¸åŒdocumentæœ‰ç›¸åŒçš„keyï¼Œæ¯”å¦‚é™¤äº†ä¸Šè¿°è¿™ç§æ–‡æ¡£ç»„ç»‡ï¼Œæœ‰çš„æ–‡æ¡£æ‰€ä»£è¡¨çš„æ–‡ç« å¯èƒ½æ²¡æœ‰likesè¿™ä¸ªé¡¹ç›®ï¼Œå†æ¯”å¦‚æœ‰çš„æ–‡ç« å¯èƒ½æœ‰æ›´å¤šçš„é¡¹ç›®ï¼Œæ¯”å¦‚å¯èƒ½è¿˜æœ‰dislikesç­‰ç­‰ã€‚è¿™äº›ä¸åŒçš„æ–‡æ¡£éƒ½å¯ä»¥çµæ´»åœ°å­˜å‚¨åœ¨åŒä¸€ä¸ªé›†åˆä¸‹ï¼Œè€Œä¸”æŸ¥è¯¢èµ·æ¥ä¹Ÿå¼‚å¸¸ç®€å•ï¼Œå› ä¸ºéƒ½åœ¨ä¸€ä¸ªæ–‡æ¡£é‡Œï¼Œä¸ç”¨è¿›è¡Œå„ç§è·¨æ–‡æ¡£æŸ¥è¯¢ã€‚è€Œè¿™ç§MongoDBå¼çš„å­˜å‚¨ä¹Ÿæ–¹ä¾¿äº†æ•°æ®çš„ç»´æŠ¤ï¼Œå¯¹äºä¸€ç¯‡åšå®¢æ–‡ç« æ¥è¯´ï¼Œæ‰€æœ‰çš„ç›¸å…³æ•°æ®éƒ½åœ¨è¿™ä¸ªdocumenté‡Œé¢ï¼Œä¸ç”¨å»è€ƒè™‘ä¸€ä¸ªæ•°æ®æ“ä½œéœ€è¦involveå¤šå°‘ä¸ªè¡¨æ ¼ã€‚</p><p>å½“ç„¶ï¼Œé™¤äº†ä¸Šè¿°çš„ä¼˜ç‚¹ï¼ŒMongoDBè¿˜æœ‰ä¸å°‘åˆ«çš„ä¼˜åŠ¿ï¼Œæ¯”å¦‚MongoDBçš„æ•°æ®æ˜¯ç”¨JSON(Javascript Object Notation)å­˜å‚¨çš„(å°±æ˜¯ä¸Šé¢çš„è¿™ç§key-valueçš„å½¢å¼)ï¼Œè€Œå‡ ä¹æ‰€æœ‰çš„webåº”ç”¨éƒ½æ˜¯åŸºäºJavascriptçš„ã€‚å› æ­¤ï¼Œå­˜å‚¨çš„æ•°æ®å’Œåº”ç”¨çš„æ•°æ®çš„æ ¼å¼æ˜¯é«˜åº¦ä¸€è‡´çš„ï¼Œä¸éœ€ç»è¿‡è½¬æ¢ã€‚æ›´å¤šçš„ä¼˜ç‚¹å¯ä»¥æŸ¥çœ‹ï¼š<a href="http://www.tutorialspoint.com/mongodb/mongodb_advantages.htm">[2]</a>ã€‚</p><h4 id="2-å…³äºè¿™ç¯‡æ–‡ç« "><a href="#2-å…³äºè¿™ç¯‡æ–‡ç« " class="headerlink" title="2. å…³äºè¿™ç¯‡æ–‡ç« "></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#2-%E5%85%B3%E4%BA%8E%E8%BF%99%E7%AF%87%E6%96%87%E7%AB%A0"></a>2. å…³äºè¿™ç¯‡æ–‡ç« </h4><p>è¿™ä¸ªæç®€æ•™ç¨‹ï¼Œæˆ–è€…è¯´ç¬”è®°ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªè¦†ç›–MongoDBæ–¹æ–¹é¢é¢çš„æ•™ç¨‹ã€‚æ‰€è°“æç®€çš„æ„æ€ï¼Œå°±æ˜¯åªé€‰å–é‚£äº›æœ€é‡è¦ã€æœ€å¸¸ç”¨çš„å†…å®¹è¿›è¡ŒåŸºäºå®ä¾‹çš„ä»‹ç»ï¼Œä»è€Œè®©è¯»è€…èƒ½å¤Ÿåœ¨æœ€çŸ­çš„æ—¶é—´å†…å¿«é€Ÿä¸Šæ‰‹ï¼Œå¹¶ä¸”èƒ½é¡ºåˆ©åœ°è¿›è¡Œåç»­çš„çºµæ·±çš„å­¦ä¹ ã€‚</p><p>å…·ä½“åœ°è¯´ï¼Œè¿™ä¸ªæ•™ç¨‹çš„ç‰¹ç‚¹æ˜¯ï¼š</p><ul><li>  ä¸æ±‚å…¨é¢ï¼Œåªæ±‚å®ç”¨ã€‚åªè¦†ç›–æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼›</li><li>  ä»¥å¤§é‡ä¾‹å­ä¸ºå¯¼å‘ï¼›</li><li>  ä¸€è¾¹é˜…è¯»ä¸€è¾¹åŠ¨æ‰‹æ“ä½œçš„è¯ï¼Œå¤§çº¦åªéœ€è¦2å°æ—¶çš„æ—¶é—´ï¼›</li></ul><p>é˜…è¯»è¿™ç¯‡æ–‡ç« ä¸éœ€è¦æœ‰ç‰¹åˆ«çš„åŸºç¡€ï¼Œä½†æœ€å¥½çŸ¥é“æ•°æ®åº“çš„åŸºæœ¬æ¦‚å¿µï¼Œå¦‚æœæœ¬èº«ç†Ÿæ‚‰SQLé‚£å°±æ›´å¥½å•¦ã€‚</p><h4 id="3-å®‰è£…ä¸ç¯å¢ƒ"><a href="#3-å®‰è£…ä¸ç¯å¢ƒ" class="headerlink" title="3. å®‰è£…ä¸ç¯å¢ƒ"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#3-%E5%AE%89%E8%A3%85%E4%B8%8E%E7%8E%AF%E5%A2%83"></a>3. å®‰è£…ä¸ç¯å¢ƒ</h4><p>MongoDBå¯ä»¥åœ¨Windowsã€Linuxã€Mac OS Xç­‰ä¸»æµå¹³å°è¿è¡Œï¼Œè€Œä¸”ä¸‹è½½å’Œå®‰è£…éå¸¸ç®€å•ï¼Œéå¸¸å‹å¥½ã€‚è¿™ç¯‡æ–‡æ¡£çš„ä¾‹å­é‡‡ç”¨MongoDB 2.6ç‰ˆæœ¬ï¼Œå‡åœ¨OS Xæµ‹è¯•è¿‡ï¼Œæœ‰å……è¶³çš„ç†ç”±ç›¸ä¿¡ï¼Œåœ¨å…¶å®ƒå¹³å°ä¹Ÿèƒ½é¡ºåˆ©è¿è¡Œã€‚</p><p>Windowsçš„å®‰è£…å’Œè®¾ç½®å¯ä»¥å‚è€ƒï¼š<a href="http://www.w3cschool.cc/mongodb/mongodb-window-install.html%EF%BC%9B">http://www.w3cschool.cc/mongodb/mongodb-window-install.htmlï¼›</a></p><p>Linuxçš„å®‰è£…å’Œè®¾ç½®å¯ä»¥å‚è€ƒï¼š<a href="http://www.w3cschool.cc/mongodb/mongodb-linux-install.html%EF%BC%9B">http://www.w3cschool.cc/mongodb/mongodb-linux-install.htmlï¼›</a></p><p>Mac OS Xä¸‹çš„å®‰è£…å’Œè®¾ç½®ï¼š</p><ul><li>  1. åœ¨<a href="https://www.mongodb.org/">https://www.mongodb.org/</a> ä¸‹è½½é€‚åˆä½ çš„Macçš„MongoDb;</li><li>  2. ä¸‹è½½å¾—åˆ°çš„æ–‡ä»¶æ˜¯ä¸€ä¸ªzipæ–‡ä»¶ï¼Œè§£å‹ï¼Œç„¶åæ”¾åˆ°ä½ æƒ³åˆ°çš„æ–‡ä»¶å¤¹ï¼Œæ¯”å¦‚/Users/Steven/MongoDB;</li><li>  3. åˆ›å»ºä¸€ä¸ªä½ å–œæ¬¢çš„æ–‡ä»¶å¤¹æ¥å­˜å‚¨ä½ çš„æ•°æ®ï¼Œæ¯”å¦‚/User/Steven/myData;</li><li>  4. æ‰“å¼€Terminalï¼Œcdåˆ°2é‡Œé¢é‚£ä¸ªæ–‡ä»¶å¤¹/Users/Steven/MongoDBï¼Œå†cd bin;</li><li>  5. è¾“å…¥./mongod â€“dbpath /User/Steven/myData,ç­‰åˆ°å‡ºç°ç±»ä¼¼â€œwaiting for connections on port 27017â€ï¼Œè¯´æ˜MongoDBæœåŠ¡å™¨å·²æ¶è®¾å¥½ï¼Œè€Œæ•°æ®å°†å‚¨å­˜åœ¨myDataé‡Œé¢ï¼›</li><li>  6. æ–°æ‰“å¼€ä¸€ä¸ªTerminal, cd /Users/Steven/MongoDB/bin,ç„¶åè¿è¡Œ./mongo;é¡ºåˆ©çš„è¯å®ƒå°†å‡ºç°ä¸€ä¸ªinteractive shellè®©ä½ è¿›è¡Œå„ç§æ“ä½œï¼Œè€Œä½ çš„æ•°æ®å°†å‚¨å­˜åœ¨myDataé‡Œ</li></ul><p>å¦‚æœä»¥ä¸Šçš„å„ä¸ªæ­¥éª¤éƒ½è¿è¡Œé¡ºåˆ©ï¼Œå°±å¯ä»¥è·³åˆ°ä¸‹ä¸€èŠ‚å•¦ã€‚</p><h4 id="4-åˆ›å»ºé›†åˆå’Œåˆ é™¤é›†åˆ"><a href="#4-åˆ›å»ºé›†åˆå’Œåˆ é™¤é›†åˆ" class="headerlink" title="4. åˆ›å»ºé›†åˆå’Œåˆ é™¤é›†åˆ"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#4-%E5%88%9B%E5%BB%BA%E9%9B%86%E5%90%88%E5%92%8C%E5%88%A0%E9%99%A4%E9%9B%86%E5%90%88"></a>4. åˆ›å»ºé›†åˆå’Œåˆ é™¤é›†åˆ</h4><p>åœ¨ä¸Šä¸€èŠ‚æ‰§è¡Œå®Œæ­¥éª¤6åï¼Œä½ ä¼šçœ‹åˆ°å‘½ä»¤è¡Œé‡Œæ˜¾ç¤ºï¼š<code>connecting to: test</code>ï¼Œè¿™é‡Œçš„<code>test</code>æ˜¯é»˜è®¤çš„æ•°æ®åº“ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ–°å»ºä¸€ä¸ªæ•°æ®åº“ã€‚åœ¨å‘½ä»¤è¡Œé‡Œæ‰“å…¥ï¼š</p><figure class="highlight stata"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stata"><span class="hljs-keyword">use</span> <span class="hljs-keyword">tutorial</span><br><br></code></pre></div></td></tr></table></figure><p>è¿™æ ·å°±æ–°å»ºäº†ä¸€ä¸ªå«åš<code>tutorial</code>çš„æ•°æ®åº“ã€‚ä½ å¯ä»¥æ‰§è¡Œ</p><figure class="highlight dart"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dart"><span class="hljs-keyword">show</span> databases<br><br></code></pre></div></td></tr></table></figure><p>æ¥æ˜¾ç¤ºå½“å‰çš„æ•°æ®åº“ã€‚ä¸è¿‡è¿™æ—¶å€™ç”±äºæˆ‘ä»¬çš„æ–°æ•°æ®åº“æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥ä¼šæ˜¾ç¤ºç±»ä¼¼è¿™æ ·çš„ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">admin</span>  (empty)<br><span class="hljs-attribute">local</span>  <span class="hljs-number">0</span>.<span class="hljs-number">078</span>GB<br><br></code></pre></div></td></tr></table></figure><p>æˆ‘ä»¬è¯•ç€å¾€æˆ‘ä»¬çš„æ•°æ®åº“é‡Œæ·»åŠ ä¸€ä¸ªé›†åˆ(collection)ï¼ŒMongoDBé‡Œçš„é›†åˆå’ŒSQLé‡Œé¢çš„è¡¨æ ¼æ˜¯ç±»ä¼¼çš„ï¼š</p><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.createCollection</span>(<span class="hljs-string">&#x27;author&#x27;</span>)<br><br></code></pre></div></td></tr></table></figure><p>é¡ºåˆ©çš„è¯ä¼šæ˜¾ç¤ºï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123; <span class="hljs-attr">&quot;ok&quot;</span> : <span class="hljs-number">1</span> &#125;<br><br></code></pre></div></td></tr></table></figure><p>è¡¨ç¤ºåˆ›å»ºæˆåŠŸã€‚</p><p>ä½ å¯ä»¥å†å›å¤´æ‰§è¡Œï¼š</p><figure class="highlight dart"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dart"><span class="hljs-keyword">show</span> databases<br><br></code></pre></div></td></tr></table></figure><p>è¿™æ—¶å€™æˆ‘ä»¬çš„tutorialé›†åˆå·²ç»ä½åˆ—å…¶ä¸­ã€‚ä½ å¯ä»¥å†æ‰§è¡Œ</p><figure class="highlight dart"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dart"><span class="hljs-keyword">show</span> collections<br><br></code></pre></div></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åˆ›å»ºçš„é›†åˆauthorä¹Ÿåœ¨å…¶ä¸­ã€‚</p><p>æˆ‘ä»¬æš‚æ—¶ä¸éœ€è¦authorè¿™ä¸ªé›†åˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡Œï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.author</span><span class="hljs-selector-class">.drop</span>()<br><br></code></pre></div></td></tr></table></figure><p>æ¥å°†å…¶åˆ é™¤ã€‚è¿™æ—¶å€™ä½ å†æ‰§è¡Œ<code>show collections</code>ï¼Œå°±å†ä¹Ÿçœ‹ä¸åˆ°æˆ‘ä»¬çš„authoräº†ã€‚</p><p>è¿™ä¸€èŠ‚è¦è®°ä½çš„ç‚¹ä¸»è¦åªæœ‰ä¸€ä¸ªï¼šé›†åˆ(collection)ç±»ä¼¼äºSQLçš„è¡¨æ ¼(table)ï¼Œç±»ä¼¼äºExcelçš„ä¸€ä¸ªä¸ªè¡¨æ ¼ã€‚</p><h4 id="5-æ’å…¥"><a href="#5-æ’å…¥" class="headerlink" title="5. æ’å…¥"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#5-%E6%8F%92%E5%85%A5"></a>5. æ’å…¥</h4><p>æƒ³è±¡ä¸€ä¸ªç²¾ç®€ç‰ˆçš„â€œè±†ç“£ç”µå½±â€ã€‚æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ï¼Œæ¥å­˜å‚¨æ¯éƒ¨ç”µå½±çš„ä¿¡æ¯ï¼Œç”µå½±çš„ä¿¡æ¯åŒ…æ‹¬ï¼š</p><ul><li>  ç”µå½±åå­—</li><li>  å¯¼æ¼”</li><li>  ä¸»æ¼”(å¯èƒ½å¤šä¸ª)</li><li>  ç±»å‹æ ‡ç­¾(å¯èƒ½å¤šä¸ª)</li><li>  ä¸Šæ˜ æ—¥æœŸ</li><li>  å–œæ¬¢äººæ•°</li><li>  ä¸å–œæ¬¢äººæ•°</li><li>  ç”¨æˆ·è¯„è®º(å¯èƒ½å¤šä¸ª)</li></ul><p>æ˜¾ç„¶æˆ‘ä»¬éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªå«ç”µå½±çš„é›†åˆï¼š</p><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.createCollection</span>(<span class="hljs-string">&#x27;movie&#x27;</span>)<br><br></code></pre></div></td></tr></table></figure><p>ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ’å…¥æ•°æ®äº†ï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.insert</span>(<br> &#123;<br>   <span class="hljs-attribute">title</span>: <span class="hljs-string">&#x27;Forrest Gump&#x27;</span>, <br>   directed_by: <span class="hljs-string">&#x27;Robert Zemeckis&#x27;</span>,<br>   stars: [<span class="hljs-string">&#x27;Tom Hanks&#x27;</span>, <span class="hljs-string">&#x27;Robin Wright&#x27;</span>, <span class="hljs-string">&#x27;Gary Sinise&#x27;</span>],<br>   tags: [<span class="hljs-string">&#x27;drama&#x27;</span>, <span class="hljs-string">&#x27;romance&#x27;</span>],<br>   debut: new <span class="hljs-built_in">Date</span>(<span class="hljs-number">1994</span>,<span class="hljs-number">7</span>,<span class="hljs-number">6</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),<br>   likes: <span class="hljs-number">864367</span>,<br>   dislikes: <span class="hljs-number">30127</span>,<br>   comments: [<br>      &#123;<br>         user:<span class="hljs-string">&#x27;user1&#x27;</span>,<br>         message: <span class="hljs-string">&#x27;My first comment&#x27;</span>,<br>         dateCreated: new <span class="hljs-built_in">Date</span>(<span class="hljs-number">2013</span>,<span class="hljs-number">11</span>,<span class="hljs-number">10</span>,<span class="hljs-number">2</span>,<span class="hljs-number">35</span>),<br>         like: <span class="hljs-number">0</span> <br>      &#125;,<br>      &#123;<br>         <span class="hljs-attribute">user</span>:<span class="hljs-string">&#x27;user2&#x27;</span>,<br>         message: <span class="hljs-string">&#x27;My first comment too!&#x27;</span>,<br>         dateCreated: new <span class="hljs-built_in">Date</span>(<span class="hljs-number">2013</span>,<span class="hljs-number">11</span>,<span class="hljs-number">11</span>,<span class="hljs-number">6</span>,<span class="hljs-number">20</span>),<br>         like: <span class="hljs-number">0</span> <br>      &#125;<br>   ]<br>&#125;<br>)<br><br></code></pre></div></td></tr></table></figure><p>è¯·æ³¨æ„ï¼Œè¿™é‡Œæ’å…¥æ•°æ®ä¹‹å‰ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦å…ˆå£°æ˜movieè¿™ä¸ªé›†åˆé‡Œé¢æœ‰å“ªäº›é¡¹ç›®ã€‚æˆ‘ä»¬ç›´æ¥æ’å…¥å°±å¯ä»¥äº†~è¿™ä¸€ç‚¹å’ŒSQLä¸ä¸€æ ·ï¼ŒSQLå¿…é¡»å…ˆå£°æ˜ä¸€ä¸ªtableé‡Œé¢æœ‰å“ªäº›åˆ—ï¼Œè€ŒMongoDBä¸éœ€è¦ã€‚</p><p>æŠŠä¸Šé¢çš„ä¾‹å­å¤åˆ¶è¿›å‘½ä»¤è¡Œåº”è¯¥å¯ä»¥é¡ºåˆ©è¿è¡Œï¼Œä½†æˆ‘å¼ºçƒˆå»ºè®®ä½ æ‰‹åŠ¨æ‰“ä¸€ä¸‹ï¼Œæˆ–è€…è¾“å…¥ä¸€éƒ¨ä½ è‡ªå·±å–œæ¬¢çš„ç”µå½±ã€‚<code>insert</code>æ“ä½œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š</p><ul><li>  1. ä¸åŒkey-valueéœ€è¦ç”¨é€—å·éš”å¼€ï¼Œè€Œkey:valueä¸­é—´æ˜¯ç”¨å†’å·ï¼›</li><li>  2. å¦‚æœä¸€ä¸ªkeyæœ‰å¤šä¸ªvalueï¼Œvalueè¦ç”¨[]ã€‚å“ªæ€•å½“å‰åªæœ‰ä¸€ä¸ªvalueï¼Œä¹ŸåŠ ä¸Š[]ä»¥å¤‡åç»­çš„æ·»åŠ ï¼›</li><li>  3. æ•´ä¸ªâ€œæ•°æ®å—â€è¦ç”¨{}æ‹¬èµ·æ¥ï¼›</li></ul><p>å¦‚æœä½ åœ¨<code>insert</code>ä¹‹åçœ‹åˆ°<code>WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)</code>ï¼Œè¯´æ˜å†™å…¥æˆåŠŸã€‚</p><p>è¿™ä¸ªæ—¶å€™ä½ å¯ä»¥ç”¨æŸ¥è¯¢çš„æ–¹å¼æ¥è¿”å›æ•°æ®åº“ä¸­çš„æ•°æ®ï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.find</span>()<span class="hljs-selector-class">.pretty</span>()<br><br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œ<code>find()</code>é‡Œé¢æ˜¯ç©ºçš„ï¼Œè¯´æ˜æˆ‘ä»¬ä¸åšé™åˆ¶å’Œç­›é€‰ï¼Œç±»ä¼¼äºSQLæ²¡æœ‰<code>WHERE</code>è¯­å¥ä¸€æ ·ã€‚è€Œ<code>pretty()</code>è¾“å‡ºçš„æ˜¯ç»æ ¼å¼ç¾åŒ–åçš„æ•°æ®ï¼Œä½ å¯ä»¥è‡ªå·±è¯•è¯•æ²¡æœ‰<code>pretty()</code>ä¼šæ€ä¹ˆæ ·ã€‚</p><p>ä»”ç»†è§‚å¯Ÿ<code>find()</code>çš„ç»“æœï¼Œä½ ä¼šå‘ç°å¤šäº†ä¸€ä¸ªå«<code>&#39;_id&#39;</code>çš„ä¸œè¥¿ï¼Œè¿™æ˜¯æ•°æ®åº“è‡ªåŠ¨åˆ›å»ºçš„ä¸€ä¸ªIDå·ï¼Œåœ¨åŒä¸€ä¸ªæ•°æ®åº“é‡Œï¼Œæ¯ä¸ªæ–‡æ¡£çš„IDå·éƒ½æ˜¯ä¸åŒçš„ã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åŒæ—¶è¾“å…¥å¤šä¸ªæ•°æ®ï¼š</p><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.insert</span>([<br> &#123;<br>   <span class="hljs-attribute">title</span>: <span class="hljs-string">&#x27;Fight Club&#x27;</span>, <br>   <span class="hljs-attribute">directed_by</span>: <span class="hljs-string">&#x27;David Fincher&#x27;</span>,<br>   <span class="hljs-attribute">stars</span>: [<span class="hljs-string">&#x27;Brad Pitt&#x27;</span>, <span class="hljs-string">&#x27;Edward Norton&#x27;</span>, <span class="hljs-string">&#x27;Helena Bonham Carter&#x27;</span>],<br>   <span class="hljs-attribute">tags</span>: <span class="hljs-string">&#x27;drama&#x27;</span>,<br>   <span class="hljs-attribute">debut</span>: new Date(<span class="hljs-number">1999</span>,<span class="hljs-number">10</span>,<span class="hljs-number">15</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),<br>   <span class="hljs-attribute">likes</span>: <span class="hljs-number">224360</span>,<br>   <span class="hljs-attribute">dislikes</span>: <span class="hljs-number">40127</span>,<br>   <span class="hljs-attribute">comments</span>: [<br>      &#123;<br>         <span class="hljs-attribute">user</span>:<span class="hljs-string">&#x27;user3&#x27;</span>,<br>         <span class="hljs-attribute">message</span>: <span class="hljs-string">&#x27;My first comment&#x27;</span>,<br>         <span class="hljs-attribute">dateCreated</span>: new Date(<span class="hljs-number">2008</span>,<span class="hljs-number">09</span>,<span class="hljs-number">13</span>,<span class="hljs-number">2</span>,<span class="hljs-number">35</span>),<br>         <span class="hljs-attribute">like</span>: <span class="hljs-number">0</span> <br>      &#125;,<br>      &#123;<br>         <span class="hljs-attribute">user</span>:<span class="hljs-string">&#x27;user2&#x27;</span>,<br>         <span class="hljs-attribute">message</span>: <span class="hljs-string">&#x27;My first comment too!&#x27;</span>,<br>         <span class="hljs-attribute">dateCreated</span>: new Date(<span class="hljs-number">2003</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">6</span>,<span class="hljs-number">20</span>),<br>         <span class="hljs-attribute">like</span>: <span class="hljs-number">14</span> <br>      &#125;,<br>      &#123;<br>         <span class="hljs-attribute">user</span>:<span class="hljs-string">&#x27;user7&#x27;</span>,<br>         <span class="hljs-attribute">message</span>: <span class="hljs-string">&#x27;Good Movie!&#x27;</span>,<br>         <span class="hljs-attribute">dateCreated</span>: new Date(<span class="hljs-number">2009</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">6</span>,<span class="hljs-number">20</span>),<br>         <span class="hljs-attribute">like</span>: <span class="hljs-number">2</span><br>      &#125;<br>   ]<br>&#125;,<br>&#123;<br>   <span class="hljs-attribute">title</span>: <span class="hljs-string">&#x27;Seven&#x27;</span>, <br>   <span class="hljs-attribute">directed_by</span>: <span class="hljs-string">&#x27;David Fincher&#x27;</span>,<br>   <span class="hljs-attribute">stars</span>: [<span class="hljs-string">&#x27;Morgan Freeman&#x27;</span>, <span class="hljs-string">&#x27;Brad Pitt&#x27;</span>,  <span class="hljs-string">&#x27;Kevin Spacey&#x27;</span>],<br>   <span class="hljs-attribute">tags</span>: [<span class="hljs-string">&#x27;drama&#x27;</span>,<span class="hljs-string">&#x27;mystery&#x27;</span>,<span class="hljs-string">&#x27;thiller&#x27;</span>],<br>   <span class="hljs-attribute">debut</span>: new Date(<span class="hljs-number">1995</span>,<span class="hljs-number">9</span>,<span class="hljs-number">22</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>),<br>   <span class="hljs-attribute">likes</span>: <span class="hljs-number">134370</span>,<br>   <span class="hljs-attribute">dislikes</span>: <span class="hljs-number">1037</span>,<br>   <span class="hljs-attribute">comments</span>: [<br>      &#123;<br>         <span class="hljs-attribute">user</span>:<span class="hljs-string">&#x27;user3&#x27;</span>,<br>         <span class="hljs-attribute">message</span>: <span class="hljs-string">&#x27;Love Kevin Spacey&#x27;</span>,<br>         <span class="hljs-attribute">dateCreated</span>: new Date(<span class="hljs-number">2002</span>,<span class="hljs-number">09</span>,<span class="hljs-number">13</span>,<span class="hljs-number">2</span>,<span class="hljs-number">35</span>),<br>         <span class="hljs-attribute">like</span>: <span class="hljs-number">0</span> <br>      &#125;,<br>      &#123;<br>         <span class="hljs-attribute">user</span>:<span class="hljs-string">&#x27;user2&#x27;</span>,<br>         <span class="hljs-attribute">message</span>: <span class="hljs-string">&#x27;Good works!&#x27;</span>,<br>         <span class="hljs-attribute">dateCreated</span>: new Date(<span class="hljs-number">2013</span>,<span class="hljs-number">10</span>,<span class="hljs-number">21</span>,<span class="hljs-number">6</span>,<span class="hljs-number">20</span>),<br>         <span class="hljs-attribute">like</span>: <span class="hljs-number">14</span> <br>      &#125;,<br>      &#123;<br>         <span class="hljs-attribute">user</span>:<span class="hljs-string">&#x27;user7&#x27;</span>,<br>         <span class="hljs-attribute">message</span>: <span class="hljs-string">&#x27;Good Movie!&#x27;</span>,<br>         <span class="hljs-attribute">dateCreated</span>: new Date(<span class="hljs-number">2009</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">6</span>,<span class="hljs-number">20</span>),<br>         <span class="hljs-attribute">like</span>: <span class="hljs-number">2</span><br>      &#125;<br>   ]<br>&#125;<br>])<br><br></code></pre></div></td></tr></table></figure><p>é¡ºåˆ©çš„è¯ä¼šæ˜¾ç¤ºï¼š</p><figure class="highlight ada"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ada">BulkWriteResult(&#123;<br><span class="hljs-string">&quot;writeErrors&quot;</span> : [ ],<br><span class="hljs-string">&quot;writeConcernErrors&quot;</span> : [ ],<br><span class="hljs-string">&quot;nInserted&quot;</span> : 2,<br><span class="hljs-string">&quot;nUpserted&quot;</span> : 0,<br><span class="hljs-string">&quot;nMatched&quot;</span> : 0,<br><span class="hljs-string">&quot;nModified&quot;</span> : 0,<br><span class="hljs-string">&quot;nRemoved&quot;</span> : 0,<br><span class="hljs-string">&quot;upserted&quot;</span> : [ ]<br><br></code></pre></div></td></tr></table></figure><p>è¡¨é¢æˆ‘ä»¬æˆåŠŸåœ°æ’å…¥äº†ä¸¤ä¸ªæ•°æ®ã€‚æ³¨æ„æ‰¹é‡æ’å…¥çš„æ ¼å¼æ˜¯è¿™æ ·çš„ï¼š<code>db.movie.insert([&#123;ITEM1&#125;,&#123;ITEM2&#125;])</code>ã€‚å‡ éƒ¨ç”µå½±çš„å¤–é¢éœ€è¦ç”¨[]æ‹¬èµ·æ¥ã€‚</p><p>è¯·æ³¨æ„ï¼Œè™½ç„¶collectionçš„æ’å…¥ä¸éœ€è¦å…ˆå£°æ˜ï¼Œä½†è¡¨è¾¾ç›¸åŒæ„æ€çš„keyï¼Œåå­—è¦ä¸€æ ·ï¼Œæ¯”å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä¸€ä¸ªæ–‡æ¡£é‡Œç”¨<code>directed_by</code>æ¥è¡¨ç¤ºå¯¼æ¼”ï¼Œåˆ™åœ¨å…¶å®ƒæ–‡æ¡£ä¹Ÿè¦ä¿æŒåŒæ ·çš„åå­—(è€Œä¸æ˜¯<code>director</code>ä¹‹ç±»çš„)ã€‚ä¸åŒçš„åå­—ä¸æ˜¯ä¸å¯ä»¥ï¼ŒæŠ€æœ¯ä¸Šå®Œå…¨å¯è¡Œï¼Œä½†ä¼šç»™æŸ¥è¯¢å’Œæ›´æ–°å¸¦æ¥å›°éš¾ã€‚</p><p>å¥½äº†ï¼Œåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªå«tutorialçš„æ•°æ®åº“ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªå«movieçš„é›†åˆï¼Œè€Œmovieé‡Œé¢æœ‰ä¸‰ä¸ªè®°å½•ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å¯¹å…¶è¿›è¡ŒæŸ¥è¯¢äº†ã€‚</p><h4 id="6-æŸ¥è¯¢"><a href="#6-æŸ¥è¯¢" class="headerlink" title="6. æŸ¥è¯¢"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#6-%E6%9F%A5%E8%AF%A2"></a>6. æŸ¥è¯¢</h4><p>åœ¨ä¸Šä¸€èŠ‚æˆ‘ä»¬å·²ç»æ¥è§¦åˆ°æœ€ç®€å•çš„æŸ¥è¯¢<code>db.movie.find().pretty()</code>ã€‚MongoDBæ”¯æŒå„ç§å„æ ·çš„æ·±åº¦æŸ¥è¯¢åŠŸèƒ½ã€‚å…ˆæ¥ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼Œæ‰¾å‡ºå¤§å«èŠ¬å¥‡(David Fincher)å¯¼æ¼”çš„æ‰€æœ‰ç”µå½±ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">db.movie.<span class="hljs-builtin-name">find</span>(&#123;<span class="hljs-string">&#x27;directed_by&#x27;</span>:<span class="hljs-string">&#x27;David Fincher&#x27;</span>&#125;).pretty()<br><br></code></pre></div></td></tr></table></figure><p>å°†è¿”å›ã€Šæå‡»ä¿±ä¹éƒ¨ã€‹å’Œã€Šä¸ƒå®—ç½ªã€‹ä¸¤éƒ¨ç”µå½±ã€‚è¿™ç§æœç´¢å’ŒSQLçš„<code>WHERE</code>è¯­å¥æ˜¯å¾ˆç›¸ä¼¼çš„ã€‚</p><p>ä¹Ÿå¯ä»¥è®¾ç½®å¤šä¸ªæ¡ä»¶ã€‚æ¯”å¦‚æ‰¾å‡ºå¤§å«èŠ¬å¥‡å¯¼æ¼”çš„, æ‘©æ ¹å¼—é‡Œæ›¼ä¸»æ¼”çš„ç”µå½±ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">db.movie.<span class="hljs-builtin-name">find</span>(&#123;<span class="hljs-string">&#x27;directed_by&#x27;</span>:<span class="hljs-string">&#x27;David Fincher&#x27;</span>, <span class="hljs-string">&#x27;stars&#x27;</span>:<span class="hljs-string">&#x27;Morgan Freeman&#x27;</span>&#125;).pretty()<br><br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œä¸¤ä¸ªæ¡ä»¶ä¹‹é—´ï¼Œæ˜¯ANDçš„å…³ç³»ï¼Œåªæœ‰åŒæ—¶æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶çš„ç”µå½±æ‰ä¼šè¢«è¾“å‡ºã€‚åŒç†ï¼Œå¯ä»¥è®¾ç½®å¤šä¸ªçš„æ¡ä»¶ï¼Œä¸èµ˜è¿°ã€‚</p><p>æ¡ä»¶ä¹‹é—´ä¹Ÿå¯ä»¥æ˜¯æˆ–çš„å…³ç³»ï¼Œæ¯”å¦‚æ‰¾å‡ºç½—å®¾æ€€ç‰¹æˆ–æ‘©æ ¹å¼—é‡Œæ›¼ä¸»æ¼”çš„ç”µå½±ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">db.movie.<span class="hljs-builtin-name">find</span>(<br>&#123;<br>  <span class="hljs-variable">$or</span>: <br>     [  &#123;<span class="hljs-string">&#x27;stars&#x27;</span>:<span class="hljs-string">&#x27;Robin Wright&#x27;</span>&#125;, <br>        &#123;<span class="hljs-string">&#x27;stars&#x27;</span>:<span class="hljs-string">&#x27;Morgan Freeman&#x27;</span>&#125;<br>     ]<br>&#125;).pretty()<br><br></code></pre></div></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œé¢ç¨æ˜¾å¤æ‚çš„å„ç§æ‹¬å·ã€‚</p><p>è¿˜å¯ä»¥è®¾ç½®ä¸€ä¸ªèŒƒå›´çš„æœç´¢ï¼Œæ¯”å¦‚æ‰¾å‡º50ä¸‡äººä»¥ä¸Šèµçš„ç”µå½±ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">db.movie.<span class="hljs-builtin-name">find</span>(&#123;<span class="hljs-string">&#x27;likes&#x27;</span>:&#123;<span class="hljs-variable">$gt</span>:500000&#125;&#125;).pretty()<br><br></code></pre></div></td></tr></table></figure><p>åŒæ ·è¦æ³¨æ„ç•¥å¤æ‚çš„æ‹¬å·ã€‚æ³¨æ„ï¼Œåœ¨è¿™äº›æŸ¥è¯¢é‡Œï¼Œkeyçš„å•å¼•å·éƒ½æ˜¯å¯é€‰çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šè¿°è¯­å¥ä¹Ÿå¯ä»¥å†™æˆï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.find</span>(&#123;<span class="hljs-attribute">likes</span>:&#123;$gt:<span class="hljs-number">500000</span>&#125;&#125;)<span class="hljs-selector-class">.pretty</span>()<br><br></code></pre></div></td></tr></table></figure><p>ç±»ä¼¼åœ°ï¼Œå°‘äºäºŒåä¸‡äººèµçš„ç”µå½±ï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.find</span>(&#123;<span class="hljs-attribute">likes</span>:&#123;$lt:<span class="hljs-number">200000</span>&#125;&#125;)<span class="hljs-selector-class">.pretty</span>()<br><br></code></pre></div></td></tr></table></figure><p>ç±»ä¼¼çš„è¿ç®—ç¬¦è¿˜æœ‰ï¼š<code>$lte</code>:å°äºæˆ–ç­‰äºï¼›<code>$gte</code>:å¤§äºæˆ–ç­‰äºï¼›<code>$ne</code>:ä¸ç­‰äºã€‚</p><p>æ³¨æ„ï¼Œå¯¹äºåŒ…å«å¤šä¸ªå€¼çš„keyï¼ŒåŒæ ·å¯ä»¥ç”¨findæ¥æŸ¥è¯¢ã€‚æ¯”å¦‚ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">db.movie.<span class="hljs-builtin-name">find</span>(&#123;<span class="hljs-string">&#x27;tags&#x27;</span>:<span class="hljs-string">&#x27;romance&#x27;</span>&#125;)<br><br></code></pre></div></td></tr></table></figure><p>å°†è¿”å›ã€Šé˜¿ç”˜æ­£ä¼ ã€‹ï¼Œè™½ç„¶å…¶æ ‡ç­¾æ—¢æœ‰romanceï¼Œåˆæœ‰dramaï¼Œä½†åªè¦ç¬¦åˆä¸€ä¸ªå°±å¯ä»¥äº†ã€‚</p><p>å¦‚æœä½ ç¡®åˆ‡åœ°çŸ¥é“è¿”å›çš„ç»“æœåªæœ‰ä¸€ä¸ªï¼Œä¹Ÿå¯ä»¥ç”¨<code>findOne</code>:</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">db<span class="hljs-selector-class">.movie</span>.findOne(&#123;<span class="hljs-string">&#x27;title&#x27;</span>:<span class="hljs-string">&#x27;Forrest Gump&#x27;</span>&#125;)<br><br></code></pre></div></td></tr></table></figure><p>å¦‚æœæœ‰å¤šä¸ªç»“æœï¼Œåˆ™ä¼šæŒ‰ç£ç›˜å­˜å‚¨é¡ºåºè¿”å›ç¬¬ä¸€ä¸ªã€‚è¯·æ³¨æ„ï¼Œ<code>findOne()</code>è‡ªå¸¦prettyæ¨¡å¼ï¼Œæ‰€ä»¥ä¸èƒ½å†åŠ <code>pretty()</code>ï¼Œå°†æŠ¥é”™ã€‚</p><p>å¦‚æœç»“æœå¾ˆå¤šè€Œä½ åªæƒ³æ˜¾ç¤ºå…¶ä¸­ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨<code>limit()</code>å’Œ<code>skip()</code>ï¼Œå‰è€…æŒ‡æ˜è¾“å‡ºçš„ä¸ªæ•°ï¼Œåè€…æŒ‡æ˜ä»ç¬¬äºŒä¸ªç»“æœå¼€å§‹æ•°ã€‚æ¯”å¦‚ï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.find</span>()<span class="hljs-selector-class">.limit</span>(2)<span class="hljs-selector-class">.skip</span>(1)<span class="hljs-selector-class">.pretty</span>()<br><br></code></pre></div></td></tr></table></figure><p>åˆ™è·³è¿‡ç¬¬ä¸€éƒ¨ï¼Œä»ç¬¬äºŒéƒ¨å¼€å§‹é€‰å–ä¸¤éƒ¨ç”µå½±ã€‚</p><h4 id="7-å±€éƒ¨æŸ¥è¯¢"><a href="#7-å±€éƒ¨æŸ¥è¯¢" class="headerlink" title="7. å±€éƒ¨æŸ¥è¯¢"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#7-%E5%B1%80%E9%83%A8%E6%9F%A5%E8%AF%A2"></a>7. å±€éƒ¨æŸ¥è¯¢</h4><p>ç¬¬äº”èŠ‚çš„æ—¶å€™æˆ‘ä»¬è®²äº†<code>find</code>çš„ç”¨æ³•ï¼Œä½†å¯¹äºç¬¦åˆæ¡ä»¶çš„æ¡ç›®ï¼Œæˆ‘ä»¬éƒ½æ˜¯è¿”å›æ•´ä¸ªJSONæ–‡ä»¶çš„ã€‚è¿™ç±»ä¼¼äºSQLé‡Œé¢çš„<code>SELECT *</code>ã€‚æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦çš„ï¼Œä»…ä»…æ˜¯éƒ¨åˆ†æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œ<code>find</code>çš„å±€éƒ¨æŸ¥è¯¢çš„åŠŸèƒ½å°±æ´¾ä¸Šç”¨åœºäº†ã€‚å…ˆæ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œè¿”å›tagsä¸ºdramaçš„ç”µå½±çš„åå­—å’Œé¦–æ˜ æ—¥æœŸã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">db.movie.<span class="hljs-builtin-name">find</span>(&#123;<span class="hljs-string">&#x27;tags&#x27;</span>:<span class="hljs-string">&#x27;drama&#x27;</span>&#125;,&#123;<span class="hljs-string">&#x27;debut&#x27;</span>:1,<span class="hljs-string">&#x27;title&#x27;</span>:1&#125;).pretty()<br><br></code></pre></div></td></tr></table></figure><p>æ•°æ®åº“å°†è¿”å›ï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br><span class="hljs-attr">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;549cfb42f685c085f1dd47d4&quot;</span>),<br><span class="hljs-attr">&quot;title&quot;</span> : <span class="hljs-string">&quot;Forrest Gump&quot;</span>,<br><span class="hljs-attr">&quot;debut&quot;</span> : ISODate(<span class="hljs-string">&quot;1994-08-05T16:00:00Z&quot;</span>)<br>&#125;<br>&#123;<br><span class="hljs-attr">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;549cff96f685c085f1dd47d6&quot;</span>),<br><span class="hljs-attr">&quot;title&quot;</span> : <span class="hljs-string">&quot;Fight Club&quot;</span>,<br><span class="hljs-attr">&quot;debut&quot;</span> : ISODate(<span class="hljs-string">&quot;1999-11-14T16:00:00Z&quot;</span>)<br>&#125;<br>&#123;<br><span class="hljs-attr">&quot;_id&quot;</span> : ObjectId(<span class="hljs-string">&quot;549cff96f685c085f1dd47d7&quot;</span>),<br><span class="hljs-attr">&quot;title&quot;</span> : <span class="hljs-string">&quot;Seven&quot;</span>,<br><span class="hljs-attr">&quot;debut&quot;</span> : ISODate(<span class="hljs-string">&quot;1995-10-21T16:00:00Z&quot;</span>)<br>&#125;<br><br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œfindçš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨æ¥æ§åˆ¶è¾“å‡ºçš„ï¼Œ1è¡¨ç¤ºè¦è¿”å›ï¼Œè€Œ0åˆ™è¡¨ç¤ºä¸è¿”å›ã€‚é»˜è®¤å€¼æ˜¯0ï¼Œä½†<code>_id</code>æ˜¯ä¾‹å¤–ï¼Œå› æ­¤å¦‚æœä½ ä¸æƒ³è¾“å‡º<code>_id</code>ï¼Œéœ€è¦æ˜¾å¼åœ°å£°æ˜ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">db.movie.<span class="hljs-builtin-name">find</span>(&#123;<span class="hljs-string">&#x27;tags&#x27;</span>:<span class="hljs-string">&#x27;drama&#x27;</span>&#125;,&#123;<span class="hljs-string">&#x27;debut&#x27;</span>:1,<span class="hljs-string">&#x27;title&#x27;</span>:1,<span class="hljs-string">&#x27;_id&#x27;</span>:0&#125;).pretty()<br><br></code></pre></div></td></tr></table></figure><h4 id="8-æ›´æ–°"><a href="#8-æ›´æ–°" class="headerlink" title="8. æ›´æ–°"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#8-%E6%9B%B4%E6%96%B0"></a>8. æ›´æ–°</h4><p>å¾ˆå¤šæƒ…å†µä¸‹ä½ éœ€è¦æ›´æ–°ä½ çš„æ•°æ®åº“ï¼Œæ¯”å¦‚æœ‰äººå¯¹æŸéƒ¨ç”µå½±ç‚¹äº†ä¸ªèµï¼Œé‚£ä¹ˆä½ éœ€è¦æ›´æ–°ç›¸åº”çš„æ•°æ®åº“ã€‚æ¯”å¦‚æœ‰äººå¯¹ã€Šä¸ƒå®—ç½ªã€‹ç‚¹äº†ä¸ªèµï¼Œè€Œå®ƒæœ¬æ¥çš„èµçš„ä¸ªæ•°æ˜¯134370ï¼Œé‚£ä¹ˆä½ éœ€è¦æ›´æ–°åˆ°134371ã€‚å¯ä»¥è¿™æ ·æ“ä½œï¼š</p><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.update</span>(&#123;<span class="hljs-attribute">title</span>:<span class="hljs-string">&#x27;Seven&#x27;</span>&#125;, &#123;$<span class="hljs-attribute">set</span>:&#123;<span class="hljs-attribute">likes</span>:<span class="hljs-number">134371</span>&#125;&#125;)<br><br></code></pre></div></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå¤§æ‹¬å·é‡Œè¡¨æ˜è¦é€‰å–çš„å¯¹è±¡ï¼Œç¬¬äºŒä¸ªè¡¨æ˜è¦æ”¹åŠ¨çš„æ•°æ®ã€‚è¯·æ³¨æ„ä¸Šè¿°çš„æ“ä½œç›¸å½“ä¸ç°å®ï¼Œå› ä¸ºä½ é¦–å…ˆè¦çŸ¥é“ä¹‹å‰çš„æ•°å­—æ˜¯å¤šå°‘ï¼Œç„¶ååŠ ä¸€ï¼Œä½†é€šå¸¸ä½ ä¸è¯»å–æ•°æ®åº“çš„è¯ï¼Œæ˜¯ä¸ä¼šçŸ¥é“è¿™ä¸ªæ•°(134370)çš„ã€‚MongoDBæä¾›äº†ä¸€ç§ç®€ä¾¿çš„æ–¹æ³•ï¼Œå¯ä»¥å¯¹ç°æœ‰æ¡ç›®è¿›è¡Œå¢é‡æ“ä½œã€‚å‡è®¾åˆæœ‰äººå¯¹ã€Šä¸ƒå®—ç½ªã€‹ç‚¹äº†ä¸¤ä¸ªèµï¼Œåˆ™å¯ä»¥ï¼š</p><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.update</span>(&#123;<span class="hljs-attribute">title</span>:<span class="hljs-string">&#x27;Seven&#x27;</span>&#125;, &#123;$<span class="hljs-attribute">inc</span>:&#123;<span class="hljs-attribute">likes</span>:<span class="hljs-number">2</span>&#125;&#125;)<br><br></code></pre></div></td></tr></table></figure><p>å¦‚æœä½ æŸ¥è¯¢çš„è¯ï¼Œä¼šå‘ç°ç‚¹èµæ•°å˜ä¸º134373äº†ï¼Œè¿™é‡Œç”¨çš„æ˜¯<code>$inc</code>ã€‚é™¤äº†å¢é‡æ›´æ–°ï¼ŒMongoDBè¿˜æä¾›äº†å¾ˆå¤šçµæ´»çš„æ›´æ–°é€‰é¡¹ï¼Œå…·ä½“å¯ä»¥çœ‹ï¼š<a href="http://docs.mongodb.org/manual/reference/operator/update-field/">http://docs.mongodb.org/manual/reference/operator/update-field/</a> ã€‚</p><p>æ³¨æ„å¦‚æœæœ‰å¤šéƒ¨ç¬¦åˆè¦æ±‚çš„ç”µå½±ã€‚åˆ™é»˜è®¤åªä¼šæ›´æ–°ç¬¬ä¸€ä¸ªã€‚å¦‚æœè¦å¤šä¸ªåŒæ—¶æ›´æ–°ï¼Œè¦è®¾ç½®<code>&#123;multi:true&#125;</code>ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š</p><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.update</span>(&#123;&#125;, &#123;$<span class="hljs-attribute">inc</span>:&#123;<span class="hljs-attribute">likes</span>:<span class="hljs-number">10</span>&#125;&#125;,&#123;<span class="hljs-attribute">multi</span>:true&#125;)<br><br></code></pre></div></td></tr></table></figure><p>æ‰€æœ‰ç”µå½±çš„èµæ•°éƒ½å¤šäº†10.</p><p>æ³¨æ„ï¼Œä»¥ä¸Šçš„æ›´æ–°æ“ä½œä¼šæ›¿æ¢æ‰åŸæ¥çš„å€¼ï¼Œæ‰€ä»¥å¦‚æœä½ æ˜¯æƒ³åœ¨åŸæœ‰çš„å€¼å¾—åŸºç¡€ä¸Šå¢åŠ ä¸€ä¸ªå€¼çš„è¯ï¼Œåˆ™åº”è¯¥ç”¨<code>$push</code>ï¼Œæ¯”å¦‚ï¼Œä¸ºã€Šä¸ƒå®—ç½ªã€‹æ·»åŠ ä¸€ä¸ªpopularçš„tagsã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs stylus">db<span class="hljs-selector-class">.movie</span>.update(&#123;<span class="hljs-string">&#x27;title&#x27;</span>:<span class="hljs-string">&#x27;Seven&#x27;</span>&#125;, &#123;<span class="hljs-variable">$push</span>:&#123;<span class="hljs-string">&#x27;tags&#x27;</span>:<span class="hljs-string">&#x27;popular&#x27;</span>&#125;&#125;)<br><br></code></pre></div></td></tr></table></figure><p>ä½ ä¼šå‘ç°ã€Šä¸ƒå®—ç½ªã€‹ç°åœ¨æœ‰å››ä¸ªæ ‡ç­¾ï¼š</p><figure class="highlight ada"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ada"><span class="hljs-string">&quot;tags&quot;</span> : [<br><span class="hljs-string">&quot;drama&quot;</span>,<br><span class="hljs-string">&quot;mystery&quot;</span>,<br><span class="hljs-string">&quot;thiller&quot;</span>,<br><span class="hljs-string">&quot;popular&quot;</span><br>],<br><br></code></pre></div></td></tr></table></figure><h4 id="9-åˆ é™¤"><a href="#9-åˆ é™¤" class="headerlink" title="9. åˆ é™¤"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#9-%E5%88%A0%E9%99%A4"></a>9. åˆ é™¤</h4><p>åˆ é™¤çš„å¥æ³•å’Œfindå¾ˆç›¸ä¼¼ï¼Œæ¯”å¦‚ï¼Œè¦åˆ é™¤æ ‡ç­¾ä¸ºromanceçš„ç”µå½±ï¼Œåˆ™ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">db.movie.<span class="hljs-builtin-name">remove</span>(&#123;<span class="hljs-string">&#x27;tags&#x27;</span>:<span class="hljs-string">&#x27;romance&#x27;</span>&#125;)<br><br></code></pre></div></td></tr></table></figure><p>è€ƒè™‘åˆ°æˆ‘ä»¬æ•°æ®åº“æ¡ç›®å¼‚å¸¸ç¨€å°‘ï¼Œå°±ä¸å»ºè®®ä½ æ‰§è¡Œè¿™æ¡å‘½ä»¤äº†~</p><p>æ³¨æ„ï¼Œä¸Šé¢çš„ä¾‹å­ä¼šåˆ é™¤æ‰€æœ‰æ ‡ç­¾åŒ…å«romanceçš„ç”µå½±ã€‚å¦‚æœä½ åªæƒ³åˆ é™¤ç¬¬ä¸€ä¸ªï¼Œåˆ™</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">db.movie.<span class="hljs-builtin-name">remove</span>(&#123;<span class="hljs-string">&#x27;tags&#x27;</span>:<span class="hljs-string">&#x27;romance&#x27;</span>&#125;,1)<br><br></code></pre></div></td></tr></table></figure><p>å¦‚æœä¸åŠ ä»»ä½•é™åˆ¶ï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.remove</span>()<br><br></code></pre></div></td></tr></table></figure><p>ä¼šåˆ é™¤movieè¿™ä¸ªé›†åˆä¸‹çš„æ‰€æœ‰æ–‡æ¡£ã€‚</p><h4 id="10-ç´¢å¼•å’Œæ’åº"><a href="#10-ç´¢å¼•å’Œæ’åº" class="headerlink" title="10. ç´¢å¼•å’Œæ’åº"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#10-%E7%B4%A2%E5%BC%95%E5%92%8C%E6%8E%92%E5%BA%8F"></a>10. ç´¢å¼•å’Œæ’åº</h4><p>ä¸ºæ–‡æ¡£ä¸­çš„ä¸€äº›keyåŠ ä¸Šç´¢å¼•(index)å¯ä»¥åŠ å¿«æœç´¢é€Ÿåº¦ã€‚è¿™ä¸€ç‚¹ä¸éš¾ç†è§£ï¼Œå‡å¦‚æ²¡æœ‰æ²¡æœ‰ç´¢å¼•ï¼Œæˆ‘ä»¬è¦æŸ¥æ‰¾åå­—ä¸ºSevençš„ç”µå½±ï¼Œå°±å¿…é¡»åœ¨æ‰€æœ‰æ–‡æ¡£é‡Œé€ä¸ªæœç´¢ã€‚è€Œå¦‚æœå¯¹åå­—è¿™ä¸ªkeyåŠ ä¸Šç´¢å¼•å€¼ï¼Œåˆ™ç”µå½±åè¿™ä¸ªå­—ç¬¦ä¸²å’Œæ•°å­—å»ºç«‹äº†æ˜ å°„ï¼Œè¿™æ ·åœ¨æœç´¢çš„æ—¶å€™å°±ä¼šå¿«å¾ˆå¤šã€‚æ’åºçš„æ—¶å€™ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œä¸èµ˜è¿°ã€‚MongoDBé‡Œé¢ä¸ºæŸä¸ªkeyåŠ ä¸Šç´¢å¼•çš„æ–¹å¼å¾ˆç®€å•ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦å¯¹å¯¼æ¼”è¿™ä¸ªkeyåŠ ç´¢å¼•ï¼Œåˆ™å¯ä»¥ï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.ensureIndex</span>(&#123;<span class="hljs-attribute">directed_by</span>:<span class="hljs-number">1</span>&#125;)<br><br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œçš„1æ˜¯å‡åºç´¢å¼•ï¼Œå¦‚æœè¦é™åºç´¢å¼•ï¼Œç”¨-1ã€‚</p><p>MongoDBæ”¯æŒå¯¹è¾“å‡ºè¿›è¡Œæ’åºï¼Œæ¯”å¦‚æŒ‰åå­—æ’åºï¼š</p><figure class="highlight dos"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dos">db.movie.<span class="hljs-built_in">find</span>().<span class="hljs-built_in">sort</span>(&#123;&#x27;<span class="hljs-built_in">title</span>&#x27;:<span class="hljs-number">1</span>&#125;).pretty()<br><br></code></pre></div></td></tr></table></figure><p>åŒæ ·åœ°ï¼Œ1æ˜¯å‡åºï¼Œ-1æ˜¯é™åºã€‚é»˜è®¤æ˜¯1ã€‚</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.getIndexes</span>()<br><br></code></pre></div></td></tr></table></figure><p>å°†è¿”å›æ‰€æœ‰ç´¢å¼•ï¼ŒåŒ…æ‹¬å…¶åå­—ã€‚</p><p>è€Œ</p><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.dropIndex</span>(<span class="hljs-string">&#x27;index_name&#x27;</span>)<br><br></code></pre></div></td></tr></table></figure><p>å°†åˆ é™¤å¯¹åº”çš„ç´¢å¼•ã€‚</p><h4 id="11-èšåˆ"><a href="#11-èšåˆ" class="headerlink" title="11. èšåˆ"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#11-%E8%81%9A%E5%90%88"></a>11. èšåˆ</h4><p>MongoDBæ”¯æŒç±»ä¼¼äºSQLé‡Œé¢çš„<code>GROUP BY</code>æ“ä½œã€‚æ¯”å¦‚å½“æœ‰ä¸€å¼ å­¦ç”Ÿæˆç»©çš„æ˜ç»†è¡¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾å‡ºæ¯ä¸ªåˆ†æ•°æ®µçš„å­¦ç”Ÿå„æœ‰å¤šå°‘ã€‚ä¸ºäº†å®ç°è¿™ä¸ªæ“ä½œï¼Œæˆ‘ä»¬éœ€è¦ç¨åŠ æ”¹åŠ¨æˆ‘ä»¬çš„æ•°æ®åº“ã€‚æ‰§è¡Œä»¥ä¸‹ä¸‰æ¡å‘½ä»¤ï¼š</p><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.update</span>(&#123;<span class="hljs-attribute">title</span>:<span class="hljs-string">&#x27;Seven&#x27;</span>&#125;,&#123;$<span class="hljs-attribute">set</span>:&#123;<span class="hljs-attribute">grade</span>:<span class="hljs-number">1</span>&#125;&#125;)<br><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.update</span>(&#123;<span class="hljs-attribute">title</span>:<span class="hljs-string">&#x27;Forrest Gump&#x27;</span>&#125;,&#123;$<span class="hljs-attribute">set</span>:&#123;<span class="hljs-attribute">grade</span>:<span class="hljs-number">1</span>&#125;&#125;)<br><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.update</span>(&#123;<span class="hljs-attribute">title</span>:<span class="hljs-string">&#x27;Fight Club&#x27;</span>&#125;,&#123;$<span class="hljs-attribute">set</span>:&#123;<span class="hljs-attribute">grade</span>:<span class="hljs-number">2</span>&#125;&#125;)<br><br></code></pre></div></td></tr></table></figure><p>è¿™å‡ æ¡æ˜¯ç»™æ¯éƒ¨ç”µå½±åŠ ä¸€ä¸ªè™šæ‹Ÿçš„åˆ†çº§ï¼Œå‰ä¸¤éƒ¨æ˜¯å½’ç±»æ˜¯ä¸€çº§ï¼Œåä¸€éƒ¨æ˜¯äºŒçº§ã€‚</p><p>è¿™é‡Œä½ ä¹Ÿå¯ä»¥çœ‹åˆ°MongoDBçš„å¼ºå¤§ä¹‹å¤„ï¼šå¯ä»¥åŠ¨æ€åœ°åç»­æ·»åŠ å„ç§æ–°é¡¹ç›®ã€‚</p><p>æˆ‘ä»¬å…ˆé€šè¿‡èšåˆæ¥æ‰¾å‡ºæ€»å…±æœ‰å‡ ç§çº§åˆ«ã€‚</p><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.aggregate</span>([&#123;$<span class="hljs-attribute">group</span>:&#123;<span class="hljs-attribute">_id</span>:<span class="hljs-string">&#x27;$grade&#x27;</span>&#125;&#125;])<br><br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123; <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-number">2</span> &#125;<br>&#123; <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-number">1</span> &#125;<br><br></code></pre></div></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œçš„2å’Œ1æ˜¯æŒ‡çº§åˆ«ï¼Œè€Œä¸æ˜¯æ¯ä¸ªçº§åˆ«çš„ç”µå½±æ•°ã€‚è¿™ä¸ªä¾‹å­çœ‹å¾—æ¸…æ¥šäº›ï¼š</p><figure class="highlight less"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs less"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.aggregate</span>([&#123;$<span class="hljs-attribute">group</span>:&#123;<span class="hljs-attribute">_id</span>:<span class="hljs-string">&#x27;$directed_by&#x27;</span>&#125;&#125;])<br><br></code></pre></div></td></tr></table></figure><p>è¿™é‡ŒæŒ‰ç…§å¯¼æ¼”åå­—è¿›è¡Œèšåˆã€‚è¾“å‡ºï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123; <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;David Fincher&quot;</span> &#125;<br>&#123; <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;Robert Zemeckis&quot;</span> &#125;<br><br></code></pre></div></td></tr></table></figure><p>æ¥ç€æˆ‘ä»¬è¦æ‰¾å‡ºï¼Œæ¯ä¸ªå¯¼æ¼”çš„ç”µå½±æ•°åˆ†åˆ«æœ‰å¤šå°‘ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs groovy">db.movie.aggregate([&#123;<span class="hljs-attr">$group:</span>&#123;<span class="hljs-attr">_id:</span><span class="hljs-string">&#x27;$directed_by&#x27;</span>,<span class="hljs-attr">num_movie:</span>&#123;<span class="hljs-attr">$sum:</span><span class="hljs-number">1</span>&#125;&#125;&#125;])<br><br></code></pre></div></td></tr></table></figure><p>å°†ä¼šè¾“å‡ºï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123; <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;David Fincher&quot;</span>, <span class="hljs-attr">&quot;num_movie&quot;</span> : <span class="hljs-number">2</span> &#125;<br>&#123; <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;Robert Zemeckis&quot;</span>, <span class="hljs-attr">&quot;num_movie&quot;</span> : <span class="hljs-number">1</span> &#125;<br><br></code></pre></div></td></tr></table></figure><p>æ³¨æ„$sumåé¢çš„1è¡¨ç¤ºåªæ˜¯æŠŠç”µå½±æ•°åŠ èµ·æ¥ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥ç»Ÿè®¡åˆ«çš„æ•°æ®ï¼Œæ¯”å¦‚ä¸¤ä½å¯¼æ¼”è°çš„èµæ¯”è¾ƒå¤šï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs groovy">db.movie.aggregate([&#123;<span class="hljs-attr">$group:</span>&#123;<span class="hljs-attr">_id:</span><span class="hljs-string">&#x27;$directed_by&#x27;</span>,<span class="hljs-attr">num_likes:</span>&#123;<span class="hljs-attr">$sum:</span><span class="hljs-string">&#x27;$likes&#x27;</span>&#125;&#125;&#125;])<br><br></code></pre></div></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123; <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;David Fincher&quot;</span>, <span class="hljs-attr">&quot;num_likes&quot;</span> : <span class="hljs-number">358753</span> &#125;<br>&#123; <span class="hljs-attr">&quot;_id&quot;</span> : <span class="hljs-string">&quot;Robert Zemeckis&quot;</span>, <span class="hljs-attr">&quot;num_likes&quot;</span> : <span class="hljs-number">864377</span> &#125;<br><br></code></pre></div></td></tr></table></figure><p>æ³¨æ„è¿™äº›æ•°æ®éƒ½çº¯å±è™šæ„å•Šï¼</p><p>é™¤äº†<code>$sum</code>ï¼Œè¿˜æœ‰å…¶å®ƒä¸€äº›æ“ä½œã€‚æ¯”å¦‚ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs groovy">db.movie.aggregate([&#123;<span class="hljs-attr">$group:</span>&#123;<span class="hljs-attr">_id:</span><span class="hljs-string">&#x27;$directed_by&#x27;</span>,<span class="hljs-attr">num_movie:</span>&#123;<span class="hljs-attr">$avg:</span><span class="hljs-string">&#x27;$likes&#x27;</span>&#125;&#125;&#125;])<br><br></code></pre></div></td></tr></table></figure><p>ç»Ÿè®¡å¹³å‡çš„èµã€‚</p><figure class="highlight groovy"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs groovy">db.movie.aggregate([&#123;<span class="hljs-attr">$group:</span>&#123;<span class="hljs-attr">_id:</span><span class="hljs-string">&#x27;$directed_by&#x27;</span>,<span class="hljs-attr">num_movie:</span>&#123;<span class="hljs-attr">$first:</span><span class="hljs-string">&#x27;$likes&#x27;</span>&#125;&#125;&#125;])<br><br></code></pre></div></td></tr></table></figure><p>è¿”å›æ¯ä¸ªå¯¼æ¼”çš„ç”µå½±ä¸­çš„ç¬¬ä¸€éƒ¨çš„èµæ•°ã€‚</p><p>å…¶å®ƒå„ç§æ“ä½œå¯ä»¥å‚è€ƒï¼š<a href="http://docs.mongodb.org/manual/reference/operator/aggregation/group/">http://docs.mongodb.org/manual/reference/operator/aggregation/group/</a> ã€‚</p><h4 id="12-All-or-Nothing"><a href="#12-All-or-Nothing" class="headerlink" title="12. All or Nothing?"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#12-all-or-nothing"></a>12. All or Nothing?</h4><p>MongoDBæ”¯æŒå•ä¸ªæ–‡æ¡£å†…çš„åŸå­åŒ–æ“ä½œ(atomic operation)ï¼Œè¿™æ˜¯è¯´ï¼Œå¯ä»¥å°†å¤šæ¡å…³äºåŒä¸€ä¸ªæ–‡æ¡£çš„æŒ‡ä»¤æ”¾åˆ°ä¸€èµ·ï¼Œä»–ä»¬è¦ä¹ˆä¸€èµ·æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œã€‚è€Œä¸ä¼šæ‰§è¡Œåˆ°ä¸€åŠã€‚æœ‰äº›åœºåˆéœ€è¦ç¡®ä¿å¤šæ¡æ‰§è¡Œä¸€èµ·é¡ºæ¬¡æ‰§è¡Œã€‚æ¯”å¦‚ä¸€ä¸ªåœºæ™¯ï¼šä¸€ä¸ªç”µå•†ç½‘ç«™ï¼Œç”¨æˆ·æŸ¥è¯¢æŸç§å•†å“çš„å‰©ä½™æ•°é‡ï¼Œä»¥åŠç”¨æˆ·è´­ä¹°è¯¥ç§å•†å“ï¼Œè¿™ä¸¤ä¸ªæ“ä½œï¼Œå¿…é¡»æ”¾åœ¨ä¸€èµ·æ‰§è¡Œã€‚ä¸ç„¶çš„è¯ï¼Œå‡å®šæˆ‘ä»¬å…ˆæ‰§è¡Œå‰©ä½™æ•°é‡çš„æŸ¥è¯¢ï¼Œè¿™æ˜¯å‡å®šä¸º1ï¼Œç”¨æˆ·æ¥ç€è´­ä¹°ï¼Œä½†å‡å¦‚è¿™ä¸¤ä¸ªæ“ä½œä¹‹é—´è¿˜åŠ å…¥äº†å…¶å®ƒæ“ä½œï¼Œæ¯”å¦‚å¦ä¸€ä¸ªç”¨æˆ·æŠ¢å…ˆè´­ä¹°äº†ï¼Œé‚£ä¹ˆåŸå…ˆè´­ä¹°ç”¨æˆ·çš„è´­ä¹°çš„è¡Œä¸ºå°±ä¼šé€ æˆæ•°æ®åº“çš„é”™è¯¯ï¼Œå› ä¸ºå®é™…ä¸Šè¿™ç§å•†å“ä»¥åŠæ²¡æœ‰å­˜è´§äº†ã€‚ä½†å› ä¸ºæŸ¥è¯¢å‰©ä½™æ•°é‡å’Œè´­ä¹°ä¸æ˜¯åœ¨ä¸€ä¸ªâ€œåŸå­åŒ–æ“ä½œâ€ä¹‹å†…ï¼Œå› æ­¤ä¼šå‘ç”Ÿè¿™æ ·çš„é”™è¯¯<a href="http://www.tutorialspoint.com/mongodb/mongodb_atomic_operations.htm">[2]</a>ã€‚</p><p>MongoDBæä¾›äº†<code>findAndModify</code>çš„æ–¹æ³•æ¥ç¡®ä¿atomic operationã€‚æ¯”å¦‚è¿™æ ·çš„ï¼š</p><figure class="highlight groovy"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs groovy">db.movie.findAndModify(<br>&#123;<br><span class="hljs-symbol">query:</span>&#123;<span class="hljs-string">&#x27;title&#x27;</span>:<span class="hljs-string">&#x27;Forrest Gump&#x27;</span>&#125;,<br><span class="hljs-symbol">update:</span>&#123;<span class="hljs-attr">$inc:</span>&#123;<span class="hljs-attr">likes:</span><span class="hljs-number">10</span>&#125;&#125;<br>&#125;<br>      )<br><br></code></pre></div></td></tr></table></figure><p>queryæ˜¯æŸ¥æ‰¾å‡ºåŒ¹é…çš„æ–‡æ¡£ï¼Œå’Œfindæ˜¯ä¸€æ ·çš„ï¼Œè€Œupdateåˆ™æ˜¯æ›´æ–°likesè¿™ä¸ªé¡¹ç›®ã€‚æ³¨æ„ç”±äºMongoDBåªæ”¯æŒå•ä¸ªæ–‡æ¡£çš„atomic operationï¼Œå› æ­¤å¦‚æœqueryå‡ºå¤šäºä¸€ä¸ªæ–‡æ¡£ï¼Œåˆ™åªä¼šå¯¹ç¬¬ä¸€ä¸ªæ–‡æ¡£è¿›è¡Œæ“ä½œã€‚</p><p><code>findAndModify</code>è¿˜æ”¯æŒæ›´å¤šçš„æ“ä½œï¼Œå…·ä½“è§ï¼š<a href="http://docs.mongodb.org/manual/reference/command/findAndModify/%E3%80%82">http://docs.mongodb.org/manual/reference/command/findAndModify/ã€‚</a></p><h4 id="13-æ–‡æœ¬æœç´¢"><a href="#13-æ–‡æœ¬æœç´¢" class="headerlink" title="13. æ–‡æœ¬æœç´¢"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#13-%E6%96%87%E6%9C%AC%E6%90%9C%E7%B4%A2"></a>13. æ–‡æœ¬æœç´¢</h4><p>é™¤äº†å‰é¢ä»‹ç»çš„å„ç§æ·±åº¦æŸ¥è¯¢åŠŸèƒ½ï¼ŒMongoDBè¿˜æ”¯æŒæ–‡æœ¬æœç´¢ã€‚å¯¹æ–‡æœ¬æœç´¢ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¹è¦æœç´¢çš„keyå»ºç«‹ä¸€ä¸ªtextç´¢å¼•ã€‚å‡å®šæˆ‘ä»¬è¦å¯¹æ ‡é¢˜è¿›è¡Œæ–‡æœ¬æœç´¢ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè¿™æ ·ï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.ensureIndex</span>(&#123;<span class="hljs-attribute">title</span>:<span class="hljs-string">&#x27;text&#x27;</span>&#125;)<br><br></code></pre></div></td></tr></table></figure><p>æ¥ç€æˆ‘ä»¬å°±å¯ä»¥å¯¹æ ‡é¢˜è¿›è¡Œæ–‡æœ¬æœç´¢äº†ï¼Œæ¯”å¦‚ï¼ŒæŸ¥æ‰¾å¸¦æœ‰â€Gumpâ€çš„æ ‡é¢˜ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">db.movie.<span class="hljs-builtin-name">find</span>(&#123;<span class="hljs-variable">$text</span>:&#123;<span class="hljs-variable">$search</span>:<span class="hljs-string">&quot;Gump&quot;</span>&#125;&#125;).pretty()<br><br></code></pre></div></td></tr></table></figure><p>æ³¨æ„textå’Œsearchå‰é¢çš„$ç¬¦å·ã€‚</p><p>è¿™ä¸ªä¾‹å­é‡Œï¼Œæ–‡æœ¬æœç´¢ä½œç”¨ä¸æ˜¯éå¸¸æ˜æ˜¾ã€‚ä½†å‡è®¾æˆ‘ä»¬è¦æœç´¢çš„keyæ˜¯ä¸€ä¸ªé•¿é•¿çš„æ–‡æ¡£ï¼Œè¿™ç§text searchçš„æ–¹ä¾¿æ€§å°±æ˜¾ç°å‡ºæ¥äº†ã€‚MongoDBç›®å‰æ”¯æŒ15ç§è¯­è¨€çš„æ–‡æœ¬æœç´¢ã€‚</p><h4 id="14-æ­£åˆ™è¡¨è¾¾å¼"><a href="#14-æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="14. æ­£åˆ™è¡¨è¾¾å¼"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#14-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"></a>14. æ­£åˆ™è¡¨è¾¾å¼</h4><p>MongoDBè¿˜æ”¯æŒåŸºäºæ­£åˆ™è¡¨è¾¾å¼çš„æŸ¥è¯¢ã€‚å¦‚æœä¸çŸ¥é“æ­£åˆ™è¡¨è¾¾å¼æ˜¯ä»€ä¹ˆï¼Œå¯ä»¥å‚è€ƒ<a href="http://en.wikipedia.org/wiki/Regular_expression">Wikipedia</a>ã€‚è¿™é‡Œç®€å•ä¸¾å‡ ä¸ªä¾‹å­ã€‚æ¯”å¦‚ï¼ŒæŸ¥æ‰¾æ ‡é¢˜ä»¥<code>b</code>ç»“å°¾çš„ç”µå½±ä¿¡æ¯ï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.find</span>(&#123;<span class="hljs-attribute">title</span>:&#123;$regex:<span class="hljs-string">&#x27;.*b$&#x27;</span>&#125;&#125;)<span class="hljs-selector-class">.pretty</span>()<br><br></code></pre></div></td></tr></table></figure><p>ä¹Ÿå¯ä»¥å†™æˆï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.find</span>(&#123;<span class="hljs-attribute">title</span>:/.*b$/&#125;)<span class="hljs-selector-class">.pretty</span>()<br><br></code></pre></div></td></tr></table></figure><p>æŸ¥æ‰¾å«æœ‰â€™Fightâ€™æ ‡é¢˜çš„ç”µå½±ï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.find</span>(&#123;<span class="hljs-attribute">title</span>:/Fight/&#125;)<span class="hljs-selector-class">.pretty</span>()<br><br></code></pre></div></td></tr></table></figure><p>æ³¨æ„ä»¥ä¸ŠåŒ¹é…éƒ½æ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œå¦‚æœä½ è¦è®©å…¶ä¸åŒºåˆ†å¤§å°å†™ï¼Œåˆ™å¯ä»¥ï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">db</span><span class="hljs-selector-class">.movie</span><span class="hljs-selector-class">.find</span>(&#123;<span class="hljs-attribute">title</span>:&#123;$regex:<span class="hljs-string">&#x27;fight.*b&#x27;</span>,$options:<span class="hljs-string">&#x27;$i&#x27;</span>&#125;&#125;)<span class="hljs-selector-class">.pretty</span>()<br><br></code></pre></div></td></tr></table></figure><p><code>$i</code>æ˜¯insensitiveçš„æ„æ€ã€‚è¿™æ ·çš„è¯ï¼Œå³ä½¿æ˜¯å°å†™çš„fightï¼Œä¹Ÿèƒ½æœåˆ°äº†ã€‚</p><h4 id="15-åè®°"><a href="#15-åè®°" class="headerlink" title="15. åè®°"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#15-%E5%90%8E%E8%AE%B0"></a>15. åè®°</h4><p>è‡³æ­¤ï¼ŒMongoDBçš„æœ€åŸºæœ¬çš„å†…å®¹å°±ä»‹ç»å¾—å·®ä¸å¤šäº†ã€‚å¦‚æœæœ‰ä»€ä¹ˆé—æ¼çš„ä»¥åæˆ‘ä¼šè¡¥ä¸Šä¾†ã€‚å¦‚æœä½ ä¸€è·¯çœ‹åˆ°åº•å®Œå…¨äº†è¿™ä¸ªå…¥é—¨æ•™ç¨‹ï¼Œæ­å–œä½ ï¼Œä½ ä¸€å®šæ˜¯ä¸€ä¸ªæœ‰æ¯…åŠ›çš„äººã€‚</p><p>æŠŠè¿™ä¸ªæ–‡æ¡£è¿‡ä¸€éï¼Œä¸ä¼šè®©ä½ å˜æˆä¸€ä¸ªMongoDBçš„ä¸“å®¶(å¦‚æœä¼šé‚£å°±å¤ªå¥‡æ€ªäº†)ã€‚ä½†å¦‚æœå®ƒèƒ½æˆ–å¤šæˆ–å°‘å‡å°‘ä½ ä¸Šæ‰‹çš„æ—¶é—´ï¼Œæˆ–è€…è®©ä½ æ„è¯†åˆ°â€œå’¦ï¼ŒMongoDBå…¶å®æ²¡é‚£ä¹ˆå¤æ‚â€ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•™ç¨‹çš„ç›®çš„ä¹Ÿå°±è¾¾åˆ°å•¦ã€‚</p><p>è¿™ä¸ªæ–‡æ¡£æ˜¯åŒ†å¿™å†™å°±çš„ï¼Œå‡ºé”™ç®€ç›´æ˜¯ä¸€å®šçš„ã€‚å¦‚æœæ‚¨å‘ç°äº†ä»»ä½•é”™è¯¯æˆ–è€…æœ‰å…³äºæœ¬æ–‡çš„ä»»ä½•å»ºè®®ï¼Œéº»çƒ¦å‘é‚®ä»¶ç»™æˆ‘ï¼ˆstevenslxie at gmail.comï¼‰æˆ–è€…åœ¨GitHubä¸Šç›´æ¥äº¤æµï¼Œä¸èƒœæ„Ÿæ¿€ã€‚</p><h4 id="è½¬è½½å£°æ˜"><a href="#è½¬è½½å£°æ˜" class="headerlink" title="è½¬è½½å£°æ˜"></a><a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md#%E8%BD%AC%E8%BD%BD%E5%A3%B0%E6%98%8E"></a>è½¬è½½å£°æ˜</h4><p>å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œå¯ä»¥éšæ„è½¬è½½ã€‚ä½†è¯·</p><ul><li>  æ ‡æ˜åŸä½œè€…StevenSLXie;</li><li>  æ ‡æ˜åŸé“¾æ¥(<a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md">https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md</a>);</li><li>  åœ¨å¯èƒ½çš„æƒ…å†µä¸‹è¯·ä¿æŒæ–‡æœ¬æ˜¾ç¤ºçš„ç¾è§‚ã€‚æ¯”å¦‚ï¼Œè¯·ä¸è¦ç›´æ¥ä¸€é”®å¤åˆ¶åˆ°åšå®¢ä¹‹ç±»ï¼Œå› ä¸ºä»£ç çš„æ˜¾ç¤ºæ•ˆæœå¯èƒ½éå¸¸ç³Ÿç³•;</li><li>  è¯·å°†è¿™ä¸ªè½¬è½½å£°æ˜åŒ…å«è¿›æ¥ï¼›</li></ul>]]></content>
    
    
    <categories>
      
      <category>è½¬è½½</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mongodb</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaç”Ÿæˆsitemapç½‘ç«™åœ°å›¾</title>
    <link href="/Java%E7%94%9F%E6%88%90sitemap%E7%BD%91%E7%AB%99%E5%9C%B0%E5%9B%BE.html"/>
    <url>/Java%E7%94%9F%E6%88%90sitemap%E7%BD%91%E7%AB%99%E5%9C%B0%E5%9B%BE.html</url>
    
    <content type="html"><![CDATA[<p>sitemap æ˜¯ä»€ä¹ˆï¼Ÿå¯¹åº”æ²¡æœ‰æ¥è§¦è¿‡ç½‘ç«™ SEO çš„åŒå­¦å¯èƒ½ä¸çŸ¥é“ï¼Œè¿™é‡Œå¼•ç”¨ä¸€ä¸‹ç™¾åº¦ç«™é•¿çš„ä¸€æ®µè§£é‡Šã€‚</p><blockquote><p>Sitemapï¼ˆå³ç«™ç‚¹åœ°å›¾ï¼‰å°±æ˜¯æ‚¨ç½‘ç«™ä¸Šå„ç½‘é¡µçš„åˆ—è¡¨ã€‚åˆ›å»ºå¹¶æäº¤Sitemapæœ‰åŠ©äºç™¾åº¦å‘ç°å¹¶äº†è§£æ‚¨ç½‘ç«™ä¸Šçš„æ‰€æœ‰ç½‘é¡µã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨Sitemapæä¾›æœ‰å…³æ‚¨ç½‘ç«™çš„å…¶ä»–ä¿¡æ¯ï¼Œå¦‚ä¸Šæ¬¡æ›´æ–°æ—¥æœŸã€Sitemapæ–‡ä»¶çš„æ›´æ–°é¢‘ç‡ç­‰ï¼Œä¾›ç™¾åº¦Spiderå‚è€ƒ</p></blockquote><p>ç®€å•æ¥è¯´ï¼Œsitemap å°±æ˜¯æœç´¢å¼•æ“çˆ¬è™«ä¾¿äºçˆ¬å–åˆ°ç½‘ç«™å†…çš„æ‰€æœ‰ç½‘é¡µã€‚</p><a id="more"></a><h2 id="SEOä¹‹åˆ"><a href="#SEOä¹‹åˆ" class="headerlink" title="SEOä¹‹åˆ"></a>SEOä¹‹åˆ</h2><p>ä¹‹å‰ç‰¹æ„é€šè¿‡ <code>site</code> æŒ‡ä»¤æŸ¥è¯¢è¿‡å…¬å¸åŒè¡Œä¸šç½‘ç«™çš„æ”¶å½•æƒ…å†µï¼Œå‘ç°æœç´¢å¼•æ“å¯¹äºæˆ‘å¸çš„ç½‘ç«™æ”¶å½•æ•°é‡çœŸçš„ä¸æ˜¯å·®äº†ä¸€æ˜ŸåŠç‚¹-.-ï¼ŒåŸå› å˜›ï¼Œå°±æ˜¯ä¸€ç›´æ²¡æœ‰ä¸“é—¨çš„äººåš SEO ä¼˜åŒ–å·¥ä½œã€‚</p><p>å‰å‡ ä¸ªæœˆæˆ‘å€’æ˜¯ç”Ÿæˆäº†ç½‘ç«™çš„ä¸€éƒ¨åˆ† sitemap æäº¤åˆ°ç¥é©¬æœç´¢ç«™é•¿å¹³å°ï¼Œä½†æ˜¯æ˜æ˜æ˜¯æŒ‰ç…§å®˜æ–¹æ–‡æ¡£æ ¼å¼ç”Ÿæˆçš„ï¼Œå´ä¸€ç›´æç¤ºæ ¼å¼ä¸å¯¹ï¼Œä¹Ÿä¸çŸ¥é“ä»€ä¹ˆæƒ…å†µï¼Œä¹Ÿæ²¡æœ‰å®˜æ–¹åé¦ˆæ¸ é“ï¼Œå°±ä¸äº†äº†ä¹‹äº†ã€‚æœ€è¿‘å…¬å¸æ–°æ‹›äº† SEO ä¸“å‘˜ï¼Œäºæ˜¯ä¾¿æœ‰äº†å®šæ—¶ç”Ÿæˆ sitemap æ–‡ä»¶çš„éœ€æ±‚ã€‚è¿™ç§ç”Ÿæˆçš„æ–‡ä»¶ä¸€èˆ¬éƒ½æ˜¯å¯¹å¤–ç›´æ¥å¯ä»¥è®¿é—®çš„ï¼Œå¯ä»¥é€šè¿‡ nginx é…ç½®é™æ€èµ„æºæ–‡ä»¶æ¥å®Œæˆã€‚</p><h2 id="éœ€æ±‚æ¢è®¨"><a href="#éœ€æ±‚æ¢è®¨" class="headerlink" title="éœ€æ±‚æ¢è®¨"></a>éœ€æ±‚æ¢è®¨</h2><p>sitemap çš„æ ¼å¼ä¸€èˆ¬æ˜¯ XML æ ¼å¼çš„ï¼Œç¬¬ä¸€ååº”å°±æ˜¯å¯ä»¥ä½¿ç”¨ DOM4J æ¥å®Œæˆï¼Œä½†æ˜¯åš SEO çš„åŒäº‹è¯´äº†ï¼Œå› ä¸º sitemap æ–‡ä»¶çš„é™åˆ¶ï¼ŒåŒä¸€ä¸ª sitemap æ–‡ä»¶æœ€å¤šæœ‰ 5 ä¸‡æ¡ URLï¼Œè¶…å‡º 5 ä¸‡æ¡ï¼Œå°±åº”è¯¥æ”¾å…¥åˆ°ä¸‹ä¸€ä¸ª sitemap æ–‡ä»¶å½“ä¸­å»ã€‚é€šè¿‡ DOM4J æ¥åšçš„è¯ï¼Œè¿˜éœ€è¦åˆ¤æ–­æ¡æ•°æ„Ÿè§‰æœ‰ç‚¹éº»çƒ¦(æ‡’)ï¼Œå°±ä¸Š gayhub æœäº†ä¸€ä¸‹ç›¸å…³çš„è½®å­ generate sitemapï¼Œæ‰¾åˆ°äº†ç°æˆçš„è½®å­ **<a href="https://github.com/dfabulich/sitemapgen4j">sitemapgen4j</a>**ï¼Œé¡¹ç›®çš„ README ä¸­ä½¿ç”¨æ–¹æ³•å†™çš„æ¯”è¾ƒå®Œå–„ï¼Œè¿™é‡Œä¸å†å¤šè¯´ã€‚</p><p>ä¸ºä»€ä¹ˆæ–‡æ¡£å¾ˆå®Œå–„çš„æƒ…å†µä¸‹ï¼Œæˆ‘è¦å†™è¿™ç¯‡åšå®¢å‘¢ï¼Ÿ(10æœˆç¬¬ä¸€ç¯‡ï¼Œå‡‘æ•°çš„(é€ƒ~)</p><p>ä¸Šæ–‡æåˆ°äº†ï¼Œå¦‚æœè¶…å‡ºäº† 5 ä¸‡æ¡éœ€è¦å†™å…¥å¦å¤–ä¸€ä¸ª sitemap å½“ä¸­ï¼Œè¿™ä¸ªåŠŸèƒ½ sitemapgen4j å·²ç»æ›¿æˆ‘ä»¬å®ç°äº†ï¼Œæ— éœ€æ‹…å¿ƒã€‚å¦‚æœè¶…å‡ºï¼Œç”Ÿæˆçš„æ–‡ä»¶å°±åƒæ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight crmsh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs crmsh">- article1.xml<br>- article2.xml<br>- article3.xml<br>- article4.xml<br></code></pre></div></td></tr></table></figure><p>è¿™æ ·çš„è¯ï¼Œåœ¨ç«™é•¿å¹³å°è¿™é‡Œï¼Œå¦‚æœæ–°å¢äº†æ–‡ä»¶å°±è¦æ–°å¢ä¸€æ¡sitemap ç½‘å€è®°å½•ï¼Œå¾ˆéº»çƒ¦ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/2018102115401243528566.png"></p><p>å¥½åœ¨ï¼Œæœç´¢å¼•æ“è€ƒè™‘åˆ°äº†è¿™ç§é—®é¢˜ï¼Œæœ‰ç›¸åº”çš„è§£å†³æ–¹æ³•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20181021154012451648209.png"></p><p>æˆ‘ä»¬æŠŠæ¯æ¬¡ç”Ÿæˆçš„ sitemap æ–‡ä»¶çš„åœ°å€ï¼Œæ·»åŠ åˆ°ä¸€ä¸ª sitemap ç´¢å¼•æ–‡ä»¶å½“ä¸­å»ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬åªéœ€è¦å‘å¹³å°æäº¤ä¸€ä¸ª sitemap ç´¢å¼•æ–‡ä»¶çš„åœ°å€å³å¯ã€‚</p><p>ä¸å¤šè¯´ï¼Œä»£ç è§ã€‚</p><h2 id="ç”Ÿæˆ-sitemap-æ–‡ä»¶"><a href="#ç”Ÿæˆ-sitemap-æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆ sitemap æ–‡ä»¶"></a>ç”Ÿæˆ sitemap æ–‡ä»¶</h2><p>é¦–å…ˆå¼•å…¥ sitemapgen4j ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.dfabulich<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>sitemapgen4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>ç¼–å†™ç”Ÿæˆ sitemap ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">generateSitemap</span><span class="hljs-params">()</span> </span>&#123;<br>    String tempPath = <span class="hljs-string">&quot;/home/seo&quot;</span>;<br>    <span class="hljs-comment">//String tempPath = System.getProperty(&quot;java.io.tmpdir&quot;) + File.separator + &quot;/seo/&quot;;</span><br>    File file = <span class="hljs-keyword">new</span> File(tempPath);<br>    <span class="hljs-keyword">if</span> (!file.exists()) &#123;<br>        file.mkdirs();<br>    &#125;<br>    String domain = <span class="hljs-string">&quot;https://www.domain.com&quot;</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        WebSitemapGenerator g1 = WebSitemapGenerator.builder(domain, file)<br>                .fileNamePrefix(<span class="hljs-string">&quot;article&quot;</span>).build();<br>        Date date = <span class="hljs-keyword">new</span> Date();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">21</span>; i++) &#123;<br>            WebSitemapUrl url = <span class="hljs-keyword">new</span> WebSitemapUrl.Options(domain + <span class="hljs-string">&quot;/article/&quot;</span> + i ).lastMod(date).build();<br>            g1.addUrl(url);<br>        &#125;<br><br>        WebSitemapGenerator g2 = WebSitemapGenerator.builder(domain, file)<br>                .fileNamePrefix(<span class="hljs-string">&quot;issue&quot;</span>).build();<br>        Date date2 = <span class="hljs-keyword">new</span> Date();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">21</span>; i++) &#123;<br>            WebSitemapUrl url = <span class="hljs-keyword">new</span> WebSitemapUrl.Options(domain + <span class="hljs-string">&quot;/issue/&quot;</span> + i ).lastMod(date2).build();<br>            g2.addUrl(url);<br>        &#125;<br><br>        List&lt;String&gt; fileNames = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br><br>        <span class="hljs-comment">// ç”Ÿæˆ sitemap æ–‡ä»¶</span><br>        List&lt;File&gt; articleFiles = g1.write();<br>        articleFiles.forEach(e -&gt; fileNames.add(e.getName()));<br>        List&lt;File&gt; issueFiles = g2.write();<br>        issueFiles.forEach(e -&gt; fileNames.add(e.getName()));<br><br>        <span class="hljs-comment">// æ„é€  sitemap_index ç”Ÿæˆå™¨</span><br>        W3CDateFormat dateFormat = <span class="hljs-keyword">new</span> W3CDateFormat(W3CDateFormat.Pattern.DAY);<br>        SitemapIndexGenerator sitemapIndexGenerator = <span class="hljs-keyword">new</span> SitemapIndexGenerator<br>                .Options(domain, <span class="hljs-keyword">new</span> File(tempPath + <span class="hljs-string">&quot;sitemap_index.xml&quot;</span>))<br>                .dateFormat(dateFormat)<br>                .autoValidate(<span class="hljs-keyword">true</span>)<br>                .build();<br><br>        fileNames.forEach(e -&gt; &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-comment">// ç»„è£… sitemap æ–‡ä»¶ URL åœ°å€</span><br>                sitemapIndexGenerator.addUrl(domain + <span class="hljs-string">&quot;/&quot;</span> + e);<br>            &#125; <span class="hljs-keyword">catch</span> (MalformedURLException e1) &#123;<br>                e1.printStackTrace();<br>            &#125;<br>        &#125;);<br><br>        <span class="hljs-comment">// ç”Ÿæˆ sitemap_index æ–‡ä»¶</span><br>        sitemapIndexGenerator.write();<br><br>    &#125; <span class="hljs-keyword">catch</span> (MalformedURLException e) &#123;<br>        e.printStackTrace();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="é€šè¿‡-Nginx-æä¾›ç»™å¤–éƒ¨è®¿é—®"><a href="#é€šè¿‡-Nginx-æä¾›ç»™å¤–éƒ¨è®¿é—®" class="headerlink" title="é€šè¿‡ Nginx æä¾›ç»™å¤–éƒ¨è®¿é—®"></a>é€šè¿‡ Nginx æä¾›ç»™å¤–éƒ¨è®¿é—®</h2><p>æ–‡ä»¶å·²ç»ç”Ÿæˆäº†ï¼Œå°±éœ€è¦å¯¹å¤–æä¾›è®¿é—®äº†ï¼Œè¿™é‡Œä½¿ç”¨ nginx æ¥å®ç°ï¼Œå¦‚æœç”¨ apache ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><p>ä¸Šæ–‡ç”Ÿæˆçš„æ–‡ä»¶æˆ‘æ”¾åœ¨äº† <strong>/home/seo</strong> ç›®å½•ä¸‹ï¼Œæ–‡ä»¶æœ‰</p><figure class="highlight crmsh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs crmsh">- seo<br>    - article1.xml<br>    - article2.xml<br>    - article3.xml<br>    - article4.xml<br>    - sitemap_index.xml<br></code></pre></div></td></tr></table></figure><p>ç°åœ¨ä¿®æ”¹ nginx é…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œè¯´æ˜ä¸€ä¸‹ï¼Œå› ä¸º sitemap ç”Ÿæˆä¸€ä»½å°±å¯ä»¥äº†ï¼Œä½†æ˜¯è¦é€šè¿‡åŸŸåèƒ½ç›´æ¥è®¿é—®åˆ°ï¼Œæ‰€ä»¥éœ€è¦åœ¨ nginx è·³è½¬ä¸€ä¸‹åˆ°æœ‰ sitemap æ–‡ä»¶çš„æœåŠ¡å™¨ã€‚</p><p>å­˜æ”¾ sitemap æ–‡ä»¶çš„ nginx é…ç½®å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs conf">server &#123;<br>    listen          8888;<br>    server_name     111.112.113.114;<br>    charset utf8;<br><br>    access_log logs&#x2F;access.log  main;<br><br>    location &#x2F; &#123;<br>        alias &#x2F;home&#x2F;seo&#x2F;;<br>        sendfile on;<br>        autoindex on;<br>        autoindex_exact_size off;<br>        autoindex_localtime on;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ ¹åŸŸåçš„ nginx é…ç½®æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs conf">server &#123;<br>    listen          80;<br>    server_name     www.domain.com;<br>    charset utf8;<br><br>    access_log logs&#x2F;access.log  main;<br><br>    location &#x2F;seo&#x2F; &#123;<br>        proxy_pass http:&#x2F;&#x2F;111.112.113.114:8888;<br>    &#125;<br>    <br>    location &#x2F; &#123;<br>        proxy_pass http:&#x2F;&#x2F;homeServer;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>æ³¨æ„: ç¬¬ä¸€ä¸ª locationå— ä¸­çš„ proxy_pass è¡Œå°¾æœ‰ä¸ª /</strong></p><p><a href="http://www.domain.com/seo/sitemap_index.xml">www.domain.com/seo/sitemap_index.xml</a><br>å°±ä¼šåœ¨ <a href="http://www.domain.com/">www.domain.com</a> è¿™é‡Œç›´æ¥åä»£åˆ° 111.112.113.114 è¿™å°æœåŠ¡å™¨ä¸Šäº†ã€‚</p><p>ç«™é•¿å¹³å°åªç”¨æäº¤è¿™ä¸€ä¸ª URL <strong><a href="http://www.domain.com/seo/sitemap_index.xml">www.domain.com/seo/sitemap_index.xml</a></strong> å³å¯ã€‚</p><h2 id="æœ‰ç–‘é—®"><a href="#æœ‰ç–‘é—®" class="headerlink" title="æœ‰ç–‘é—®?"></a>æœ‰ç–‘é—®?</h2><p>æ¬¢è¿æ¥ä¿¡ï¼Œ<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=JVNGSFRlQ0pdSERMSQtGSkg">ç»™æˆ‘å†™ä¿¡</a></p>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>javaç”Ÿæˆsitemap</tag>
      
      <tag>sitemapgen4jç”Ÿæˆsitemap</tag>
      
      <tag>seo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…³é”®è¯é«˜äº®</title>
    <link href="/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%B3%E9%94%AE%E8%AF%8D%E9%AB%98%E4%BA%AE.html"/>
    <url>/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%B3%E9%94%AE%E8%AF%8D%E9%AB%98%E4%BA%AE.html</url>
    
    <content type="html"><![CDATA[<p>å‰é¢å‡ ç¯‡æ–‡ç« è¯¦ç»†è®²è§£äº† ElasticSearch çš„æ­å»ºä»¥åŠä½¿ç”¨ SpringDataElasticSearch æ¥å®Œæˆæœç´¢æŸ¥è¯¢ï¼Œä½†æ˜¯æœç´¢ä¸€èˆ¬éƒ½ä¼šæœ‰æœç´¢å…³é”®å­—é«˜äº®çš„åŠŸèƒ½ï¼Œä»Šå¤©æˆ‘ä»¬æŠŠå®ƒç»™åŠ ä¸Šã€‚</p><a id="more"></a><h2 id="ç³»åˆ—æ–‡ç« "><a href="#ç³»åˆ—æ–‡ç« " class="headerlink" title="ç³»åˆ—æ–‡ç« "></a>ç³»åˆ—æ–‡ç« </h2><ul><li>ä¸€ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ElasticSearché›†ç¾¤æ­å»º</a></li><li>äºŒã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E5%85%A5%E9%97%A8.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ElasticSearchå…¥é—¨</a></li><li>ä¸‰ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BIK%E5%88%86%E8%AF%8D%E4%BB%A5%E5%8F%8A%E6%8B%BC%E9%9F%B3%E5%88%86%E8%AF%8D.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹IKåˆ†è¯ä»¥åŠæ‹¼éŸ³åˆ†è¯</a></li><li>å››ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BLogstash%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5%E5%BB%BA%E7%AB%8B%E7%B4%A2%E5%BC%95.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹Logstashå®æ—¶åŒæ­¥å»ºç«‹ç´¢å¼•</a></li><li>äº”ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%A5%E9%97%A8.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…¥é—¨</a></li><li>å…­ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%B3%E9%94%AE%E8%AF%8D%E9%AB%98%E4%BA%AE.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…³é”®è¯é«˜äº®</a></li><li>â€¦</li></ul><h2 id="ç¯å¢ƒä¾èµ–"><a href="#ç¯å¢ƒä¾èµ–" class="headerlink" title="ç¯å¢ƒä¾èµ–"></a>ç¯å¢ƒä¾èµ–</h2><p>æœ¬æ–‡ä»¥åŠåç»­ es ç³»åˆ—æ–‡ç« éƒ½åŸºäº <strong>5.5.3</strong> è¿™ä¸ªç‰ˆæœ¬çš„ elasticsearch ï¼Œè¿™ä¸ªç‰ˆæœ¬æ¯”è¾ƒç¨³å®šï¼Œå¯ä»¥ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚</p><p>SpringDataElasticSearch çš„åŸºæœ¬ä½¿ç”¨å¯ä»¥çœ‹æˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç«  <a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%A5%E9%97%A8.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…¥é—¨</a>ï¼Œæœ¬æ–‡å°±ä¸å†èµ˜è¿°ã€‚</p><h2 id="é«˜äº®å…³é”®å­—å®ç°"><a href="#é«˜äº®å…³é”®å­—å®ç°" class="headerlink" title="é«˜äº®å…³é”®å­—å®ç°"></a>é«˜äº®å…³é”®å­—å®ç°</h2><p>å‰æ–‡æŸ¥è¯¢æ˜¯é€šè¿‡å†™ä¸€ä¸ªæ¥å£æ¥ç»§æ‰¿ ElasticsearchRepository æ¥å®ç°çš„ï¼Œä½†æ˜¯å¦‚æœè¦å®ç°é«˜äº®ï¼Œæˆ‘ä»¬å°±ä¸èƒ½è¿™æ ·åšäº†ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ° <strong>ElasticsearchTemplate</strong>æ¥å®Œæˆã€‚</p><p>æŸ¥çœ‹è¿™ä¸ªç±»çš„æºç </p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ElasticsearchTemplate</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ElasticsearchOperations</span>, <span class="hljs-title">ApplicationContextAware</span> </span>&#123;<br>    ...<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒElasticsearchTemplate å®ç°äº†æ¥å£ <strong>ApplicationContextAware</strong>ï¼Œæ‰€ä»¥è¿™ä¸ªç±»æ˜¯è¢« Spring ç®¡ç†çš„ï¼Œå¯ä»¥åœ¨ç±»é‡Œé¢ç›´æ¥æ³¨å…¥ä½¿ç”¨ã€‚</p><p>ä»£ç å¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Slf4j</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HighlightBookRepositoryTest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EsSearchApplicationTests</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> ElasticsearchTemplate elasticsearchTemplate;<br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> ExtResultMapper extResultMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testHighlightQuery</span><span class="hljs-params">()</span> </span>&#123;<br>        BookQuery query = <span class="hljs-keyword">new</span> BookQuery();<br>        query.setQueryString(<span class="hljs-string">&quot;ç©¿è¶Š&quot;</span>);<br><br>        <span class="hljs-comment">// å¤åˆæŸ¥è¯¢</span><br>        BoolQueryBuilder boolQuery = QueryBuilders.boolQuery();<br><br>        <span class="hljs-comment">// ä»¥ä¸‹ä¸ºæŸ¥è¯¢æ¡ä»¶, ä½¿ç”¨ must query è¿›è¡ŒæŸ¥è¯¢ç»„åˆ</span><br>        MultiMatchQueryBuilder matchQuery = QueryBuilders.multiMatchQuery(query.getQueryString(), <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;intro&quot;</span>, <span class="hljs-string">&quot;author&quot;</span>);<br>        boolQuery.must(matchQuery);<br><br>        PageRequest pageRequest = PageRequest.of(query.getPage() - <span class="hljs-number">1</span>, query.getSize());<br><br>        NativeSearchQuery searchQuery = <span class="hljs-keyword">new</span> NativeSearchQueryBuilder()<br>                .withQuery(boolQuery)<br>                .withHighlightFields(<br>                        <span class="hljs-keyword">new</span> HighlightBuilder.Field(<span class="hljs-string">&quot;name&quot;</span>).preTags(<span class="hljs-string">&quot;&lt;span style=\&quot;color:red\&quot;&gt;&quot;</span>).postTags(<span class="hljs-string">&quot;&lt;/span&gt;&quot;</span>),<br>                        <span class="hljs-keyword">new</span> HighlightBuilder.Field(<span class="hljs-string">&quot;author&quot;</span>).preTags(<span class="hljs-string">&quot;&lt;span style=\&quot;color:red\&quot;&gt;&quot;</span>).postTags(<span class="hljs-string">&quot;&lt;/span&gt;&quot;</span>))<br>                .withPageable(pageRequest)<br>                .build();<br>        Page&lt;Book&gt; books = elasticsearchTemplate.queryForPage(searchQuery, Book.class, extResultMapper);<br><br>        books.forEach(e -&gt; log.info(<span class="hljs-string">&quot;&#123;&#125;&quot;</span>, e));<br>        <span class="hljs-comment">// &lt;span style=&quot;color:red&quot;&gt;ç©¿è¶Š&lt;/span&gt;å°é“äºº</span><br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œ çš„</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">Page&lt;Book&gt; books = elasticsearchTemplate.queryForPage(searchQuery, Book.class, extResultMapper);<br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œè¿”å›çš„æ˜¯åˆ†é¡µå¯¹è±¡ã€‚<br>æŸ¥è¯¢æ–¹å¼å’Œä¸Šæ–‡çš„å·®ä¸å¤šï¼Œåªä¸è¿‡æ˜¯æ˜¯ Repository å˜æˆäº† ElasticsearchTemplateï¼Œæ“ä½œæ–¹å¼ä¹Ÿå¤§åŒå°å¼‚ã€‚</p><p>è¿™é‡Œç”¨åˆ°äº† ExtResultMapperï¼Œè¯·æ¥ç€çœ‹ä¸‹æ–‡ã€‚</p><h2 id="è‡ªå®šä¹‰ResultMapper"><a href="#è‡ªå®šä¹‰ResultMapper" class="headerlink" title="è‡ªå®šä¹‰ResultMapper"></a>è‡ªå®šä¹‰ResultMapper</h2><p>ResultMapper æ˜¯ç”¨äºå°† ES æ–‡æ¡£è½¬æ¢æˆ Java å¯¹è±¡çš„æ˜ å°„ç±»ï¼Œå› ä¸º SpringDataElasticSearch é»˜è®¤çš„çš„æ˜ å°„ç±» DefaultResultMapper ä¸æ”¯æŒé«˜äº®ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦è‡ªå·±å®šä¹‰ä¸€ä¸ª ResultMapperã€‚</p><p>å¤åˆ¶ DefaultResultMapper ç±»ï¼Œé‡å‘½åä¸º ExtResultMapperï¼Œå¯¹æ„é€ æ–¹æ³•åç§°ä¿®æ”¹ä¸ºæ­£ç¡®çš„å€¼ã€‚</p><p>æ–°å¢ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå°†é«˜äº®çš„å†…å®¹èµ‹å€¼ç»™éœ€è¦è½¬æ¢çš„ Java å¯¹è±¡å†…ã€‚</p><p>åœ¨ mapResults æ–¹æ³•å†…è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p><p><strong>æ³¨æ„ï¼šè¿™ä¸ªç±»å¯ä»¥ç›´æ¥æ‹·è´åˆ°ä½ çš„é¡¹ç›®ä¸­ç›´æ¥ä½¿ç”¨ï¼</strong><br>æˆ‘å†™è¿™ä¹ˆå¤šï¼Œåªæ˜¯æƒ³è¯´æ˜ä¸ºä»€ä¹ˆè¿™ä¸ªç±»æ˜¯è¿™æ ·çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.fasterxml.jackson.core.JsonEncoding;<br><span class="hljs-keyword">import</span> com.fasterxml.jackson.core.JsonFactory;<br><span class="hljs-keyword">import</span> com.fasterxml.jackson.core.JsonGenerator;<br><span class="hljs-keyword">import</span> org.apache.commons.beanutils.PropertyUtils;<br><span class="hljs-keyword">import</span> org.elasticsearch.action.get.GetResponse;<br><span class="hljs-keyword">import</span> org.elasticsearch.action.get.MultiGetItemResponse;<br><span class="hljs-keyword">import</span> org.elasticsearch.action.get.MultiGetResponse;<br><span class="hljs-keyword">import</span> org.elasticsearch.action.search.SearchResponse;<br><span class="hljs-keyword">import</span> org.elasticsearch.common.text.Text;<br><span class="hljs-keyword">import</span> org.elasticsearch.search.SearchHit;<br><span class="hljs-keyword">import</span> org.elasticsearch.search.SearchHitField;<br><span class="hljs-keyword">import</span> org.elasticsearch.search.fetch.subphase.highlight.HighlightField;<br><span class="hljs-keyword">import</span> org.springframework.data.domain.Pageable;<br><span class="hljs-keyword">import</span> org.springframework.data.elasticsearch.ElasticsearchException;<br><span class="hljs-keyword">import</span> org.springframework.data.elasticsearch.annotations.Document;<br><span class="hljs-keyword">import</span> org.springframework.data.elasticsearch.annotations.ScriptedField;<br><span class="hljs-keyword">import</span> org.springframework.data.elasticsearch.core.AbstractResultMapper;<br><span class="hljs-keyword">import</span> org.springframework.data.elasticsearch.core.DefaultEntityMapper;<br><span class="hljs-keyword">import</span> org.springframework.data.elasticsearch.core.EntityMapper;<br><span class="hljs-keyword">import</span> org.springframework.data.elasticsearch.core.aggregation.AggregatedPage;<br><span class="hljs-keyword">import</span> org.springframework.data.elasticsearch.core.aggregation.impl.AggregatedPageImpl;<br><span class="hljs-keyword">import</span> org.springframework.data.elasticsearch.core.mapping.ElasticsearchPersistentEntity;<br><span class="hljs-keyword">import</span> org.springframework.data.elasticsearch.core.mapping.ElasticsearchPersistentProperty;<br><span class="hljs-keyword">import</span> org.springframework.data.mapping.context.MappingContext;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><span class="hljs-keyword">import</span> org.springframework.util.Assert;<br><span class="hljs-keyword">import</span> org.springframework.util.StringUtils;<br><br><span class="hljs-keyword">import</span> java.io.ByteArrayOutputStream;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.nio.charset.Charset;<br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ç±»åç§°ï¼šExtResultMapper</span><br><span class="hljs-comment"> * ç±»æè¿°ï¼šè‡ªå®šä¹‰ç»“æœæ˜ å°„ç±»</span><br><span class="hljs-comment"> * åˆ›å»ºäººï¼šWeJan</span><br><span class="hljs-comment"> * åˆ›å»ºæ—¶é—´ï¼š2018-09-13 20:47</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExtResultMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractResultMapper</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> MappingContext&lt;? extends ElasticsearchPersistentEntity&lt;?&gt;, ElasticsearchPersistentProperty&gt; mappingContext;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ExtResultMapper</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(<span class="hljs-keyword">new</span> DefaultEntityMapper());<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ExtResultMapper</span><span class="hljs-params">(MappingContext&lt;? extends ElasticsearchPersistentEntity&lt;?&gt;, ElasticsearchPersistentProperty&gt; mappingContext)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(<span class="hljs-keyword">new</span> DefaultEntityMapper());<br>        <span class="hljs-keyword">this</span>.mappingContext = mappingContext;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ExtResultMapper</span><span class="hljs-params">(EntityMapper entityMapper)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(entityMapper);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ExtResultMapper</span><span class="hljs-params">(</span></span><br><span class="hljs-function"><span class="hljs-params">            MappingContext&lt;? extends ElasticsearchPersistentEntity&lt;?&gt;, ElasticsearchPersistentProperty&gt; mappingContext,</span></span><br><span class="hljs-function"><span class="hljs-params">            EntityMapper entityMapper)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(entityMapper);<br>        <span class="hljs-keyword">this</span>.mappingContext = mappingContext;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-function">AggregatedPage&lt;T&gt; <span class="hljs-title">mapResults</span><span class="hljs-params">(SearchResponse response, Class&lt;T&gt; clazz, Pageable pageable)</span> </span>&#123;<br>        <span class="hljs-keyword">long</span> totalHits = response.getHits().totalHits();<br>        List&lt;T&gt; results = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (SearchHit hit : response.getHits()) &#123;<br>            <span class="hljs-keyword">if</span> (hit != <span class="hljs-keyword">null</span>) &#123;<br>                T result = <span class="hljs-keyword">null</span>;<br>                <span class="hljs-keyword">if</span> (StringUtils.hasText(hit.sourceAsString())) &#123;<br>                    result = mapEntity(hit.sourceAsString(), clazz);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    result = mapEntity(hit.getFields().values(), clazz);<br>                &#125;<br>                setPersistentEntityId(result, hit.getId(), clazz);<br>                setPersistentEntityVersion(result, hit.getVersion(), clazz);<br>                populateScriptFields(result, hit);<br>               <br>               <span class="hljs-comment">// é«˜äº®æŸ¥è¯¢</span><br>                populateHighLightedFields(result, hit.getHighlightFields());<br>                results.add(result);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AggregatedPageImpl&lt;T&gt;(results, pageable, totalHits, response.getAggregations(), response.getScrollId());<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> &lt;T&gt;  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">populateHighLightedFields</span><span class="hljs-params">(T result, Map&lt;String, HighlightField&gt; highlightFields)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (HighlightField field : highlightFields.values()) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                PropertyUtils.setProperty(result, field.getName(), concat(field.fragments()));<br>            &#125; <span class="hljs-keyword">catch</span> (InvocationTargetException | IllegalAccessException | NoSuchMethodException e) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ElasticsearchException(<span class="hljs-string">&quot;failed to set highlighted value for field: &quot;</span> + field.getName()<br>                        + <span class="hljs-string">&quot; with value: &quot;</span> + Arrays.toString(field.getFragments()), e);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">concat</span><span class="hljs-params">(Text[] texts)</span> </span>&#123;<br>        StringBuffer sb = <span class="hljs-keyword">new</span> StringBuffer();<br>        <span class="hljs-keyword">for</span> (Text text : texts) &#123;<br>            sb.append(text.toString());<br>        &#125;<br>        <span class="hljs-keyword">return</span> sb.toString();<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">populateScriptFields</span><span class="hljs-params">(T result, SearchHit hit)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (hit.getFields() != <span class="hljs-keyword">null</span> &amp;&amp; !hit.getFields().isEmpty() &amp;&amp; result != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">for</span> (java.lang.reflect.Field field : result.getClass().getDeclaredFields()) &#123;<br>                ScriptedField scriptedField = field.getAnnotation(ScriptedField.class);<br>                <span class="hljs-keyword">if</span> (scriptedField != <span class="hljs-keyword">null</span>) &#123;<br>                    String name = scriptedField.name().isEmpty() ? field.getName() : scriptedField.name();<br>                    SearchHitField searchHitField = hit.getFields().get(name);<br>                    <span class="hljs-keyword">if</span> (searchHitField != <span class="hljs-keyword">null</span>) &#123;<br>                        field.setAccessible(<span class="hljs-keyword">true</span>);<br>                        <span class="hljs-keyword">try</span> &#123;<br>                            field.set(result, searchHitField.getValue());<br>                        &#125; <span class="hljs-keyword">catch</span> (IllegalArgumentException e) &#123;<br>                            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ElasticsearchException(<span class="hljs-string">&quot;failed to set scripted field: &quot;</span> + name + <span class="hljs-string">&quot; with value: &quot;</span><br>                                    + searchHitField.getValue(), e);<br>                        &#125; <span class="hljs-keyword">catch</span> (IllegalAccessException e) &#123;<br>                            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ElasticsearchException(<span class="hljs-string">&quot;failed to access scripted field: &quot;</span> + name, e);<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> &lt;T&gt; <span class="hljs-function">T <span class="hljs-title">mapEntity</span><span class="hljs-params">(Collection&lt;SearchHitField&gt; values, Class&lt;T&gt; clazz)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> mapEntity(buildJSONFromFields(values), clazz);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">buildJSONFromFields</span><span class="hljs-params">(Collection&lt;SearchHitField&gt; values)</span> </span>&#123;<br>        JsonFactory nodeFactory = <span class="hljs-keyword">new</span> JsonFactory();<br>        <span class="hljs-keyword">try</span> &#123;<br>            ByteArrayOutputStream stream = <span class="hljs-keyword">new</span> ByteArrayOutputStream();<br>            JsonGenerator generator = nodeFactory.createGenerator(stream, JsonEncoding.UTF8);<br>            generator.writeStartObject();<br>            <span class="hljs-keyword">for</span> (SearchHitField value : values) &#123;<br>                <span class="hljs-keyword">if</span> (value.getValues().size() &gt; <span class="hljs-number">1</span>) &#123;<br>                    generator.writeArrayFieldStart(value.getName());<br>                    <span class="hljs-keyword">for</span> (Object val : value.getValues()) &#123;<br>                        generator.writeObject(val);<br>                    &#125;<br>                    generator.writeEndArray();<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    generator.writeObjectField(value.getName(), value.getValue());<br>                &#125;<br>            &#125;<br>            generator.writeEndObject();<br>            generator.flush();<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> String(stream.toByteArray(), Charset.forName(<span class="hljs-string">&quot;UTF-8&quot;</span>));<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-function">T <span class="hljs-title">mapResult</span><span class="hljs-params">(GetResponse response, Class&lt;T&gt; clazz)</span> </span>&#123;<br>        T result = mapEntity(response.getSourceAsString(), clazz);<br>        <span class="hljs-keyword">if</span> (result != <span class="hljs-keyword">null</span>) &#123;<br>            setPersistentEntityId(result, response.getId(), clazz);<br>            setPersistentEntityVersion(result, response.getVersion(), clazz);<br>        &#125;<br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> &lt;T&gt; <span class="hljs-function">LinkedList&lt;T&gt; <span class="hljs-title">mapResults</span><span class="hljs-params">(MultiGetResponse responses, Class&lt;T&gt; clazz)</span> </span>&#123;<br>        LinkedList&lt;T&gt; list = <span class="hljs-keyword">new</span> LinkedList&lt;&gt;();<br>        <span class="hljs-keyword">for</span> (MultiGetItemResponse response : responses.getResponses()) &#123;<br>            <span class="hljs-keyword">if</span> (!response.isFailed() &amp;&amp; response.getResponse().isExists()) &#123;<br>                T result = mapEntity(response.getResponse().getSourceAsString(), clazz);<br>                setPersistentEntityId(result, response.getResponse().getId(), clazz);<br>                setPersistentEntityVersion(result, response.getResponse().getVersion(), clazz);<br>                list.add(result);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> list;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setPersistentEntityId</span><span class="hljs-params">(T result, String id, Class&lt;T&gt; clazz)</span> </span>&#123;<br><br>        <span class="hljs-keyword">if</span> (mappingContext != <span class="hljs-keyword">null</span> &amp;&amp; clazz.isAnnotationPresent(Document.class)) &#123;<br><br>            ElasticsearchPersistentEntity&lt;?&gt; persistentEntity = mappingContext.getRequiredPersistentEntity(clazz);<br>            ElasticsearchPersistentProperty idProperty = persistentEntity.getIdProperty();<br><br>            <span class="hljs-comment">// Only deal with String because ES generated Ids are strings !</span><br>            <span class="hljs-keyword">if</span> (idProperty != <span class="hljs-keyword">null</span> &amp;&amp; idProperty.getType().isAssignableFrom(String.class)) &#123;<br>                persistentEntity.getPropertyAccessor(result).setProperty(idProperty, id);<br>            &#125;<br><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setPersistentEntityVersion</span><span class="hljs-params">(T result, <span class="hljs-keyword">long</span> version, Class&lt;T&gt; clazz)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (mappingContext != <span class="hljs-keyword">null</span> &amp;&amp; clazz.isAnnotationPresent(Document.class)) &#123;<br><br>            ElasticsearchPersistentEntity&lt;?&gt; persistentEntity = mappingContext.getPersistentEntity(clazz);<br>            ElasticsearchPersistentProperty versionProperty = persistentEntity.getVersionProperty();<br><br>            <span class="hljs-comment">// Only deal with Long because ES versions are longs !</span><br>            <span class="hljs-keyword">if</span> (versionProperty != <span class="hljs-keyword">null</span> &amp;&amp; versionProperty.getType().isAssignableFrom(Long.class)) &#123;<br>                <span class="hljs-comment">// check that a version was actually returned in the response, -1 would indicate that</span><br>                <span class="hljs-comment">// a search didn&#x27;t request the version ids in the response, which would be an issue</span><br>                Assert.isTrue(version != -<span class="hljs-number">1</span>, <span class="hljs-string">&quot;Version in response is -1&quot;</span>);<br>                persistentEntity.getPropertyAccessor(result).setProperty(versionProperty, version);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œä½¿ç”¨åˆ°äº† <strong>PropertyUtils</strong> ï¼Œéœ€è¦å¼•å…¥ä¸€ä¸ª Apache çš„ä¾èµ–ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-beanutils<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-beanutils<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.9.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>è‡ªå®šä¹‰ ResultMapper å†™å¥½ä¹‹åï¼Œæ·»åŠ  <strong>@Component</strong> æ³¨è§£ï¼Œè¡¨ç¤ºä¸º Spring çš„ä¸€ä¸ªç»„ä»¶ï¼Œåœ¨ç±»ä¸­è¿›è¡Œæ³¨å…¥ä½¿ç”¨å³å¯ã€‚</p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>æœ¬æ–‡ç¤ºä¾‹é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/Mosiki/SpringDataElasticSearchQuickStartExample">https://github.com/Mosiki/SpringDataElasticSearchQuickStartExample</a></p><h2 id="æœ‰ç–‘é—®"><a href="#æœ‰ç–‘é—®" class="headerlink" title="æœ‰ç–‘é—®?"></a>æœ‰ç–‘é—®?</h2><p>æ¬¢è¿æ¥ä¿¡ï¼Œ<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=JVNGSFRlQ0pdSERMSQtGSkg">ç»™æˆ‘å†™ä¿¡</a></p>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringDataElasticSearché«˜äº®</tag>
      
      <tag>SpringDataElasticSearchå…³é”®è¯é«˜äº®</tag>
      
      <tag>ElasticsearchTemplateä½¿ç”¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…¥é—¨</title>
    <link href="/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%A5%E9%97%A8.html"/>
    <url>/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%A5%E9%97%A8.html</url>
    
    <content type="html"><![CDATA[<p>ç½‘ä¸Šå¤§å¤šé€šè¿‡ java æ“ä½œ es ä½¿ç”¨çš„éƒ½æ˜¯ TransportClientï¼Œè€Œä»‹ç»ä½¿ç”¨ SpringDataElasticSearch çš„æ–‡ç« ç›¸å¯¹æ¯”è¾ƒå°‘ï¼Œç¬”è€…ä¹Ÿæ˜¯æ‘¸ç´¢äº†è®¸ä¹…ï¼Œæ¥ä¸‹æ¥æœ¬æ–‡ä»‹ç» SpringDataElasticSearch çš„ api ä½¿ç”¨ï¼Œæ›´åŠ æ–¹ä¾¿çš„è¿›è¡ŒæŸ¥è¯¢ã€‚</p><a id="more"></a><h2 id="ç³»åˆ—æ–‡ç« "><a href="#ç³»åˆ—æ–‡ç« " class="headerlink" title="ç³»åˆ—æ–‡ç« "></a>ç³»åˆ—æ–‡ç« </h2><ul><li>ä¸€ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ElasticSearché›†ç¾¤æ­å»º</a></li><li>äºŒã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E5%85%A5%E9%97%A8.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ElasticSearchå…¥é—¨</a></li><li>ä¸‰ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BIK%E5%88%86%E8%AF%8D%E4%BB%A5%E5%8F%8A%E6%8B%BC%E9%9F%B3%E5%88%86%E8%AF%8D.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹IKåˆ†è¯ä»¥åŠæ‹¼éŸ³åˆ†è¯</a></li><li>å››ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BLogstash%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5%E5%BB%BA%E7%AB%8B%E7%B4%A2%E5%BC%95.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹Logstashå®æ—¶åŒæ­¥å»ºç«‹ç´¢å¼•</a></li><li>äº”ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%A5%E9%97%A8.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…¥é—¨</a></li><li>å…­ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%B3%E9%94%AE%E8%AF%8D%E9%AB%98%E4%BA%AE.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…³é”®è¯é«˜äº®</a></li><li>â€¦</li></ul><h2 id="ç¯å¢ƒä¾èµ–"><a href="#ç¯å¢ƒä¾èµ–" class="headerlink" title="ç¯å¢ƒä¾èµ–"></a>ç¯å¢ƒä¾èµ–</h2><p>æœ¬æ–‡ä»¥åŠåç»­ es ç³»åˆ—æ–‡ç« éƒ½åŸºäº <strong>5.5.3</strong> è¿™ä¸ªç‰ˆæœ¬çš„ elasticsearch ï¼Œè¿™ä¸ªç‰ˆæœ¬æ¯”è¾ƒç¨³å®šï¼Œå¯ä»¥ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚</p><p>æœ¬æ–‡é¡¹ç›®åŸºäº <strong>SpringBoot 2.0.4.RELEASE</strong> è¿›è¡Œæ„å»ºï¼Œé¦–å…ˆå¼•å…¥ Spring Data ElasticSearch çš„ä¾èµ–ã€‚</p><p>æ³¨æ„ï¼šå› ä¸ºæ˜¯ Spring Boot é¡¹ç›®ï¼Œæ‰€ä»¥å¼•å…¥çš„ä¾èµ–æ˜¯ <strong>spring-boot-starter-data-elasticsearch</strong>ï¼Œè€Œä¸æ˜¯ç›´æ¥å¼•å…¥ <strong>spring-data-elasticsearch</strong>ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-elasticsearch<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>Spring Data ElasticSearch ä¸ ElasticSearch æœ‰å¯¹åº”å…³ç³»</p><table><thead><tr><th align="center">spring data elasticsearch</th><th align="center">elasticsearch</th></tr></thead><tbody><tr><td align="center">3.1.x</td><td align="center">6.2.2</td></tr><tr><td align="center">3.0.x</td><td align="center">5.5.0</td></tr><tr><td align="center">2.1.x</td><td align="center">2.4.0</td></tr><tr><td align="center">2.0.x</td><td align="center">2.2.0</td></tr><tr><td align="center">1.3.x</td><td align="center">1.5.2</td></tr></tbody></table><p>è€Œæœ¬æ–‡ä½¿ç”¨çš„ SpringBoot 2.0.4.RELEASE è‡ªåŠ¨ä¾èµ–çš„ Spring Data ElasticSearch ç‰ˆæœ¬æ˜¯ <strong>3.0.9.RELEASE</strong>ï¼Œå¯¹åº”çš„ elasticsearch ç‰ˆæœ¬æ˜¯ 5.5.xï¼Œå¯çŸ¥ä¾èµ–æ˜¯æ­£ç¡®çš„ç‰ˆæœ¬ã€‚</p><h2 id="åˆ›å»º-Document-ç±»"><a href="#åˆ›å»º-Document-ç±»" class="headerlink" title="åˆ›å»º Document ç±»"></a>åˆ›å»º Document ç±»</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@Document(indexName = &quot;novel&quot;, type = &quot;book&quot;, createIndex = false)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Book</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Serializable</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = <span class="hljs-number">8504604495927552402L</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * éœ€è¦æ·»åŠ  <span class="hljs-doctag">@Id</span> æ ‡è¯†ä¸»é”®</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Id</span><br>    <span class="hljs-keyword">private</span> Integer id;<br><br>    <span class="hljs-keyword">private</span> Integer words;<br><br>    <span class="hljs-keyword">private</span> String intro;<br><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-keyword">private</span> Integer sort;<br><br>    <span class="hljs-keyword">private</span> Boolean vip;<br><br>    <span class="hljs-keyword">private</span> Integer site;<br><br>    <span class="hljs-keyword">private</span> String author;<br><br>    <span class="hljs-keyword">private</span> Integer collection;<br><br>    <span class="hljs-keyword">private</span> Integer click;<br><br>    <span class="hljs-keyword">private</span> Integer popularity;<br><br>    <span class="hljs-keyword">private</span> Integer goods;<br><br>    <span class="hljs-keyword">private</span> Integer status;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * éœ€è¦è‡ªå®šä¹‰æ—¶é—´æ ¼å¼åŒ–æ ¼å¼ï¼Œå¦åˆ™ä¼šä½¿ç”¨é»˜è®¤æ—¶é—´æ ¼å¼åŒ–</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@JsonFormat</span> (shape = JsonFormat.Shape.STRING, pattern =<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>)<br>    <span class="hljs-keyword">private</span> Date updatetime;<br><br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¿™ä¸ª Document ç±»å°è£…äº†ç´¢å¼•çš„å…¨éƒ¨å­—æ®µä¿¡æ¯ï¼Œæ³¨æ„å­—æ®µåç§°è¦ä¸ç´¢å¼•ç±»å‹çš„å­—æ®µåç§°ä¸€è‡´ã€‚</p><h2 id="åˆ›å»º-Repository-æ¥å£"><a href="#åˆ›å»º-Repository-æ¥å£" class="headerlink" title="åˆ›å»º Repository æ¥å£"></a>åˆ›å»º Repository æ¥å£</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">BookRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ElasticsearchRepository</span>&lt;<span class="hljs-title">Book</span>, <span class="hljs-title">Integer</span>&gt; </span>&#123;<br><br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç”¨è¿‡ SpringDataJPA çš„æœ‹å‹éƒ½åº”è¯¥çŸ¥é“ï¼ŒElasticsearchRepository çš„ä¸¤ä¸ªæ³›å‹åˆ†åˆ«ä¸º Documet ä»¥åŠ Document çš„ä¸»é”®ç±»å‹ã€‚</p><h2 id="åˆ›å»ºæµ‹è¯•ç±»"><a href="#åˆ›å»ºæµ‹è¯•ç±»" class="headerlink" title="åˆ›å»ºæµ‹è¯•ç±»"></a>åˆ›å»ºæµ‹è¯•ç±»</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Slf4j</span><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BookRepositoryTest</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> BookRepository bookRepository;<br>    <br><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æ¼”ç¤ºç®€å•æŸ¥è¯¢"><a href="#æ¼”ç¤ºç®€å•æŸ¥è¯¢" class="headerlink" title="æ¼”ç¤ºç®€å•æŸ¥è¯¢"></a>æ¼”ç¤ºç®€å•æŸ¥è¯¢</h2><h3 id="åŒ¹é…æŸ¥è¯¢-MatchQuery"><a href="#åŒ¹é…æŸ¥è¯¢-MatchQuery" class="headerlink" title="åŒ¹é…æŸ¥è¯¢(MatchQuery)"></a>åŒ¹é…æŸ¥è¯¢(MatchQuery)</h3><p>è¿›è¡Œæ¨¡ç³ŠåŒ¹é…æŸ¥è¯¢ï¼Œè¿™é‡Œæ¼”ç¤ºçš„æ˜¯é€šè¿‡ name è¿™ä¸ªå­—æ®µè¿›è¡ŒæŸ¥è¯¢</p><figure class="highlight reasonml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs reasonml">@Test<br>public void find<span class="hljs-constructor">Book()</span> &#123;<br>    MatchQueryBuilder matchQuery = <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">QueryBuilders</span>.</span></span><span class="hljs-keyword">match</span><span class="hljs-constructor">Query(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;ç«çˆ†å¨±ä¹å¤©ç‹&quot;</span>)</span>;<br>    bookRepository.search(matchQuery)<br>            .<span class="hljs-keyword">for</span><span class="hljs-constructor">Each(<span class="hljs-params">e</span> -&gt; <span class="hljs-params">log</span>.<span class="hljs-params">info</span>(<span class="hljs-string">&quot;ä½œå“ä¿¡æ¯ï¼š&#123;&#125;&quot;</span>, <span class="hljs-params">e</span>)</span>);<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="é¡¹æŸ¥è¯¢-TermQuery"><a href="#é¡¹æŸ¥è¯¢-TermQuery" class="headerlink" title="é¡¹æŸ¥è¯¢(TermQuery)"></a>é¡¹æŸ¥è¯¢(TermQuery)</h3><p>å®Œå…¨åŒ¹é…æŸ¥è¯¢ï¼Œè¿™é‡Œæ¼”ç¤ºæŸ¥è¯¢ id ä¸º 2 çš„æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">findBook</span><span class="hljs-params">()</span> </span>&#123;<br><br>    TermQueryBuilder termQuery = QueryBuilders.termQuery(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-number">2</span>);<br>    bookRepository.search(termQuery)<br>            .forEach(e -&gt; log.info(<span class="hljs-string">&quot;ä½œå“ä¿¡æ¯ï¼š&#123;&#125;&quot;</span>, e));<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="èŒƒå›´æŸ¥è¯¢-Range-Query"><a href="#èŒƒå›´æŸ¥è¯¢-Range-Query" class="headerlink" title="èŒƒå›´æŸ¥è¯¢(Range Query)"></a>èŒƒå›´æŸ¥è¯¢(Range Query)</h3><p>èŒƒå›´æŸ¥è¯¢ï¼Œè¿™é‡Œæ¼”ç¤ºæŸ¥è¯¢å­—æ•°åœ¨ 0-30w ä¹‹é—´çš„ä½œå“</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">findBook</span><span class="hljs-params">()</span> </span>&#123;<br>    RangeQueryBuilder rangeQuery = QueryBuilders.rangeQuery(<span class="hljs-string">&quot;words&quot;</span>).gt(<span class="hljs-number">0</span>).lt(<span class="hljs-number">300000</span>);<br>    bookRepository.search(rangeQuery)<br>            .forEach(e -&gt; log.info(<span class="hljs-string">&quot;ä½œå“ä¿¡æ¯ï¼š&#123;&#125;&quot;</span>, e));<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„ï¼šå¦‚æœå¯¹æ—¶é—´è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ï¼Œæ³¨æ„ä¸èƒ½ä¼ é€’ Date å¯¹è±¡æˆ–è€… æ¯«ç§’å€¼ï¼Œåªèƒ½ä¼ é€’ <strong>yyyy-MM-dd HH:mm:ss</strong> æ ¼å¼çš„å­—ç¬¦ä¸²æ—¶é—´å‚æ•°ã€‚</p><h2 id="å¤åˆæŸ¥è¯¢"><a href="#å¤åˆæŸ¥è¯¢" class="headerlink" title="å¤åˆæŸ¥è¯¢"></a>å¤åˆæŸ¥è¯¢</h2><p>ä»¥ä¸Šæ¼”ç¤ºäº†å‡ ä¸ªåŸºæœ¬æŸ¥è¯¢ï¼Œä½†æ˜¯å¦‚æœè¦å®ç°å¤šç­›é€‰æ¡ä»¶çš„æŸ¥è¯¢ï¼Œå°±éœ€è¦æŠŠå¤šä¸ªåŸºæœ¬æŸ¥è¯¢è¿›è¡Œç»„åˆï¼Œè¿™é‡Œå°±ç”¨åˆ°äº† <strong>bool æŸ¥è¯¢</strong></p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/201809061536241809780.png"><br>ç°åœ¨æ¥å®ç°è¿™ä¸ªæŸ¥è¯¢</p><h3 id="BookQuery-å‚æ•°å°è£…"><a href="#BookQuery-å‚æ•°å°è£…" class="headerlink" title="BookQuery å‚æ•°å°è£…"></a>BookQuery å‚æ•°å°è£…</h3><p>ä½¿ç”¨ BookQuery ç±»å°è£…æŸ¥è¯¢å‚æ•°</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BookQuery</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> String queryString;<br><br>    <span class="hljs-keyword">private</span> Integer page = <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">private</span> Integer size = <span class="hljs-number">20</span>;<br><br>    <span class="hljs-keyword">private</span> Integer wordsBegin;<br><br>    <span class="hljs-keyword">private</span> Integer wordsEnd;<br><br>    <span class="hljs-keyword">private</span> Integer sort;<br><br>    <span class="hljs-keyword">private</span> Boolean vip;<br><br>    <span class="hljs-keyword">private</span> Integer site;<br><br>    <span class="hljs-keyword">private</span> Integer collection;<br><br>    <span class="hljs-keyword">private</span> Integer click;<br><br>    <span class="hljs-keyword">private</span> Integer popularity;<br><br>    <span class="hljs-keyword">private</span> Integer goods;<br><br>    <span class="hljs-keyword">private</span> Integer status;<br><br>    <span class="hljs-keyword">private</span> Date updatetime;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="æŸ¥è¯¢æµ‹è¯•"><a href="#æŸ¥è¯¢æµ‹è¯•" class="headerlink" title="æŸ¥è¯¢æµ‹è¯•"></a>æŸ¥è¯¢æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">findBook</span><span class="hljs-params">()</span> </span>&#123;<br><br>    BookQuery query = <span class="hljs-keyword">new</span> BookQuery();<br>    query.setQueryString(<span class="hljs-string">&quot;é­”&quot;</span>);<br>    query.setSite(<span class="hljs-number">2</span>);<span class="hljs-comment">// 1 æ˜¯ç”·ç”Ÿ 2 æ˜¯å¥³ç”Ÿ</span><br>    query.setSort(<span class="hljs-number">29</span>); <span class="hljs-comment">// 29 æ˜¯ç„å¹»</span><br>    query.setVip(<span class="hljs-keyword">true</span>);<span class="hljs-comment">// æŸ¥è¯¢ vip ä½œå“</span><br>    query.setWordsBegin(<span class="hljs-number">0</span>); <span class="hljs-comment">// æŸ¥è¯¢å­—æ•°åœ¨ 0-25w ä¹‹é—´çš„ä½œå“</span><br>    query.setWordsEnd(<span class="hljs-number">500000</span>);<br>    query.setPage(<span class="hljs-number">1</span>);<span class="hljs-comment">// åˆ†é¡µé¡µç </span><br>    query.setSize(<span class="hljs-number">10</span>);<span class="hljs-comment">// æ¯é¡µæ˜¾ç¤ºæ•°</span><br><br>    <span class="hljs-comment">// å¤åˆæŸ¥è¯¢</span><br>    BoolQueryBuilder boolQuery = QueryBuilders.boolQuery();<br><br>    <span class="hljs-comment">// ä»¥ä¸‹ä¸ºæŸ¥è¯¢æ¡ä»¶, ä½¿ç”¨ must query è¿›è¡ŒæŸ¥è¯¢ç»„åˆ</span><br>    MultiMatchQueryBuilder matchQuery = QueryBuilders.multiMatchQuery(query.getQueryString(), <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;intro&quot;</span>, <span class="hljs-string">&quot;author&quot;</span>);<br>    boolQuery.must(matchQuery);<br><br>    <span class="hljs-comment">// ä»¥ä¸‹ä¸ºè¿‡æ»¤ç­›é€‰æ¡ä»¶ï¼Œä½¿ç”¨ filter æ¯”ä½¿ç”¨ must query æ€§èƒ½è¦å¥½</span><br>    TermQueryBuilder siteQuery = QueryBuilders.termQuery(<span class="hljs-string">&quot;site&quot;</span>, query.getSite());<br>    boolQuery.filter(siteQuery);<br>    TermQueryBuilder sortQuery = QueryBuilders.termQuery(<span class="hljs-string">&quot;sort&quot;</span>, query.getSort());<br>    boolQuery.filter(sortQuery);<br>    TermQueryBuilder vipQuery = QueryBuilders.termQuery(<span class="hljs-string">&quot;vip&quot;</span>, query.getVip());<br>    boolQuery.filter(vipQuery);<br>    RangeQueryBuilder wordsQuery = QueryBuilders.rangeQuery(<span class="hljs-string">&quot;words&quot;</span>).gt(query.getWordsBegin()).lt(query.getWordsEnd());<br>    boolQuery.filter(wordsQuery);<br><br>    Sort sort = Sort.by(Sort.Direction.DESC, <span class="hljs-string">&quot;click&quot;</span>);<br>    <span class="hljs-comment">// åˆ†é¡µ åŒæ—¶æ ¹æ® ç‚¹å‡»æ•° click è¿›è¡Œé™åºæ’åˆ—</span><br>    PageRequest pageRequest = PageRequest.of(query.getPage() - <span class="hljs-number">1</span>, query.getSize(), sort);<br><br>    log.info(<span class="hljs-string">&quot;&#123;&#125;&quot;</span>, boolQuery);<br>    bookRepository.search(boolQuery, pageRequest)<br>            .forEach(e -&gt; log.info(<span class="hljs-string">&quot;ä½œå“ä¿¡æ¯ï¼š&#123;&#125;&quot;</span>, e));<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æŸ¥å‡ºç»“æœï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs routeros">2018-09-12 22:33:05.750  <span class="hljs-builtin-name">INFO</span> 25896 --- [           main] i.g.mosiki.search.BookRepositoryTest     : ä½œå“ä¿¡æ¯ï¼šBook(<span class="hljs-attribute">id</span>=7, <span class="hljs-attribute">words</span>=345004, intro=  æ¨èã€Šå¯»é¾™ä¼ ã€‹ã€Šé­‚æ‘„å¤©ä¸‹ã€‹ ä½œå“å±ç„å¹»å¼‚ç•Œå¤§é™†é£æ ¼ï¼ å¯æƒœé¢‘é“ä¸èƒ½æ›´æ”¹åªèƒ½åœ¨å¥‡å¹»æ··ï¼ ä¹¦å‹ç¾¤ï¼š292<span class="hljs-built_in">..</span>.  , <span class="hljs-attribute">name</span>=ç­é­”æˆåœ£, <span class="hljs-attribute">sort</span>=29, <span class="hljs-attribute">vip</span>=<span class="hljs-literal">true</span>, <span class="hljs-attribute">site</span>=2, <span class="hljs-attribute">author</span>=ç­‰å¾…æ½‡æ¹˜è¯—ç¤¾, <span class="hljs-attribute">collection</span>=13, <span class="hljs-attribute">click</span>=63263, <span class="hljs-attribute">popularity</span>=2314, <span class="hljs-attribute">goods</span>=5353, <span class="hljs-attribute">status</span>=0, <span class="hljs-attribute">updatetime</span>=Tue Sep 04 16:54:15 CST 2018)<br>2018-09-12 22:33:05.751  <span class="hljs-builtin-name">INFO</span> 25896 --- [           main] i.g.mosiki.search.BookRepositoryTest     : ä½œå“ä¿¡æ¯ï¼šBook(<span class="hljs-attribute">id</span>=9, <span class="hljs-attribute">words</span>=233000, intro=  ä¸€ååœ°çƒçš„å¹³å‡¡çš„å°‘å¹´ï¼Œå› ä¸ºä¸€åœºæ¸¸æˆï¼Œè·å¾—æ­»ç¥çš„ä¼ æ‰¿ï¼Œä»è€Œç©¿è¶Šåˆ°å¦å¤–ä¸€ç‰‡é™Œç”Ÿçš„å¤§é™†ï¼Œä»æ­¤å¼€å¯äº†ä¸€æ®µä¼ å¥‡çš„äººç”Ÿï¼Œä¹å¤©æ˜Ÿæ²³ï¼Œå¾ä¹ƒæ­»ç¥ï¼ŒæŒæ§ç”Ÿæ­»ï¼Œåˆ¤å¤ºç½ªæ¶ï¼Œæˆ‘ä»æ²¡è§è¿‡åœ°ç‹±ï¼Œå› ä¸ºæˆ‘çš„åå­—ï¼Œä¾¿ä»£è¡¨åœ°ç‹±ï¼Œå¾ä¹ƒæ­»ç¥ï¼Œå¾åæ—å¤©ã€‚ï¼ˆPSï¼šå•å¥³ä¸»ï¼Œçˆ½æ–‡ä¸è™å¿ƒï¼Œä¸»è§’ä»¥æ€è¯é“ï¼Œæ€è¯¥æ€ä¹‹äººï¼Œä¸åœ£æ¯ï¼Œç•¥è…¹é»‘ï¼‰ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šå¸¦ç€æ­»ç¥å»ç©¿è¶Šã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼å¸¦ç€æ­»ç¥å»ç©¿è¶Šæœ€æ–°ç« èŠ‚,å¸¦ç€æ­»ç¥å»ç©¿è¶Šæ— å¼¹çª—,å¸¦ç€æ­»ç¥å»ç©¿è¶Šå…¨æ–‡é˜…è¯».  , <span class="hljs-attribute">name</span>=å¸¦ç€æ­»ç¥å»ç©¿è¶Š, <span class="hljs-attribute">sort</span>=29, <span class="hljs-attribute">vip</span>=<span class="hljs-literal">true</span>, <span class="hljs-attribute">site</span>=2, <span class="hljs-attribute">author</span>=æ¢¦ä¾, <span class="hljs-attribute">collection</span>=6326, <span class="hljs-attribute">click</span>=523, <span class="hljs-attribute">popularity</span>=135, <span class="hljs-attribute">goods</span>=34252, <span class="hljs-attribute">status</span>=0, <span class="hljs-attribute">updatetime</span>=Thu Dec 28 04:53:07 CST 2017)<br>2018-09-12 22:33:05.751  <span class="hljs-builtin-name">INFO</span> 25896 --- [           main] i.g.mosiki.search.BookRepositoryTest     : ä½œå“ä¿¡æ¯ï¼šBook(<span class="hljs-attribute">id</span>=5, <span class="hljs-attribute">words</span>=490000, intro=  å¯Œå®¶å­å¼Ÿå¢¨æµå› ä¸ºå‘ç°äº†æ‘å­ä¸­çš„ç§˜å¯†ï¼Œåœ¨è‰¯å¿ƒä¸äº²æƒ…çš„æŠ˜ç£¨ä¸‹ï¼Œé€ƒåˆ°äº†è¾¹å¢ƒå°åŸã€‚å› ä¸ºä¸€ä¸ªé¦™-è‰³è€Œåˆææ€–çš„æ¢¦ï¼Œå¢¨æµç»å†äº†ä¸€äº›è¯¡å¼‚çš„äº‹ï¼Œä»è€Œå¾—çŸ¥è‡ªå·±çš„å‰ä¸–ä¸ä»Šç”Ÿçš„ä½¿å‘½ã€‚è¸ä¸Šè—åœ°ï¼Œå†ç»ç£¨éš¾ï¼Œå…‹æœäº†è‡ªå·±çš„å¿ƒé­”ï¼Œæˆ˜èƒœäº†<span class="hljs-built_in">..</span>.  , <span class="hljs-attribute">name</span>=ä¼é­”, <span class="hljs-attribute">sort</span>=29, <span class="hljs-attribute">vip</span>=<span class="hljs-literal">true</span>, <span class="hljs-attribute">site</span>=2, <span class="hljs-attribute">author</span>=ä¸€å¶style, <span class="hljs-attribute">collection</span>=526, <span class="hljs-attribute">click</span>=9, <span class="hljs-attribute">popularity</span>=41516, <span class="hljs-attribute">goods</span>=7687, <span class="hljs-attribute">status</span>=0, <span class="hljs-attribute">updatetime</span>=Thu Sep 06 04:54:05 CST 2018)<br><br></code></pre></div></td></tr></table></figure><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>SpringDataElasticSearch å…¥é—¨å°±åˆ°è¿™é‡Œäº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•å‘¢ï¼Ÿ</p><p>æœ¬æ–‡ç¤ºä¾‹é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/Mosiki/SpringDataElasticSearchQuickStartExample">https://github.com/Mosiki/SpringDataElasticSearchQuickStartExample</a></p><h2 id="æœ‰ç–‘é—®"><a href="#æœ‰ç–‘é—®" class="headerlink" title="æœ‰ç–‘é—®?"></a>æœ‰ç–‘é—®?</h2><p>æ¬¢è¿æ¥ä¿¡ï¼Œ<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=JVNGSFRlQ0pdSERMSQtGSkg">ç»™æˆ‘å†™ä¿¡</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://blog.csdn.net/tianyaleixiaowu/article/details/77965257">https://blog.csdn.net/tianyaleixiaowu/article/details/77965257</a></li><li><a href="https://tech.youzan.com/search-engine1/#43filteredquery">https://tech.youzan.com/search-engine1/#43filteredquery</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringDataElasticSearchä½¿ç”¨æ•™ç¨‹</tag>
      
      <tag>SpringDataElasticSearchæŸ¥è¯¢</tag>
      
      <tag>SpringDataElasticSearchå…¥é—¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹Logstashå®æ—¶åŒæ­¥å»ºç«‹ç´¢å¼•</title>
    <link href="/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BLogstash%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5%E5%BB%BA%E7%AB%8B%E7%B4%A2%E5%BC%95.html"/>
    <url>/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BLogstash%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5%E5%BB%BA%E7%AB%8B%E7%B4%A2%E5%BC%95.html</url>
    
    <content type="html"><![CDATA[<p>ç”¨è¿‡ Solr çš„æœ‹å‹éƒ½çŸ¥é“ï¼ŒSolr å¯ä»¥ç›´æ¥åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®æ•°æ®åº“è¿æ¥ä»è€Œå®Œæˆç´¢å¼•çš„åŒæ­¥åˆ›å»ºï¼Œä½†æ˜¯ ElasticSearch æœ¬èº«å¹¶ä¸å…·å¤‡è¿™æ ·çš„åŠŸèƒ½ï¼Œé‚£å¦‚ä½•å»ºç«‹ç´¢å¼•å‘¢ï¼Ÿæ–¹æ³•å…¶å®å¾ˆå¤šï¼Œå¯ä»¥ä½¿ç”¨ Java API çš„æ–¹å¼å»ºç«‹ç´¢å¼•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ Logstash çš„æ’ä»¶ logstash-input-jdbc å®Œæˆï¼Œä»Šå¤©æ¥æ¢è®¨ä¸‹å¦‚ä½•ä½¿ç”¨ logstash-input-jdbc å®Œæˆå…¨é‡åŒæ­¥ä»¥åŠå¢é‡åŒæ­¥ã€‚</p><a id="more"></a><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><p>æœ¬æ–‡ä»¥åŠåç»­ es ç³»åˆ—æ–‡ç« éƒ½åŸºäº <strong>5.5.3</strong> è¿™ä¸ªç‰ˆæœ¬çš„ elasticsearch ï¼Œè¿™ä¸ªç‰ˆæœ¬æ¯”è¾ƒç¨³å®šï¼Œå¯ä»¥ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚</p><p>é»˜è®¤ä½ å·²ç»æ­å»ºå¥½ es çš„åŸºç¡€ç¯å¢ƒï¼Œå¦‚è¿˜æœªæ­å»ºå¥½ï¼Œè¯·å‚è€ƒå‰æ–‡ã€‚æ¥ä¸‹æ¥åªè®²è§£ logstash çš„å®‰è£…ä½¿ç”¨ã€‚æœ¬æ–‡ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ logstash ï¼Œç‰ˆæœ¬å·ä¸º 6.4.0ã€‚</p><h2 id="ç³»åˆ—æ–‡ç« "><a href="#ç³»åˆ—æ–‡ç« " class="headerlink" title="ç³»åˆ—æ–‡ç« "></a>ç³»åˆ—æ–‡ç« </h2><ul><li>ä¸€ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ElasticSearché›†ç¾¤æ­å»º</a></li><li>äºŒã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E5%85%A5%E9%97%A8.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ElasticSearchå…¥é—¨</a></li><li>ä¸‰ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BIK%E5%88%86%E8%AF%8D%E4%BB%A5%E5%8F%8A%E6%8B%BC%E9%9F%B3%E5%88%86%E8%AF%8D.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹IKåˆ†è¯ä»¥åŠæ‹¼éŸ³åˆ†è¯</a></li><li>å››ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BLogstash%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5%E5%BB%BA%E7%AB%8B%E7%B4%A2%E5%BC%95.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹Logstashå®æ—¶åŒæ­¥å»ºç«‹ç´¢å¼•</a></li><li>äº”ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%A5%E9%97%A8.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…¥é—¨</a></li><li>å…­ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%B3%E9%94%AE%E8%AF%8D%E9%AB%98%E4%BA%AE.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…³é”®è¯é«˜äº®</a></li><li>â€¦</li></ul><h2 id="æ•°æ®å‡†å¤‡"><a href="#æ•°æ®å‡†å¤‡" class="headerlink" title="æ•°æ®å‡†å¤‡"></a>æ•°æ®å‡†å¤‡</h2><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/201809061536241809780.png"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œå¦‚æœè¦å®ç°è¿™ä¸ªæœç´¢ï¼Œé¦–å…ˆè¦åˆ›å»ºç›¸å…³çš„ç´¢å¼•ï¼Œç­›é€‰æ¡ä»¶æœ‰ç”·ç”Ÿ/å¥³ç”Ÿï¼Œè¿˜æœ‰åˆ†ç±»ï¼Œå±æ€§ï¼Œå­—æ•°ï¼Œè¿è½½çŠ¶æ€ï¼Œå“è´¨ç­‰ï¼Œæ’åºæ¡ä»¶æœ‰äººæ°”ï¼Œæ—¶é—´ï¼Œå­—æ•°ï¼Œæ”¶è—ï¼Œæ¨èï¼Œç‚¹å‡»ã€‚</p><p>è¿™äº›æ•°æ®æ­£å¸¸éƒ½ä¸ä¼šå†åŒä¸€å¼ è¡¨å½“ä¸­ï¼Œè€Œæ˜¯åˆ†å¸ƒäºä¸åŒçš„è¡¨ä¸­ï¼Œä½†è¿™äº›æ•°æ®éƒ½ä¸ä½œå“çš„ id ç´§ç´§å…³è”ã€‚æœ¬æ–‡ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼ŒæŠŠè¿™äº›æ•°æ®éƒ½æ”¾åœ¨åŒä¸€å¼ è¡¨å½“ä¸­ï¼Œå¦‚æœåœ¨å®é™…ä½¿ç”¨çš„è¿‡ç¨‹å½“ä¸­ï¼Œå¦‚æœé‡åˆ°å¤šå¼ è¡¨çš„æƒ…å†µï¼Œå¯ä»¥å†™ sql è¿›è¡Œè”åˆæŸ¥è¯¢ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥å»ºç«‹ç´¢å¼•ï¼Œå®ç°æ–¹å¼è¯¦è§ä¸‹æ–‡ã€‚</p><h3 id="åˆ›å»ºè¡¨ç»“æ„"><a href="#åˆ›å»ºè¡¨ç»“æ„" class="headerlink" title="åˆ›å»ºè¡¨ç»“æ„"></a>åˆ›å»ºè¡¨ç»“æ„</h3><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `book`  (<br>  `id` <span class="hljs-type">bigint</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT,<br>  `create_time` datetime(<span class="hljs-number">0</span>) <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  `update_time` datetime(<span class="hljs-number">0</span>) <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  `status` tinyint(<span class="hljs-number">11</span>) <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  `name` <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_bin <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  `intro` longtext <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_bin <span class="hljs-keyword">NULL</span>,<br>  `icon` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  `author` <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_bin <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  `words` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  `collection` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  `goods` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  `click` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  `site` tinyint(<span class="hljs-number">11</span>) <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  `sort` tinyint(<span class="hljs-number">11</span>) <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  `vip` tinyint(<span class="hljs-number">11</span>) <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  `popularity` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  <span class="hljs-keyword">PRIMARY</span> <span class="hljs-keyword">KEY</span> (`id`) <span class="hljs-keyword">USING</span> BTREE<br>) ENGINE <span class="hljs-operator">=</span> InnoDB  <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> <span class="hljs-operator">=</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> <span class="hljs-operator">=</span> utf8mb4_bin ;<br></code></pre></div></td></tr></table></figure><h3 id="å¯¼å…¥æµ‹è¯•æ•°æ®"><a href="#å¯¼å…¥æµ‹è¯•æ•°æ®" class="headerlink" title="å¯¼å…¥æµ‹è¯•æ•°æ®"></a>å¯¼å…¥æµ‹è¯•æ•°æ®</h3><p>æ³¨ï¼šæµ‹è¯•æ•°æ®æ˜¯é€šè¿‡çˆ¬è™«åœ¨ç›—ç‰ˆç½‘ç«™æŠ“çš„ï¼Œä¸ªåˆ«æ•°æ®èƒ¡ä¹±å¡«å†™çš„ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:01&#x27;</span>, <span class="hljs-string">&#x27;2018-09-10 20:53:46&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ç«çˆ†å¨±ä¹å¤©ç‹&#x27;</span>, <span class="hljs-string">&#x27;  æœ‰äººè¯´ï¼šâ€œä»–æ˜¯è‡³é«˜æ— ä¸Šçš„éŸ³ä¹æ•™çš‡ï¼â€æœ‰äººè¯´ï¼šâ€œä»–æ˜¯æ— äººèƒ½åŠçš„å½±è§†å›½ç‹ï¼â€è¿˜æœ‰äººè¯´ï¼šâ€œä»–æ˜¯ç¥çº§ä½œå®¶ã€è¯å‰§å¤§å¸ˆã€ä¼Ÿå¤§çš„éŸ³ä¹å®¶â€¦â€¦â€ä»–ä½¿åå¤å…ƒç´ ç‹‚æš´å†²å‡»è¥¿æ–¹æ–‡åŒ–ï¼Œå´åˆèƒ½åšå‡ºä»¤è¥¿æ–¹äººä¹Ÿä¸åŠçš„æ¬§ç¾éŸ³ä¹å½±è§†ã€‚ä»–é€ å°±äº†æ— æ•°çš„æ­Œæ˜Ÿå½±æ˜Ÿï¼Œåˆ›ä½œå‡ºæ— æ•°çš„ç»å…¸ï¼Œå»ºç«‹äº†ä¸€ä¸ªåºå¤§çš„å¨±ä¹å¸å›½ã€‚å½“æ‰€æœ‰äººç§°é¢‚ä»–è†œæ‹œä»–çš„æ—¶å€™ï¼Œåªæœ‰ä»–è‡ªå·±çŸ¥é“ï¼Œä»–ä¸è¿‡æ˜¯ä¸€ä¸ªæ„å¤–æ¥è‡ªå¼‚æ—¶ç©ºçš„æ–‡åŒ–ä½¿è€…ã€‚  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;èŒ¶ä¸é…’ä¹‹æ­Œ&#x27;</span>, <span class="hljs-number">230000</span>, <span class="hljs-number">4234</span>, <span class="hljs-number">42315</span>, <span class="hljs-number">523</span>, <span class="hljs-number">2</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">12423</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:01&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:03&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;æ— é™å¹³è¡Œè¿›åŒ–&#x27;</span>, <span class="hljs-string">&#x27;  æ—¥å¤ä¸€æ—¥çš„æ¯ç‡¥ç”Ÿæ´»è®©å»–å®‡å¼€å§‹äº§ç”Ÿäº†éš¾ä»¥æŠ‘åˆ¶çš„åŒå€¦ã€‚æ²‰é‡åºå¤§çš„ç»æµè´Ÿæ‹…ä½¿ä»–çš„ç”Ÿæ´»å¼€å§‹äº§ç”Ÿäº†å˜åŒ–ã€‚å†å²çš„ç¼ºå¤±æ›´æ˜¯æˆä¸ºäº†ä»–å¿ƒä¸­ä¸æ•£çš„è°œå›¢ã€‚æŸä¸€å¤©çªå¦‚å…¶æ¥çš„é™Œç”Ÿä¿¡æ¯ç»ˆäºç»™ä»–æ‰“å¼€äº†ä¸€æ‰‡é—¨ã€‚æ€§æ ¼å„å¼‚çš„Xæˆ˜è­¦ä¸å¤æ‚åºå¤§çš„å¤ä»‡è€…è”ç›Ÿä¼šå†åº¦çˆ†å‘æ€æ ·çš„æˆ˜äº‰ã€‚åŠ å‹’æ¯”æµ·ä¸Šæ˜¯å¦è¿˜ä¼šæ‰¬èµ·ç¬¬å››è‰˜ä¼ å¥‡æˆ˜èˆ°çš„æ——å¸œã€‚é“ºå¤©ç›–åœ°çš„å®‡å®™è™«æ—ä¸å†°å†·æœºæ¢°çš„äººå·¥æ™ºèƒ½è°æ‰æ˜¯æœ€å…·æœ‰ä¾µç•¥æ€§çš„æ–‡æ˜ã€‚æœ€ç»ˆå»–å®‡ä¼šå¦‚ä½•é€‰æ‹©ï¼Œå‘å·¦è¿˜æ˜¯å‘å³â€¦â€¦ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šæ— é™å¹³è¡Œè¿›åŒ–ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼æ— é™å¹³è¡Œè¿›åŒ–æœ€æ–°ç« èŠ‚,æ— é™å¹³è¡Œè¿›åŒ–æ— å¼¹çª—,æ— é™å¹³è¡Œè¿›åŒ–å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;é›ªè‰²é“¶ç‹¼CS&#x27;</span>, <span class="hljs-number">555555</span>, <span class="hljs-number">450000</span>, <span class="hljs-number">13412</span>, <span class="hljs-number">555</span>, <span class="hljs-number">2</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">342</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:02&#x27;</span>, <span class="hljs-string">&#x27;2018-09-15 20:53:55&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;é€†å¤©è¯ç¥&#x27;</span>, <span class="hljs-string">&#x27;  ä¸€ä¸ªæ„å¤–ï¼Œè®©ä»–åœ¨æ˜Ÿç©ºçš„å½¼å²¸ä¸¤åœ°ç›¸æœ›ã€‚ä¸‰äººæºæ‰‹ï¼Œæ€å‡ºäº†è¿™ç‰‡å¤§é™†çš„å››æ–¹å¨åã€‚ä»–ï¼Œå¼ å‡¡ï¼Œæ—¢ç„¶è·å¾—æ–°ç”Ÿï¼Œå°±ç»ä¸å†åšå¼±è€…ã€‚æ—¢ç„¶è¦æˆä¸ºå¼ºè€…ï¼Œå°±å¿…é¡»è®©è¿™ç‰‡æ˜Ÿç©ºé¢¤æŠ–ï¼â€œæ—¢ç„¶æ˜¯æˆ‘çš„æœªæ¥ï¼Œé‚£ä¾¿åªèƒ½ç”±æˆ‘ä¸»å®°â€  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;æ«å¶&#x27;</span>, <span class="hljs-number">340000</span>, <span class="hljs-number">213334</span>, <span class="hljs-number">3421</span>, <span class="hljs-number">42314</span>, <span class="hljs-number">2</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">52315</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:02&#x27;</span>, <span class="hljs-string">&#x27;2018-08-16 20:53:59&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;é”¦ç»£é£åä¹‹ç¬¬ä¸€å†œå®¶å¥³1&#x27;</span>, <span class="hljs-string">&#x27;  å‰ä¸–å¥¹æ˜¯é“è¡€æ‰‹è…•çš„å¸å›½é›†å›¢æ€»è£ï¼Œå´è¢«å¿ƒçˆ±ä¹‹äººè®¾è®¡ï¼Œé­‚å½’å¤©å›½ã€‚ å†æ¬¡ççœ¼ï¼Œçœ¼å‰çš„ä¸‰é—´èŒ…è‰å±‹ï¼Œä¸€å¯¹å°ç˜¦çŒ´ã€‚ å°±ç®—æ˜¯å¥¹å®šåŠ›å†å¼ºæ‚ï¼Œåœ¨ä»–ä»¬å–Šå‡ºé‚£å£°â€œå¨˜â€çš„æ—¶å€™ï¼Œè¿˜æ˜¯è®©å¥¹å·®ç‚¹æ²¡è·³èµ·æ¥ã€‚ å‰ä¸–æ´»åˆ°28è¿˜æ˜¯æ¸…ç™½å¦‚å…°ï¼Œä¸€ä¸ªç©¿è¶Šå°±è®©å¥¹å‹‰å¼ºç®—æ˜¯Bçš„èº«æï¼Œå­•è‚²å‡ºä¸€å¯¹å„¿å¥³ï¼Ÿ å½“ç„¶ï¼Œè¿™è¿˜æ˜¯å…¶æ¬¡ï¼Œæœ€é‡è¦çš„æ˜¯å¥¹ä¸«çš„å±…ç„¶æ˜¯æœªå©šç”Ÿå­ï¼Œè¿™åœ¨ç°ä»£éƒ½é­äººç™½çœ¼çš„äº‹æƒ…ï¼Œé‚£ä¸ªå¤©æ€çš„èƒ½å‘Šè¯‰å¥¹ï¼Œè¿™ä¸ªèº«ä½“çš„åŸä¸»ï¼Œæ˜¯ä¸æ˜¯å¤ªç‰›å‰äº†ï¼Œå±…ç„¶æ²¡æœ‰è¢«æµ¸çŒªç¬¼ã€‚ åªæ˜¯ï¼Œå½“è¿™å¯¹ç˜¦çš„çš®åŒ…éª¨çš„å°åŒ…å­åœ¨å¥¹è·Ÿå‰ï¼Œè‚¿ç€ä¸¤å¯¹çœ¼æ³¡å¿è€…æ³ªèŠ±è·‘å‰è·‘åï¼Œå°±ç®—æ˜¯å¥¹å†ä¸æƒ³é¢å¯¹ç°å®ï¼Œä¹Ÿæ— æ³•åè§†ä¸ç†ã€‚ æ—¢ç„¶è®©å¥¹å†æ¬¡é‡ç”Ÿï¼Œå¥¹åŠ¿å¿…è¦å·¦æ‰‹æŒ¥èˆé”„å¤´ï¼Œå³æ‰‹æ‰§ç¬”ç®—ç›˜ï¼Œå¸¦ç€ä¸€å¯¹å¯çˆ±çš„åŒ…å­ï¼Œå‘å®¶è‡´å¯Œã€‚ è´­ç”°åœ°ï¼Œå»ºè±ªå®…ï¼Œä¹°ä¸‹äººï¼Œé¡¾é•¿å·¥ï¼Œä¸€åˆ‡éƒ½å†æœç€è®©å¥¹æ»¡æ„çš„æ–¹å‘å‰è¿›ï¼Œè€Œé‚£äº›çœ¼çº¢å«‰å¦’ä¹‹è¾ˆï¼Œå®Œå…¨éƒ½æ˜¯å¥¹ä¸šä½™ä¹‹æ—¶çš„æ¶ˆé£ï¼Œæ ¹æœ¬å°±ä¸æ˜¯ä¸€ä¸ªç­‰çº§ã€‚ ä½†æ˜¯ï¼Œå¸¸åœ¨æ²³è¾¹èµ°ï¼Œå“ªæœ‰ä¸æ¹¿é‹ï¼Œè¿™ä¸ªé“ç†å¥¹æ˜ç™½ï¼Œå´æ²¡æƒ³åˆ°é‚£é‹å­ä¼šæ¹¿çš„è¿™ä¹ˆå¿«ï¼Œé¢å¯¹é‚£ä¸ªå¦‚åŒå¦–å­½èˆ¬ï¼Œè¡¨é¢è°¦è°¦å…¬å­ï¼Œé£åæ— åŒï¼Œå®åˆ™è…¹é»‘ç‹¡è¯ˆï¼Œæ€ä¹ˆå‘æ­»å¥¹æ€ä¹ˆæ¥ï¼Œè¿˜è®©å¥¹æœ‰ç«æ²¡å¤„å‘ã€‚ ç²¾å½©å°å‰§åœº å½“ä¸€å¯¹ç²‰é›•ç‰ç¢çš„åŒ…å­è¢«ä¸€ä¸ªé£åç»ä»£çš„ç”·äººä¸€æ‰‹ä¸€ä¸ªæŠ±è¿›æ¥ï¼Œå›ç‘¶çœŸå¿ƒçš„é»‘é¢äº†ï¼Œæ³ªå¥”äº†ã€‚ ä»–ä»¬è¿™ä¸¤ä¸ªæ²¡è‰¯å¿ƒçš„åˆ°åº•æ˜ä¸æ˜ç™½ï¼Œä»€ä¹ˆæ˜¯å¼•ç‹¼å…¥å®¤å•Šã€‚ â€œå¤šè°¢å®å…¬å­é€ä»–ä»¬å›æ¥ï¼Œæ‚¨çœ‹å¦‚ä»Šå¤©è‰²å·²æ™šï¼Œä¸ºäº†å®å…¬å­çš„åå£°ï¼Œå°å¦‡äººä¹Ÿä¸æ•¢ä¹…ç•™ï¼Œå®å…¬å­è¯·å›å§ã€‚â€å¥¹å¿«æ­¥ä¸Šå‰ï¼Œä¸€æŠŠä¸€ä¸ªæŠŠå°åŒ…å­ä»é‚£ä¸ªç”·äººæ€€é‡Œè’¿å‡ºæ¥ï¼Œå¿«è¨€å¿«è¯­çš„ä¸‹äº†é€å®¢ä»¤ã€‚ ç”·äººå¥½çœ‹çš„çœ‰æ¯›å¾®æŒ‘ï¼Œéšåä¸€æ¨¡æƒ…ç»ªä»çœ¸ä¸­è¿…é€Ÿåˆ’è¿‡ï¼Œå¿«çš„éš¾ä»¥æ•æ‰ã€‚ â€œæ— å¦¨ï¼Œæˆ‘æ¥é™ªé™ªè¿™ä¸¤ä¸ªå°å®¶ä¼™ï¼Œå›å¨˜å­ä¸å¿…å¤šå¿ƒã€‚â€ â€œæˆ‘â€¦â€å¥¹å·®ç‚¹æ²¡è¢«å™æ­»ï¼Œå¥¹æœ‰ä»€ä¹ˆå¥½å¤šå¿ƒçš„ï¼Œå°±å†²ç€ä»–è§Šè§å¥¹çš„å­©å­ï¼Œå°±ä¸èƒ½è®©å¥¹ç•™ä¸‹ã€‚ åªæ˜¯å¥¹çš„è¯æ²¡æœ‰è¯´å®Œï¼Œå°±è¢«ç”·äººè´´é¢è€Œæ¥çš„ä¿Šå½¦å“å¾—å‘åé€€å»ï¼Œè€Œç”·äººå«ç¬‘çš„é»‘çœ¸å’Œæ¸…æ·¡çš„è¯è¯­ï¼Œå´è®©å¥¹å·®ç‚¹æ€’ç«ç‹‚é£™ï¼Œâ€œè¿˜æ˜¯ä½ æƒ³æˆ‘æŠŠä»–ä»¬å¸¦å›å»ï¼Ÿâ€ å›ç‘¶å¤§æƒŠï¼Œå¸¦å›å»ï¼Ÿé‚£æ˜¯ç»å¯¹ä¸å¯èƒ½çš„ï¼Œå¥¹çš„å„¿å¥³ï¼Œè°æ•¢æ‰“ä¸»æ„ï¼Œè°å°±æ²¡æ´»è·¯ï¼Œè¯è™½ç„¶å¾ˆç›´ç™½ï¼Œå´ç‹¬ç‹¬å¯¹ä»–ä¸ç®¡ç”¨ã€‚  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;å¸­å¦–å¦–&#x27;</span>, <span class="hljs-number">444902</span>, <span class="hljs-number">23</span>, <span class="hljs-number">5353</span>, <span class="hljs-number">21323</span>, <span class="hljs-number">2</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">314</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:02&#x27;</span>, <span class="hljs-string">&#x27;2018-09-05 20:54:05&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ä¼é­”&#x27;</span>, <span class="hljs-string">&#x27;  å¯Œå®¶å­å¼Ÿå¢¨æµå› ä¸ºå‘ç°äº†æ‘å­ä¸­çš„ç§˜å¯†ï¼Œåœ¨è‰¯å¿ƒä¸äº²æƒ…çš„æŠ˜ç£¨ä¸‹ï¼Œé€ƒåˆ°äº†è¾¹å¢ƒå°åŸã€‚å› ä¸ºä¸€ä¸ªé¦™-è‰³è€Œåˆææ€–çš„æ¢¦ï¼Œå¢¨æµç»å†äº†ä¸€äº›è¯¡å¼‚çš„äº‹ï¼Œä»è€Œå¾—çŸ¥è‡ªå·±çš„å‰ä¸–ä¸ä»Šç”Ÿçš„ä½¿å‘½ã€‚è¸ä¸Šè—åœ°ï¼Œå†ç»ç£¨éš¾ï¼Œå…‹æœäº†è‡ªå·±çš„å¿ƒé­”ï¼Œæˆ˜èƒœäº†...  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;ä¸€å¶style&#x27;</span>, <span class="hljs-number">490000</span>, <span class="hljs-number">526</span>, <span class="hljs-number">7687</span>, <span class="hljs-number">9</span>, <span class="hljs-number">2</span>, <span class="hljs-number">29</span>, <span class="hljs-number">1</span>, <span class="hljs-number">41516</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">6</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:02&#x27;</span>, <span class="hljs-string">&#x27;2018-09-10 00:54:10&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å¼ºçˆ±ä¹‹ç‹¬å®¶æ‹¥æœ‰&#x27;</span>, <span class="hljs-string">&#x27;  å¥¹æ˜¯åè´µåƒé‡‘ï¼Œä»–æ˜¯å•†ç•Œç²¾è‹±ã€‚ ä»–ä»¬çš„è®¢å©šç¤¼ä¸Šï¼Œå¥¹æƒ¨é­èƒŒå›ã€‚ çˆ¶äº²æ°”è¡€æ”»å¿ƒå½“åœºæ˜å€’ï¼Œå†ä¹Ÿæ²¡æœ‰é†’æ¥ã€‚ è‡ªå·±æ›´è¢«æœªå©šå¤«åºŠä¸Šçš„å¥³äººé™·å®³å…¥ç‹±. è«ä»²æ™–è¿™ä¸ªè®©å¥¹åˆçˆ±åˆæ¨çš„ç”·äººå‡ ä¹æˆäº†å¥¹è¿™ä¸‰å¹´çš„æ¢¦é¥ã€‚ ä¸‰å¹´çš„ç‰¢ç‹±ï¼Œå†å‡ºæ¥ï¼Œå¥¹ä¸€æ— æ‰€æœ‰ï¼Œè€Œä»–å·²æ˜¯æ±ŸåŸç¿»æ‰‹ä¸ºäº‘è¦†æ‰‹ä¸ºé›¨çš„ç¥ç§˜è§’è‰²ã€‚  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;æ²³æ¸…æµ·æ™ä¸ƒä¸ƒ&#x27;</span>, <span class="hljs-number">980000</span>, <span class="hljs-number">513</span>, <span class="hljs-number">212342</span>, <span class="hljs-number">36236</span>, <span class="hljs-number">2</span>, <span class="hljs-number">29</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1142314</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">7</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:02&#x27;</span>, <span class="hljs-string">&#x27;2018-09-04 08:54:15&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ç­é­”æˆåœ£&#x27;</span>, <span class="hljs-string">&#x27;  æ¨èã€Šå¯»é¾™ä¼ ã€‹ã€Šé­‚æ‘„å¤©ä¸‹ã€‹ ä½œå“å±ç„å¹»å¼‚ç•Œå¤§é™†é£æ ¼ï¼ å¯æƒœé¢‘é“ä¸èƒ½æ›´æ”¹åªèƒ½åœ¨å¥‡å¹»æ··ï¼ ä¹¦å‹ç¾¤ï¼š292...  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;ç­‰å¾…æ½‡æ¹˜è¯—ç¤¾&#x27;</span>, <span class="hljs-number">345004</span>, <span class="hljs-number">13</span>, <span class="hljs-number">5353</span>, <span class="hljs-number">63263</span>, <span class="hljs-number">2</span>, <span class="hljs-number">29</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2314</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:03&#x27;</span>, <span class="hljs-string">&#x27;2018-09-03 21:54:27&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;æˆ‘çš„åˆç§Ÿç¾å¥³æ€»è£&#x27;</span>, <span class="hljs-string">&#x27;  å’Œç¾å¥³åŒå±…æ˜¯ä¸€ä»¶å¾ˆå¿«ä¹å¾ˆäº«å—çš„äº‹æƒ…å—ï¼Ÿçœ‹çœ‹å…µç‹æ›¹å°é›·è„¸ä¸Šè›‹è›‹çš„å¿§ä¼¤ï¼Œå¤§å®¶è¿˜æ˜¯é†’é†’å§ï¼ä»–å¥½æƒ³å¥½æƒ³å‘Šè¯‰éš”å£æˆ¿é—´çš„åˆ˜è–‡è–‡ï¼Œèƒ½ä¸èƒ½åˆ«åœ¨å®¢å…é‡Œé»„ç“œè˜¸èœ‚èœœå®æ¥å®å»ï¼Ÿèƒ½ä¸èƒ½æ™šä¸Šå…‰æºœæºœç²¾æ²¹æŒ‰æ‘©çš„æ—¶å€™æ‹‰å¥½çª—å¸˜ï¼Ÿæˆ‘ç”Ÿç†å¾ˆæ­£å¸¸ï¼Œè‚ å­å¾ˆèŠ±èŠ±ï¼Œçˆ±å¥½è‹è€æ¹¿ï¼Œä½ ä¸«åˆ«é€¼äººå¤ªç”šï¼  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;è–¯æ¡&#x27;</span>, <span class="hljs-number">890000</span>, <span class="hljs-number">5435</span>, <span class="hljs-number">3553</span>, <span class="hljs-number">543</span>, <span class="hljs-number">2</span>, <span class="hljs-number">29</span>, <span class="hljs-number">1</span>, <span class="hljs-number">412356</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">9</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:03&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:07&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å¸¦ç€æ­»ç¥å»ç©¿è¶Š&#x27;</span>, <span class="hljs-string">&#x27;  ä¸€ååœ°çƒçš„å¹³å‡¡çš„å°‘å¹´ï¼Œå› ä¸ºä¸€åœºæ¸¸æˆï¼Œè·å¾—æ­»ç¥çš„ä¼ æ‰¿ï¼Œä»è€Œç©¿è¶Šåˆ°å¦å¤–ä¸€ç‰‡é™Œç”Ÿçš„å¤§é™†ï¼Œä»æ­¤å¼€å¯äº†ä¸€æ®µä¼ å¥‡çš„äººç”Ÿï¼Œä¹å¤©æ˜Ÿæ²³ï¼Œå¾ä¹ƒæ­»ç¥ï¼ŒæŒæ§ç”Ÿæ­»ï¼Œåˆ¤å¤ºç½ªæ¶ï¼Œæˆ‘ä»æ²¡è§è¿‡åœ°ç‹±ï¼Œå› ä¸ºæˆ‘çš„åå­—ï¼Œä¾¿ä»£è¡¨åœ°ç‹±ï¼Œå¾ä¹ƒæ­»ç¥ï¼Œå¾åæ—å¤©ã€‚ï¼ˆPSï¼šå•å¥³ä¸»ï¼Œçˆ½æ–‡ä¸è™å¿ƒï¼Œä¸»è§’ä»¥æ€è¯é“ï¼Œæ€è¯¥æ€ä¹‹äººï¼Œä¸åœ£æ¯ï¼Œç•¥è…¹é»‘ï¼‰ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šå¸¦ç€æ­»ç¥å»ç©¿è¶Šã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼å¸¦ç€æ­»ç¥å»ç©¿è¶Šæœ€æ–°ç« èŠ‚,å¸¦ç€æ­»ç¥å»ç©¿è¶Šæ— å¼¹çª—,å¸¦ç€æ­»ç¥å»ç©¿è¶Šå…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;æ¢¦ä¾&#x27;</span>, <span class="hljs-number">233000</span>, <span class="hljs-number">6326</span>, <span class="hljs-number">34252</span>, <span class="hljs-number">523</span>, <span class="hljs-number">2</span>, <span class="hljs-number">29</span>, <span class="hljs-number">1</span>, <span class="hljs-number">135</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">10</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:03&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:07&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;äº¡çµä¸èŠ¯ç‰‡&#x27;</span>, <span class="hljs-string">&#x27;  ä¸€ä½è‰è”ä¸–ç•Œå† å†›æ•°è½½çš„ç”µå­ç«æŠ€ç©å®¶ï¼Œåœ¨ä¸€æ¬¡æ¯”èµ›ä¸­ï¼Œå¤©é™é»‘è‰²é—ªç”µï¼Œå¸¦ç€ä¸»è§’å¼ è¿œè¿˜æœ‰ä¸€æšåœ°çƒä¸Šæœ€å…ˆè¿›çš„èŠ¯ç‰‡ã€ç©¿è¶Šåˆ°äº†å‰‘ä¸é­”æ³•çš„ä¸–ç•Œã€‚æ•…äº‹æ²¡æœ‰yyï¼Œæƒ…èŠ‚å‘å±•æœ‰è¿¹å¯å¯»ã€‚æ²¡æœ‰ç§é©¬ï¼Œæ‰€æœ‰çˆ±æƒ…èµ·äºç‚¹æ»´ã€‚æ›´æ²¡æœ‰ç”·ä¸»è™èº¯ä¸€éœ‡ã€ä»è€…äº‘é›†ï¼Œæœ‰çš„åªæ˜¯åŒç”Ÿå…±æ­»ç§¯ç´¯çš„å‹æƒ…ï¼Œè¿™ã€å°±æ˜¯ä¼™ä¼´çš„æ„ä¹‰ã€‚ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šäº¡çµä¸èŠ¯ç‰‡ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼äº¡çµä¸èŠ¯ç‰‡æœ€æ–°ç« èŠ‚,äº¡çµä¸èŠ¯ç‰‡æ— å¼¹çª—,äº¡çµä¸èŠ¯ç‰‡å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å†¬å†¬ä¸œ&#x27;</span>, <span class="hljs-number">2559900</span>, <span class="hljs-number">5</span>, <span class="hljs-number">431</span>, <span class="hljs-number">42135</span>, <span class="hljs-number">2</span>, <span class="hljs-number">29</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4124</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">11</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:03&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:08&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ç©¿è¶Šå°é“äºº&#x27;</span>, <span class="hljs-string">&#x27;  å°æé£åˆ€é‡Œé¢:â€œé£åˆ€å‰å®³ï¼Ÿæˆ‘çš„ç¬¦å’’å¦‚ä½•ï¼Ÿâ€ä»™å‰‘ä¸‰:â€œè¿™å°±æ˜¯åƒé‡Œä¹‹å¤–å–äººé¦–çº§çš„å‰‘å•Šï¼â€çº¢æ¥¼æ¢¦é‡Œé¢ï¼šâ€œè´¾å®ç‰é‚£å—é€šçµå®ç‰åº”è¯¥æ˜¯ä¸ªçµå®çº§çš„ï¼Œææ¥ææ¥ã€‚â€ä¸‰å›½æ¼”ä¹‰ï¼šâ€œæ’’è±†æˆå…µï¼Œé»„å·¾åŠ›å£«ï¼Œã€Šå¤ªå¹³å¤©ä¹¦ã€‹ï¼Œä»™æœ¯å•Šï¼Œå¼ è§’ï¼Œä½ åˆ«è·‘ï¼â€è¥¿æ¸¸è®°ï¼šâ€œå‘¼ï¼Œç»ˆäºåˆ°äº†ä»™ç•Œäº†ã€‚â€ä¸‰ä½“ï¼šâ€œäºŒå‘ç®”ï¼Œçœ‹æˆ‘èŠ¥å­é¡»å¼¥ä¹‹æœ¯ã€‚â€æ¼«å¨:â€œoaaï¼Ÿä»€ä¹ˆä¸œè¥¿ï¼Ÿâ€å°é“äººè½¬èº«ï¼Œä¸€åŒçœ¼çœ‹äº†è¿‡æ¥ï¼šâ€œå‘µï¼æ‰§ç¬”è€…ï¼Ÿâ€ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šç©¿è¶Šå°é“äººã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼ç©¿è¶Šå°é“äººæœ€æ–°ç« èŠ‚,ç©¿è¶Šå°é“äººæ— å¼¹çª—,ç©¿è¶Šå°é“äººå…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;æ¥šéªš&#x27;</span>, <span class="hljs-number">455000</span>, <span class="hljs-number">342536</span>, <span class="hljs-number">23545</span>, <span class="hljs-number">53533254</span>, <span class="hljs-number">2</span>, <span class="hljs-number">29</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2431</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">12</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:03&#x27;</span>, <span class="hljs-string">&#x27;2018-09-06 20:58:34&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å¨æ­¦å°å¨˜å­&#x27;</span>, <span class="hljs-string">&#x27;  æœç­±ç–åšäº†ä¸ªå™©æ¢¦ï¼Œæ¢¦é‡Œå¨˜è¢«äººå®³æ­»ï¼Œå¥¹ä¹Ÿæ²¡å¾—åˆ°å¥½ä¸‹åœºã€‚ä¸€ççœ¼ï¼šæˆçœŸäº†ï¼æ—¢ç„¶æœ‰äººè¦èµ¶å°½æ€ç»ï¼Œå°±åˆ«æ€ªå¥¹ä»¥ç‰™è¿˜ç‰™ï¼è°çŸ¥ä¸ºå¨˜æŠ¥ä»‡æ„å¤–å‘ç°èº«ä¸–ï¼šå“­ï¼Œæ˜¯æ¡çš„ï¼å¥½ä¸å®¹æ˜“æœ‰ä¸ªå¯¹çœ¼çš„å°‘å¹´ï¼šå™—ï¼Œæ˜¯èˆ…èˆ…ï¼æ—¢ç„¶å¥¹çš„äººç”Ÿæ˜¯ä¸€ä¸ªå‘è¿ç€ä¸€ä¸ªå‘ï¼Œä¸å¦‚å‡¿æˆä¸€æ¡æ²³ï¼Œæ”¾å¼€æ¥é€ ä½œå§ï¼ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šå¨æ­¦å°å¨˜å­ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼å¨æ­¦å°å¨˜å­æœ€æ–°ç« èŠ‚,å¨æ­¦å°å¨˜å­æ— å¼¹çª—,å¨æ­¦å°å¨˜å­å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;ç‡•ä¸ƒçˆ±åƒé±¼&#x27;</span>, <span class="hljs-number">2389400</span>, <span class="hljs-number">325</span>, <span class="hljs-number">4325</span>, <span class="hljs-number">324</span>, <span class="hljs-number">2</span>, <span class="hljs-number">29</span>, <span class="hljs-number">0</span>, <span class="hljs-number">213</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">13</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:03&#x27;</span>, <span class="hljs-string">&#x27;2018-09-10 08:45:40&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å†°ç«ç ´åç¥&#x27;</span>, <span class="hljs-string">&#x27;  å½“å·¨é¾™çš„æ—¶ä»£æ¸æ¸ç»ˆç»“ï¼Œå½“æœ¯å¸ˆä»¬åœ¨æ˜Ÿç©ºä¸‹ç•™ä¸‹æ— æ•°çš„è´¢å¯Œå’Œä¼ è¯´ï¼Œä¸€ä¸ªä¸ªè§‰é†’çš„å°‘å¹´ï¼Œä¾¿å¼€å§‹è¸ä¸Šä»–ä»¬çš„å¾é€”ã€‚  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;æ— ç½ª&#x27;</span>, <span class="hljs-number">23452343</span>, <span class="hljs-number">325324</span>, <span class="hljs-number">52</span>, <span class="hljs-number">555</span>, <span class="hljs-number">2</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">412</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">14</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:04&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;åå¹´ç›¸æ‹ä¸ç›¸çŸ¥&#x27;</span>, <span class="hljs-string">&#x27;  åå¹´ä¹‹å‰ï¼Œå¥¹å–œæ¬¢ä»–ï¼Œè€Œä»–ä¸çŸ¥é“ã€‚åå¹´ä¹‹åï¼Œä»–çˆ±æ‹å¥¹ï¼Œå¯å¥¹å´ä¸åœ¨ã€‚ä¸€æ®µä¸æºæ‚ä»»ä½•å…¶ä»–åˆ©ç›Šçš„çº¯æƒ…çˆ±æ‹ä¹‹æ—…ï¼Œç©¶ç«Ÿæ‹æƒ…çš„ç»ˆç‚¹åœ¨ä½•æ–¹ï¼Ÿæ—…é€”çš„ç»“å±€åˆå°†æ€æ ·ï¼Ÿ677577335æœ¬ä¹¦ç¾¤ï¼Œå„ä½å–œæ¬¢æœ¬ä¹¦çš„ä¸å–œæ¬¢æœ¬ä¹¦çš„éƒ½å¯ä»¥è¿›æ¥ï¼Œåªè¦æ˜¯å–œæ¬¢çœ‹å°è¯´çš„éƒ½å¯ä»¥è¿›æ¥èŠèŠ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šåå¹´ç›¸æ‹ä¸ç›¸çŸ¥ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼åå¹´ç›¸æ‹ä¸ç›¸çŸ¥æœ€æ–°ç« èŠ‚,åå¹´ç›¸æ‹ä¸ç›¸çŸ¥æ— å¼¹çª—,åå¹´ç›¸æ‹ä¸ç›¸çŸ¥å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;é’æ¾ä¸æœ½&#x27;</span>, <span class="hljs-number">2355421</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5534</span>, <span class="hljs-number">42314</span>, <span class="hljs-number">2</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">231</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">15</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:04&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ç»ˆææ•™å¸ˆ&#x27;</span>, <span class="hljs-string">&#x27;  æœ±é›€ä¸­å­¦æ ¡è§„ï¼šã€€ã€€ ç¬¬ä¸€æ¡ï¼Œç¦æ­¢å¸ˆç”Ÿæ‹ï¼ã€€ã€€ ç¬¬äºŒæ¡ï¼Œç¦æ­¢å¸ˆç”Ÿæ‹ï¼ã€€ã€€ ç¬¬ä¸‰æ¡ï¼Œç¦æ­¢å¸ˆç”Ÿæ‹ï¼ â€”â€”â€”- ã€€ã€€ æˆ‘åšå®šä¸ç§»çš„è®¤ä¸ºç©¿ç™½è‰²åŠé€æ˜è¡¬è¡£ï¼Œé‡Œé¢çš„é»‘è‰²Braè‹¥éšè‹¥ç°çš„å­¦ç”Ÿå¦¹å­æ‰æ˜¯æœ€æ€§æ„Ÿçš„å¥³ç¥ï¼  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;æŸ³ä¸‹æŒ¥&#x27;</span>, <span class="hljs-number">2143214</span>, <span class="hljs-number">523</span>, <span class="hljs-number">5555</span>, <span class="hljs-number">234</span>, <span class="hljs-number">2</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">512</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">16</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:04&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;é‚ªç‹ç»å® è›‡èå«¡å¦ƒ&#x27;</span>, <span class="hljs-string">&#x27;  â€œå¤ªå­æ®¿ä¸‹ï¼Œä»Šæ—¥ä¸æ˜¯ä½ æ¯å©šï¼Œè€Œæ˜¯æˆ‘æ¯å©šã€‚æˆ‘èŠ±æƒŠç¾½ä¸å«æ¸£ç”·ï¼Œä¸å«ç§çŒªç”·ï¼Œè¦å«ä¾¿å«å® æˆ‘ä¸Šå¤©ç–¼æˆ‘å…¥åœ°ï¼Œä¸€ç”Ÿåªå¨¶ä¸€å¦»çš„ç”·äººã€‚â€ ä¸€é“åœ£æ—¨é€åˆ°å¤ªå­é¢å‰ï¼Œå¤ªå­è„¸è‰²ç¬é—´é’é»‘ä¸€ç‰‡ï¼Œæ»¡å ‚å®¾å®¢çš†å¤±è‰²ã€‚ å¥¹ï¼Œé­é­‰ç»„ç»‡çš„é‡‘ç‰Œåˆ¶æ¯’å¸ˆï¼Œä¸€æœç©¿è¶Šæˆäº†ä»»äººæ¬ºå‡Œçš„å¯æ€œå¤ªå­å¦ƒï¼Œçˆ¹ä¸ç–¼å¦¹ä¸çˆ±ï¼Œè¿˜è¢«ç™¾èˆ¬æ¬ºå‡Œã€‚ éª‚æˆ‘çš„ï¼Œæ¶æ¯’çš„éª‚å›å»ã€‚æ‰“æˆ‘çš„ï¼Œç‹ ç‹ çš„æ‰“å›å»ã€‚ç®—è®¡æˆ‘çš„ï¼Œç™¾å€åƒå€çš„ç®—è®¡å›å»ã€‚ å¯æ˜¯è¿™äº›æ¸£ç”·æ¸£å¥³ä¸€ä¸ªä¸ªèµ¶ç€é€ä¸Šé—¨è®©å¥¹æ”¶æ‹¾ï¼Œé‚£å°±åˆ«æ€ªå¥¹å†·è¡€æ— æƒ…ï¼Œå¿ƒç‹ æ‰‹è¾£äº†ï¼Œå¼„ä¸æ­»ä½ ä¹Ÿè¦å¼„æ®‹ä½ ã€‚ ä»–ï¼Œå¸å›½å®¶å–»æˆ·æ™“ï¼Œé—»ä¹‹å˜è‰²çš„å—œè¡€é‚ªç‹ï¼Œä»æ— ä¸€ç‰©å…¥çœ¼ï¼Œå´å¼ºåŠ¿éœ¸é“çš„ç¼ ä¸Šå¥¹ï¼Œçœ‰çœ¼ç¼ç¼ï¼Œé‚ªé­…å‹¾å¼•ï¼šâ€œæˆ‘å® ä½ ä¸Šå¤©ï¼Œç–¼ä½ å…¥åœ°ï¼Œè¦ä¸è¦ï¼Ÿâ€ ç²¾å½©å¯¹è¯ä¸€ï¼š â€œç¾½å„¿ï¼Œè¿™ä¸€æ¬¡æˆ‘çœŸå¿ƒè¯šæ„çš„å‘ä½ æäº²ï¼Œå¨¶ä½ åšæˆ‘çš„ä¸œå®«å¤ªå­å¦ƒï¼Œæœªæ¥ç‡•äº‘å›½çš„çš‡åå¨˜å¨˜ã€‚â€ â€œæ ‘ä¸è¦çš®å¿…æ­»æ— ç–‘ï¼Œäººä¸è¦è„¸å¤©ä¸‹æ— æ•Œï¼Œå¤ªå­æ®¿ä¸‹çš„è„¸çš®å ªç§°ä¸€ç»ã€‚â€ â€œç¾½å„¿ï¼Œæˆ‘é”™äº†ï¼Œä½ åŸè°…æœ¬å®«ä¸€å›å§ã€‚â€ â€œæˆ‘çœ‹è§ä½ è¿™å¼ ç ´è„¸å°±æƒ³å¼„æ®‹ä½ ï¼Œæ›´åˆ«æä¸Šä½ è¿™ç ´èˆ¹äº†ï¼Œæ»šå§ã€‚â€ ç²¾å½©å¯¹è¯äºŒï¼š â€œåŒ—å¹½ç‹æ®¿ä¸‹ï¼Œä½ ä¸æ˜¯è¯´ä½ æ˜¯æ–­è¢–å—ï¼Ÿâ€å¥³å­æ°”æ€¥è´¥åçš„å†·å“¼ã€‚ â€œä¸æ˜¯æˆ‘è¯´çš„ï¼Œæ˜¯ä½ è¯´çš„ã€‚â€ â€œé‚£ä½ è¯´ä»€ä¹ˆéš¾è¨€ä¹‹éšï¼Œè¯´ä»€ä¹ˆè®©æˆ‘å¸®ä½ æ²»ï¼ŒåŸæ¥æ˜¯å æˆ‘çš„ä¾¿å®œåƒæˆ‘çš„è±†è…è´¥ã€‚â€ â€œè²Œä¼¼æœ¬ç‹æ‰æ˜¯æ¯”è¾ƒåƒäºçš„é‚£ä¸€ä¸ªï¼Œä½ åƒæˆ‘çš„è±†è…æ¯”æˆ‘åƒä½ çš„è±†è…å¤šï¼Œâ€ä¿Šç¾éœ¸æ°”çš„ç”·å­ä¸€è„¸çš„å§”å±ˆã€‚ â€œæ„æ€æ˜¯ç‹çˆ·ä½ åƒäºäº†ï¼Ÿâ€å¥³å­å¾®çœ¯çœ¼ä¸Šï¼Œé˜´ä¾§ä¾§çš„å¼€å£ã€‚ â€œä¸åƒäºï¼Œåªè¦ä½ å¯¹æˆ‘è´Ÿè´£å°±å¥½ã€‚â€ â€œå‡­ä»€ä¹ˆè¦æˆ‘è´Ÿè´£ã€‚â€ â€œæœ¬ç‹è´Ÿè´£ä¹Ÿè¡Œï¼Œæˆ‘å® ä½ ï¼Œæˆ‘ç–¼ä½ ï¼Œå¯å¥½ï¼Ÿâ€  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;å´ç¬‘ç¬‘&#x27;</span>, <span class="hljs-number">3859643</span>, <span class="hljs-number">245632</span>, <span class="hljs-number">4223</span>, <span class="hljs-number">43325</span>, <span class="hljs-number">2</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">51251</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">17</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:04&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ç¥é­”éœ¸ä½“&#x27;</span>, <span class="hljs-string">&#x27; æ‹“æ‹”é‡é€†å¤©é‡ç”Ÿã€èº«è—ç¥æ ¹ã€æ‰‹æ¡ç¥ç¬¦ã€æ‹¥æœ‰å‰ä¸–è®°å¿†ï¼Œä»å°å¼€å§‹ä¿®ç‚¼æœ€éš¾ä¿®ç‚¼çš„ç‚¼ä½“æ³•å†³ç¥é­”ä¹å˜ã€‚ ã€€ã€€ç¥é­”ä¹å˜ï¼Œæ¯ä¿®ç‚¼æˆåŠŸä¸€å˜ï¼Œä¸ä½†è‚‰ä½“åŠ›é‡æš´å¢ï¼Œè¿˜å¤šä¸€äº›ç¥å¥‡çš„æœ¬é¢†ã€‚ ã€€ã€€ä¸ºäº†ä¿®ç‚¼ç¥é­”ä¹å˜ï¼Œæ‹“æ‹”é‡èµ°éæ— æ•°æ˜Ÿå®‡ä¸–ç•Œï¼Œé—¯è¿‡æ— æ•°é™©åœ°ç»åŸŸï¼Œå¤§æˆ˜ç¥é­”ç¥å…½é¬¼ç¥ã€‚ ã€€ã€€æœ€ç»ˆï¼Œç¥é­”ä¹å˜å¤§æˆï¼Œæˆå°±çœŸæ­£çš„ç¥é­”éœ¸ä½“ï¼Œæ— æ•Œè¯¸å¤©ä¸‡ç•Œã€‚ ã€€ã€€å®Œæœ¬è€ä¹¦ã€Šå…­é“ä»™å°Šã€‹ï¼Œäº”ç™¾äºŒåä¸‡å­—ï¼Œäººå“ä¿è¯ï¼æ”¾å¿ƒæ”¶è—ï¼ ã€€ã€€è€äº‘æ–°ä¹¦ç¾¤ã€€229522850  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;äº‘éœ†é£&#x27;</span>, <span class="hljs-number">2456235</span>, <span class="hljs-number">3532</span>, <span class="hljs-number">5535</span>, <span class="hljs-number">5434</span>, <span class="hljs-number">2</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5154</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">18</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:04&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å¦–å¨†å¬å”¤å¸ˆ&#x27;</span>, <span class="hljs-string">&#x27;  åä¸ºâ€œå¦–å¨†â€çš„æ— è‰¯å°‘å¥³ï¼Œè¢«ä¸€æšè¯¡å¼‚çš„é»‘æš—é­”ç é™„èº«ï¼ŒäºŒæ¬¡ç©¿è¶Šå¼‚ä¸–ã€‚ å¥¹æ˜¯è¢«ç–¯å­å¸¦å¤§çš„å°ä¹ä¸ï¼Œä¸‡å¹´ä¸é‡çš„â€œåºŸæâ€è´Ÿçµæ ¹ã€‚ å—åˆ°é»‘æš—é­”ç å½±å“è€Œå¸¦æœ‰è¢«ä¸–äººå”¾å¼ƒçš„æš—ä¹‹åŠ›çš„â€œé‚ªæ¶é­”å¥³â€ï¼ é­”äº‘å®—è¦åå™¬å¥¹ï¼šâ€œä½ çš„åŠ›é‡åŒ–ä¸ºæˆ‘ç”¨å¯å¥½ï¼Ÿâ€ å…‰æ˜é˜µè¥è¦ç»æ€å¥¹ï¼šâ€œé­”å¥³ï¼å“ªé‡Œé€ƒï¼â€ å¼ºå¤§æˆ˜ç¥è¦å‹’ç´¢å¥¹ï¼šâ€œç”¨è¿™å¹»å™¨ï¼Œä½ ä¸é…ï¼â€ å…‰ä¸æš—ï¼Œçš†ä¸å®¹å¥¹åœ¨ä¸–é—´å­˜åœ¨ï¼ å–„ä¸æ¶ï¼Œè°æ‰é™ªå¥¹ç›´æ£é»„é¾™ï¼Ÿ â€œæƒ³åå™¬æˆ‘çš„ï¼æŠŠä½ ä»¬çš„å®è—éƒ½æ‹¿å‡ºæ¥å§ï¼â€ â€œæƒ³ç»æ€æˆ‘çš„ï¼ç”¨è½®å›é¼æŠŠä½ ä»¬éƒ½ç‚¼æˆæ´»äººè¯ä¸¹ï¼â€ â€œæƒ³å‹’ç´¢æˆ‘çš„ï¼æœ¬å§‘å¨˜è¦ä½ çœ‹çœ‹ä»€ä¹ˆæ‰æ˜¯å¼ºï¼ç›—ï¼ç‹ï¼â€ å¤´å¸¦æ¤ç³»ç‹—è¡€ç‰¡ä¸¹çš‡ï¼è„šè¸èµ¤ç«çƒˆç„°ç‚¸æ¯›é¸¡ï¼æ‰‹æŒæ€äººç‚¼ä¸¹è½®å›é¼â€¦â€¦ å¼ºå¥‘å¼‚å…½ï¼æš—é©­é­”ä»†ï¼ å¬å”¤ï¼ç¥å…½çº§ä»¥ä¸‹çš„å–½å•°é€šé€šè®©å¼€ï¼ â€œæˆ‘ä»¥æœ±é›€åœ£ç«ï¼Œé©æ–°è¿™ä¸ªä¸–ç•Œï¼â€ ä¸”çœ‹å¥³ä¸»ä»¥å¦©åªšçš„çœ¼æ³¢ç©è½¬ä¸–é—´é«˜æ‰‹ï¼Œä»¥è…¹é»‘å¼ºå¤§çš„æ‰‹æ®µç‹‚æˆ˜å¤©ä¸‹ç¾¤é›„ï¼ æœ¬æ–‡ä¸€å¯¹ä¸€ çˆ†ç¬‘+å¥³å¼º+è…¹é»‘+æˆé•¿ å°æ¶æï¼ŒçœŸç„å¹»~ æ­¤æ–‡ä»æ— æ–­æ›´è®°å½•ï¼Œæƒ…èŠ‚ç²¾å½©ï¼Œæ¬¢è¿å„è·¯é“å‹çƒ­æƒ…è·³å‘~ â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—† â€”â€”â€”â€”äººç‰©æ‰“æ²¹è¯—ä¸€é¦–â€”â€”â€”â€” â—†å¥¹æœ‰ä¸€ä¸ªæ— èŠçš„æ—¶å€™å°±ä¼šç‚¹èµ·â€œç­é­”ç¥ç„°â€çƒ§æŸ´ç©çš„ç–¯çˆ¹çˆ¹ï¼šâ€œå¦–å¦–ï¼Œæˆ‘é¥¿ï¼Œæˆ‘è¦åƒå¤§é¸¡è…¿ï¼â€ â—†å¥¹æœ‰ä¸€åªäººè§äººä¸çˆ±ï¼ŒèŠ±è§èŠ±ä¸å¼€çš„æ¤ç³»æˆ˜å…½ï¼šâ€œæˆ‘æ˜¯ä¸‘å…«æ€ªï¼Œå—¯ï¼Œå¦–å¦–è¯´è¿‡æˆ‘æ˜¯ä¸‘å…«æ€ªï¼Œæˆ‘çš„çœ¼ï¼Œåªæ¯”æ˜Ÿæ˜Ÿç’€ç’¨é‚£ä¹ˆä¸€ç‚¹ç‚¹ï¼Œæˆ‘çš„è„¸ï¼Œåªæ¯”å…ˆå¤©å¤§å¸å¸…é‚£ä¹ˆä¸€ç‚¹ç‚¹ï¼Œæˆ‘å¾ˆè‡ªå‘ï¼Œè¯·ä¸è¦è·Ÿæˆ‘è®²è¯ã€‚â€ â—†å¥¹æœ‰ä¸€ä¸ªé’±æ¯”å‘½é‡è¦ï¼Œæœ‰é’±å°±æ˜¯å¨˜çš„å°‘å¹´å¤§ç®¡å®¶ï¼Œå¦‚æœé—®ä»–è¦é’±è¿˜æ˜¯è¦å‘½ï¼Œä»–ä¼šç›´æ¥å››ä»°å…«å‰å€’åœ¨åœ°ä¸Šï¼šâ€œå¤§çˆ·ï¼Œå¥´å®¶ä¸€å¤œï¼Œåªè¦ä¸€ä¸ªé‡‘å¸ã€‚â€ â—†å¥¹æœ‰ä¸€ä¸ªéªšåŒ…çš„çº¢å‘è¿½æ±‚è€…ï¼šâ€œæ¥çš„ç¾å¥³ä»¬ï¼Œå¿«ç•™ä¸‹ä½ ä»¬çš„â€˜æ”¶è—â€™ï¼Œä¸ç„¶æœ¬å…¬å­æ»šåœ°åŠæœˆï¼Œç»ä¸å‡ºå…³ï¼â€ Oï¼ˆâˆ©ï¼¿âˆ©ï¼‰O~ â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—† ----------å…¬å‘Šæ¿---------- â—†æœ¬æ–‡æ¯æ—¥æ›´æ–°æ—¶é—´â—† å¦‚æ— ç‰¹åˆ«é€šçŸ¥ï¼Œæ¯æ—¥ä¸Šåˆä¹ç‚¹å·¦å³ 5000+ Oï¼ˆâˆ©ï¼¿âˆ©ï¼‰O~ â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—† æ¨èç„å¹»å¥½æ–‡ã€Šç››ä¸–é‚ªå‡°ã€‹ BYï¼šæœˆæ¸…æ ‘å½± å¥¹çš„å€¾æƒ…ä»˜å‡ºï¼Œç»ˆæŠµä¸è¿‡ä¸€å¥åŠŸé«˜ç›–ä¸»ã€‚ äº²å‹çš„å€’æˆˆï¼Œçˆ±äººçš„èƒŒå›ï¼Œè®©å¥¹å¿ƒå¦‚æ­»ç°ã€‚ å”¯æœ‰ä»–ä¾æ—§ç«™åœ¨å¥¹èº«è¾¹ï¼Œæ‹¥å¥¹å…¥æ€€ã€‚ â€œä»¥å¾ä¹‹å¿ƒï¼Œäºˆæ±é‡ç”Ÿï¼Œè½¬ä¸–ä¹‹é­‚ï¼Œç”Ÿç”Ÿç›¸ä¼´ï¼Œä¸ç¦»ä¸å¼ƒã€‚å¥‘ï¼â€ æµ´ç«é‡ç”Ÿï¼Œå†æ¬¡ççœ¼ï¼Œå¥¹å·²å…¥é­”ï¼ ä¸”çœ‹å¥¹å¦‚ä½•åœ¨è¿™è†æ£˜ä¸­ç ´å¼€é‡é‡è¿·é›¾ï¼Œå‡­å€Ÿç€è‡ªå·±çš„åŠªåŠ›ä¸€æ­¥æ­¥èµ°å‘äº‘ç«¯ï¼Œå°†æ›¾ç»çš„è€»è¾±ä¸€åŒè¸©åœ¨è„šä¸‹ï¼ å†ä¸–ä¸ºäººï¼Œå¥¹â€”â€”æ³¨å®šå…‰èŠ’ä¸‡ä¸ˆï¼ â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—† ï¼ï¼ï¼ï¼äººç‰©è®¤å…»å°åº—ï¼ï¼ï¼ ã€ç–¯ å­ã€‘ ç”± ç¾½æ¯› è®¤å…» ã€å¦– å¨†ã€‘ ç”± å…¬å­é™Œå‡Œ è®¤å…» ã€ç¿¦ ç¾½ã€‘ ç”± æœˆæ¸…æ ‘å½± è®¤å…» ã€ç™½ å¤œ ä¸€ã€‘ ç”± åˆ‘å†·å¢¨ è®¤å…» ã€ç“¦ ä¼¦ã€‘ ç”± ç‘•æ‹ è®¤å…» ã€é¾™ è§‰ã€‘ ç”± è²å¿ƒç´«ç’ƒ è®¤å…» ã€ä¸‘ ä¸‘ã€‘ ç”± å¾ä¾ç³¯ è®¤å…» ã€å…ƒ æ–¹ã€‘ ç”± å°æ®‹ è®¤å…» ã€ç‰§é‡å¯’æ±Ÿã€‘ ç”± å…”å…” è®¤å…» ã€çº³ å¤š å¤šã€‘ ç”± å¦å„¿ è®¤å…» ã€éº’ éºŸ ç‹ã€‘ ç”± 954637819 è®¤å…» ã€çƒˆç„°é£é¹°ã€‘ ç”± å¤è½©æœˆ è®¤å…» ã€æ‹” è‰ å„¿ã€‘ ç”± äº‘å½±æ‚ ç„¶ è®¤å…» ã€é’ å›ã€‘ ç”± å¿˜æƒ…ç´«é›ª è®¤å…» ã€æ³¥ å·´ å›¢ã€‘ ç”± åªšå¦† è®¤å…» ã€èµ¤ ç«ã€‘ ç”± åªšå¦† è®¤å…» ã€äºŒ æ¯›ã€‘ ç”± å°¤å…® è®¤å…» ã€æµ·æ¶…å®—å¸ˆã€‘ ç”± ysfengy è®¤å…» ã€å§¬ å¤© ç™½ã€‘ ç”±xanxus1896 è®¤å…» ã€ ç‚ ã€‘ ç”± å¤è½©æœˆ è®¤å…» ã€ç™¾ é‡Œ å°˜ã€‘ ç”± å°å¯çˆ± è®¤å…» ã€æˆ˜ è™ã€‘ ç”± è“ è®¤å…» ã€ç­ äº‘ é£ã€‘ ç”± æœˆä¾æµ…é›ª è®¤å…» ã€è¡€ å ä¸‰ã€‘ ç”± ç”±å¤œ è®¤å…» ã€å…­ çµ ç ã€‘ ç”± kanshu001 è®¤å…» ã€å›¡ å›¡ã€‘ ç”±1003695331è®¤å…» â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—†â—† ï¼ï¼ï¼ï¼å¥½æ–‡æ¨èï¼ï¼ï¼ æˆ‘çš„æ—§æ–‡ ã€Šçºµç´«ã€‹ åˆ‘å†·å¢¨ ã€Šå¼‚ç«ç„šå¤©ã€‹ æœˆæ¸…æ ‘å½± ã€Šç››ä¸–é‚ªå‡°ã€‹ å…”æ¢“ ã€Šè„±çº¿é»‘å…¬ä¸»ã€‹ ä»™é­… ã€Šå¦–ä»™é­…ä¸–ã€‹ å¢¨å¢¨ ã€Šå“¥å“¥æ˜¯åªå¦–ã€‹ å³å¢¨è¡€å¤œ ã€Šæ­»ç¥æˆé•¿å²ã€‹  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;ç¿¦ç¾½&#x27;</span>, <span class="hljs-number">1333413</span>, <span class="hljs-number">34</span>, <span class="hljs-number">6543</span>, <span class="hljs-number">678898</span>, <span class="hljs-number">2</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">651223</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">19</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:04&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;æ°¸å¤œå›ç‹&#x27;</span>, <span class="hljs-string">&#x27;  åƒå¤œè‡ªå›°è‹¦ä¸­å´›èµ·ï¼Œåœ¨èƒŒå›ä¸­å è½ã€‚è‡ªæ­¤ä¸€ä¸ªäººï¼Œä¸€æŠŠæªï¼Œè¡Œåœ¨æ°¸å¤œä¸é»æ˜ä¹‹é—´ï¼Œå´èµ°å‡ºä¸€æ®µä¼ å¥‡ã€‚è‹¥æ°¸å¤œæ³¨å®šæ˜¯ä»–çš„å‘½è¿ï¼Œé‚£ä»–ä¹Ÿè¦æˆä¸ºä¸»å®°çš„ç‹ã€‚ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šæ°¸å¤œå›ç‹ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼æ°¸å¤œå›ç‹æœ€æ–°ç« èŠ‚,æ°¸å¤œå›ç‹æ— å¼¹çª—,æ°¸å¤œå›ç‹å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;çƒŸé›¨æ±Ÿå—&#x27;</span>, <span class="hljs-number">235212</span>, <span class="hljs-number">6342</span>, <span class="hljs-number">2343542</span>, <span class="hljs-number">6234</span>, <span class="hljs-number">2</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">143212</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">20</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:04&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;é›ªä¸­æ‚åˆ€è¡Œ&#x27;</span>, <span class="hljs-string">&#x27;  æœ‰ä¸ªç™½ç‹å„¿è„¸ï¼Œä½©åŒåˆ€ç»£å†¬æ˜¥é›·ï¼Œè¦åšé‚£å¤©ä¸‹ç¬¬ä¸€ã€‚æ¹–åº•æœ‰ç™½å‘è€é­çˆ±åƒè¤ã€‚ç¼ºé—¨ç‰™è€ä»†èƒŒå‰‘åŒ£ã€‚å±±ä¸Šæœ‰ä¸ªéª‘é’ç‰›çš„å¹´è½»å¸ˆå”ç¥–ï¼Œä¸æ•¢ä¸‹å±±ã€‚æœ‰ä¸ªéª‘ç†ŠçŒ«æ‰›å‘æ—¥è‘µä¸å¤ªå†·çš„å°‘å¥³æ€æ‰‹ã€‚ è¿™ä¸ªæ±Ÿæ¹–ï¼Œé«˜äººå‡ºè¡Œè¦æ³¨é‡å‡ºå°˜è£…æ‰®ï¼Œå¥³ä¾ è¡Œèµ°æ±Ÿæ¹–è¦æ³¨æ„åŸ¹å…»äººæ°”ï¼Œå®—æ´¾è¦è·Ÿåº™å ‚æ‰“å¥½å…³ç³»ã€‚ è€Œä¸»è§’ï¼Œåˆ™æ½‡æ´’å¸¦åˆ€ï¼ŒæŠŠæ±Ÿæ¹–æ…äº†ä¸€ä¸ªé€šé€ã€‚ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šé›ªä¸­æ‚åˆ€è¡Œã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼é›ªä¸­æ‚åˆ€è¡Œæœ€æ–°ç« èŠ‚,é›ªä¸­æ‚åˆ€è¡Œæ— å¼¹çª—,é›ªä¸­æ‚åˆ€è¡Œå…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;çƒ½ç«æˆè¯¸ä¾¯&#x27;</span>, <span class="hljs-number">35525</span>, <span class="hljs-number">353</span>, <span class="hljs-number">5345</span>, <span class="hljs-number">624</span>, <span class="hljs-number">2</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2314</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">21</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:04&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:05&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;åœ°çƒç¾å˜&#x27;</span>, <span class="hljs-string">&#x27;  ã€2017ç§‘å¹»å¾æ–‡ã€‘å‚èµ›ä½œå“ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šåœ°çƒç¾å˜ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼åœ°çƒç¾å˜æœ€æ–°ç« èŠ‚,åœ°çƒç¾å˜æ— å¼¹çª—,åœ°çƒç¾å˜å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;çŸ³æ…Œ&#x27;</span>, <span class="hljs-number">25254</span>, <span class="hljs-number">46236</span>, <span class="hljs-number">335</span>, <span class="hljs-number">5234</span>, <span class="hljs-number">2</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">412</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">22</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:05&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;æ±‚ç”Ÿæ¬²&#x27;</span>, <span class="hljs-string">&#x27;  è¿™ä¸ªä¸–ç•Œï¼Œäººå¹¶ä¸æ˜¯å”¯ä¸€çš„æ™ºæ…§ç”Ÿç‰©ï¼Œè¿˜æœ‰è¿™æ¯”äººæ›´é«˜çº§çš„ç”Ÿç‰©ï¼Œä»–ä»¬çœ‹å¾…äººçš„æ€åº¦å¦‚ä½•ï¼Ÿè€å…¬ï¼Œæˆ‘è¦ä½ æ€äº†æ‰€æœ‰æƒ³ä¼¤å®³æˆ‘çš„äººã€‚â€œå¥¹çš„é‡å¿ƒå¤ªå¤§ï¼Œä¸æ˜¯å¸®å¥¹ï¼Œè€Œæ˜¯å®³å¥¹ã€‚â€â€œå¥¹çš„ä¸€åˆ‡ï¼Œæˆ‘è´Ÿè´£ã€‚â€ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šæ±‚ç”Ÿæ¬²ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼æ±‚ç”Ÿæ¬²æœ€æ–°ç« èŠ‚,æ±‚ç”Ÿæ¬²æ— å¼¹çª—,æ±‚ç”Ÿæ¬²å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;åå°”è¡—æ‰›æŠŠå­&#x27;</span>, <span class="hljs-number">56135</span>, <span class="hljs-number">6353</span>, <span class="hljs-number">5666</span>, <span class="hljs-number">2345</span>, <span class="hljs-number">2</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">51243</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">23</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:05&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:06&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;éƒ½å¸‚æ— é™å–é’±ç³»ç»Ÿ&#x27;</span>, <span class="hljs-string">&#x27;  è‡ªä»å¾—åˆ°æ— é™å–é’±ç³»ç»Ÿä¹‹åï¼Œå¶å‡¡çš„äººç”Ÿè½¨è¿¹ä»æ­¤æ”¹å˜â€¦â€¦ æ¯å¤©æ—©ä¸Šé†’æ¥ï¼Œä¸ç”¨æ‹…å¿ƒæ²¡é’±èŠ±ï¼Œè€Œåº”è¯¥æ‹…å¿ƒè¿™ä¹ˆå¤šé’±ï¼Œè¦æ€ä¹ˆèŠ±â€¦â€¦ åªè¦æ˜¯ä»»ä½•é’±èƒ½å¤Ÿè§£å†³çš„é—®é¢˜ï¼Œéƒ½ä¸æ˜¯é—®é¢˜ï¼Œç„¶è€Œä¸ºäº†å¾—åˆ°è¿™äº›é’±ï¼Œä¸å¾—ä¸æŒ‰ç…§ç³»ç»Ÿæç¤ºï¼Œå®Œæˆä¸€ç³»åˆ—çš„ä»»åŠ¡ã€‚ ä»»åŠ¡å¤±è´¥çš„æƒ©ç½šï¼Œå°†ä¼šæ˜¯èº«ä½“æ¶ˆå¤±ååˆ†ä¹‹ä¸€ï¼ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šéƒ½å¸‚æ— é™å–é’±ç³»ç»Ÿã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼éƒ½å¸‚æ— é™å–é’±ç³»ç»Ÿæœ€æ–°ç« èŠ‚,éƒ½å¸‚æ— é™å–é’±ç³»ç»Ÿæ— å¼¹çª—,éƒ½å¸‚æ— é™å–é’±ç³»ç»Ÿå…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;é£å¤©å…¥åœ°&#x27;</span>, <span class="hljs-number">651341</span>, <span class="hljs-number">434</span>, <span class="hljs-number">5334</span>, <span class="hljs-number">234</span>, <span class="hljs-number">2</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">215</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">24</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:05&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:07&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;è’å²›é¥¥è’&#x27;</span>, <span class="hljs-string">&#x27;  å¨ç¥ç©¿è¶Šåˆ°äº†ä¸€ç‰‡æµ·æ»©ä¸Šï¼Œé™¤äº†è„‘æµ·ä¸­çš„é¥¥è’åˆ¶ä½œç³»ç»Ÿï¼Œèº«ä¸Šåˆ«æ— é•¿ç‰©ã€‚ç¥¥å’Œçš„å²›å±¿ä¸Šæœ‰ç€æ½œè—é»‘æš—å’Œç§˜å¯†ï¼Œä¸ºäº†ç”Ÿå­˜ï¼Œå¨ç¥ä¸å¾—ä¸å·å…¥å…¶ä¸­ã€‚å¨ç¥å¼€å§‹å¯»æ‰¾å›å®¶çš„è·¯ã€‚è‡´å‘½çš„é»‘æš—ï¼Œç¥ç§˜çš„é˜´å½±ï¼Œåœ£æ´çš„æ˜Ÿçµã€‚ å¨ç¥ä¼šå›å»å—ï¼Ÿ æ–°ä¹¦æ¨èï¼šã€ç™½é“¶éœ¸ä¸» ã€ã€å¤§ç‹é¥¶å‘½ ã€ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šè’å²›é¥¥è’ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼è’å²›é¥¥è’æœ€æ–°ç« èŠ‚,è’å²›é¥¥è’æ— å¼¹çª—,è’å²›é¥¥è’å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å‡å¿ƒä¹‹ç«&#x27;</span>, <span class="hljs-number">521333</span>, <span class="hljs-number">53534</span>, <span class="hljs-number">2436</span>, <span class="hljs-number">2345</span>, <span class="hljs-number">1</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">415126</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">25</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:05&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å®˜é“ä¹‹æ­¥æ­¥é«˜å‡&#x27;</span>, <span class="hljs-string">&#x27;  é’åŸå¸‚å›½èµ„å§”æ™®é€šç§‘å‘˜æ¥šå¤©èˆ’ï¼Œå› æ’ç ´åŠå…¬å®¤ä¸»ä»»çš„å¥½äº‹è€Œé¢ä¸´è¢«å‘é…çš„å„è¿ï¼Œéšåå´ç»å†äº†ä¸€ç³»åˆ—åŒªå¤·æ‰€æ€çš„å¥‡...  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;åŒ—å²¸&#x27;</span>, <span class="hljs-number">551612</span>, <span class="hljs-number">234632</span>, <span class="hljs-number">5243</span>, <span class="hljs-number">3245</span>, <span class="hljs-number">1</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">124</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">26</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:05&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å‚²ç¥åˆ€å°Š&#x27;</span>, <span class="hljs-string">&#x27; ä¸€é¢—æ¡€éªœçš„å¿ƒï¼Œä¸€æŠŠä¸ç¾çš„åˆ€ï¼Œä¸€ä¸ªå‚²è§†ä»™ç¥çš„ä¸æœ½ä¼ å¥‡ã€‚ä½ æ˜¯è°ï¼Ÿåˆ«é—®æˆ‘æ˜¯è°ï¼Œè¯·ä¸æˆ‘ä¸€æˆ˜ï¼â€”â€”â€”â€”â€”â€”QQç¾¤ï¼š51765913  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;é¡¹å&#x27;</span>, <span class="hljs-number">351314</span>, <span class="hljs-number">435</span>, <span class="hljs-number">45</span>, <span class="hljs-number">2534</span>, <span class="hljs-number">1</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">6143</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">27</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:05&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ä¾¯é—¨åŒ»å¥³,åº¶æ‰‹é©­å¤«&#x27;</span>, <span class="hljs-string">&#x27;   &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;æ²§æµ·æ˜ç &#x27;</span>, <span class="hljs-number">251234</span>, <span class="hljs-number">243544</span>, <span class="hljs-number">3425</span>, <span class="hljs-number">35235</span>, <span class="hljs-number">1</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">421342314</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">28</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:06&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:13&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;æ å¤ºè¯¸å¤©ä¸‡ç•Œ&#x27;</span>, <span class="hljs-string">&#x27;  é¾™ç„æ‹¥æœ‰æ å¤ºä¸‡ç•Œçš„ç‰ä½©ï¼Œä»¥è¯¸å¤©ä¸‡ç•Œçš„èµ„æºæˆæ— æ•Œå¤§ä¸»å®°ã€‚æ­¦ä¾ ä¸–ç•Œ:å¤©é¾™ï¼Œç¬‘å‚²ï¼Œå°„é›•ï¼Œç¥é›•ï¼Œé£äº‘â€¦â€¦ä»™ä¾ ä¸–ç•Œ:ä»™å‰‘ï¼ŒèŠ±åƒéª¨ï¼Œè¯›ä»™â€¦â€¦åŠ¨æ¼«ä¸–ç•Œ:ç«å½±ï¼Œè¶…ç¥å­¦é™¢â€¦â€¦å°è¯´ä¸–ç•Œ:å®Œç¾ä¸–ç•Œï¼Œæ–—ç ´ï¼Œé®å¤©ï¼Œæ–—ç½—â€¦â€¦ç”µå½±ä¸–ç•Œ:è¥¿æ¸¸é™é­”ä¸–ç•Œï¼Œåƒµå°¸å…ˆç”Ÿï¼Œå¤§è¯è¥¿æ¸¸â€¦â€¦ç¥è¯ä¸–ç•Œ:è¥¿æ¸¸è®°ï¼Œå°ç¥æ¦œï¼Œæ´ªè’â€¦â€¦ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šæ å¤ºè¯¸å¤©ä¸‡ç•Œã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼æ å¤ºè¯¸å¤©ä¸‡ç•Œæœ€æ–°ç« èŠ‚,æ å¤ºè¯¸å¤©ä¸‡ç•Œæ— å¼¹çª—,æ å¤ºè¯¸å¤©ä¸‡ç•Œå…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;æˆ‘åŸéå‡¡&#x27;</span>, <span class="hljs-number">521222</span>, <span class="hljs-number">24325</span>, <span class="hljs-number">2345</span>, <span class="hljs-number">666</span>, <span class="hljs-number">1</span>, <span class="hljs-number">26</span>, <span class="hljs-number">0</span>, <span class="hljs-number">411235</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">29</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:06&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:07&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ç«å½±ä¹‹æœ€å¼ºè™«å¸ˆ&#x27;</span>, <span class="hljs-string">&#x27;  æ¿€èŒçš„èè‰ï¼Œçƒ­è¡€çš„å°‘å¹´ï¼Œä¸ºæ‰“ç ´æ¬¡å…ƒå£ä¸€å¾€æ— å‰ï¼ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šç«å½±ä¹‹æœ€å¼ºè™«å¸ˆã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼ç«å½±ä¹‹æœ€å¼ºè™«å¸ˆæœ€æ–°ç« èŠ‚,ç«å½±ä¹‹æœ€å¼ºè™«å¸ˆæ— å¼¹çª—,ç«å½±ä¹‹æœ€å¼ºè™«å¸ˆå…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;æ¥ä¸€åˆ€&#x27;</span>, <span class="hljs-number">544111</span>, <span class="hljs-number">325</span>, <span class="hljs-number">3434525</span>, <span class="hljs-number">623534</span>, <span class="hljs-number">1</span>, <span class="hljs-number">25</span>, <span class="hljs-number">0</span>, <span class="hljs-number">51244</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">30</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:07&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;é™†æˆ˜å…µç‹&#x27;</span>, <span class="hljs-string">&#x27; å°‘å¹´ä»æ–°å…µè›‹å­ä¸€æ­¥æ­¥æˆé•¿ï¼Œç£¨ç»ƒæˆä¸€æŠŠéšå»çš„åˆ€é”‹ï¼Œæ—¶åˆ»ä¸ºç€æ¢¦æƒ³è€Œå¥‹æ–—ï¼Œç»å†æ— å°½çš„è‰°éš¾å›°é˜»ï¼Œæœ€ç»ˆäº†ä¸ºçœŸç›¸è€Œæˆ˜æ–—ï¼ï¼ ã€€ã€€æˆ‘çš„ä¹¦å‹äº¤æµç¾¤ï¼š241911158ï¼Œæˆ‘çš„QQï¼š807457338  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;å¯å¯æ¯”å°”&#x27;</span>, <span class="hljs-number">355555</span>, <span class="hljs-number">45346</span>, <span class="hljs-number">543</span>, <span class="hljs-number">5234</span>, <span class="hljs-number">1</span>, <span class="hljs-number">25</span>, <span class="hljs-number">0</span>, <span class="hljs-number">51261</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">31</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:07&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:12&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å˜èº«ä¹‹æŠŠåæ´¾å…»æ­ªäº†è‚¿ä¹ˆç ´&#x27;</span>, <span class="hljs-string">&#x27;  æ¿€èŒçš„èè‰ï¼Œçƒ­è¡€çš„å°‘å¹´ï¼Œä¸ºæ‰“ç ´æ¬¡å…ƒå£ä¸€å¾€æ— å‰ï¼ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šå˜èº«ä¹‹æŠŠåæ´¾å…»æ­ªäº†è‚¿ä¹ˆç ´ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼å˜èº«ä¹‹æŠŠåæ´¾å…»æ­ªäº†è‚¿ä¹ˆç ´æœ€æ–°ç« èŠ‚,å˜èº«ä¹‹æŠŠåæ´¾å…»æ­ªäº†è‚¿ä¹ˆç ´æ— å¼¹çª—,å˜èº«ä¹‹æŠŠåæ´¾å…»æ­ªäº†è‚¿ä¹ˆç ´å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å‘†èŒå°æ€»&#x27;</span>, <span class="hljs-number">222235</span>, <span class="hljs-number">364326</span>, <span class="hljs-number">25342</span>, <span class="hljs-number">632</span>, <span class="hljs-number">1</span>, <span class="hljs-number">25</span>, <span class="hljs-number">0</span>, <span class="hljs-number">521341</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">32</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:07&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å”¯æ„¿æƒ…æ·±ä¸è´Ÿå©š&#x27;</span>, <span class="hljs-string">&#x27;  æ¸£ç”·å’Œå°ä¸‰è”æ‰‹è®¾è®¡ï¼Œè®©å¥¹è¢«æ‰£ä¸Šä¸å¹²å‡€çš„éª‚åï¼Œå©†å©†æš´æ‰“ï¼Œè¿˜é€¼ç€å¥¹å‡€èº«å‡ºæˆ·ã€‚å¥¹æ²¡äº†å®¶ï¼Œä¹Ÿå¤±å»äº†è…¹ä¸­åˆšæˆå‹çš„å­©å­ã€‚èµ°æŠ•æ— è·¯ï¼Œä¸ºäº†å¤ä»‡ï¼Œåªèƒ½é€‰æ‹©çˆ¬ä¸Šæ¸£ç”·å¯¹æ‰‹çš„åºŠã€‚ä»–æ˜¯å¤©ä¹‹éª„å­ï¼Œå¥¹æœ¬ä»¥ä¸ºé•œèŠ±æ°´æœˆåå†æ— äº¤é›†ï¼Œå´.. å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šå”¯æ„¿æƒ…æ·±ä¸è´Ÿå©šã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼å”¯æ„¿æƒ…æ·±ä¸è´Ÿå©šæœ€æ–°ç« èŠ‚,å”¯æ„¿æƒ…æ·±ä¸è´Ÿå©šæ— å¼¹çª—,å”¯æ„¿æƒ…æ·±ä¸è´Ÿå©šå…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;æ—§åŸé›ª&#x27;</span>, <span class="hljs-number">5123566</span>, <span class="hljs-number">534</span>, <span class="hljs-number">234562</span>, <span class="hljs-number">636</span>, <span class="hljs-number">1</span>, <span class="hljs-number">25</span>, <span class="hljs-number">0</span>, <span class="hljs-number">42156</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">33</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:07&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:08&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;æˆ‘çš„ç»è‰²ç¾å¥³ç‰¹å·¥è€å©†&#x27;</span>, <span class="hljs-string">&#x27;  ã€ç«çˆ†æ–°ä¹¦ã€‘åœ°ä¸‹ä¸–ç•Œçš„ç‹è€…ç¥ç§˜å½’éšï¼Œå°±åœ¨å„ç•Œå¤§ä½¬éƒ½æ¾äº†ä¸€å£æ°”çš„æ—¶å€™ï¼Œæ®Šä¸çŸ¥ï¼Œè¿œåœ¨ä½£å…µç¦åœ°çš„åå¤ï¼Œæ€èµ·äº†ä¸€åœºå‰æ‰€æœªæœ‰çš„æ³¢æ¾œï¼ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šæˆ‘çš„ç»è‰²ç¾å¥³ç‰¹å·¥è€å©†ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼æˆ‘çš„ç»è‰²ç¾å¥³ç‰¹å·¥è€å©†æœ€æ–°ç« èŠ‚,æˆ‘çš„ç»è‰²ç¾å¥³ç‰¹å·¥è€å©†æ— å¼¹çª—,æˆ‘çš„ç»è‰²ç¾å¥³ç‰¹å·¥è€å©†å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ç¨£ç‰§é±¼&#x27;</span>, <span class="hljs-number">351235</span>, <span class="hljs-number">2435</span>, <span class="hljs-number">45325</span>, <span class="hljs-number">5353</span>, <span class="hljs-number">1</span>, <span class="hljs-number">25</span>, <span class="hljs-number">0</span>, <span class="hljs-number">42</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">34</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:07&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:10&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;åŒ—é›„&#x27;</span>, <span class="hljs-string">&#x27;  æœ¬ä¹¦ç®€ä»‹ï¼š å¤§ä¸šå…­å¹´ï¼Œå¼ºç››çš„å¤§éš‹è¿æ¥äº†è½¬æŠ˜ç‚¹ã€‚ è¿™ä¸€å¹´ï¼Œéš‹å¸æ¨å¹¿å¼€å§‹å‡†å¤‡å¾ä¼é«˜ä¸½ï¼Œé¡ºåŠ¿æ‹‰å¼€äº†éš‹æœ«æˆ˜ä¹±çš„åºå¹•ã€‚ æ¥ä¸‹æ¥çš„å‡ å¹´é—´ï¼Œå¤©ä¸‹æ¿è¡ï¼Œç¾¤é›„å¹¶èµ·ã€‚ åå…«è·¯åç‹ï¼Œå…­åå››è·¯çƒŸå°˜ï¼Œè‰è½è±ªæ°ï¼Œé—¨é˜€ä¸–å®¶ï¼Œçº·çº·ç²‰å¢¨ç™»åœºï¼Œé€é¹¿å¤©ä¸‹ã€‚ åŒ—æ–¹çªå¥æ±—å›½ï¼Œé›„è¸æ¼ åŒ—ï¼Œè™è§†çœˆçœˆã€‚ å†…å¿§å¤–æ‚£ä¹‹ä¸‹ï¼Œä¸€ä¸ªå¼ºå¤§çš„å¸å›½ï¼Œæœ€ç»ˆè½°ç„¶å´©å¡Œã€‚ è¿™æ˜¯ä¸ªæœ€å…·ä¼ å¥‡è‰²å½©çš„æ—¶ä»£ï¼Œä¹ŸåŒæ ·æ˜¯ä¸­åŸå¤§åœ°æœ€ä¸ºæ··ä¹±é»‘æš—çš„æ—¶èŠ‚ã€‚ å°±åœ¨è¿™æ ·ä¸€ä¸ªæ—¶å€™ï¼Œä¸€ä¸ªæ¥å†å¥‡å¼‚çš„è¾¹å¡å°‘å¹´ï¼Œå¸¦ç€è‰åŸçš„é£å¯’ï¼Œå’Œä¸€è‚¡æ»¡ä¸åœ¨ä¹çš„åŠ²å¤´ï¼Œä¸€å¤´æ‰è¿›äº†è¿™ä¹±ä¸–æ¼©æ¶¡ä¹‹ä¸­ã€‚ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€ŠåŒ—é›„ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼åŒ—é›„æœ€æ–°ç« èŠ‚,åŒ—é›„æ— å¼¹çª—,åŒ—é›„å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;æ²³è¾¹è‰&#x27;</span>, <span class="hljs-number">5235132</span>, <span class="hljs-number">523</span>, <span class="hljs-number">3425</span>, <span class="hljs-number">35</span>, <span class="hljs-number">1</span>, <span class="hljs-number">25</span>, <span class="hljs-number">0</span>, <span class="hljs-number">143165</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">35</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:07&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:10&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å¼‚ä¸–ç•Œçš„æˆ˜æ–—å¥¶å¦ˆ&#x27;</span>, <span class="hljs-string">&#x27;  æ›¾ç»è¶…äººæ°”ç½‘ç»œæ¸¸æˆâ€œå¼‚ä¸–ç•Œï¼Œâ€æ›¹ç²æ•æœ‰ä¸‰ä¸ªè§’è‰²åˆ›ä¸‹äº†ä¼ è¯´è®°å½•ã€‚ç‹‚æˆ˜å£«çº¢æ˜­æ„¿ï¼Œæ‰“å‡ºäº†â€œå¼‚ä¸–ç•Œâ€æœ€å¼ºä¸€å‡»çš„çˆ†å‘ä¼¤å®³ï¼›æ­¦åœ£æœæœæš®æš®ï¼Œè¿ç»­ä¸‰æ¬¡èµ›å­£æ‹¿ä¸‹ç«æŠ€åœºSOLOèµ›å† å†›ï¼›èˆ°ç‚®æŒæ§è€…çº¢ç»³ç»“å‘ï¼Œå¸¦é¢†å…¬ä¼šéƒ¨ä¸‹æ‹¿ä¸‹ä¸ƒæ¬¡ä¸–ç•Œçº§BOSSé¦–æ€ï¼›åœ¨å…¶æ¸¸æˆç»ˆæ­¢è¥è¿çš„é‚£ä¸€å¤©ï¼Œæ›¹ç²æ•æƒ³èµ·è‡ªå·±å”¯ç‹¬æ²¡æœ‰ç©è¿‡å¥¶å¦ˆï¼Œç»“æœç­‰åˆ°è¥è¿æ—¶é—´ç»“æŸï¼Œè§’è‰²å´æ— æ³•é€€å‡ºæ¸¸æˆï¼Œæ‹¥æœ‰ç«¥é¢œè´«ä¹³å¤–è¡¨çš„æ›¹ç²æ•å±•å¼€äº†å‰æ‰€æœªæœ‰çš„ç¬¬å››æ¬¡ä¼ è¯´â€¦â€¦ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šå¼‚ä¸–ç•Œçš„æˆ˜æ–—å¥¶å¦ˆã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼å¼‚ä¸–ç•Œçš„æˆ˜æ–—å¥¶å¦ˆæœ€æ–°ç« èŠ‚,å¼‚ä¸–ç•Œçš„æˆ˜æ–—å¥¶å¦ˆæ— å¼¹çª—,å¼‚ä¸–ç•Œçš„æˆ˜æ–—å¥¶å¦ˆå…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å¤ä¼Šæ°´å¿ƒ&#x27;</span>, <span class="hljs-number">5661233</span>, <span class="hljs-number">26</span>, <span class="hljs-number">35</span>, <span class="hljs-number">3462</span>, <span class="hljs-number">1</span>, <span class="hljs-number">24</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4112</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">36</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:07&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;æ­¦æé˜´é˜³&#x27;</span>, <span class="hljs-string">&#x27;  å¤©åœ°å§‹åˆ†é˜´é˜³ï¼Œäº˜å¤å¹³è¡¡ã€‚æœ‰äººä¼å›¾ä»¥å¤–åŠ›ä¸»å®°äº”è¡Œå¤§é™†ï¼Œé¢ è¦†ä¸–ç•Œï¼ä¸€ä¸ªèº«å…·èŠ±ç“¶ä½“è´¨çš„å°‘å¹´ï¼Œæ— å½¢ä¸­æˆäº†å¯¹æŠ—å¼ºå¤§å¤–åŠ›çš„ä¸»è¦äººé€‰ã€‚åäºŒå²èµ·æ­¥ï¼Œèƒ½å¦æ‹…èµ·é‡ä»»ï¼Ÿè«åé­‚åŠ›ã€äº”è¡Œä¹‹å­ã€çº¢é¢œçŸ¥å·±ã€é˜´é˜³äº’ä¿®â€¦â€¦è¿™é‡Œæ˜¯æ­¦åŠ¨ä¹¾å¤çš„ç²¾å½©ä¸–ç•Œï¼P:æ–°äººæ–°ä¹¦ï¼Œæ›´æ–°ç¨³å®šã€‚ä¹¦å‹ç¾¤249540907ã€‚è¯·å¤šæ”¯æŒï¼  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;æ¥šæ¾æº&#x27;</span>, <span class="hljs-number">455432</span>, <span class="hljs-number">345</span>, <span class="hljs-number">3</span>, <span class="hljs-number">23634</span>, <span class="hljs-number">1</span>, <span class="hljs-number">24</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4145</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">37</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:08&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:09&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;è‹çµä¸»å®°&#x27;</span>, <span class="hljs-string">&#x27;  ä¸‡çµä¸–ç•Œï¼Œå¤©åœ°æ— å ï¼Œå®—æ—åƒä¸‡ï¼Œå¼ºäººè¾ˆå‡ºï¼è‹ç©¹ä¹‹ä¸‹ï¼Œè¡¨é¢ç¾¤é›„å‰²æ®ï¼Œå†…é‡Œæš—æµæ¶ŒåŠ¨ï¼Œåªå¾…å¤§æµªæ·˜æ²™ï¼Œä¼ºæœºä¹˜é£è€Œä¸Šâ€¦â€¦å¹³å‡¡å°å­éŸ©çƒ¨ï¼Œä¹ ç¥ç§˜åŠŸæ³•æ¨ªç©ºå‡ºä¸–ï¼Œè¸å¤ä»‡ä¹‹è·¯ï¼Œå…¥ä¿®ç‚¼å¾é€”ï¼Œæ€èµ·ä¸å¯é˜»æŒ¡ä¹‹æ´ªæµï¼è‡ªæ­¤ï¼Œå±±æ²³æ—¥æœˆå˜â€¦â€¦ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šè‹çµä¸»å®°ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼è‹çµä¸»å®°æœ€æ–°ç« èŠ‚,è‹çµä¸»å®°æ— å¼¹çª—,è‹çµä¸»å®°å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;äººç”Ÿå¥½æ¢¦&#x27;</span>, <span class="hljs-number">561355</span>, <span class="hljs-number">6666</span>, <span class="hljs-number">62</span>, <span class="hljs-number">54325</span>, <span class="hljs-number">1</span>, <span class="hljs-number">24</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2143</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">38</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:08&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:11&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å®šä½å¯»å®ç³»ç»Ÿ&#x27;</span>, <span class="hljs-string">&#x27;  åˆ«äººç”¨èŠå¤©è½¯ä»¶æ³¡å¦æŠŠå¦¹å­ï¼Œè½»æ¾ä¸€ä¸‹é™„è¿‘äººå°±æ˜¯ç¾å¥³å¦‚äº‘...å¯æ˜¯æˆ‘çš„é™„è¿‘äººé‡Œï¼Œæ²¡æœ‰ä»€ä¹ˆç¾å¥³ç›´æ’­...æœç´¢ä¸€ä¸‹é™„è¿‘äººï¼Œç²¾ç¡®å®šä½å‡ºæ¥çš„...ä¸æ˜¯çµä¸¹å¦™è¯ï¼Œå°±æ˜¯å¤è‘£æ–‡ç‰©...ä¸Šåˆ°å¤©æåœ°å®ï¼Œä¸‹åˆ°è¡¥è‚¾å£®é˜³...éƒ½åªå› è„‘æµ·ä¹‹ä¸­æœ‰ç€ä¸€ä¸ªç³»ç»Ÿï¼Œå¯ä»¥çœ‹åˆ°åˆ«äººçœ‹ä¸åˆ°çš„æœç´¢ä¿¡æ¯...åˆ«è¯´æˆ‘èº«ä¸Šå¸¦ç€BUGï¼Œæˆ‘çœŸçš„å°±æ˜¯æƒ³æ³¡å¦¹å­è€Œå·²...è®¾å®šå¥½è‡ªå·±çš„äººç”Ÿï¼Œèµ°å‡ºä¸€ä¸ªä¸ä¸€æ ·çš„äººç”Ÿå·…å³°... å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šå®šä½å¯»å®ç³»ç»Ÿã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼å®šä½å¯»å®ç³»ç»Ÿæœ€æ–°ç« èŠ‚,å®šä½å¯»å®ç³»ç»Ÿæ— å¼¹çª—,å®šä½å¯»å®ç³»ç»Ÿå…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;æ²é›ªæ²‰é£&#x27;</span>, <span class="hljs-number">123344</span>, <span class="hljs-number">5325</span>, <span class="hljs-number">266</span>, <span class="hljs-number">3425</span>, <span class="hljs-number">1</span>, <span class="hljs-number">24</span>, <span class="hljs-number">1</span>, <span class="hljs-number">12342</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">39</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:08&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ä¸è´¥æˆ˜ç¥&#x27;</span>, <span class="hljs-string">&#x27;  å°‘å¹´ï¼Œå°±æ˜¯è¦åœ¨é˜³å…‰ä¸‹æŒ¥æ´’æ±—æ°´ï¼ å°‘å¹´ï¼Œå°±æ˜¯è¦ä¸æ–­æˆ˜æ–—ï¼Œç„¶åèƒœåˆ©ï¼ æ— å°½å¤©è·¯ä¹‹æ—…ï¼Œæ— å°½å¾é€”ï¼Œè§è¯å°‘å¹´çš„çƒ­è¡€å’Œä¼ å¥‡ï¼ å¿ƒæ€€é‡æœ›ï¼Œçƒˆè¡€å¦‚ç‡ƒï¼ æ°¸è¿œå°‘å¹´ï¼Œä¸è´¥æˆ˜ç¥ï¼ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šä¸è´¥æˆ˜ç¥ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;æ–¹æƒ³&#x27;</span>, <span class="hljs-number">54633</span>, <span class="hljs-number">2534</span>, <span class="hljs-number">3262</span>, <span class="hljs-number">63263</span>, <span class="hljs-number">1</span>, <span class="hljs-number">24</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2521</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">40</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:08&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;è‡³å°Šç¥å¸&#x27;</span>, <span class="hljs-string">&#x27;  è‡³å°Šç¥å¸çš„ç®€ä»‹ï¼šã€é‡ç£…æ¨èä½è°ƒå“¥å®Œæœ¬å°è¯´ã€Šè‡³å°Šé¾™å¸ã€‹ä¸ã€Šé€é¥ç‹‚å°‘ã€‹ã€‘ä¸€ä¸ªä»å°è¢«äººå˜²ç¬‘ä¸ºåºŸç‰©çš„å°‘å¹´ï¼Œåœ¨ä¸€æ¬¡å±é™©çš„ç‹©çŒä¸­ï¼Œé­äººæ‰“æ–­å››è‚¢ï¼ŒçŸ³æ²‰æ·±æ½­ï¼Œä¸æ–™å´å› ç¥¸å¾—ç¦ï¼Œæ”¶äº†ä¸€åä¸Šå¤ä»™äººçš„æ®‹é­‚ä¸ºä»†ã€‚åœ¨ä»™ä»†çš„æ¿€åŠ±ä¸‹ï¼Œä»–å‡­å€Ÿå¼ºæ‚çš„æ„å¿—åŠ›ä¸ä¸æ‡ˆçš„åŠªåŠ›ï¼Œåœ¨åº„ä¸­æ¯”æ­¦å¤§ä¼šä¸Šä¸€é¸£æƒŠäººï¼Œå½»åº•å‘Šåˆ«äº†åºŸç‰©çš„ç§°å·ï¼Œä¹‹åä»¥æ­¦å…¥é“ï¼Œå†²ç ´äº†ä½“å†…å µå¡çš„ç»è„‰ï¼Œæ‹¥æœ‰äº†äº”è¡Œå…ƒåŠ›çš„è¶…å¼ºä¿®ç‚¼å¤©èµ‹ã€‚ä»æ­¤ï¼Œå¶å¤©å†³å¿ƒå€¾æ¯•ç”Ÿä¹‹åŠ›ï¼Œé€†å¤©æ”¹å‘½ï¼Œå»è¿½å¯»ä¿®ç‚¼çš„æè‡´å¢ƒç•Œã€‚ä¸€è·¯æ€ä»™å¼‘ç¥ï¼Œå½ªæ‚çš„ä¿®ç‚¼ä¹‹è·¯æ— éœ€è§£é‡Šã€‚  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;ä½è°ƒå“¥&#x27;</span>, <span class="hljs-number">432513</span>, <span class="hljs-number">4532</span>, <span class="hljs-number">32234</span>, <span class="hljs-number">3254</span>, <span class="hljs-number">1</span>, <span class="hljs-number">22</span>, <span class="hljs-number">1</span>, <span class="hljs-number">51</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">41</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:08&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ç´«é˜³&#x27;</span>, <span class="hljs-string">&#x27;  ç´«é˜³  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;é£å¾¡ä¹ç§‹&#x27;</span>, <span class="hljs-number">5513243</span>, <span class="hljs-number">276236</span>, <span class="hljs-number">32445</span>, <span class="hljs-number">6666</span>, <span class="hljs-number">1</span>, <span class="hljs-number">22</span>, <span class="hljs-number">1</span>, <span class="hljs-number">245</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">42</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:08&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:10&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;åˆ˜å¤‡çš„æ—¥å¸¸&#x27;</span>, <span class="hljs-string">&#x27;  ã€å†å²æ–°çºªå…ƒè„‘æ´é£æš´å¾æ–‡ã€‘å‚èµ›ä½œå“ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šåˆ˜å¤‡çš„æ—¥å¸¸ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼åˆ˜å¤‡çš„æ—¥å¸¸æœ€æ–°ç« èŠ‚,åˆ˜å¤‡çš„æ—¥å¸¸æ— å¼¹çª—,åˆ˜å¤‡çš„æ—¥å¸¸å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ç†é¦™å¦‚é£&#x27;</span>, <span class="hljs-number">521111</span>, <span class="hljs-number">6234</span>, <span class="hljs-number">264534</span>, <span class="hljs-number">3425</span>, <span class="hljs-number">1</span>, <span class="hljs-number">22</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6124</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">43</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:08&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:12&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ç‹‚æ­¦ä»™çš‡&#x27;</span>, <span class="hljs-string">&#x27;  æˆ‘ä¸ºè¼èšï¼Œä¸–äººå¯æ¬ºï¼Œä¸–äººä¸ºè¼èšï¼Œæˆ‘å¯æ¬ºä¸–äººã€‚ä¸€æ¯ä¸Šå­˜ï¼Œæˆ˜æ–—ä¸æ­¢ã€‚å³ä¾¿æ˜¯æ­»ï¼Œä¹Ÿè¦æ­»çš„æƒŠå¤©åŠ¨åœ°ã€‚ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šç‹‚æ­¦ä»™çš‡ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼ç‹‚æ­¦ä»™çš‡æœ€æ–°ç« èŠ‚,ç‹‚æ­¦ä»™çš‡æ— å¼¹çª—,ç‹‚æ­¦ä»™çš‡å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ç§‹é£è‹¥æ°´&#x27;</span>, <span class="hljs-number">356623</span>, <span class="hljs-number">626</span>, <span class="hljs-number">62</span>, <span class="hljs-number">23466</span>, <span class="hljs-number">1</span>, <span class="hljs-number">22</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5124</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">44</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:08&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;æ–°åˆºå®¢åˆ—ä¼ &#x27;</span>, <span class="hljs-string">&#x27;  èº²åœ¨é˜´æš—çš„è§’è½ï¼Œå†·é™æ€è€ƒï¼Œä»”ç»†è§‚å¯Ÿå‘¨å›´çš„ä¸€åˆ‡åŠ¨å‘ï¼Œæ›´è¦å°å¿ƒåŒè¡Œæ¥æŠ¢ç”Ÿæ„ã€‚æŸä¸€åˆ»ï¼Œç›®æ ‡å‡ºç°ï¼Œè¿é¢å¾®ç¬‘èµ°è¿‡ã€‚åˆºå‡ºä¸€å‰‘ï¼ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šæ–°åˆºå®¢åˆ—ä¼ ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼æ–°åˆºå®¢åˆ—ä¼ æœ€æ–°ç« èŠ‚,æ–°åˆºå®¢åˆ—ä¼ æ— å¼¹çª—,æ–°åˆºå®¢åˆ—ä¼ å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;ä¸–å°˜é£&#x27;</span>, <span class="hljs-number">351334</span>, <span class="hljs-number">5234</span>, <span class="hljs-number">2345</span>, <span class="hljs-number">3425</span>, <span class="hljs-number">1</span>, <span class="hljs-number">22</span>, <span class="hljs-number">1</span>, <span class="hljs-number">42315</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">45</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:08&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ä¸æœ½ç¥ç³&#x27;</span>, <span class="hljs-string">&#x27;  è¿™æ˜¯ä¸€ä¸ªç¥ç§˜çš„ä¸–ç•Œï¼Œè¿™é‡Œæœ‰æœ€å¼ºçš„æ­¦é“ï¼Œæœ€ç¥ç§˜çš„ç³æœ¯ï¼å…«ä¸–å†ï¼Œä¹ä¸ºå°Šï¼ä¸€ä»£å¤ªå¤å¤§èƒ½ï¼Œå†ç»å…«ä¸–ç£¨ç ºè€Œå½’ï¼Œä»–æƒ³ä¸æ˜ç™½ï¼Œè¿™ä¸€ä¸–ä¸ºä»€ä¹ˆé‚£ä¹ˆå¤šæ³•å®æ‰¾ä»–è®¤ä¸»ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰é‚£ä¹ˆå¤šç¾å¥³æ¥ç»™ä»–æš–åºŠï¼Œä½†æ˜¯ä»–çŸ¥é“ï¼Œä»–å°†æ‹¥ç¾å¹¶è¸©ç€æ•Œäººçš„å°¸ä½“ï¼Œèµ°ä¸Šè‡³å°Šä¹‹è·¯ï¼è§å¯»ï¼šâ€œè¿™ä¸€ä¸–ï¼Œæˆ‘è¦è®©æ‰€æœ‰äººéƒ½åœ¨æˆ‘çš„è„šä¸‹é¢¤æŠ–ï¼ç»è‰²ç¾å¥³ä»¬ï¼Œæ¥é™ªå“¥å“¥å¿«ä¹åŒä¿®ã€‚â€  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;é£èˆå¤©ä¸‹&#x27;</span>, <span class="hljs-number">566666</span>, <span class="hljs-number">525</span>, <span class="hljs-number">25342</span>, <span class="hljs-number">45326</span>, <span class="hljs-number">1</span>, <span class="hljs-number">22</span>, <span class="hljs-number">1</span>, <span class="hljs-number">51261</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">46</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:09&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:09&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;èŠ±éƒ½å°ä»™åŒ»&#x27;</span>, <span class="hljs-string">&#x27;  å°ä»™åŒ»æºé€ åŒ–å®å¡”ï¼Œçºµæ¨ªéƒ½å¸‚ï¼Œå®å¡”åœ¨æ‰‹ï¼Œç¾å¥³æˆ‘æœ‰ï¼èµšæœ€å¤šçš„é’±ï¼Œè¸©æœ€ç‰›çš„äººï¼Œå¨¶æœ€ç¾çš„è€å©†ï¼Œä¸“æ²»å„ç§ä¸æœã€‚ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€ŠèŠ±éƒ½å°ä»™åŒ»ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼èŠ±éƒ½å°ä»™åŒ»æœ€æ–°ç« èŠ‚,èŠ±éƒ½å°ä»™åŒ»æ— å¼¹çª—,èŠ±éƒ½å°ä»™åŒ»å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;åä¸‰åˆ€&#x27;</span>, <span class="hljs-number">542135</span>, <span class="hljs-number">2642</span>, <span class="hljs-number">3245</span>, <span class="hljs-number">26346</span>, <span class="hljs-number">1</span>, <span class="hljs-number">22</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2143</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">47</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:09&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å¥³ç¥æ€»è£çˆ±ä¸Šæˆ‘&#x27;</span>, <span class="hljs-string">&#x27;  èº«æ€€å¼‚èƒ½å´ç”˜äºå¹³æ·¡çš„é…’åº—å°ä¿å®‰ï¼Œä¸ç¾è‹¥å¤©ä»™å´å†·è‹¥å†°éœœçš„æ€»è£æœ‰äº†äº¤é›†ï¼Œå¥¹ä¸»åŠ¨æ±‚å©šä»–å´è¯´ä¸ï¼Œé¢†è¯å½“æ™šé™ªä¼´ä»–çš„å±…ç„¶æ˜¯å¦ä¸ªå¥³äººã€‚ä»æ­¤ï¼Œå„è‰²ç¾å¥³æŠ•æ€€é€æŠ±ï¼Œè¦å‘½çš„æ˜¯æ¯ä¸ªå¥³äººéƒ½å¸¦ç€ä¸€å †ç”©ä¸æ‰çš„éº»çƒ¦â€¦â€¦  &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;æ„¤æ€’å°é¸Ÿ&#x27;</span>, <span class="hljs-number">111111</span>, <span class="hljs-number">62624</span>, <span class="hljs-number">52352</span>, <span class="hljs-number">6234</span>, <span class="hljs-number">1</span>, <span class="hljs-number">22</span>, <span class="hljs-number">1</span>, <span class="hljs-number">23415</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">48</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:09&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:18&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;èŒå®å°ç¥é¾™ï¼šå¦–çš‡ç››å® ä¸è‰¯å¦ƒ&#x27;</span>, <span class="hljs-string">&#x27;  éœ‡æƒŠï¼ç»ç¾å°‘å¥³æ£ºæäº§å­ï¼Œå„¿å­å±…ç„¶æ˜¯ä¸ªå¤´ä¸Šæœ‰çŠ„è§’çš„å¦–æ€ªã€‚å‡°æ¸…å¦¤æ¶åœ°å¤§å“­ã€‚å¥‡æ€ªï¼ä¸ºä»€ä¹ˆå¥¹éƒ½æœ‰å­©å­äº†ï¼Œè¿˜æœ‰ç”·äººçº ç¼ ä¸ä¼‘å•Šï¼Ÿå‡°æ¸…å¦¤å“­ç¬‘ä¸å¾—ã€‚æŸå¤©ï¼Œå¦–å­½ç”·å­å°†å¥¹å’šåœ¨æ ‘ä¸Šï¼Œâ€œæ’©å®Œå°±æƒ³è·‘ï¼Œä½ è¦å¯¹æˆ‘è´Ÿè´£ï¼â€å¥¹å‹¾å”‡ä¸€ç¬‘ï¼Œå°†ä»–åå‹ï¼Œâ€œæŠ±æ­‰ï¼Œæˆ‘æ›´å–œæ¬¢åœ¨ä¸Šé¢ã€‚â€ä½œä¸ºä¸€ä»£åŒ»æ¯’åŒç»çš„æ€æ‰‹å¥³ç‹ï¼Œè¯´å¥¹æ˜¯åºŸç‰©ï¼Ÿæ”¾å±ï¼Œæˆ‘æ¥å‘Šè¯‰ä½ ä»€ä¹ˆæ˜¯ç»ä¸–å¤©æ‰ï¼åªæ˜¯ä¸‡ä¸‡æ²¡æƒ³åˆ°æƒ¹ä¸Šäº†ä¸€ä¸ªæ¯”å¥¹æ›´ç»ä¸–æ›´å¦–å­½çš„ç”·äººï¼Œä»æ­¤ä½ è¿½æˆ‘é€ƒï¼Œä½ æ€äººæˆ‘é€’åˆ€ï¼Œä¸€èµ·ç§°ï¼ˆhuoï¼‰éœ¸ï¼ˆhaiï¼‰å¤©ä¸‹ã€‚ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€ŠèŒå®å°ç¥é¾™ï¼šå¦–çš‡ç››å® ä¸è‰¯å¦ƒã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼èŒå®å°ç¥é¾™ï¼šå¦–çš‡ç››å® ä¸è‰¯å¦ƒæœ€æ–°ç« èŠ‚,èŒå®å°ç¥é¾™ï¼šå¦–çš‡ç››å® ä¸è‰¯å¦ƒæ— å¼¹çª—,èŒå®å°ç¥é¾™ï¼šå¦–çš‡ç››å® ä¸è‰¯å¦ƒå…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;å§’ç³–&#x27;</span>, <span class="hljs-number">353251</span>, <span class="hljs-number">252</span>, <span class="hljs-number">24</span>, <span class="hljs-number">26345</span>, <span class="hljs-number">1</span>, <span class="hljs-number">22</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4126</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">49</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:09&#x27;</span>, <span class="hljs-string">&#x27;2018-09-14 20:54:49&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;Xå¤„é¦–å¸­ç‰¹å·¥çš‡å¦ƒ&#x27;</span>, <span class="hljs-string">&#x27;   &#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;é€äº‘ä¹‹å·…&#x27;</span>, <span class="hljs-number">3521434</span>, <span class="hljs-number">262345</span>, <span class="hljs-number">2543</span>, <span class="hljs-number">6236</span>, <span class="hljs-number">1</span>, <span class="hljs-number">22</span>, <span class="hljs-number">1</span>, <span class="hljs-number">416213</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `book`(`id`, `create_time`, `update_time`, `status`, `name`, `intro`, `icon`, `author`, `words`, `collection`, `goods`, `click`, `site`, `sort`, `vip`, `popularity`) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">50</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:09&#x27;</span>, <span class="hljs-string">&#x27;2017-12-27 20:53:10&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;ä¹è½¬åœ£çµå†³&#x27;</span>, <span class="hljs-string">&#x27;  äº”ç™¾å¹´å‰ï¼Œä»–å¿ƒçˆ±çš„å¥³å­ï¼Œç«Ÿçˆ¬ä¸Šäº†è‡ªå·±åŒçˆ¶å¼‚æ¯å“¥å“¥çš„åºŠã€‚æ¯’é…’ç©¿è‚ ï¼Œä¸€ä»£å¤©éª„ï¼Œå°±æ­¤é™¨è½ã€‚äº”ç™¾å¹´åï¼Œä»–é‡ç”Ÿå½’æ¥ã€‚å´å‘ç°æ¯’å®³ä»–çš„ç‹—ç”·å¥³ã€‚å·²ç»Ÿé¢†ä¸ƒæµ·å…«å·ã€‚å·ç§°â€œå‡¤åâ€â€œé¾™å¸â€å¨éœ‡å…«æ–¹ã€‚å½“é¾™åŸå‰‘å‡ºï¼Œé›·éœ†ç ´ç©ºï¼Œéœ‡ç ´è‹ç©¹ï¼Œå±±æ²³ç ´ç¢ï¼Œæ˜Ÿè¾°é™¨è½ã€‚â€œå¾…æˆ‘é‡ä¿®30å¹´ï¼Œå¿…å°†è¸ç ´æ˜Ÿæ²³ï¼Œè¡€æ´—é‡‘éŠ®æ®¿ï¼â€â€¦â€¦â€¦ å„ä½ä¹¦å‹è¦æ˜¯è§‰å¾—ã€Šä¹è½¬åœ£çµå†³ã€‹è¿˜ä¸é”™çš„è¯è¯·ä¸è¦å¿˜è®°å‘æ‚¨QQç¾¤å’Œå¾®åšé‡Œçš„æœ‹å‹æ¨èå“¦ï¼ä¹è½¬åœ£çµå†³æœ€æ–°ç« èŠ‚,ä¹è½¬åœ£çµå†³æ— å¼¹çª—,ä¹è½¬åœ£çµå†³å…¨æ–‡é˜…è¯».  &#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;é›¨å¢¨é£èµ·&#x27;</span>, <span class="hljs-number">511333</span>, <span class="hljs-number">2534</span>, <span class="hljs-number">2345</span>, <span class="hljs-number">6234524</span>, <span class="hljs-number">1</span>, <span class="hljs-keyword">NULL</span>, <span class="hljs-number">1</span>, <span class="hljs-number">51262</span>);<br></code></pre></div></td></tr></table></figure><h2 id="åˆ›å»ºç´¢å¼•"><a href="#åˆ›å»ºç´¢å¼•" class="headerlink" title="åˆ›å»ºç´¢å¼•"></a>åˆ›å»ºç´¢å¼•</h2><p>ä½¿ç”¨ postman ç­‰å·¥å…·åˆ›å»º es ç´¢å¼•ï¼Œå…¶ä¸­ä½¿ç”¨åˆ°äº† ik ä»¥åŠ pinyin åˆ†è¯å™¨ï¼Œå…·ä½“é…ç½®å¯ä»¥å‚è€ƒæˆ‘å‰é¢çš„æ–‡ç« ã€‚</p><p>PUT: <a href="http://192.168.200.192:9200/novel">http://192.168.200.192:9200/novel</a></p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;settings&quot;</span>:&#123;<br>        <span class="hljs-attr">&quot;number_of_shards&quot;</span>:<span class="hljs-number">5</span>,<br>        <span class="hljs-attr">&quot;number_of_replicas&quot;</span>:<span class="hljs-number">1</span>,<br>        <span class="hljs-attr">&quot;analysis&quot;</span>:&#123;<br>            <span class="hljs-attr">&quot;analyzer&quot;</span>:&#123;<br>                <span class="hljs-attr">&quot;pinyin_analyzer&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;tokenizer&quot;</span>:<span class="hljs-string">&quot;ik_smart&quot;</span>,<br>                    <span class="hljs-attr">&quot;filter&quot;</span>:[<br>                        <span class="hljs-string">&quot;full_pinyin_no_space&quot;</span>,<br>                        <span class="hljs-string">&quot;full_pinyin_with_space&quot;</span>,<br>                        <span class="hljs-string">&quot;first_letter_pinyin&quot;</span><br>                    ]<br>                &#125;<br>            &#125;,<br>            <span class="hljs-attr">&quot;filter&quot;</span>:&#123;<br>                <span class="hljs-attr">&quot;full_pinyin_no_space&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;pinyin&quot;</span>,<br>                    <span class="hljs-attr">&quot;first_letter&quot;</span>:<span class="hljs-string">&quot;none&quot;</span>,<br>                    <span class="hljs-attr">&quot;padding_char&quot;</span>:<span class="hljs-string">&quot;&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;full_pinyin_with_space&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;pinyin&quot;</span>,<br>                    <span class="hljs-attr">&quot;first_letter&quot;</span>:<span class="hljs-string">&quot;none&quot;</span>,<br>                    <span class="hljs-attr">&quot;padding_char&quot;</span>:<span class="hljs-string">&quot; &quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;first_letter_pinyin&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;pinyin&quot;</span>,<br>                    <span class="hljs-attr">&quot;first_letter&quot;</span>:<span class="hljs-string">&quot;only&quot;</span>,<br>                    <span class="hljs-attr">&quot;padding_char&quot;</span>:<span class="hljs-string">&quot;&quot;</span><br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;,<br>    <span class="hljs-attr">&quot;mappings&quot;</span>:&#123;<br>        <span class="hljs-attr">&quot;book&quot;</span>:&#123;<br>            <span class="hljs-attr">&quot;properties&quot;</span>:&#123;<br>                <span class="hljs-attr">&quot;id&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;integer&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;words&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;integer&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;intro&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;analyzer&quot;</span>:<span class="hljs-string">&quot;ik_smart&quot;</span>,<br>                    <span class="hljs-attr">&quot;search_analyzer&quot;</span>:<span class="hljs-string">&quot;ik_smart&quot;</span>,<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;name&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;analyzer&quot;</span>:<span class="hljs-string">&quot;pinyin_analyzer&quot;</span>,<br>                    <span class="hljs-attr">&quot;search_analyzer&quot;</span>:<span class="hljs-string">&quot;pinyin_analyzer&quot;</span>,<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;sort&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;integer&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;updatetime&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;date&quot;</span>,<br>                    <span class="hljs-attr">&quot;format&quot;</span>:<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;vip&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;boolean&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;site&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;integer&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;author&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;analyzer&quot;</span>:<span class="hljs-string">&quot;pinyin_analyzer&quot;</span>,<br>                    <span class="hljs-attr">&quot;search_analyzer&quot;</span>:<span class="hljs-string">&quot;pinyin_analyzer&quot;</span>,<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;collection&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;integer&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;click&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;integer&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;popularity&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;integer&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;goods&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;integer&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;status&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;integer&quot;</span><br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ³¨æ„ï¼Œè¿™é‡Œç´¢å¼•çš„æ‰€æœ‰å­—æ®µéƒ½æ˜¯å°å†™çš„ï¼Œä¸è¦åŒ…å«å¤§å†™ï¼Œå¦åˆ™åç»­ä¼šå‡ºç°é—®é¢˜ã€‚<br>ç´¢å¼•åˆ›å»ºå¥½äº†ä¹‹åï¼Œå®‰è£… logstashã€‚</p><h2 id="å®‰è£…-logstash"><a href="#å®‰è£…-logstash" class="headerlink" title="å®‰è£… logstash"></a>å®‰è£… logstash</h2><p>Tips: å› ä¸º logstash å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šå ç”¨è¾ƒé«˜çš„ CPU ï¼Œå»ºè®®ä¸è¦æ”¾åœ¨ es é›†ç¾¤çš„æœåŠ¡å™¨ä¸Šï¼Œæœ€å¥½æ¢ä¸€å°æœåŠ¡å™¨è¿›è¡Œå®‰è£…ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">wget</span> https://artifacts.elastic.co/downloads/logstash/logstash-<span class="hljs-number">6</span>.<span class="hljs-number">4</span>.<span class="hljs-number">0</span>.tar.gz<br><br><span class="hljs-attribute">tar</span> -xvf logstash-<span class="hljs-number">6</span>.<span class="hljs-number">4</span>.<span class="hljs-number">0</span>.tar.gz<br></code></pre></div></td></tr></table></figure><p>å› ä¸ºå»ºç«‹ç´¢å¼•éœ€è¦ä½¿ç”¨åˆ° <strong>logstash-input-jdbc</strong>ï¼Œæ‰€ä»¥å…ˆé…ç½®è¿™ä¸ªæ’ä»¶ï¼Œ<strong>è¿™ä¸ªæ’ä»¶åœ¨ logstash 5.0 ä¹‹åå°±é»˜è®¤è‡ªå¸¦äº†ï¼Œæ— éœ€å†æ¬¡å®‰è£…</strong>ã€‚</p><h2 id="é…ç½®-logstashåŒæ­¥ä¹‹å…¨é‡åŒæ­¥"><a href="#é…ç½®-logstashåŒæ­¥ä¹‹å…¨é‡åŒæ­¥" class="headerlink" title="é…ç½® logstashåŒæ­¥ä¹‹å…¨é‡åŒæ­¥"></a>é…ç½® logstashåŒæ­¥ä¹‹å…¨é‡åŒæ­¥</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-comment">## è¿›å…¥ logstash æ ¹ç›®å½•</span><br>cd <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/</span>logstash-<span class="hljs-number">6.4</span>.<span class="hljs-number">0</span><br><br><span class="hljs-comment">## åˆ›å»ºå­˜æ”¾ logstash-input-jdbc ç›¸å…³é…ç½®ä»¥åŠä¾èµ–çš„ç›®å½•</span><br>mkdir logstash-input-jdbc<br><br>cd logstash-input-jdbc<br><br><span class="hljs-comment">## åˆ›å»ºä¸¤ä¸ªç›®å½•</span><br>mkdir lib &amp; mkdir conf<br><br><span class="hljs-comment">## ä¸‹è½½ jdbc æ‰€éœ€çš„ mysql é©±åŠ¨åˆ° lib ç›®å½•</span><br>wget http:<span class="hljs-regexp">//</span>central.maven.org<span class="hljs-regexp">/maven2/my</span>sql<span class="hljs-regexp">/mysql-connector-java/</span><span class="hljs-number">6.0</span>.<span class="hljs-number">6</span><span class="hljs-regexp">/mysql-connector-java-6.0.6.jar -P lib/</span><br><br><span class="hljs-comment">## è¿›å…¥ conf/ ç›®å½•</span><br>cd conf/<br><br><span class="hljs-comment">## åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯ jdbc çš„ sqlï¼Œå¦ä¸€ä¸ªæ˜¯ logstash-input-jdbc çš„é…ç½®æ–‡ä»¶</span><br><br>vim mysql2es.sql<br></code></pre></div></td></tr></table></figure><p>é¦–å…ˆç¼–å†™ sqlï¼Œ æ„é€ ç´¢å¼•æ‰€éœ€çš„æ•°æ®ã€‚ç”±äºæ˜¯ç¬¬ä¸€æ¬¡åŒæ­¥åˆ° es,æ‰€ä»¥è¿›è¡Œå…¨é‡åŒæ­¥ï¼Œä¸è¿‡è¿™é‡Œçš„å…¨é‡ä¹Ÿå¹¶éæ˜¯ä¸€æ¬¡æ€§æŠŠæŸ¥å‡ºåº“å†…æ‰€æœ‰æ•°æ®ï¼Œè€Œæ˜¯ä¼ªå…¨é‡çš„å¢é‡åŒæ­¥ã€‚</p><p><strong>mysql2es.sql</strong> å†…å®¹ä¸º</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span><br>`id`,<br>IFNULL( `update_time`, <span class="hljs-string">&#x27;1970-01-01 08:00:00&#x27;</span> ) <span class="hljs-keyword">AS</span> `updatetime`,<br>`status`,<br>`name`,<br>IFNULL( `intro`, <span class="hljs-string">&#x27;&#x27;</span> ) <span class="hljs-keyword">AS</span> `intro`,<br>`author`,<br>`words`,<br>`collection`,<br>`goods`,<br>`click`,<br>`site`,<br>`sort`,<br>`vip`,<br>`popularity` <br><span class="hljs-keyword">FROM</span><br>book <br><span class="hljs-keyword">WHERE</span><br>id <span class="hljs-operator">&gt;=</span> :sql_last_value <span class="hljs-keyword">and</span> id <span class="hljs-operator">&lt;</span> :sql_last_value <span class="hljs-operator">+</span> <span class="hljs-number">11</span><br></code></pre></div></td></tr></table></figure><p><strong>æ³¨æ„</strong>ä¸ºäº†é¿å…ä¸€æ¬¡æ€§æŸ¥è¯¢ï¼Œå¯¹æ•°æ®åº“é€ æˆå¤ªå¤§å‹åŠ›ï¼Œå› æ­¤è¿™é‡Œä½¿ç”¨äº†å¢é‡çš„æ–¹å¼æ¥å®Œæˆåˆå§‹åŒ–åŒæ­¥åˆ° esï¼Œè¿™é‡Œçš„ :sql_last_value æ˜¯ logstash ä¸Šä¸€æ­¥åŒæ­¥çš„æœ€åçš„å€¼ï¼Œè¿™é‡Œä¸º idï¼Œä¹Ÿå¯ä»¥æ˜¯æ—¶é—´ã€‚å› ä¸ºæ¼”ç¤ºç”¨çš„æµ‹è¯•æ•°æ®è¾ƒå°‘ï¼Œæ‰€ä»¥æ¯æ¬¡åªåŒæ­¥äº† 10 æ¡è®°å½•ï¼Œå¦‚æœå®é™…ä½¿ç”¨ï¼Œä¸€æ¬¡åŒæ­¥ 1000 æ¡æ¯”è¾ƒåˆé€‚ï¼Œå³ <code>:sql_last_value + 1001</code></p><p><strong>sql æŸ¥è¯¢å‡ºçš„å­—æ®µåè¦ä¸ç´¢å¼•å­—æ®µåç§°å¯¹åº”ä¸Šï¼Œå¦åˆ™æ— æ³•æ˜ å°„åŒæ­¥ã€‚</strong></p><p>è¿™é‡Œçš„ mysql2es.sql å°†åœ¨ logstash-input-jdbc ä¸­ç”¨åˆ°ï¼Œåˆ›å»ºæ–‡ä»¶ mysql2es.conf</p><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim"><span class="hljs-keyword">vim</span> mysql2es.<span class="hljs-keyword">conf</span><br></code></pre></div></td></tr></table></figure><p>mysql2es.conf çš„å†…å®¹æ˜¯ï¼š</p><figure class="highlight puppet"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs puppet"><span class="hljs-keyword">input</span> &#123;<br>    stdin &#123;<br>    &#125;<br>    <span class="hljs-keyword">jdbc</span> &#123;<br>      <span class="hljs-comment"># æ•°æ®åº“</span><br>      <span class="hljs-attr">jdbc_connection_string</span> =&gt; <span class="hljs-string">&quot;jdbc:mysql://192.168.199.192:3306/novel&quot;</span><br>      <span class="hljs-comment"># ç”¨æˆ·åå¯†ç </span><br>      <span class="hljs-attr">jdbc_user</span> =&gt; <span class="hljs-string">&quot;root&quot;</span><br>      <span class="hljs-attr">jdbc_password</span> =&gt; <span class="hljs-string">&quot;123456&quot;</span><br>      <span class="hljs-comment"># jaråŒ…çš„ä½ç½®</span><br>      <span class="hljs-attr">jdbc_driver_library</span> =&gt; <span class="hljs-string">&quot;/usr/local/es/logstash-6.4.0/logstash-input-jdbc/lib/mysql-connector-java-6.0.6.jar&quot;</span><br>      <span class="hljs-comment"># mysqlçš„Driver</span><br>      <span class="hljs-attr">jdbc_driver_class</span> =&gt; <span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span><br>      <span class="hljs-comment"># è¯»å–è¿™ä¸ªsql</span><br>      <span class="hljs-attr">statement_filepath</span> =&gt; <span class="hljs-string">&quot;/usr/local/es/logstash-6.4.0/logstash-input-jdbc/conf/mysql2es.sql&quot;</span><br>      <span class="hljs-comment"># æŒ‡å®šæ—¶åŒº</span><br>      <span class="hljs-attr">jdbc_default_timezone</span> =&gt; <span class="hljs-string">&quot;Asia/Shanghai&quot;</span><br>      <span class="hljs-comment"># æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡åŒæ­¥(åˆ† æ—¶ å¤© æœˆ å¹´)ï¼Œæ¯”å¦‚æ¯ååˆ†é’Ÿ(*/10 * * * *)</span><br>      <span class="hljs-attr">schedule</span> =&gt; <span class="hljs-string">&quot;* * * * *&quot;</span><br>      <span class="hljs-comment">#ç´¢å¼•çš„ç±»å‹</span><br>      <span class="hljs-attr">type</span> =&gt; <span class="hljs-string">&quot;book&quot;</span><br><br>      <span class="hljs-attr">use_column_value</span> =&gt; <span class="hljs-string">&quot;true&quot;</span><br>      <span class="hljs-comment">#tracking_column_type: é€’å¢å­—æ®µçš„ç±»å‹ï¼Œnumeric è¡¨ç¤ºæ•°å€¼ç±»å‹, timestamp è¡¨ç¤ºæ—¶é—´æˆ³ç±»å‹</span><br>      <span class="hljs-attr">tracking_column_type</span> =&gt; <span class="hljs-string">&quot;numeric&quot;</span><br>      <span class="hljs-comment"># é€’å¢å­—æ®µ</span><br>      <span class="hljs-attr">tracking_column</span> =&gt; <span class="hljs-string">&quot;id&quot;</span><br>      <span class="hljs-comment"># ä¿å­˜æ¯æ¬¡åŒæ­¥æ—¶é€’å¢å­—æ®µçš„æœ€åä¸€ä¸ªå€¼åˆ°è¿™ä¸ªæ–‡ä»¶</span><br>      <span class="hljs-attr">last_run_metadata_path</span> =&gt; <span class="hljs-string">&quot;/usr/local/es/logstash-6.4.0/logstash-input-jdbc/conf/full_sync&quot;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">filter</span> &#123;<br><br>    json &#123;<br>        <span class="hljs-attr">source</span> =&gt; <span class="hljs-string">&quot;message&quot;</span><br>        <span class="hljs-attr">remove_field</span> =&gt; [<span class="hljs-string">&quot;message&quot;</span>]<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">output</span> &#123;<br>    elasticsearch &#123;<br>        <span class="hljs-attr">hosts</span> =&gt; <span class="hljs-string">&quot;192.168.199.192:9200&quot;</span><br>        <span class="hljs-comment"># index ç´¢å¼•å</span><br>        <span class="hljs-attr">index</span> =&gt; <span class="hljs-string">&quot;novel&quot;</span><br>        <span class="hljs-comment"># éœ€è¦å…³è”çš„æ•°æ®åº“ä¸­æœ‰æœ‰ä¸€ä¸ªidå­—æ®µï¼Œå¯¹åº”ç´¢å¼•çš„idå·</span><br>        <span class="hljs-attr">document_id</span> =&gt; <span class="hljs-string">&quot;%&#123;id&#125;&quot;</span><br>    &#125;<br>    <span class="hljs-keyword">stdout</span> &#123;<br>        <span class="hljs-attr">codec</span> =&gt; json_lines<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="å¯åŠ¨logstashåŒæ­¥"><a href="#å¯åŠ¨logstashåŒæ­¥" class="headerlink" title="å¯åŠ¨logstashåŒæ­¥"></a>å¯åŠ¨logstashåŒæ­¥</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/</span>logstash-<span class="hljs-number">6.4</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/bin/</span>logstash -f <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/</span>logstash-<span class="hljs-number">6.4</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/logstash-input-jdbc/</span>conf/mysql2es.conf<br></code></pre></div></td></tr></table></figure><p>å¯åŠ¨åç¨ç­‰ä¸€ä¼šå„¿ï¼Œå¦‚æœé…ç½®æ­£ç¡®ä¼šæ‰“å°å‡ºæ‰§è¡Œçš„ sql:</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> `id`,IFNULL(`update_time`,<span class="hljs-string">&#x27;1970-01-01 08:00:00&#x27;</span>) <span class="hljs-keyword">AS</span> `updatetime`,`status`,`name`,IFNULL(`intro`,<span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-keyword">AS</span> `intro`,`author`,`words`,`collection`,`goods`,`click`,`site`,`sort`,`vip`,`popularity` <span class="hljs-keyword">FROM</span> book <span class="hljs-keyword">WHERE</span> id<span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span> <span class="hljs-keyword">AND</span> id<span class="hljs-operator">&lt;</span> <span class="hljs-number">0</span><span class="hljs-operator">+</span><span class="hljs-number">11</span><br></code></pre></div></td></tr></table></figure><p>æŸ¥çœ‹ ElasticSearchHead æ§åˆ¶å°ï¼Œå‘ç°ä¹Ÿå·²ç»æœ‰äº† 10 æ¡ç´¢å¼•æ•°æ®ã€‚<br>ç”±äºæ¯æ¬¡åŒæ­¥ 10 æ¡ï¼Œæ¯åˆ†é’ŸåŒæ­¥ä¸€æ¬¡ï¼Œ5åˆ†é’Ÿåï¼Œæµ‹è¯•çš„ 50æ¡è®°å½•ä¹Ÿå·²ç»å…¨éƒ¨è¢«åŒæ­¥åˆ° es é‡Œäº†ã€‚</p><p>ctrl + c åœæ­¢åŒæ­¥è¿›ç¨‹ï¼ŒæŸ¥çœ‹æ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cat <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/</span>logstash-<span class="hljs-number">6.4</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/logstash-input-jdbc/</span>conf/full_sync<br></code></pre></div></td></tr></table></figure><p>æ–‡ä»¶ä¸­çš„æ•°å­—æ­£æ˜¯ä¸Šæ¬¡æœ€ååŒæ­¥çš„ id</p><h2 id="logstashå¢é‡åŒæ­¥"><a href="#logstashå¢é‡åŒæ­¥" class="headerlink" title="logstashå¢é‡åŒæ­¥"></a>logstashå¢é‡åŒæ­¥</h2><p>æ ¹æ® id è¿›è¡ŒåŒæ­¥ï¼Œå¦‚æœå¯¹æ•°æ®åº“ä¸­å·²è¢«åŒæ­¥åˆ° es çš„æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼Œè¿™ä¸ªæ•°æ®ä¹Ÿä¸ä¼šè¢«åŒæ­¥æ›´æ–°åˆ° es å½“ä¸­å»ã€‚</p><p>æ ¹æ® id æ¯æ¬¡åŒæ­¥ 1000 æ¡ï¼Œè¿™ç§åŒæ­¥æ–¹å¼ä¹Ÿåªé€‚åˆç¬¬ä¸€æ¬¡å…¨é‡è¿›è¡Œåˆå§‹åŒ–æ—¶å€™ä½¿ç”¨ï¼Œåç»­å¢é‡åŒæ­¥æœ€å¥½æ ¹æ®æ—¶é—´æˆ³çš„æ–¹å¼å®Œæˆã€‚</p><p>ä¿®æ”¹ <strong>mysql2es.sql</strong></p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span><br>`id`,<br>IFNULL( `update_time`, <span class="hljs-string">&#x27;1970-01-01 08:00:00&#x27;</span> ) <span class="hljs-keyword">AS</span> `updatetime`,<br>`status`,<br>`name`,<br>IFNULL( `intro`, <span class="hljs-string">&#x27;&#x27;</span> ) <span class="hljs-keyword">AS</span> `intro`,<br>`author`,<br>`words`,<br>`collection`,<br>`goods`,<br>`click`,<br>`site`,<br>`sort`,<br>`vip`,<br>`popularity` <br><span class="hljs-keyword">FROM</span><br>book <br><span class="hljs-keyword">WHERE</span><br>update_time <span class="hljs-operator">&gt;=</span> convert_tz(:sql_last_value, <span class="hljs-string">&#x27;+00:00&#x27;</span>,<span class="hljs-string">&#x27;-08:00&#x27;</span>)<br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> update_time <span class="hljs-keyword">asc</span><br></code></pre></div></td></tr></table></figure><p><strong>æ³¨æ„è¿™é‡Œä½¿ç”¨åˆ°äº† convert_tz è¿™ä¸ªå‡½æ•°ï¼ŒåŸå› æ˜¯ logstash ä¼šåœ¨åŒæ­¥æ—¶åœ¨æœ€ååŒæ­¥æ—¶é—´å¢åŠ  8 ä¸ªå°æ—¶ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨å‡½æ•°ï¼Œå‡å» 8 ä¸ªå°æ—¶æ‰æ˜¯æ­£ç¡®çš„æ—¶é—´ã€‚ å› ä¸ºlogstash è®°å½•æœ€åä¸€æ¬¡åŒæ­¥çš„å€¼æ˜¯æœ€åä¸€æ¡è®°å½•çš„ï¼Œæ‰€ä»¥ï¼Œæœ€å¥½æ ¹æ® update_time è¿›è¡Œå‡åºæ’åºï¼Œå³å–çš„å€¼æ˜¯ç¦»ç°åœ¨æœ€è¿‘çš„æ—¶é—´ã€‚</strong></p><p>ä¿®æ”¹ <strong>mysql2es.conf</strong></p><figure class="highlight puppet"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs puppet"><span class="hljs-keyword">input</span> &#123;<br>    stdin &#123;<br>    &#125;<br>    <span class="hljs-keyword">jdbc</span> &#123;<br>      <span class="hljs-comment"># æ•°æ®åº“</span><br>      <span class="hljs-attr">jdbc_connection_string</span> =&gt; <span class="hljs-string">&quot;jdbc:mysql://192.168.199.192:3306/novel&quot;</span><br>      <span class="hljs-comment"># ç”¨æˆ·åå¯†ç </span><br>      <span class="hljs-attr">jdbc_user</span> =&gt; <span class="hljs-string">&quot;root&quot;</span><br>      <span class="hljs-attr">jdbc_password</span> =&gt; <span class="hljs-string">&quot;123456&quot;</span><br>      <span class="hljs-comment"># jaråŒ…çš„ä½ç½®</span><br>      <span class="hljs-attr">jdbc_driver_library</span> =&gt; <span class="hljs-string">&quot;/usr/local/es/logstash-6.4.0/logstash-input-jdbc/lib/mysql-connector-java-6.0.6.jar&quot;</span><br>      <span class="hljs-comment"># mysqlçš„Driver</span><br>      <span class="hljs-attr">jdbc_driver_class</span> =&gt; <span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span><br>      <span class="hljs-comment"># è¯»å–è¿™ä¸ªsql</span><br>      <span class="hljs-attr">statement_filepath</span> =&gt; <span class="hljs-string">&quot;/usr/local/es/logstash-6.4.0/logstash-input-jdbc/conf/mysql2es.sql&quot;</span><br>      <span class="hljs-comment"># æŒ‡å®šæ—¶åŒº</span><br>      <span class="hljs-attr">jdbc_default_timezone</span> =&gt; <span class="hljs-string">&quot;Asia/Shanghai&quot;</span><br>      <span class="hljs-comment"># æ¯åˆ†é’Ÿ</span><br>      <span class="hljs-attr">schedule</span> =&gt; <span class="hljs-string">&quot;* * * * *&quot;</span><br>      <span class="hljs-comment">#ç´¢å¼•çš„ç±»å‹</span><br>      <span class="hljs-attr">type</span> =&gt; <span class="hljs-string">&quot;book&quot;</span><br><br>      <span class="hljs-attr">use_column_value</span> =&gt; <span class="hljs-string">&quot;true&quot;</span><br>      <span class="hljs-comment">#tracking_column_type: é€’å¢å­—æ®µçš„ç±»å‹ï¼Œnumeric è¡¨ç¤ºæ•°å€¼ç±»å‹, timestamp è¡¨ç¤ºæ—¶é—´æˆ³ç±»å‹</span><br>      <span class="hljs-attr">tracking_column_type</span> =&gt; <span class="hljs-string">&quot;timestamp&quot;</span><br>      <span class="hljs-comment"># é€’å¢å­—æ®µ</span><br>      <span class="hljs-attr">tracking_column</span> =&gt; <span class="hljs-string">&quot;updatetime&quot;</span><br>      <span class="hljs-comment"># ä¿å­˜æ¯æ¬¡åŒæ­¥æ—¶é€’å¢å­—æ®µçš„æœ€åä¸€ä¸ªå€¼åˆ°è¿™ä¸ªæ–‡ä»¶</span><br>      <span class="hljs-attr">last_run_metadata_path</span> =&gt; <span class="hljs-string">&quot;/usr/local/es/logstash-6.4.0/logstash-input-jdbc/conf/incr_sync&quot;</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">filter</span> &#123;<br><br>    json &#123;<br>        <span class="hljs-attr">source</span> =&gt; <span class="hljs-string">&quot;message&quot;</span><br>        <span class="hljs-attr">remove_field</span> =&gt; [<span class="hljs-string">&quot;message&quot;</span>]<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">output</span> &#123;<br>    elasticsearch &#123;<br>        <span class="hljs-attr">hosts</span> =&gt; <span class="hljs-string">&quot;192.168.199.192:9200&quot;</span><br>        <span class="hljs-comment"># index ç´¢å¼•å</span><br>        <span class="hljs-attr">index</span> =&gt; <span class="hljs-string">&quot;novel&quot;</span><br>        <span class="hljs-comment"># éœ€è¦å…³è”çš„æ•°æ®åº“ä¸­æœ‰æœ‰ä¸€ä¸ªidå­—æ®µï¼Œå¯¹åº”ç´¢å¼•çš„idå·</span><br>        <span class="hljs-attr">document_id</span> =&gt; <span class="hljs-string">&quot;%&#123;id&#125;&quot;</span><br>    &#125;<br>    <span class="hljs-keyword">stdout</span> &#123;<br>        <span class="hljs-attr">codec</span> =&gt; json_lines<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¿®æ”¹å¢é‡çš„å­—æ®µä¸º updatetimeï¼Œä¸”å­—æ®µç±»å‹è®¾ç½®ä¸º timestampï¼Œ<br>æŒ‡å®šè®°å½•æœ€ååŒæ­¥æ—¶é—´çš„æ–‡ä»¶ä¸º incr_sync ï¼ŒåŒæ—¶åœ¨ conf ç›®å½•ä¸‹åˆ›å»ºè¿™ä¸ªæ–‡ä»¶ incr_syncï¼Œè®¾ç½®ä¸€ä¸‹åˆå§‹å€¼ï¼Œå³åŒæ­¥å¤§äºè®¾ç½®è¿™ä¸ªå€¼çš„æ•°æ®ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/</span>logstash-<span class="hljs-number">6.4</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/logstash-input-jdbc/</span>conf/<br>vim incr_conf<br><br><span class="hljs-comment"># æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œè¿™é‡Œå…·ä½“æ—¶é—´æ ¹æ®ä½ çš„æƒ…å†µè‡ªè¡Œä¿®æ”¹</span><br><br>--- !ruby/object:DateTime <span class="hljs-string">&#x27;2018-09-04 16:47:14.000000000 Z&#x27;</span><br><br><br><span class="hljs-comment">## æ³¨æ„ä¿®æ”¹åªéœ€è¦æ”¹ 2018-09-04 16:47:14 è¿™ä¸€éƒ¨åˆ†ï¼Œå…¶ä»–åœ°æ–¹å°±ä¸è¦æ”¹ï¼Œæ”¹äº†æ ¼å¼å¯èƒ½ä¼šä¸å¯¹ã€‚</span><br></code></pre></div></td></tr></table></figure><p>ä¿å­˜é€€å‡ºï¼Œæ‰§è¡ŒåŒæ­¥å‘½ä»¤</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/</span>logstash-<span class="hljs-number">6.4</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/bin/</span>logstash -f <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/</span>logstash-<span class="hljs-number">6.4</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/logstash-input-jdbc/</span>conf/mysql2es.conf<br></code></pre></div></td></tr></table></figure><p>è¿‡ä¸€ä¼šå„¿ï¼Œæ­£å¸¸è¾“å‡º sql è¯­å¥</p><figure class="highlight n1ql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs n1ql"><span class="hljs-keyword">SELECT</span> <span class="hljs-symbol">`id`</span>,<span class="hljs-built_in">IFNULL</span>(<span class="hljs-symbol">`update_time`</span>,<span class="hljs-string">&#x27;1970-01-01 08:00:00&#x27;</span>) <span class="hljs-keyword">AS</span> <span class="hljs-symbol">`updatetime`</span>,<span class="hljs-symbol">`status`</span>,<span class="hljs-symbol">`name`</span>,<span class="hljs-built_in">IFNULL</span>(<span class="hljs-symbol">`intro`</span>,<span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-keyword">AS</span> <span class="hljs-symbol">`intro`</span>,<span class="hljs-symbol">`author`</span>,<span class="hljs-symbol">`words`</span>,<span class="hljs-symbol">`collection`</span>,<span class="hljs-symbol">`goods`</span>,<span class="hljs-symbol">`click`</span>,<span class="hljs-symbol">`site`</span>,<span class="hljs-symbol">`sort`</span>,<span class="hljs-symbol">`vip`</span>,<span class="hljs-symbol">`popularity`</span> <span class="hljs-keyword">FROM</span> book <span class="hljs-keyword">WHERE</span> update_time&gt; <span class="hljs-string">&#x27;2018-09-04 16:47:14&#x27;</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> update_time <span class="hljs-keyword">asc</span><br></code></pre></div></td></tr></table></figure><p><strong>incr_sync æ–‡ä»¶ä¸­çš„å€¼ï¼Œä¼šå› ä¸ºæ¯æ¬¡åŒæ­¥åŒæ­¥å–çš„æ˜¯æœ€åä¸€æ¡è®°å½•çš„å€¼ï¼Œæ‰€ä»¥æœ€å¥½å¯¹æ—¶é—´è¿›è¡Œæ’åº</strong></p><p><strong>é…ç½®æ–‡ä»¶ä¸­ï¼Œå½“åœ¨inputçš„jdbcä¸‹ï¼Œå¢åŠ typeå±æ€§æ—¶ï¼Œä¼šå¯¼è‡´è¯¥ç´¢å¼•ä¸‹å¢åŠ typeå­—æ®µã€‚æ‰€ä»¥sqlæŸ¥è¯¢å‡ºçš„å­—æ®µä¸è¦ç”¨typeï¼Œå¦‚æœæœ‰ï¼Œasæˆå…¶ä»–çš„åå­—ï¼Œä¸ç„¶çš„è¯ï¼Œè¿™é‡Œåˆ¤æ–­ä¼šæœ‰å¼‚å¸¸</strong></p><h2 id="logstash-åŒæ­¥åå°è¿è¡Œ"><a href="#logstash-åŒæ­¥åå°è¿è¡Œ" class="headerlink" title="logstash åŒæ­¥åå°è¿è¡Œ"></a>logstash åŒæ­¥åå°è¿è¡Œ</h2><p>ä¸Šé¢çš„è¿è¡Œå‘½ä»¤å¦‚æœæ¨å‡ºç»ˆç«¯æˆ–è€…æŒ‰ä¸‹ ctrl + cï¼ŒåŒæ­¥å°±ä¼šç»ˆæ­¢ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è®©åŒæ­¥ä»»åŠ¡åœ¨åå°è¿è¡Œã€‚</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">nouhup <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/</span>logstash-<span class="hljs-number">6.4</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/bin/</span>logstash -f <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/</span>logstash-<span class="hljs-number">6.4</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/logstash-input-jdbc/</span>conf/mysql2es.conf &amp;<br></code></pre></div></td></tr></table></figure><p>ä½¿ç”¨ <strong>nohup</strong> å’Œ * å·å°†è¦æ‰§è¡Œçš„è¯­å¥åŒ…è£¹èµ·æ¥ï¼Œå°±å¯ä»¥å®ç°åå°è¿è¡Œäº†ï¼ŒåŒæ—¶ä¼šåœ¨å½“å‰æ‰§è¡Œå‘½ä»¤çš„ç›®å½•ç”Ÿæˆä¸€ä¸ª nohup.out çš„æ–‡ä»¶ï¼Œè¿™é‡Œ logstash çš„è¿è¡Œæ—¥å¿—ä¼šè¢«å†™å…¥åˆ°è¿™ä¸ªæ–‡ä»¶å½“ä¸­ã€‚</p><figure class="highlight ada"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ada">tail -fn300 nohup.<span class="hljs-keyword">out</span><br></code></pre></div></td></tr></table></figure><h2 id="æœ‰ç–‘é—®"><a href="#æœ‰ç–‘é—®" class="headerlink" title="æœ‰ç–‘é—®?"></a>æœ‰ç–‘é—®?</h2><p>æ¬¢è¿æ¥ä¿¡ï¼Œ<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=JVNGSFRlQ0pdSERMSQtGSkg">ç»™æˆ‘å†™ä¿¡</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://www.cnblogs.com/licongyu/p/5383334.html">https://www.cnblogs.com/licongyu/p/5383334.html</a></li><li><a href="https://blog.csdn.net/laoyang360/article/details/51747266">https://blog.csdn.net/laoyang360/article/details/51747266</a></li><li><a href="https://segmentfault.com/a/1190000011784259">https://segmentfault.com/a/1190000011784259</a></li><li><a href="https://wenchao.ren/archives/393#8">https://wenchao.ren/archives/393#8</a></li><li><a href="http://www.cnblogs.com/xuwenjin/p/8989043.html">http://www.cnblogs.com/xuwenjin/p/8989043.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ElasticSearchç´¢å¼•åŒæ­¥åˆ›å»º</tag>
      
      <tag>logstashå…¨é‡åŒæ­¥å»ºç«‹esç´¢å¼•</tag>
      
      <tag>logstashå¢é‡åŒæ­¥å»ºç«‹esç´¢å¼•</tag>
      
      <tag>logstash-input-jdbcå¢é‡åŒæ­¥æ—¶é—´ä¸å¯¹</tag>
      
      <tag>logstash-input-jdbcå»ºç«‹ç´¢å¼•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹IKåˆ†è¯ä»¥åŠæ‹¼éŸ³åˆ†è¯</title>
    <link href="/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BIK%E5%88%86%E8%AF%8D%E4%BB%A5%E5%8F%8A%E6%8B%BC%E9%9F%B3%E5%88%86%E8%AF%8D.html"/>
    <url>/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BIK%E5%88%86%E8%AF%8D%E4%BB%A5%E5%8F%8A%E6%8B%BC%E9%9F%B3%E5%88%86%E8%AF%8D.html</url>
    
    <content type="html"><![CDATA[<p>elasticsearch å®˜æ–¹é»˜è®¤çš„åˆ†è¯æ’ä»¶ï¼Œå¯¹ä¸­æ–‡åˆ†è¯æ•ˆæœä¸ç†æƒ³ï¼Œå®ƒæ˜¯æŠŠä¸­æ–‡è¯è¯­åˆ†æˆäº†ä¸€ä¸ªä¸€ä¸ªçš„æ±‰å­—ã€‚æ‰€ä»¥æˆ‘ä»¬å¼•å…¥ es æ’ä»¶ es-ikã€‚åŒæ—¶ä¸ºäº†æå‡ç”¨æˆ·ä½“éªŒï¼Œå¼•å…¥ es-pinyin æ’ä»¶ã€‚æœ¬æ–‡ä»‹ç»è¿™ä¸¤ä¸ª es æ’ä»¶çš„å®‰è£…ã€‚</p><a id="more"></a><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><p>æœ¬æ–‡ä»¥åŠåç»­ es ç³»åˆ—æ–‡ç« éƒ½åŸºäº <strong>5.5.3</strong> è¿™ä¸ªç‰ˆæœ¬çš„ elasticsearch ï¼Œè¿™ä¸ªç‰ˆæœ¬æ¯”è¾ƒç¨³å®šï¼Œå¯ä»¥ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚</p><p>ik åˆ†è¯å™¨ å’Œ pinyin åˆ†è¯å™¨åœ¨ github ä»“åº“å¯ä»¥æ‰¾åˆ°ï¼Œæ³¨æ„ç‰ˆæœ¬ä¸ elasticsearch çš„ç‰ˆæœ¬éœ€è¦å¯¹åº”ï¼Œæœ¬æ–‡ä½¿ç”¨ <strong>5.5.3</strong> ç‰ˆæœ¬</p><ul><li><a href="https://github.com/medcl/elasticsearch-analysis-ik/releases/tag/v5.5.3">ik åˆ†è¯å™¨ä¸‹è½½</a></li><li><a href="https://github.com/medcl/elasticsearch-analysis-pinyin/releases/tag/v5.5.3">pinyin åˆ†è¯å™¨ä¸‹è½½</a></li></ul><p>å¦‚æœ elasticsearch ä¸æˆ‘çš„ç‰ˆæœ¬ä¸åŒï¼Œå¯ä»¥å»å®˜æ–¹ github å¯¹åº”çš„ä»“åº“æŸ¥çœ‹å¯¹åº”ç‰ˆæœ¬çš„ ik ä»¥åŠ pinyin åˆ†è¯å™¨ã€‚</p><h2 id="ç³»åˆ—æ–‡ç« "><a href="#ç³»åˆ—æ–‡ç« " class="headerlink" title="ç³»åˆ—æ–‡ç« "></a>ç³»åˆ—æ–‡ç« </h2><ul><li>ä¸€ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ElasticSearché›†ç¾¤æ­å»º</a></li><li>äºŒã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E5%85%A5%E9%97%A8.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ElasticSearchå…¥é—¨</a></li><li>ä¸‰ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BIK%E5%88%86%E8%AF%8D%E4%BB%A5%E5%8F%8A%E6%8B%BC%E9%9F%B3%E5%88%86%E8%AF%8D.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹IKåˆ†è¯ä»¥åŠæ‹¼éŸ³åˆ†è¯</a></li><li>å››ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BLogstash%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5%E5%BB%BA%E7%AB%8B%E7%B4%A2%E5%BC%95.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹Logstashå®æ—¶åŒæ­¥å»ºç«‹ç´¢å¼•</a></li><li>äº”ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%A5%E9%97%A8.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…¥é—¨</a></li><li>å…­ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%B3%E9%94%AE%E8%AF%8D%E9%AB%98%E4%BA%AE.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…³é”®è¯é«˜äº®</a></li><li>â€¦</li></ul><h2 id="å®‰è£…-ik-åˆ†è¯å™¨"><a href="#å®‰è£…-ik-åˆ†è¯å™¨" class="headerlink" title="å®‰è£… ik åˆ†è¯å™¨"></a>å®‰è£… ik åˆ†è¯å™¨</h2><p>å‰æ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»å®‰è£…äº† elasticsearchï¼Œæˆ‘ä»¬åœ¨å…¶åŸºç¡€ä¸Šå®‰è£…åˆ†è¯å™¨</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/</span><br><br><span class="hljs-comment">## ä¸‹è½½ ik åˆ†è¯å™¨</span><br>wget https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/medcl/</span>elasticsearch-analysis-ik<span class="hljs-regexp">/releases/</span>download<span class="hljs-regexp">/v5.5.3/</span>elasticsearch-analysis-ik-<span class="hljs-number">5.5</span>.<span class="hljs-number">3</span>.zip<br><br><span class="hljs-comment">## ä½¿ç”¨ unzip è§£å‹</span><br><span class="hljs-comment">## å¦‚æœæœªå®‰è£…ï¼Œé€šè¿‡ yum instal unzip è¿›è¡Œå®‰è£…</span><br>unzip elasticsearch-analysis-ik-<span class="hljs-number">5.5</span>.<span class="hljs-number">3</span>.zip<br><br><br><span class="hljs-comment">## åœ¨ elasticsearch å®‰è£…ç›®å½•ä¸‹çš„ plugins æ–‡ä»¶å¤¹ä¸‹åˆ›å»º ik ç›®å½•</span><br>mkdir <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/m</span>aster<span class="hljs-regexp">/plugins/i</span>k<br><br><span class="hljs-comment">## å°†è§£å‹åçš„ ik ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ç§»åŠ¨åˆ°  /usr/local/es/master/plugins/ik/</span><br>mv <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/</span>elasticsearch<span class="hljs-regexp">/* /u</span>sr<span class="hljs-regexp">/local/</span>es<span class="hljs-regexp">/master/</span>plugins<span class="hljs-regexp">/ik/</span><br><br><span class="hljs-comment">## é‡å¯ elasticsearch æˆ–å¯åŠ¨ master elasticsearch</span><br><span class="hljs-comment">## æ³¨æ„å¯åŠ¨æ—¶ï¼Œéœ€è¦åˆ‡æ¢åˆ° esuser ç”¨æˆ·</span><br><br><br><span class="hljs-comment">## å¯åŠ¨æˆåŠŸåï¼Œæ—¥å¿—é‡Œä¼šæ‰“å°æ­¤è¡Œ</span><br>[<span class="hljs-number">2018</span>-<span class="hljs-number">09</span>-<span class="hljs-number">02</span>T06:<span class="hljs-number">33</span>:<span class="hljs-number">43</span>,<span class="hljs-number">703</span>][INFO ][o.e.p.PluginsService     ] [master] loaded plugin [analysis-ik]<br></code></pre></div></td></tr></table></figure><h2 id="éªŒè¯-ik-åˆ†è¯å™¨æ˜¯å¦ç”Ÿæ•ˆ"><a href="#éªŒè¯-ik-åˆ†è¯å™¨æ˜¯å¦ç”Ÿæ•ˆ" class="headerlink" title="éªŒè¯ ik åˆ†è¯å™¨æ˜¯å¦ç”Ÿæ•ˆ"></a>éªŒè¯ ik åˆ†è¯å™¨æ˜¯å¦ç”Ÿæ•ˆ</h2><p>æ‰“å¼€ Restlet Client æˆ–è€… postman å·¥å…·</p><p>GET <code>http://192.168.199.192:9200/_analyze?analyzer=ik_smart&amp;text=&quot;ä¸­åäººæ°‘å…±å’Œå›½å›½æ­Œ&quot;</code></p><blockquote><p>ç§»é™¤åä¸º ik çš„analyzerå’Œtokenizer,è¯·åˆ†åˆ«ä½¿ç”¨ ik_smart å’Œ ik_max_word<br>ik_max_word: ä¼šå°†æ–‡æœ¬åšæœ€ç»†ç²’åº¦çš„æ‹†åˆ†ï¼Œæ¯”å¦‚ä¼šå°†â€œä¸­åäººæ°‘å…±å’Œå›½å›½æ­Œâ€æ‹†åˆ†ä¸ºâ€œä¸­åäººæ°‘å…±å’Œå›½,ä¸­åäººæ°‘,ä¸­å,åäºº,äººæ°‘å…±å’Œå›½,äººæ°‘,äºº,æ°‘,å…±å’Œå›½,å…±å’Œ,å’Œ,å›½å›½,å›½æ­Œâ€ï¼Œä¼šç©·å°½å„ç§å¯èƒ½çš„ç»„åˆï¼›<br>ik_smart: ä¼šåšæœ€ç²—ç²’åº¦çš„æ‹†åˆ†ï¼Œæ¯”å¦‚ä¼šå°†â€œä¸­åäººæ°‘å…±å’Œå›½å›½æ­Œâ€æ‹†åˆ†ä¸ºâ€œä¸­åäººæ°‘å…±å’Œå›½,å›½æ­Œâ€ã€‚</p></blockquote><p>è¿™é‡Œ analyzer å¯ä»¥æŒ‡å®šåˆ†è¯ç±»å‹ï¼Œå‘é€è¯·æ±‚è¿”å›ç»“æœï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;tokens&quot;</span>: [<br>        &#123;<br>            <span class="hljs-attr">&quot;token&quot;</span>: <span class="hljs-string">&quot;ä¸­åäººæ°‘å…±å’Œå›½&quot;</span>,<br>            <span class="hljs-attr">&quot;start_offset&quot;</span>: <span class="hljs-number">1</span>,<br>            <span class="hljs-attr">&quot;end_offset&quot;</span>: <span class="hljs-number">8</span>,<br>            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;CN_WORD&quot;</span>,<br>            <span class="hljs-attr">&quot;position&quot;</span>: <span class="hljs-number">0</span><br>        &#125;,<br>        &#123;<br>            <span class="hljs-attr">&quot;token&quot;</span>: <span class="hljs-string">&quot;å›½æ­Œ&quot;</span>,<br>            <span class="hljs-attr">&quot;start_offset&quot;</span>: <span class="hljs-number">8</span>,<br>            <span class="hljs-attr">&quot;end_offset&quot;</span>: <span class="hljs-number">10</span>,<br>            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;CN_WORD&quot;</span>,<br>            <span class="hljs-attr">&quot;position&quot;</span>: <span class="hljs-number">1</span><br>        &#125;<br>    ]<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æˆ‘è¿™é‡ŒæŒ‡å®šçš„ analyzer ä¸º ik_smartï¼Œå³ç²—ç²’åº¦åˆ†è¯ï¼Œå¯ä»¥çœ‹åˆ° ik åˆ†è¯å™¨å·²ç»ç”Ÿæ•ˆäº†ã€‚æ¥ä¸‹æ¥ç»§ç»­å®‰è£… pinyin åˆ†è¯å™¨ã€‚</p><h2 id="å®‰è£…-pinyin-åˆ†è¯å™¨"><a href="#å®‰è£…-pinyin-åˆ†è¯å™¨" class="headerlink" title="å®‰è£… pinyin åˆ†è¯å™¨"></a>å®‰è£… pinyin åˆ†è¯å™¨</h2><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/</span><br><br><span class="hljs-comment">## ä¸‹è½½ pinyin åˆ†è¯å™¨</span><br>wget https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/medcl/</span>elasticsearch-analysis-pinyin<span class="hljs-regexp">/releases/</span>download<span class="hljs-regexp">/v5.5.3/</span>elasticsearch-analysis-pinyin-<span class="hljs-number">5.5</span>.<span class="hljs-number">3</span>.zip<br><br><span class="hljs-comment">## ä½¿ç”¨ unzip è§£å‹</span><br><span class="hljs-comment">## å¦‚æœæœªå®‰è£…ï¼Œé€šè¿‡ yum instal unzip è¿›è¡Œå®‰è£…</span><br>unzip elasticsearch-analysis-pinyin-<span class="hljs-number">5.5</span>.<span class="hljs-number">3</span>.zip<br><br><br><span class="hljs-comment">## åœ¨ elasticsearch å®‰è£…ç›®å½•ä¸‹çš„ plugins æ–‡ä»¶å¤¹ä¸‹åˆ›å»º pinyin ç›®å½•</span><br>mkdir <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/m</span>aster<span class="hljs-regexp">/plugins/</span>pinyin<br><br><span class="hljs-comment">## å°†è§£å‹åçš„ ik ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ç§»åŠ¨åˆ°  /usr/local/es/master/plugins/pinyin/</span><br>mv <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/</span>elasticsearch<span class="hljs-regexp">/* /u</span>sr<span class="hljs-regexp">/local/</span>es<span class="hljs-regexp">/master/</span>plugins<span class="hljs-regexp">/pinyin/</span><br><br><span class="hljs-comment">## é‡å¯ elasticsearch æˆ–å¯åŠ¨ master elasticsearch</span><br><span class="hljs-comment">## æ³¨æ„å¯åŠ¨æ—¶ï¼Œéœ€è¦åˆ‡æ¢åˆ° esuser ç”¨æˆ·</span><br><br><br><span class="hljs-comment">## å¯åŠ¨æˆåŠŸåï¼Œæ—¥å¿—é‡Œæ‰“å°</span><br>[<span class="hljs-number">2018</span>-<span class="hljs-number">09</span>-<span class="hljs-number">02</span>T07:<span class="hljs-number">04</span>:<span class="hljs-number">56</span>,<span class="hljs-number">203</span>][INFO ][o.e.p.PluginsService     ] [master] loaded plugin [analysis-ik]<br>[<span class="hljs-number">2018</span>-<span class="hljs-number">09</span>-<span class="hljs-number">02</span>T07:<span class="hljs-number">04</span>:<span class="hljs-number">56</span>,<span class="hljs-number">203</span>][INFO ][o.e.p.PluginsService     ] [master] loaded plugin [analysis-pinyin]<br></code></pre></div></td></tr></table></figure><h2 id="éªŒè¯-pinyin-åˆ†è¯å™¨æ˜¯å¦ç”Ÿæ•ˆ"><a href="#éªŒè¯-pinyin-åˆ†è¯å™¨æ˜¯å¦ç”Ÿæ•ˆ" class="headerlink" title="éªŒè¯ pinyin åˆ†è¯å™¨æ˜¯å¦ç”Ÿæ•ˆ"></a>éªŒè¯ pinyin åˆ†è¯å™¨æ˜¯å¦ç”Ÿæ•ˆ</h2><p>æ‰“å¼€ Restlet Client æˆ–è€… postman å·¥å…·</p><p>GET <code>http://192.168.199.192:9200/_analyze?analyzer=pinyin&amp;text=&quot;æå°é¾™&quot;</code></p><p>è¿™é‡Œ analyzer å¯ä»¥æŒ‡å®šåˆ†è¯ä¸º <strong>pinyin</strong>ï¼Œå‘é€è¯·æ±‚è¿”å›ç»“æœï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;tokens&quot;</span>: [<br>        &#123;<br>            <span class="hljs-attr">&quot;token&quot;</span>: <span class="hljs-string">&quot;li&quot;</span>,<br>            <span class="hljs-attr">&quot;start_offset&quot;</span>: <span class="hljs-number">1</span>,<br>            <span class="hljs-attr">&quot;end_offset&quot;</span>: <span class="hljs-number">2</span>,<br>            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;word&quot;</span>,<br>            <span class="hljs-attr">&quot;position&quot;</span>: <span class="hljs-number">0</span><br>        &#125;,<br>        &#123;<br>            <span class="hljs-attr">&quot;token&quot;</span>: <span class="hljs-string">&quot;xiao&quot;</span>,<br>            <span class="hljs-attr">&quot;start_offset&quot;</span>: <span class="hljs-number">2</span>,<br>            <span class="hljs-attr">&quot;end_offset&quot;</span>: <span class="hljs-number">3</span>,<br>            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;word&quot;</span>,<br>            <span class="hljs-attr">&quot;position&quot;</span>: <span class="hljs-number">1</span><br>        &#125;,<br>        &#123;<br>            <span class="hljs-attr">&quot;token&quot;</span>: <span class="hljs-string">&quot;long&quot;</span>,<br>            <span class="hljs-attr">&quot;start_offset&quot;</span>: <span class="hljs-number">3</span>,<br>            <span class="hljs-attr">&quot;end_offset&quot;</span>: <span class="hljs-number">4</span>,<br>            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;word&quot;</span>,<br>            <span class="hljs-attr">&quot;position&quot;</span>: <span class="hljs-number">2</span><br>        &#125;,<br>        &#123;<br>            <span class="hljs-attr">&quot;token&quot;</span>: <span class="hljs-string">&quot;lxl&quot;</span>,<br>            <span class="hljs-attr">&quot;start_offset&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-attr">&quot;end_offset&quot;</span>: <span class="hljs-number">3</span>,<br>            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;word&quot;</span>,<br>            <span class="hljs-attr">&quot;position&quot;</span>: <span class="hljs-number">2</span><br>        &#125;<br>    ]<br>&#125;<br><br></code></pre></div></td></tr></table></figure><p>è§‚å¯Ÿç»“æœï¼Œè¯´æ˜ pinyin åˆ†è¯å™¨ä¹Ÿå·²ç»ç”Ÿæ•ˆäº†ã€‚</p><h2 id="é›†ç¾¤å…¶ä»–èŠ‚ç‚¹åˆ†è¯å™¨å®‰è£…"><a href="#é›†ç¾¤å…¶ä»–èŠ‚ç‚¹åˆ†è¯å™¨å®‰è£…" class="headerlink" title="é›†ç¾¤å…¶ä»–èŠ‚ç‚¹åˆ†è¯å™¨å®‰è£…"></a>é›†ç¾¤å…¶ä»–èŠ‚ç‚¹åˆ†è¯å™¨å®‰è£…</h2><p>ç°åœ¨åªå¯¹ master è¿›è¡Œäº†å®‰è£…ï¼Œå…¶ä»– slave ä¹Ÿéœ€è¦å®‰è£…ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡æ‹·è´çš„æ–¹å¼ç›´æ¥æ¥å®Œæˆå®‰è£…äº†ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cp -r master<span class="hljs-regexp">/plugins/</span> slave1/<br><br>cp -r master<span class="hljs-regexp">/plugins/</span> slave2/<br></code></pre></div></td></tr></table></figure><p>å¦‚æœå…¶ä»–èŠ‚ç‚¹åœ¨ä¸åŒæœåŠ¡å™¨ä¸Šï¼Œé€šè¿‡ scp å‘½ä»¤æ‹·è´å³å¯ã€‚</p><h2 id="æœ‰ç–‘é—®"><a href="#æœ‰ç–‘é—®" class="headerlink" title="æœ‰ç–‘é—®?"></a>æœ‰ç–‘é—®?</h2><p>æ¬¢è¿æ¥ä¿¡ï¼Œ<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=JVNGSFRlQ0pdSERMSQtGSkg">ç»™æˆ‘å†™ä¿¡</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://github.com/medcl/elasticsearch-analysis-pinyin/issues/19">https://github.com/medcl/elasticsearch-analysis-pinyin/issues/19</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ElasticSearchä¹‹IKåˆ†è¯å™¨å®‰è£…</tag>
      
      <tag>ElasticSearchä¹‹pinyinåˆ†è¯å™¨å®‰è£…</tag>
      
      <tag>ElasticSearchä¹‹IKåˆ†è¯å™¨ä¸pinyinåˆ†è¯å™¨ä¸€èµ·ä½¿ç”¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ElasticSearchå…¥é—¨</title>
    <link href="/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E5%85%A5%E9%97%A8.html"/>
    <url>/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E5%85%A5%E9%97%A8.html</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ç®€å•ä»‹ç»äº†ä½¿ç”¨ Rest æ¥å£ï¼Œå¯¹ es è¿›è¡Œæ“ä½œï¼Œæ›´æ·±å…¥çš„å­¦ä¹ ï¼Œå¯ä»¥å‚è€ƒæ–‡æœ«éƒ¨åˆ†ã€‚</p><a id="more"></a><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><p>æœ¬æ–‡ä»¥åŠåç»­ es ç³»åˆ—æ–‡ç« éƒ½åŸºäº <strong>5.5.3</strong> è¿™ä¸ªç‰ˆæœ¬çš„ elasticsearch ï¼Œè¿™ä¸ªç‰ˆæœ¬æ¯”è¾ƒç¨³å®šï¼Œå¯ä»¥ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚</p><h2 id="ç³»åˆ—æ–‡ç« "><a href="#ç³»åˆ—æ–‡ç« " class="headerlink" title="ç³»åˆ—æ–‡ç« "></a>ç³»åˆ—æ–‡ç« </h2><ul><li>ä¸€ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ElasticSearché›†ç¾¤æ­å»º</a></li><li>äºŒã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E5%85%A5%E9%97%A8.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ElasticSearchå…¥é—¨</a></li><li>ä¸‰ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BIK%E5%88%86%E8%AF%8D%E4%BB%A5%E5%8F%8A%E6%8B%BC%E9%9F%B3%E5%88%86%E8%AF%8D.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹IKåˆ†è¯ä»¥åŠæ‹¼éŸ³åˆ†è¯</a></li><li>å››ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BLogstash%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5%E5%BB%BA%E7%AB%8B%E7%B4%A2%E5%BC%95.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹Logstashå®æ—¶åŒæ­¥å»ºç«‹ç´¢å¼•</a></li><li>äº”ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%A5%E9%97%A8.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…¥é—¨</a></li><li>å…­ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%B3%E9%94%AE%E8%AF%8D%E9%AB%98%E4%BA%AE.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…³é”®è¯é«˜äº®</a></li><li>â€¦</li></ul><h2 id="åŸºç¡€æ¦‚å¿µ"><a href="#åŸºç¡€æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h2><p>ç´¢å¼•â€“ç›¸å½“äºæ•°æ®åº“<br>ç±»å‹â€“ç›¸å½“äºè¡¨<br>æ–‡æ¡£â€“ç›¸å½“äºä¸€æ¡è®°å½•<br>åˆ†ç‰‡â€“å¯¹ç´¢å¼•è¿›è¡Œåˆ†ç‰‡ï¼Œåˆ†å¸ƒäºé›†ç¾¤å„ä¸ªèŠ‚ç‚¹ä¸Šï¼Œé™ä½å•ä¸ªèŠ‚ç‚¹çš„å‹åŠ›<br>å¤‡ä»½â€“æ‹·è´åˆ†ç‰‡å°±å®Œæˆäº†å¤‡ä»½  </p><hr><h2 id="åŸºæœ¬è¯­æ³•"><a href="#åŸºæœ¬è¯­æ³•" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h2><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180901153578638051792.png"></p><h2 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h2><h3 id="ç´¢å¼•ç±»å‹"><a href="#ç´¢å¼•ç±»å‹" class="headerlink" title="ç´¢å¼•ç±»å‹"></a>ç´¢å¼•ç±»å‹</h3><ul><li>ç»“æ„åŒ–ç´¢å¼•<ul><li>ç‰¹ç‚¹ï¼šé€šè¿‡æ¥å£åˆ›å»ºï¼Œå¯ä»¥æŒ‡å®š mappings </li><li>url:port/ç´¢å¼•å/ç±»å‹å/_mappings</li></ul></li><li>éç»“æ„åŒ–ç´¢å¼• <ul><li>ç‰¹ç‚¹ï¼šé€šè¿‡ elasticsearch head åˆ›å»º mapping ä¸ºç©º </li></ul></li></ul><h3 id="ä½¿ç”¨-RestClient-PostMan-åˆ›å»ºç»“æ„åŒ–ç´¢å¼•"><a href="#ä½¿ç”¨-RestClient-PostMan-åˆ›å»ºç»“æ„åŒ–ç´¢å¼•" class="headerlink" title="ä½¿ç”¨ RestClient/PostMan åˆ›å»ºç»“æ„åŒ–ç´¢å¼•"></a>ä½¿ç”¨ RestClient/PostMan åˆ›å»ºç»“æ„åŒ–ç´¢å¼•</h3><p>åˆ›å»ºä¸€ä¸ª people çš„ç´¢å¼•ï¼ŒåŒ…å«ä¸€ä¸ªç±»å‹ man</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180901153578804439765.png"></p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;settings&quot;</span>:&#123;<br>        <span class="hljs-attr">&quot;number_of_shards&quot;</span>:<span class="hljs-number">3</span>,<br>        <span class="hljs-attr">&quot;number_of_replicas&quot;</span>:<span class="hljs-number">1</span><br>    &#125;,<br>    <span class="hljs-attr">&quot;mappings&quot;</span>:&#123;<br>        <span class="hljs-attr">&quot;man&quot;</span>:&#123;<br>            <span class="hljs-attr">&quot;properties&quot;</span>:&#123;<br>                <span class="hljs-attr">&quot;name&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;text&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;country&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;keyword&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;age&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;integer&quot;</span><br>                &#125;,<br>                <span class="hljs-attr">&quot;date&quot;</span>:&#123;<br>                    <span class="hljs-attr">&quot;type&quot;</span>:<span class="hljs-string">&quot;date&quot;</span>,<br>                    <span class="hljs-attr">&quot;format&quot;</span>:<span class="hljs-string">&quot;yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis&quot;</span><br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="keyword-ä¸-text-çš„åŒºåˆ«"><a href="#keyword-ä¸-text-çš„åŒºåˆ«" class="headerlink" title="keyword ä¸ text çš„åŒºåˆ«"></a>keyword ä¸ text çš„åŒºåˆ«</h4><p><strong>type ç±»å‹ä¸º keyword çš„æ—¶å€™ï¼ŒES ä¸ä¼šå¯¹å…¶è¿›è¡Œåˆ†è¯ï¼Œè€Œ text ä¼šè¢«åˆ†è¯</strong></p><h2 id="es-é€šè¿‡-rest-æ¥å£å¯¹æ•°æ®æ“ä½œ"><a href="#es-é€šè¿‡-rest-æ¥å£å¯¹æ•°æ®æ“ä½œ" class="headerlink" title="es é€šè¿‡ rest æ¥å£å¯¹æ•°æ®æ“ä½œ"></a>es é€šè¿‡ rest æ¥å£å¯¹æ•°æ®æ“ä½œ</h2><h3 id="æ’å…¥æ•°æ®"><a href="#æ’å…¥æ•°æ®" class="headerlink" title="æ’å…¥æ•°æ®"></a>æ’å…¥æ•°æ®</h3><ol><li>æŒ‡å®šæ–‡æ¡£ id æ’å…¥<ol><li><strong>PUT</strong> è¯·æ±‚ï¼š  ip:port/ç´¢å¼•/ç±»å‹/id<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180901153578852713262.png"></li></ol></li><li>è‡ªåŠ¨äº§ç”Ÿæ–‡æ¡£ id æ’å…¥<ol><li><strong>POST</strong> è¯·æ±‚ï¼š ip:port/ç´¢å¼•/ç±»å‹<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180901153578859766521.png"></li></ol></li></ol><h3 id="ä¿®æ”¹æ•°æ®"><a href="#ä¿®æ”¹æ•°æ®" class="headerlink" title="ä¿®æ”¹æ•°æ®"></a>ä¿®æ”¹æ•°æ®</h3><ol><li>ç›´æ¥ä¿®æ”¹<ol start="2"><li><strong>POST</strong> è¯·æ±‚ï¼š  ip:port/ç´¢å¼•/ç±»å‹/id/_update<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180901153578892736222.png"></li></ol></li></ol><h3 id="åˆ é™¤æ•°æ®-åˆ é™¤ç´¢å¼•"><a href="#åˆ é™¤æ•°æ®-åˆ é™¤ç´¢å¼•" class="headerlink" title="åˆ é™¤æ•°æ®/åˆ é™¤ç´¢å¼•"></a>åˆ é™¤æ•°æ®/åˆ é™¤ç´¢å¼•</h3><ol><li>åˆ é™¤æ–‡æ¡£<ol><li><strong>DELETE</strong> è¯·æ±‚ ip:ç«¯å£/ç´¢å¼•/ç±»å‹/id</li></ol></li><li>åˆ é™¤ç´¢å¼•<ol><li><strong>DELETE</strong> è¯·æ±‚ ip:ç«¯å£/ç´¢å¼•</li></ol></li></ol><h3 id="æŸ¥è¯¢æ•°æ®"><a href="#æŸ¥è¯¢æ•°æ®" class="headerlink" title="æŸ¥è¯¢æ•°æ®"></a>æŸ¥è¯¢æ•°æ®</h3><ol><li><p>ç®€å•æŸ¥è¯¢</p><ol start="2"><li><strong>GET</strong> è¯·æ±‚ï¼š ip:ç«¯å£/ç´¢å¼•/ç±»å‹/id</li></ol></li><li><p>æ¡ä»¶æŸ¥è¯¢</p><ol><li><strong>POST</strong>è¯·æ±‚ï¼š ip:ç«¯å£/ç´¢å¼•/_search</li><li>æŒ‡å®šæ¡ä»¶æŸ¥è¯¢,åˆ†é¡µä¸æ’åº <figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>     <span class="hljs-attr">&quot;query&quot;</span>:&#123;<br>         <span class="hljs-attr">&quot;match&quot;</span>:&#123;<br>             <span class="hljs-attr">&quot;name&quot;</span>:<span class="hljs-string">&quot;WeJan&quot;</span><br>         &#125;<br>     &#125;,<br>     <span class="hljs-attr">&quot;sort&quot;</span>:[<br>         &#123;<br>             <span class="hljs-attr">&quot;age&quot;</span>:&#123;<br>                 <span class="hljs-attr">&quot;order&quot;</span>:<span class="hljs-string">&quot;asc&quot;</span><br>             &#125;<br>         &#125;<br>     ],<br>     <span class="hljs-attr">&quot;from&quot;</span> : <span class="hljs-number">0</span>,<br>     <span class="hljs-attr">&quot;size&quot;</span> : <span class="hljs-number">10</span><br> &#125;<br></code></pre></div></td></tr></table></figure></li></ol></li><li><p>èšåˆæŸ¥è¯¢</p><ol><li><strong>POST</strong>è¯·æ±‚ï¼š ip:ç«¯å£/ç´¢å¼•/_search</li><li>åˆ†ç»„ï¼Œå¯ä»¥å¤šä¸ªåˆ†ç»„ <figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;aggs&quot;</span>:&#123;<br>        <span class="hljs-attr">&quot;group_by_age&quot;</span>:&#123;<br>            <span class="hljs-attr">&quot;terms&quot;</span>:&#123;<br>                <span class="hljs-attr">&quot;field&quot;</span>:<span class="hljs-string">&quot;age&quot;</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li>èšåˆè®¡ç®— <figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;aggs&quot;</span>:&#123;<br>        <span class="hljs-attr">&quot;age_count&quot;</span>:&#123;<br>            <span class="hljs-attr">&quot;stats&quot;</span>:&#123;<br>                <span class="hljs-attr">&quot;field&quot;</span>:<span class="hljs-string">&quot;age&quot;</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><ul><li>sum</li><li>avg</li><li>max</li><li>min</li><li>count</li></ul></li></ol></li></ol><h3 id="é«˜çº§æŸ¥è¯¢"><a href="#é«˜çº§æŸ¥è¯¢" class="headerlink" title="é«˜çº§æŸ¥è¯¢"></a>é«˜çº§æŸ¥è¯¢</h3><ol><li>ä¹ è¯­åŒ¹é…ï¼ˆå…¨è¯åŒ¹é…ï¼‰ <figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;query&quot;</span>:&#123;<br>        <span class="hljs-attr">&quot;match_phrase&quot;</span>:&#123;<br>            <span class="hljs-attr">&quot;name&quot;</span>:<span class="hljs-string">&quot;WeJan&quot;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li>å¤šå­—æ®µåŒ¹é…ï¼Œå¤šä¸ªå­—æ®µåŒ…å«query <figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;query&quot;</span>:&#123;<br>        <span class="hljs-attr">&quot;multi_match&quot;</span>:&#123;<br>            <span class="hljs-attr">&quot;query&quot;</span>:<span class="hljs-string">&quot;WeJan&quot;</span>,<br>            <span class="hljs-attr">&quot;fields&quot;</span>:[<span class="hljs-string">&quot;author&quot;</span>, <span class="hljs-string">&quot;title&quot;</span>]<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li>query_string æ–‡æœ¬æŸ¥è¯¢ <figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;query&quot;</span>:&#123;<br>        <span class="hljs-attr">&quot;query_string&quot;</span>:&#123;<br>            <span class="hljs-attr">&quot;name&quot;</span>:<span class="hljs-string">&quot;(WeJan AND Jan) OR å“ˆå“ˆ&quot;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li>é’ˆå¯¹å¤šä¸ªå­—æ®µçš„æ–‡æœ¬æŸ¥è¯¢ <figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;query&quot;</span>:&#123;<br>        <span class="hljs-attr">&quot;query_string&quot;</span>:&#123;<br>            <span class="hljs-attr">&quot;name&quot;</span>:<span class="hljs-string">&quot;WeJan OR å“ˆå“ˆ&quot;</span>,<br>             <span class="hljs-attr">&quot;fields&quot;</span>:[<span class="hljs-string">&quot;author&quot;</span>, <span class="hljs-string">&quot;title&quot;</span>]<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li>å­—æ®µæŸ¥è¯¢,æ¯”å¦‚å¹´é¾„ï¼Œåˆ†ç±» <figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;query&quot;</span>:&#123;<br>        <span class="hljs-attr">&quot;term&quot;</span>:&#123;<br>           <span class="hljs-attr">&quot;age&quot;</span>:<span class="hljs-number">25</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li>èŒƒå›´æŸ¥è¯¢ï¼Œå¯ä»¥å¯¹æ—¶é—´å­—æ®µè¿›è¡ŒæŸ¥è¯¢ï¼Œç°åœ¨ä½¿ç”¨ â€œnowâ€æ›¿ä»£ <figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;query&quot;</span>:&#123;<br>        <span class="hljs-attr">&quot;range&quot;</span>:&#123;<br>          <span class="hljs-attr">&quot;age&quot;</span>:&#123;<br>            <span class="hljs-attr">&quot;gte&quot;</span>:<span class="hljs-number">26</span>,<br>            <span class="hljs-attr">&quot;lte&quot;</span>:<span class="hljs-number">36</span><br>          &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2></li></ol><ul><li><a href="https://www.imooc.com/learn/889">æ…•è¯¾ç½‘ElasticSearchå…¥é—¨</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ElasticSearchè¯­æ³•å…¥é—¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ElasticSearché›†ç¾¤æ­å»º</title>
    <link href="/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA.html"/>
    <url>/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA.html</url>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬æ‰€å¸¸è§çš„ç”µå•†æœç´¢å¦‚äº¬ä¸œï¼Œæœç´¢é¡µé¢éƒ½ä¼šæä¾›å„ç§å„æ ·çš„ç­›é€‰æ¡ä»¶ï¼Œæ¯”å¦‚å“ç‰Œã€å°ºå¯¸ã€é€‚ç”¨å­£èŠ‚ã€ä»·æ ¼åŒºé—´ç­‰ï¼ŒåŒæ—¶æä¾›æ’åºï¼Œæ¯”å¦‚ä»·æ ¼æ’åºï¼Œä¿¡èª‰æ’åºï¼Œé”€é‡æ’åºç­‰ï¼Œæ–¹ä¾¿äº†ç”¨æˆ·å»æ‰¾åˆ°è‡ªå·±å¿ƒé‡Œç†æƒ³çš„å•†å“ã€‚</p><p>ç«™å†…æœç´¢å¯¹äºä¸€ä¸ªç½‘ç«™å‡ ä¹æ˜¯æ ‡é…ï¼Œåªæ˜¯æœç´¢çš„å¼ºå¤§ä¸å¦çš„åŒºåˆ«ï¼Œæœ‰çš„ç½‘ç«™åªæ”¯æŒå…³é”®è¯æ¨¡ç³Šæœç´¢ï¼Œè€Œæ·˜å®ï¼Œäº¬ä¸œæä¾›äº†ç²¾ç»†çš„ç­›é€‰æ¡ä»¶ï¼ŒåŒæ—¶æ”¯æŒæ‹¼éŸ³æœç´¢ç­‰æ›´æ–¹ä¾¿çš„æœç´¢æ–¹å¼ã€‚</p><p>ç”±äºç¬”è€…åœ¨ä¸€å®¶åšç½‘ç»œæ–‡å­¦çš„å…¬å¸å·¥ä½œï¼Œæ‰€ä»¥å®ç°å°±æ˜¯ä»¥å°è¯´ä¸ºå•†å“çš„æœç´¢ï¼Œå…·ä½“å¯ä»¥å‚è€ƒèµ·ç‚¹ç½‘å°è¯´çš„æœç´¢ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/201809061536241809780.png"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œèµ·ç‚¹ç½‘çš„æœç´¢æä¾›äº†å…³é”®è¯æœç´¢å’Œæ’åºæ¡ä»¶ä»¥åŠç­›é€‰æ¡ä»¶ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥å®ç°è¿™ä¸ªå§~</p><a id="more"></a><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><p>æœ¬æ–‡ä»¥åŠåç»­ es ç³»åˆ—æ–‡ç« éƒ½åŸºäº <strong>5.5.3</strong> è¿™ä¸ªç‰ˆæœ¬çš„ elasticsearch ï¼Œè¿™ä¸ªç‰ˆæœ¬æ¯”è¾ƒç¨³å®šï¼Œå¯ä»¥ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚</p><h2 id="ç³»åˆ—æ–‡ç« "><a href="#ç³»åˆ—æ–‡ç« " class="headerlink" title="ç³»åˆ—æ–‡ç« "></a>ç³»åˆ—æ–‡ç« </h2><ul><li>ä¸€ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ElasticSearché›†ç¾¤æ­å»º</a></li><li>äºŒã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BElasticSearch%E5%85%A5%E9%97%A8.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹ElasticSearchå…¥é—¨</a></li><li>ä¸‰ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BIK%E5%88%86%E8%AF%8D%E4%BB%A5%E5%8F%8A%E6%8B%BC%E9%9F%B3%E5%88%86%E8%AF%8D.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹IKåˆ†è¯ä»¥åŠæ‹¼éŸ³åˆ†è¯</a></li><li>å››ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BLogstash%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5%E5%BB%BA%E7%AB%8B%E7%B4%A2%E5%BC%95.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹Logstashå®æ—¶åŒæ­¥å»ºç«‹ç´¢å¼•</a></li><li>äº”ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%A5%E9%97%A8.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…¥é—¨</a></li><li>å…­ã€<a href="http://nullpointer.pw/%E5%92%8C%E6%88%91%E4%B8%80%E8%B5%B7%E6%89%93%E9%80%A0%E4%B8%AA%E7%AE%80%E5%8D%95%E6%90%9C%E7%B4%A2%E4%B9%8BSpringDataElasticSearch%E5%85%B3%E9%94%AE%E8%AF%8D%E9%AB%98%E4%BA%AE.html">å’Œæˆ‘ä¸€èµ·æ‰“é€ ä¸ªç®€å•æœç´¢ä¹‹SpringDataElasticSearchå…³é”®è¯é«˜äº®</a></li><li>â€¦</li></ul><h2 id="ç¯å¢ƒå‡†å¤‡ä¹‹-ES-é›†ç¾¤æ­å»º"><a href="#ç¯å¢ƒå‡†å¤‡ä¹‹-ES-é›†ç¾¤æ­å»º" class="headerlink" title="ç¯å¢ƒå‡†å¤‡ä¹‹ ES é›†ç¾¤æ­å»º"></a>ç¯å¢ƒå‡†å¤‡ä¹‹ ES é›†ç¾¤æ­å»º</h2><h3 id="master-é…ç½®"><a href="#master-é…ç½®" class="headerlink" title="master é…ç½®"></a>master é…ç½®</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># ä¸‹è½½ elasticsearch</span></span><br>wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.5.3.tar.gz<br><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># åˆ›å»ºç›®å½•</span></span><br>mkdir /usr/local/es<br><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># è§£å‹æ–‡ä»¶åˆ° es ç›®å½•</span></span><br>tar -xvf elasticsearch-5.5.3.tar.gz -C /usr/local/es<br><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># ä¿®æ”¹ es çš„é…ç½®æ–‡ä»¶</span></span><br>cd /usr/local/es/elasticsearch-5.5.3/config<br><br>vim elasticsearch.yml<br><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># åœ¨æ–‡ä»¶æœ«å°¾å¢åŠ </span></span><br><br>http.cors.enabled: true<br>http.cors.allow-origin: &quot;*&quot;<br>cluster.name: es-search<br>node.name: slave1<br>node.master: true<br>network.host: 0.0.0.0<br><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># ä¿®æ”¹ es çš„ jvm è®¾ç½®ï¼Œå¦‚æœä¸è°ƒèŠ‚ï¼Œå¯èƒ½å¯åŠ¨ä¸€ä¸ª master, slave å°±æ²¡è¶³å¤Ÿå†…å­˜æ¥å¯åŠ¨äº†</span></span><br><br>vim jvm.options<br><br>ä¿®æ”¹<br>-Xms2g <br>-Xmx2g<br>ä¸º<br>-Xms512m<br>-Xmx512m<br><br>æ³¨æ„ï¼Œå¦‚æœæ˜¯çº¿ä¸Šï¼Œè¿™ä¸ªå†…å­˜å°±ä¸è¦ä¿®æ”¹äº†ï¼Œä½¿ç”¨é»˜è®¤çš„å†…å­˜ 2G å³å¯ã€‚<br></code></pre></div></td></tr></table></figure><h3 id="slave-é…ç½®"><a href="#slave-é…ç½®" class="headerlink" title="slave é…ç½®"></a>slave é…ç½®</h3><figure class="highlight yaml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yaml"><span class="hljs-comment">## å‡†å¤‡æ­å»ºä¸€ä¸ªä¼ªé›†ç¾¤ 1ä¸ªmaster + 2ä¸ªslave</span><br><span class="hljs-string">cd</span> <span class="hljs-string">/usr/local/es</span><br><br><span class="hljs-comment">## å°†ç›®å½•é‡å‘½åä¸º master</span><br>[<span class="hljs-string">root@localhost</span> <span class="hljs-string">es</span>]<span class="hljs-comment"># mv elasticsearch-5.5.3/ master</span><br><br><span class="hljs-comment">##æ‹·è´ä¸¤ä»½ä¸º slave</span><br>[<span class="hljs-string">root@localhost</span> <span class="hljs-string">es</span>]<span class="hljs-comment"># cp -r master/ slave1</span><br>[<span class="hljs-string">root@localhost</span> <span class="hljs-string">es</span>]<span class="hljs-comment"># cp -r master/ slave2</span><br><br><br><span class="hljs-comment">## ä¿®æ”¹ä¸¤ä¸ª slave çš„é…ç½®</span><br><br><span class="hljs-comment">### ä¿®æ”¹ slave1 çš„é…ç½®</span><br>[<span class="hljs-string">root@localhost</span> <span class="hljs-string">es</span>]<span class="hljs-comment"># vim slave1/config/elasticsearch.yml</span><br><br><span class="hljs-attr">http.cors.enabled:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">http.cors.allow-origin:</span> <span class="hljs-string">&quot;*&quot;</span><br><span class="hljs-attr">cluster.name:</span> <span class="hljs-string">es-search</span><br><span class="hljs-attr">node.name:</span> <span class="hljs-string">slave1</span><br><span class="hljs-comment">## æ³¨æ„ http ç«¯å£ä¸è¦è®¾ç½®ä¸€æ ·ï¼Œä»¥å…å†²çª</span><br><span class="hljs-attr">http.port:</span> <span class="hljs-number">8200</span><br><span class="hljs-comment">#node.master: true</span><br><span class="hljs-attr">network.host:</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><br><br><span class="hljs-comment">### ä¿®æ”¹ slave2 çš„é…ç½®</span><br>[<span class="hljs-string">root@localhost</span> <span class="hljs-string">es</span>]<span class="hljs-comment"># vim slave2/config/elasticsearch.yml</span><br><br><span class="hljs-attr">http.cors.enabled:</span> <span class="hljs-literal">true</span><br><span class="hljs-attr">http.cors.allow-origin:</span> <span class="hljs-string">&quot;*&quot;</span><br><span class="hljs-attr">cluster.name:</span> <span class="hljs-string">es-search</span><br><span class="hljs-attr">node.name:</span> <span class="hljs-string">slave2</span><br><span class="hljs-comment">## æ³¨æ„ http ç«¯å£ä¸è¦è®¾ç½®ä¸€æ ·ï¼Œä»¥å…å†²çª</span><br><span class="hljs-attr">http.port:</span> <span class="hljs-number">7200</span><br><span class="hljs-comment">#node.master: true</span><br><span class="hljs-attr">network.host:</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><br></code></pre></div></td></tr></table></figure><h3 id="æ·»åŠ ç”¨æˆ·"><a href="#æ·»åŠ ç”¨æˆ·" class="headerlink" title="æ·»åŠ ç”¨æˆ·"></a>æ·»åŠ ç”¨æˆ·</h3><figure class="highlight perl"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs perl"><span class="hljs-comment">## å¯åŠ¨ es ä¸èƒ½ä½¿ç”¨ root ç”¨æˆ·ï¼Œæ‰€ä»¥å…ˆéœ€è¦å¢åŠ æ–°çš„ç”¨æˆ·</span><br><br>[root@localhost es]<span class="hljs-comment"># adduser esuser</span><br>[root@localhost es]<span class="hljs-comment"># chown -R esuser /usr/local/es/</span><br><br><span class="hljs-comment">## åˆ‡æ¢åˆ° esuser ç”¨æˆ·</span><br>[root@localhost es]<span class="hljs-comment"># su esuser</span><br>[esuser@localhost es]$ <span class="hljs-keyword">chmod</span> <span class="hljs-number">777</span> /usr/<span class="hljs-keyword">local</span>/es/<br><br></code></pre></div></td></tr></table></figure><h3 id="å¯åŠ¨é›†ç¾¤ä¸­çš„-master"><a href="#å¯åŠ¨é›†ç¾¤ä¸­çš„-master" class="headerlink" title="å¯åŠ¨é›†ç¾¤ä¸­çš„ master"></a>å¯åŠ¨é›†ç¾¤ä¸­çš„ master</h3><figure class="highlight inform7"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs inform7"># å…ˆæµ‹è¯•èƒ½å¦æ­£å¸¸å¯åŠ¨<br><span class="hljs-comment">[esuser@localhost es]</span>$ /usr/local/es/master/bin/elasticsearch<br><br># æŸ¥çœ‹æ‰“å°çš„æ—¥å¿—ä¿¡æ¯<br><span class="hljs-comment">[2018-09-02T01:45:21,125]</span><span class="hljs-comment">[INFO ]</span><span class="hljs-comment">[o.e.g.GatewayService     ]</span> <span class="hljs-comment">[master]</span> recovered <span class="hljs-comment">[0]</span> indices into cluster_state<br><span class="hljs-comment">[2018-09-02T01:45:21,138]</span><span class="hljs-comment">[INFO ]</span><span class="hljs-comment">[o.e.h.n.Netty4HttpServerTransport]</span> <span class="hljs-comment">[master]</span> publish_address &#123;127.0.0.1:9200&#125;, bound_addresses &#123;127.0.0.1:9200&#125;<br><span class="hljs-comment">[2018-09-02T01:45:21,138]</span><span class="hljs-comment">[INFO ]</span><span class="hljs-comment">[o.e.n.Node               ]</span> <span class="hljs-comment">[master]</span> started<br><br><br>## å¯åŠ¨å¤±è´¥æç¤º<br>ERROR: <span class="hljs-comment">[2]</span> bootstrap checks failed<br><span class="hljs-comment">[1]</span>: max file descriptors <span class="hljs-comment">[4096]</span> for elasticsearch process <span class="hljs-keyword">is</span> too low, increase to at least <span class="hljs-comment">[65536]</span><br><span class="hljs-comment">[2]</span>: max virtual memory areas vm.max_map_count <span class="hljs-comment">[65530]</span> <span class="hljs-keyword">is</span> too low, increase to at least <span class="hljs-comment">[262144]</span><br><br>## åˆ‡æ¢åˆ° root ç”¨æˆ·ï¼Œä¿®æ”¹ç³»ç»Ÿé…ç½®<br>su root<br># è¾“å…¥ç™»å½•å¯†ç <br><br>vim /etc/security/limits.conf<br><br>## åœ¨æ–‡ä»¶æœ«å°¾å¢åŠ ï¼Œä¸è¦å»æ‰å‰é¢çš„ * å·<br><br>* soft nofile 300000<br>* hard nofile 300000<br>* soft nproc 102400<br>* soft memlock unlimited<br>* hard memlock unlimited<br><br>## å¯¹ sysctl.conf æ–‡ä»¶ è¿›è¡Œä¿®æ”¹<br>echo <span class="hljs-string">&quot;vm.max_map_count=262144&quot;</span> &gt; /etc/sysctl.conf<br>sysctl -p<br><br>## ä¿®æ”¹å®Œæ¯•ï¼Œåˆ‡æ¢å› esuser ç”¨æˆ·èº«ä»½<br>su esuser<br><br>## å°è¯•å¯åŠ¨<br><span class="hljs-comment">[esuser@localhost es]</span>$ /usr/local/es/master/bin/elasticsearch<br><br># æç¤ºå·²ç»å¯åŠ¨æˆåŠŸäº†<br><span class="hljs-comment">[2018-09-02T02:10:14,285]</span><span class="hljs-comment">[INFO ]</span><span class="hljs-comment">[o.e.h.n.Netty4HttpServerTransport]</span> <span class="hljs-comment">[master]</span> publish_address &#123;192.168.199.192:9200&#125;, bound_addresses &#123;<span class="hljs-comment">[::]</span>:9200&#125;<br><span class="hljs-comment">[2018-09-02T02:10:14,285]</span><span class="hljs-comment">[INFO ]</span><span class="hljs-comment">[o.e.n.Node               ]</span> <span class="hljs-comment">[master]</span> started<br><span class="hljs-comment">[2018-09-02T02:10:14,289]</span><span class="hljs-comment">[INFO ]</span><span class="hljs-comment">[o.e.g.GatewayService     ]</span> <span class="hljs-comment">[master]</span> recovered <span class="hljs-comment">[0]</span> indices into cluster_state<br></code></pre></div></td></tr></table></figure><h3 id="éªŒè¯å¯åŠ¨"><a href="#éªŒè¯å¯åŠ¨" class="headerlink" title="éªŒè¯å¯åŠ¨"></a>éªŒè¯å¯åŠ¨</h3><p>ä½¿ç”¨æµè§ˆå™¨è®¿é—® <code>http://ip:9200 </code> ip æ›¿æ¢ä½ çš„ ip åœ°å€ï¼Œæˆ‘çš„æ˜¯ <code>http://192.168.199.192:9200</code></p><p>æµè§ˆå™¨å“åº”å†…å®¹</p><figure class="highlight"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    name: &quot;master&quot;,<br>    cluster_name: &quot;es-search&quot;,<br>    cluster_uuid: &quot;JoNUMEKFS06NHNS7p3bdWg&quot;,<br>    version: &#123;<br>        number: &quot;5.5.3&quot;,<br>        build_hash: &quot;9305a5e&quot;,<br>        build_date: &quot;2017-09-07T15:56:59.599Z&quot;,<br>        build_snapshot: false,<br>        lucene_version: &quot;6.6.0&quot;<br>    &#125;,<br>    tagline: &quot;You Know, for Search&quot;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>æ³¨æ„ï¼šå¦‚æœæ— æ³•è®¿é—®ï¼Œè¯·å…³é—­é˜²ç«å¢™</strong></p><h3 id="åå°å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨-es-é›†ç¾¤"><a href="#åå°å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨-es-é›†ç¾¤" class="headerlink" title="åå°å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨ es é›†ç¾¤"></a>åå°å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨ es é›†ç¾¤</h3><p>å‰æ–‡æ˜¯ç›´æ¥å¯åŠ¨ï¼Œå¦‚æœæŒ‰ä¸‹ ctrl + c æˆ–è€…ç»“æŸ ssh ä¼šè¯ï¼Œes ä¼šç«‹å³åœæ­¢é€€å‡ºï¼Œå› æ­¤éœ€è¦é€šè¿‡å®ˆæŠ¤è¿›ç¨‹åå°å¯åŠ¨</p><figure class="highlight dts"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs dts"><br>[esuser@localhost es]$ <span class="hljs-meta-keyword">/usr/</span>local<span class="hljs-meta-keyword">/es/</span>master<span class="hljs-meta-keyword">/bin/</span>elasticsearch -d<br><br><span class="hljs-meta">## æŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸ</span><br>ps -ef | grep elasticsearch<br><br><span class="hljs-meta">## æ­£å¸¸å¯ä»¥çœ‹åˆ°ä¸€ä¸ª elasticsearch è¿›ç¨‹</span><br><br><span class="hljs-meta">## å¦‚å‰æ–‡ä¸€æ ·ï¼Œåˆ†åˆ«æµ‹è¯•ä¸¤ä¸ª slave æ˜¯å¦å¯ä»¥æ­£å¸¸å¯åŠ¨</span><br><br><span class="hljs-meta">### æµ‹è¯•slave1</span><br>[esuser@localhost es]$ <span class="hljs-meta-keyword">/usr/</span>local<span class="hljs-meta-keyword">/es/</span>slave1<span class="hljs-meta-keyword">/bin/</span>elasticsearch -d<br><br><span class="hljs-meta">### æµè§ˆå™¨è®¿é—® http:<span class="hljs-comment">//ip:8200ï¼Œå“åº”ä¸ºï¼š</span></span><br>&#123;<br>    <span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;slave1&quot;</span>,<br>    <span class="hljs-string">&quot;cluster_name&quot;</span>:<span class="hljs-string">&quot;es-search&quot;</span>,<br>    <span class="hljs-string">&quot;cluster_uuid&quot;</span>:<span class="hljs-string">&quot;JoNUMEKFS06NHNS7p3bdWg&quot;</span>,<br>    <span class="hljs-string">&quot;version&quot;</span>:&#123;<br>        <span class="hljs-string">&quot;number&quot;</span>:<span class="hljs-string">&quot;5.5.3&quot;</span>,<br>        <span class="hljs-string">&quot;build_hash&quot;</span>:<span class="hljs-string">&quot;9305a5e&quot;</span>,<br>        <span class="hljs-string">&quot;build_date&quot;</span>:<span class="hljs-string">&quot;2017-09-07T15:56:59.599Z&quot;</span>,<br>        <span class="hljs-string">&quot;build_snapshot&quot;</span>:false,<br>        <span class="hljs-string">&quot;lucene_version&quot;</span>:<span class="hljs-string">&quot;6.6.0&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;tagline&quot;</span>:<span class="hljs-string">&quot;You Know, for Search&quot;</span><br>&#125;<br><br><span class="hljs-meta">### æµ‹è¯•slave2</span><br>[esuser@localhost es]$ <span class="hljs-meta-keyword">/usr/</span>local<span class="hljs-meta-keyword">/es/</span>slave2<span class="hljs-meta-keyword">/bin/</span>elasticsearch -d<br><span class="hljs-meta">### æµè§ˆå™¨è®¿é—® http:<span class="hljs-comment">//ip:8200ï¼Œå“åº”ä¸ºï¼š</span></span><br><br>&#123;<br><span class="hljs-symbol">    name:</span> <span class="hljs-string">&quot;slave2&quot;</span>,<br><span class="hljs-symbol">    cluster_name:</span> <span class="hljs-string">&quot;es-search&quot;</span>,<br><span class="hljs-symbol">    cluster_uuid:</span> <span class="hljs-string">&quot;JoNUMEKFS06NHNS7p3bdWg&quot;</span>,<br><span class="hljs-symbol">    version:</span> &#123;<br><span class="hljs-symbol">        number:</span> <span class="hljs-string">&quot;5.5.3&quot;</span>,<br><span class="hljs-symbol">        build_hash:</span> <span class="hljs-string">&quot;9305a5e&quot;</span>,<br><span class="hljs-symbol">        build_date:</span> <span class="hljs-string">&quot;2017-09-07T15:56:59.599Z&quot;</span>,<br><span class="hljs-symbol">        build_snapshot:</span> false,<br><span class="hljs-symbol">        lucene_version:</span> <span class="hljs-string">&quot;6.6.0&quot;</span><br>    &#125;,<br><span class="hljs-symbol">    tagline:</span> <span class="hljs-string">&quot;You Know, for Search&quot;</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>è‡³æ­¤å®Œæˆäº† es é›†ç¾¤(ä¼ª)çš„æ­å»ºã€‚</p><h2 id="ç¯å¢ƒå‡†å¤‡ä¹‹-elasticsearch-head-å®‰è£…"><a href="#ç¯å¢ƒå‡†å¤‡ä¹‹-elasticsearch-head-å®‰è£…" class="headerlink" title="ç¯å¢ƒå‡†å¤‡ä¹‹ elasticsearch head å®‰è£…"></a>ç¯å¢ƒå‡†å¤‡ä¹‹ elasticsearch head å®‰è£…</h2><p>ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬è§‚å¯Ÿè°ƒè¯•ï¼Œå®‰è£…è¿™ä¸ª es æ’ä»¶ã€‚</p><p>å®‰è£…æ­¥éª¤å‚è€ƒå®˜æ–¹ <a href="https://github.com/mobz/elasticsearch-head">github</a></p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-comment"># æŠŠæ’ä»¶å®‰è£…åˆ° es ç›®å½•ä¸‹</span><br>cd <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/es/</span><br><br>git clone git:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/mobz/</span>elasticsearch-head.git  <br>cd elasticsearch-head  <br>npm install<br>npm run start<br></code></pre></div></td></tr></table></figure><p>åœ¨ <code>npm install</code> è¿™ä¸€æ­¥ï¼Œç”±äºå›½å†…ç½‘ç»œç¯å¢ƒçš„åŸå› ï¼Œå¯èƒ½ä¼šå¤±è´¥ï¼Œå¯ä»¥npm æ¢æºé‡è¯•ã€‚</p><p>å¯åŠ¨å®Œæˆåï¼Œæµè§ˆå™¨è®¿é—® <code>http://ip:9100</code>ï¼Œæˆ‘çš„æ˜¯ <code>http://192.168.199.192:9100/</code></p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180906153624364960006.png"></p><p>è¿™é‡Œéœ€è¦ä¿®æ”¹è¿æ¥åœ°å€ï¼Œä¸ºä½ çš„ es æ‰€åœ¨çš„ ip:9200ã€‚åé¢é›†ç¾¤å¥åº·ä¸ºç»¿è‰²ä¸ºæ­£å¸¸ã€‚</p><p>åˆ°è¿™é‡Œï¼Œæ’ä»¶ä¹Ÿå°±å®‰å¥½äº†ã€‚</p><h2 id="åˆ†è¯"><a href="#åˆ†è¯" class="headerlink" title="åˆ†è¯"></a>åˆ†è¯</h2><p>å•†å“æœç´¢ï¼Œåˆ†è¯æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå¼€æºçš„ä¸­æ–‡åˆ†è¯æœ€æœ‰åçš„è«è¿‡äº IK åˆ†è¯äº†ï¼ŒåŒæ—¶ä¸ºäº†ç»™ç”¨æˆ·æä¾›æ›´å¥½çš„ä½“éªŒï¼ŒåŒæ—¶é…ç½® pinyin åˆ†è¯ï¼Œå³è¾“å…¥æ‹¼éŸ³ä¹Ÿå¯ä»¥è¿›è¡Œæœç´¢ï¼Œç½‘ä¸Šä¹Ÿæœ‰å¯¹åº”çš„åˆ†è¯å™¨ï¼Œåœ¨ä¸‹æ–‡ä¸­æˆ‘ä»¬ä¸€èµ·æ¥é…ç½®åˆ†è¯å™¨ã€‚</p><h2 id="æœ‰ç–‘é—®"><a href="#æœ‰ç–‘é—®" class="headerlink" title="æœ‰ç–‘é—®?"></a>æœ‰ç–‘é—®?</h2><p>æ¬¢è¿æ¥ä¿¡ï¼Œ<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=JVNGSFRlQ0pdSERMSQtGSkg">ç»™æˆ‘å†™ä¿¡</a></p>]]></content>
    
    
    <categories>
      
      <category>ElasticSearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ElasticSearchç¯å¢ƒæ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çˆ¬è™«å…ƒç´ é€‰æ‹©æŠ€å·§</title>
    <link href="/%E7%88%AC%E8%99%AB%E5%85%83%E7%B4%A0%E9%80%89%E6%8B%A9%E6%8A%80%E5%B7%A7.html"/>
    <url>/%E7%88%AC%E8%99%AB%E5%85%83%E7%B4%A0%E9%80%89%E6%8B%A9%E6%8A%80%E5%B7%A7.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä½œä¸ºä¸€ä¸ªçˆ¬è™«æ¡†æ¶ï¼ŒWebMagic æä¾›äº†å¤šç§é€‰æ‹©å™¨ä¾¿äºæˆ‘ä»¬çš„ä½¿ç”¨ã€‚ä½¿ç”¨ Selectable æ¥å¯¹å†…å®¹è¿›è¡Œé“¾å¼æŠ½å–ï¼Œå¸¸ç”¨çš„æŠ½å–æ–¹å¼æœ‰ï¼šCSS é€‰æ‹©å™¨ã€XPathï¼Œæ­£åˆ™è¡¨è¾¾å¼ï¼ŒJsonPathã€‚ä»Šå¤©å†™å†™å¦‚ä½•åˆ©ç”¨ä¸€äº›å·¥å…·ï¼Œæ¥å¿«æ·ç¼–å†™è¿™äº›é€‰æ‹©è¯­æ³•ã€‚</p><a id="more"></a><h2 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h2><p>å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œæœ‰äº†ä¸€ä»¶è¶æ‰‹çš„å…µå™¨ï¼Œå¹²èµ·æ´»æ¥ä¹Ÿåˆ©ç´¢ã€‚å·¥å…·ä¸»è¦ç”¨åˆ°äº†</p><ul><li>Chrome è°·æ­Œæµè§ˆå™¨</li><li>Chrome æ’ä»¶ <a href="https://chrome.google.com/webstore/detail/xpath-helper/hgimnogjllphhhkhlmebbmlgjoejdpjl">XPath Helper</a><br>(å¦‚æœä½ ç¿»ä¸äº† Q çš„è¯ï¼Œå¯ä»¥åœ¨è¿™é‡Œ <a href="http://chromecj.com/web-development/2018-01/892.html">ä¸‹è½½</a> æ’ä»¶)</li></ul><h2 id="é€‰æ‹©å¯¹è±¡"><a href="#é€‰æ‹©å¯¹è±¡" class="headerlink" title="é€‰æ‹©å¯¹è±¡"></a>é€‰æ‹©å¯¹è±¡</h2><p>ä¸ºäº†æ–¹ä¾¿å®éªŒï¼Œæˆ‘é€‰æ‹©å¯¹ æ˜é‡‘ (<a href="https://juejin.im/">https://juejin.im/</a>) è¿™ä¸ªç½‘ç«™è¿›è¡Œå®éªŒã€‚<br>ä»¥ä¸‹å†…å®¹é»˜è®¤ä½¿ç”¨çš„æ˜¯ Chromeã€‚</p><p>å®šä¹‰ä¸€ä¸ªå‡çš„éœ€æ±‚å§ï¼Œéœ€è¦å¯¹æ˜é‡‘çƒ­é—¨è¿›è¡Œçˆ¬å–ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180831153572214928252.png"></p><p>è¿™é‡Œæˆ‘ä»¬åªæƒ³è¦è·å–è¿™é‡Œçš„æ‰€æœ‰çš„æ ‡é¢˜</p><h2 id="Xpath-æŠ½å–"><a href="#Xpath-æŠ½å–" class="headerlink" title="Xpath æŠ½å–"></a>Xpath æŠ½å–</h2><p>å…·ä½“æ­¥éª¤ï¼š</p><ol><li>ç‚¹å‡»é¡µé¢ç©ºç™½å¤„ï¼Œä½¿ç”¨å¿«æ·é”® <strong>ctrl + shift + x</strong> è°ƒå‡º Xpath Helper å·¥å…·ï¼Œè°ƒå‡ºåï¼ŒæŒ‰ä½ <strong>shift</strong> ç§»åŠ¨é¼ æ ‡å¯ä»¥é€‰æ‹©å…ƒç´ ï¼Œå¹¶ä¸”è¯¥å…ƒç´ çš„ xpath ä¼šæ˜¾ç¤ºåœ¨ä¸Šæ–¹æ¡†å†…<br> <img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180831153572291788354.png"></li><li>å¯ä»¥çœ‹åˆ°ï¼Œå·¥å…·ç”Ÿæˆçš„ XPath è·¯å¾„éå¸¸é•¿ï¼Œéœ€è¦è¿›è¡Œä¼˜åŒ–ã€‚è¿™é‡Œå¯ä»¥ä½¿ç”¨è°·æ­Œæµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·å¾ˆæ–¹ä¾¿å¾—è·å– Xpath è·¯å¾„ï¼Œæ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œä½¿ç”¨å¼€å‘è€…å·¥å…·é¢æ¿ä¸Šæœ€å·¦ä¾§çš„ç®­å¤´é€‰æ‹©å·¥å…·ï¼Œé€‰æ‹©ä¸€ä¸ªæ ‡é¢˜å…ƒç´ ï¼Œå³ä¾§å°±ä¼šè‡ªåŠ¨å®šä½åˆ°è¯¥å…ƒç´ çš„æºç å¤„ï¼Œå³é”®æºç é‡Œçš„è¿™ä¸ªå…ƒç´ ï¼Œé€‰æ‹© Copy XPathã€‚<br> <img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/2018083115357231057642.png"></li><li>æ¸…ç©º Xpath Helper ä¸­çš„ QUERY æ¡†å†…çš„å†…å®¹ï¼Œç²˜è´´ Chrome å¼€å‘è€…å·¥å…·æ‹·è´çš„ Xpath è·¯å¾„ï¼Œå¯ä»¥æ¸…æ™°å¯¹æ¯”çœ‹åˆ°è·¯å¾„ç›¸çº¸ä¸Šä¸€æ­¥è·å–çš„è¦ç®€çŸ­å¾ˆå¤šï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªåŸºç¡€ä¸Šè¿›è¡Œè¿›ä¸€æ­¥åœ°ä¼˜åŒ–ã€‚<br> <img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180831153572326370899.png"></li><li>ç”±äºæˆ‘ä»¬éœ€è¦è·å–çš„æ˜¯æ‰€æœ‰çš„æ ‡é¢˜ï¼Œæ‰€ä»¥ä¿®æ”¹ Xpathï¼ŒåŒæ—¶ Xpath Helper é«˜äº®äº†è¢«é€‰æ‹©çš„å…ƒç´ ã€‚å› ä¸ºå½“å‰æ ‡é¢˜æ˜¯åœ¨ä¸€ä¸ªåˆ—è¡¨é¡µå½“ä¸­ï¼ŒæŠŠ li[2] ä¸­çš„å€¼ä¿®æ”¹ä¸º * å°±æ˜¯é€‰æ‹©æ‰€æœ‰äº†ï¼Œ// è¡¨ç¤ºä»æ ¹å…ƒç´ æŸ¥æ‰¾ï¼Œæ›¿ä»£æ‰äº†å‰é¢å¤šä½™çš„å…ƒç´ ï¼Œ  XPath åŸºç¡€è¯­æ³•å¯ä»¥ä¸Š Google æœç´¢ä¸€ä¸‹ã€‚<br> <img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180831153572349093818.png"></li></ol><h2 id="CSS-é€‰æ‹©å™¨"><a href="#CSS-é€‰æ‹©å™¨" class="headerlink" title="CSS é€‰æ‹©å™¨"></a>CSS é€‰æ‹©å™¨</h2><p>æœ‰çš„ç½‘ç«™çš„ HTML ç»“æ„ä¸é€‚åˆä½¿ç”¨ XPath æ¥å†™ï¼Œä¼šå†™çš„å¾ˆé•¿ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ css é€‰æ‹©å™¨æ¥å®Œæˆï¼Œè¿™é‡Œè¿˜æ˜¯å€ŸåŠ© Chrome çš„å¼€å‘è€…å·¥å…·ã€‚</p><ol><li>åŒä¸Šä¸€æ­¥ä¸€æ ·ï¼Œé€‰æ‹©ä¸€ä¸ªå…ƒç´ åï¼Œé€‰æ‹© Copy selector<br> <img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/2018083115357231057642.png"></li><li>å¯ä»¥åœ¨ Chrome å¼€å‘è€…å·¥å…·çš„ console é‡ŒéªŒè¯é€‰æ‹©å™¨æ˜¯å¦æ­£ç¡®,è¿™é‡Œæ­£ç¡®æ‰“å°å‡ºäº†è¿™ä¸ªå…ƒç´ ã€‚åœ¨ webmagic é‡Œé€šè¿‡ css æ–¹æ³•æˆ–è€… $ æ–¹æ³•ä¼ é€’ css é€‰æ‹©å™¨å‚æ•°ï¼Œå¾—åˆ°å¯¹è±¡.<br> <img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180831153572433184741.png"></li></ol><h2 id="json-path-æ–¹å¼"><a href="#json-path-æ–¹å¼" class="headerlink" title="json path æ–¹å¼"></a>json path æ–¹å¼</h2><p>è¯¦è§æˆ‘çš„å¦å¤–ä¸€ç¯‡åšå®¢</p><h2 id="æ­£åˆ™è¡¨è¾¾å¼æ–¹å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼æ–¹å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼æ–¹å¼"></a>æ­£åˆ™è¡¨è¾¾å¼æ–¹å¼</h2><p>è¿™ä¸ªå°±ä¸ç”¨å¤šè¯´äº†ï¼Œé€šè¿‡æ­£åˆ™æŠ½å–æ­£æ–‡ç¬¦åˆçš„å†…å®¹</p>]]></content>
    
    
    <categories>
      
      <category>WebMagic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>çˆ¬è™«æŠ€å·§</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>èŠèŠæˆ‘çš„è§„åˆ’</title>
    <link href="/%E8%81%8A%E8%81%8A%E6%88%91%E7%9A%84%E8%A7%84%E5%88%92.html"/>
    <url>/%E8%81%8A%E8%81%8A%E6%88%91%E7%9A%84%E8%A7%84%E5%88%92.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å»å¹´çš„è¿™ä¸ªæ—¶å€™ï¼Œé—²ç€æ— äº‹åˆ·çŸ¥ä¹ï¼Œçœ‹åˆ°ä¸€ä¸ªé—®é¢˜è§‰å¾—å¾ˆæœ‰æ„æ€ï¼Œã€<a href="https://www.zhihu.com/question/39430220r">å¤©å¤©å†™ä¸šåŠ¡ä»£ç çš„ç¨‹åºå‘˜ï¼Œæ€ä¹ˆæˆä¸ºæŠ€æœ¯å¤§ç‰›ï¼Œå¼€å§‹å†™æŠ€æœ¯ä»£ç ï¼Ÿ</a>ã€‘ï¼Œå½“æ—¶çš„è‡ªå·±ç¡®å®ä¹Ÿä¸€ç›´æ˜¯åœ¨å†™ä¸šåŠ¡æ–¹é¢çš„ä»£ç ï¼Œå†™çš„æ—¶é—´ä¹…äº†ï¼Œé¢å¯¹ç€æºæºä¸æ–­çš„éœ€æ±‚ï¼Œåªèƒ½ç¡¬ç€å¤´çš®å»åº”å¯¹ï¼Œå†…å¿ƒéš¾å…æœ‰æ‰€å›°æ‰°ï¼›çœ‹åˆ°æ ‡é¢˜ï¼Œæˆ‘ä¹Ÿä¸ç¦åœ¨æƒ³ï¼Œä»€ä¹ˆæ—¶å€™æˆ‘ä¹Ÿèƒ½æˆä¸ºæŠ€æœ¯å¤§ç‰›å‘¢ï¼Ÿï¼ˆå¯¹æŠ€æœ¯æœ‰æ‰€è¿½æ±‚çš„ Coder ç›®æ ‡åº”è¯¥éƒ½æ˜¯æˆä¸ºä¸€ä¸ªæŠ€æœ¯å¤§ç‰›å§ï¼‰æŠ±ç€è¿™ç§å¿ƒæ€ï¼Œæˆ‘ç‚¹è¿›äº†é—®é¢˜ã€‚</p><a id="more"></a><h2 id="æˆ‘è¯¥æ€ä¹ˆåšï¼Ÿ"><a href="#æˆ‘è¯¥æ€ä¹ˆåšï¼Ÿ" class="headerlink" title="æˆ‘è¯¥æ€ä¹ˆåšï¼Ÿ"></a>æˆ‘è¯¥æ€ä¹ˆåšï¼Ÿ</h2><p>çœ‹äº†å‡ ä¸ªå›ç­”ï¼Œå‡ ä¹éƒ½åœ¨è®²å¤§é“ç†ï¼Œçœ‹äº†æ„Ÿè§‰æ˜¯è¿™ä¹ˆä¸€å›äº‹å¾ˆæœ‰é“ç†çš„æ ·å­ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰èµ·åˆ°ä»€ä¹ˆå®é™…ä½œç”¨ã€‚ä½†æ˜¯çœ‹åˆ°äº†<a href="https://www.zhihu.com/question/39430220/answer/81648584">æè¿åçš„å›ç­”</a>ä¹‹åï¼Œâ€œ3D ç†è®ºâ€(<strong>Do more</strong>ã€<strong>Do better</strong>ã€<strong>Do exercise</strong>)å¯¹äºæˆ‘ï¼Œç”¨é†é†çŒé¡¶æ¥å½¢å®¹ä¹Ÿä¸ä¸ºè¿‡ï¼Œä»–çš„å›ç­”ä¸ä»…è§£ç­”äº†æˆ‘çš„ç–‘æƒ‘ï¼ŒåŒæ—¶ä¹Ÿç»™å‡ºäº†å…·ä½“çš„å®é™…æ–¹æ³•ã€‚å…´å¥‹ä¹‹ä½™ï¼Œç»“åˆè‡ªå·±çš„å·¥ä½œæƒ…å†µï¼Œå°†åŸå›ç­”ä¸­ <strong>Do more</strong> è¿›è¡Œäº†å°å°æ”¹åŠ¨ï¼Œéšååœ¨ç¬”è®°ä¸Šåšäº†ä¸€ç‚¹ç›¸å…³çš„æ€»ç»“ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180826153529120868146.png"></p><p>æˆ‘æŠŠ â€œ3D ç†è®ºâ€ åˆ†æˆäº†ä¸¤ä¸ªåœºæ™¯ï¼Œä¸€æ˜¯åœ¨å…¬å¸ï¼Œå¦ä¸€ä¸ªæ˜¯åœ¨å®¶ã€‚å› ä¸ºåœ¨å½“å‰çš„å…¬å¸å½“ä¸­ï¼Œä¸å¯èƒ½æŠŠå¤§æŠŠçš„æ­£å¸¸å·¥ä½œæ—¶é—´ç”¨äºæ–°çš„æŠ€æœ¯å­¦ä¹ ä¹‹ä¸Šï¼Œæ‰€ä»¥ï¼Œæˆ‘è®¤ä¸ºåœ¨å…¬å¸ä¸­èƒ½åšçš„åªæœ‰ 1ï¼Œ2ï¼Œ3 è¿™ä¸‰ç‚¹ï¼Œè€Œç¬¬ 4 ç‚¹åªèƒ½åˆ©ç”¨ä½ çš„ä¸šä½™æ—¶é—´æ¥è¿›è¡Œã€‚</p><p>å½“ç„¶é™¤äº†é‚£ç§æ²¡æœ‰ä»»åŠ¡ä¹Ÿå¿…é¡»ç¡¬æ˜¯è¦å¾…åˆ° 10 ç‚¹ä»¥åæ‰èƒ½ä¸‹ç­çš„å…¬å¸é™¤å¤–ï¼Œè¿™ç§å…¬å¸ï¼Œå…¶å®æŒ¤å‡ºå‡ ä¸ªå°æ—¶ï¼Œç”¨äºè‡ªå·±çš„å­¦ä¹ åº”è¯¥ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚å¦‚æœå¯ä»¥å‡†æ—¶ä¸‹ç­ï¼Œé™¤æ‰ä¸€å¤©çš„ç¡è§‰ï¼Œåƒé¥­ï¼Œå·¥ä½œï¼Œäº¤é€šçš„æ—¶é—´ï¼Œå¯ä»¥æ”¯é…çš„æ—¶é—´å…¶å®è¿˜æ˜¯æŒºå……è£•çš„ï¼Œå‰ææ˜¯ä¸ç©æ¸¸æˆä¸åˆ·å‰§ï¼Œå¦‚æœæ²‰è¿·çš„è¯å¯ä»¥æƒ³ä¸€äº›æªæ–½æ¥å¼ºåˆ¶çº¦æŸè‡ªå·±ã€‚</p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>åˆ°ç°åœ¨ 2018 å¹´ 8 æœˆä»½ï¼Œå·²ç»è¿‡å»äº†ä¸€å¹´ã€‚å¾ˆæƒ­æ„§çš„æ˜¯ï¼Œç¬”è€…è®¤ä¸ºè‡ªå·±å¯¹äº â€œ3D ç†è®ºâ€çš„æ‰§è¡ŒåŠ›åº¦è¿˜æ˜¯è¿œè¿œä¸å¤Ÿï¼Œç†è®ºä¸­çš„ç›®å‰ä¹Ÿåªåšåˆ°äº†å…¶ä¸­ä¸€ç‚¹ï¼Œåœ¨å…¬å¸é‡Œå¯¹è‡ªå·±è´Ÿè´£çš„ä¸šåŠ¡è¿›è¡Œäº†è¾ƒå¤§çš„è°ƒæ•´ä¼˜åŒ–ï¼Œä¹Ÿè¾¾åˆ°äº†é¢„æœŸçš„å¯é ç¨³å®šã€‚</p><p>éšç€å·¥ä½œå¹´é™çš„å¢é•¿ï¼Œæˆ‘å°±è¶Šå‘è§‰å¾—ç¨‹åºå‘˜æ˜¯ä¸ªä¸å­¦ä¹ å°±ä¸€å®šä¼šè¢«æ·˜æ±°æ‰çš„èŒä¸šï¼Œç»å¸¸èƒ½çœ‹åˆ°æŸæŸå…¬å¸è¾é€€ 40 å²ä»¥ä¸Šç¨‹åºå‘˜çš„æ–°é—»ï¼Œå°±æ„ˆå‘æ„Ÿè§‰å‹åŠ›é€æ¸å˜å¤§ï¼ˆè™½ç„¶å‰å‡ å¤©æˆ‘æ‰è¿‡å®Œ  25 å²ç”Ÿæ—¥ï¼‰ï¼Œå…¶å®æ¢ä¸€ä¸ªæ€è·¯æƒ³ï¼Œå¦‚æœä¸€ä¸ªç¨‹åºå‘˜åœ¨å…¬å¸ä¸­æ˜¯éš¾ä»¥è¢«å–ä»£çš„ï¼Œé‚£ä¹ˆä¹Ÿä¸ä¼šæ˜¯è¢«è¾é€€é‚£æ³¢äººä¸­çš„ä¸€åå§ï¼</p><p>ä¹Ÿæ˜¯ä»å»å¹´çš„ 7 æœˆå¼€å§‹ï¼Œçº¦æŸè‡ªå·±æ¯æœˆè‡³å°‘è¦å†™ä¸¤ç¯‡åšå®¢çš„ç›®æ ‡ä¹Ÿè¾¾åˆ°äº†ï¼Œä¹Ÿç®—æ˜¯æ‰§è¡Œäº† â€œ3D ç†è®ºâ€ä¸­çš„ä¸€ç‚¹å§ã€‚</p><p>ç°åœ¨åœ¨å…¬å¸ä¸­ï¼Œè´Ÿè´£çš„å†…å®¹ä¹Ÿå‘ç”Ÿäº†è½¬å˜ï¼Œçº¯ä¸šåŠ¡ä»£ç å†™çš„æ¯”ä»¥å‰è¦å°‘å¾ˆå¤šï¼Œæ›´å¤šçš„æ˜¯è¦å»å…³æ³¨åŸºç¡€æœåŠ¡ç¨³å®šï¼Œå¯¹åŸæœ‰çš„é¡¹ç›®ä¼˜åŒ–ï¼ŒæœåŠ¡æ‹†åˆ†ç­‰æ–¹é¢ï¼›ä½†æ˜¯åˆæ·±è§‰è‡ªå·±çš„æŠ€æœ¯åŠŸåº•è¿˜å¾ˆæ¬ ç¼ºï¼Œå¿™ç€è¡¥å……æ–°çš„çŸ¥è¯†ï¼Œäºæ˜¯åœ¨å·¥ä½œçš„äº§å‡ºå°±ä¸æ˜¯é‚£ä¹ˆå¾—å¤šäº†ï¼Œè¿™ä¹Ÿæ˜¯è®©æˆ‘å¾ˆå¤´ç–¼çš„äº‹æƒ…ï¼Œæ¯•ç«Ÿå·¥ä½œçš„äº§å‡ºå…³ç³»åˆ°è‡ªå·±çš„ç»©æ•ˆã€‚</p><p>å¯èƒ½æ¯ä¸ªæ—¶æœŸéƒ½ä¼šå‡ºç°ä»¤æˆ‘å¤´ç–¼çš„äº‹æƒ…ï¼Œä¹Ÿè®¸è¿™ä¹Ÿæ˜¯è®©æˆ‘çªç ´è‡ªæˆ‘çš„å¥‘æœºã€‚</p><p>æŒç»­è·µè¡Œ â€œ3Dç†è®ºâ€ï¼Œåšä¸€ä¸ªè·µè¡Œçš„ç¨‹åºå‘˜ï¼Œç›®æ ‡æˆ–è®¸å·²åœ¨ä¸è¿œå¤„å•¦~</p>]]></content>
    
    
    <categories>
      
      <category>é—²è°ˆ</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>WebMagicå®ç°åˆ†å¸ƒå¼æŠ“å–ä»¥åŠæ–­ç‚¹æŠ“å–</title>
    <link href="/WebMagic%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E6%8A%93%E5%8F%96.html"/>
    <url>/WebMagic%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E6%8A%93%E5%8F%96.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»å»å¹´åˆ°ä»Šå¹´ï¼Œç¬”è€…ä¸»è¦è´Ÿè´£çš„æ˜¯ä¸åˆä½œæ–¹çš„å†…å®¹å¯¹æ¥ï¼Œæ–°å¢çš„åˆä½œå•†ä¸æ˜¯å¾ˆå¤šçš„æƒ…å†µä¸‹ï¼Œåœ¨æˆ‘è‡ªä»å»å¹´å¼•å…¥äº† WebMagic è¿™ä¸ªçˆ¬è™«æ¡†æ¶ä¹‹åï¼ŒåŸºæœ¬å¾ˆå°‘éœ€è¦å»å…³æ³¨ç»´æŠ¤çˆ¬è™«ï¼Œåšçš„æœ€å¤šçš„æ˜¯æ–°æ¥å…¥åˆä½œå•†å»å†™å¯¹åº”çˆ¬è™«æŠ“å–æ¨¡æ¿ã€‚</p><p>å› ä¸ºåœ¨ä»£ç ä¸­å®ç°äº†å¢é‡æŠ“å–ï¼Œå•æœºä¹Ÿè¶³ä»¥æ‰¿æ‹…æ—¥å¸¸çš„æŠ“å–å·¥ä½œã€‚</p><p>åœ¨å‰ä¸¤å‘¨ï¼Œç”±äºå…¬å¸æ‹“å±•æ–°çš„ä¸šåŠ¡æ¸ é“ï¼Œéœ€è¦æ¥å…¥çš„åˆä½œå•†ç¬é—´å¢åŠ äº† 3 å€ï¼Œåˆè¢«è¦æ±‚åœ¨ 2 å¤©å†…å…¨éƒ¨æ¥å…¥ï¼Œé‚£ä¸¤å¤©å’Œå¦å¤–ä¸€ä¸ªåŒäº‹ï¼Œå‡ ä¹éƒ½åœ¨å¿™ç€é€‚é…æ¨¡æ¿ã€‚</p><p>æ€¥é€Ÿå¢åŠ åˆä½œå•†çš„åŒæ—¶ï¼ŒæœåŠ¡å™¨æ— æ³•æ‰¿å—å‹åŠ›ï¼Œé¢‘ç¹çˆ†å‡º OOM å¼‚å¸¸ï¼Œå¯¼è‡´æŠ“å–å¤§æ‰¹é‡å¤±è´¥ï¼Œå…¶ä¸­æœ€å¤šçš„ä¸€ä¸ªåˆä½œå•†æ¥å£ï¼Œéœ€è¦è§£æä¸‹è½½çš„é¡µé¢è¿‘ 500w ä¸ªï¼Œå•æœºæŠ“å–å·²æ— æ³•æ»¡è¶³éœ€æ±‚ï¼Œéœ€è¦å¤šå°æœåŠ¡å™¨åŒæ—¶æŠ“å–ã€‚</p><p>ä½†é‰´äºå½“æ—¶éœ€æ±‚ç´§ï¼Œæ²¡æœ‰æ—¶é—´å¯¹çˆ¬è™«éƒ¨åˆ†ä»£ç è¿›è¡Œé‡æ„å‡çº§ï¼Œå•æœºæŠ“å–ä¹Ÿä¸è¡Œï¼Œè€Œä¸”ä¼šå½±å“æ­£å¸¸æŠ“å–ä»»åŠ¡çš„æ‰§è¡Œï¼Œäºæ˜¯ä¸´æ—¶æƒ³äº†ä¸ªåŠæ³•åœ¨å…¶ä»–æœåŠ¡å™¨ä¸ŠæŠ“å–æŸä¸ªåˆä½œå•†ï¼Œæ‰åå·è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä½†è¿™ä¹Ÿå¹¶éé•¿ä¹…ä¹‹è®¡ã€‚</p><a id="more"></a><h2 id="åˆ†å¸ƒå¼æŠ“å–åŸºç¡€å‰æä¹‹ä¸€"><a href="#åˆ†å¸ƒå¼æŠ“å–åŸºç¡€å‰æä¹‹ä¸€" class="headerlink" title="åˆ†å¸ƒå¼æŠ“å–åŸºç¡€å‰æä¹‹ä¸€"></a>åˆ†å¸ƒå¼æŠ“å–åŸºç¡€å‰æä¹‹ä¸€</h2><p>å› ä¸ºåˆšåˆšå¼•å…¥ WebMagic è¿™ä¸ªæ¡†æ¶çš„æ—¶å€™ï¼Œè¿˜ä¸æ˜¯å¤ªç†Ÿæ‚‰ï¼Œä½¿ç”¨çš„ Scheduler æ˜¯é»˜è®¤åŸºäºå†…å­˜çš„é˜Ÿåˆ— <strong>QueueScheduler</strong> ï¼Œå½“å¾…æŠ“å–çš„ URL å¤ªå¤šæ—¶ï¼Œå†…å­˜å°±è¢«å æ»¡äº†ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</p><p>å¦‚æœè¦å®ç°åˆ†å¸ƒå¼æŠ“å–ï¼Œå‰æéœ€è¦ä½¿ç”¨åŸºäº Redis çš„ <strong>RedisScheduler</strong>ã€‚</p><p>åœ¨åˆ›å»ºçˆ¬è™«çš„æ—¶å€™ï¼Œæ‰‹åŠ¨è®¾ç½® Scheduler ä¸º RedisSchedulerã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">spider.setScheduler(<span class="hljs-keyword">new</span> RedisScheduler(jedisPool));<br></code></pre></div></td></tr></table></figure><p>RedisScheduler éœ€è¦ä¼ å…¥ JedisPool å‚æ•°ã€‚</p><p>å¦‚æœä½¿ç”¨çš„æ˜¯ SpringBootï¼Œå¯ä»¥å£°æ˜ä¸€ä¸ª RedisConfig çš„é…ç½®ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RedisConfig</span> </span>&#123;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;spring.redis.host&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String host;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;spring.redis.port&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> port;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;spring.redis.password&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> String password;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;spring.redis.timeout&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> timeout;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;spring.redis.jedis.pool.max-idle&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> maxIdle;<br><br>    <span class="hljs-meta">@Value(&quot;$&#123;spring.redis.jedis.pool.max-wait&#125;&quot;)</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> maxWaitMillis;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> JedisPool <span class="hljs-title">redisPoolFactory</span><span class="hljs-params">()</span> </span>&#123;<br>        JedisPoolConfig jedisPoolConfig = <span class="hljs-keyword">new</span> JedisPoolConfig();<br>        jedisPoolConfig.setMaxIdle(maxIdle);<br>        jedisPoolConfig.setMaxWaitMillis(maxWaitMillis);<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> JedisPool(jedisPoolConfig, host, port, timeout, password);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¦‚æœä½¿ç”¨çš„æ˜¯ Springï¼Œå¯ä»¥åœ¨ XML ä¸­é…ç½®å£°æ˜ä¸€ä¸ª Bean èŠ‚ç‚¹ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;poolConfig&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;redis.clients.jedis.JedisPoolConfig&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxActive&quot;</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;3000&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxIdle&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;100&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxWait&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;1000&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;testOnBorrow&quot;</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;jedisPool&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;redis.clients.jedis.JedisPool&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;poolConfig&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;127.0.0.1&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;2&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;6379&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;3&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;60000&quot;</span> /&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;4&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;eCii8TH3xR8&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br></code></pre></div></td></tr></table></figure><p>å£°æ˜äº† JedisPool ä¹‹åï¼Œç›´æ¥åœ¨ä»£ç ä¸­æ³¨å…¥å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br><span class="hljs-keyword">private</span> JedisPool jedisPool;<br></code></pre></div></td></tr></table></figure><h2 id="åˆ†å¸ƒå¼æŠ“å–åŸºç¡€å‰æä¹‹äºŒ"><a href="#åˆ†å¸ƒå¼æŠ“å–åŸºç¡€å‰æä¹‹äºŒ" class="headerlink" title="åˆ†å¸ƒå¼æŠ“å–åŸºç¡€å‰æä¹‹äºŒ"></a>åˆ†å¸ƒå¼æŠ“å–åŸºç¡€å‰æä¹‹äºŒ</h2><p>ä»…ä»…é…ç½®äº† RedisSchedulerï¼Œè¿˜æ— æ³•è¾¾æˆæˆ‘ä»¬çš„è¿›è¡Œåˆ†å¸ƒå¼æŠ“å–çš„ç›®çš„ï¼Œå¦‚æœéœ€è¦è¿›è¡Œåˆ†å¸ƒå¼æŠ“å–ï¼Œå…¶é˜Ÿåˆ—åº”è¯¥æ˜¯å…±äº«çš„ï¼Œå³å¤šå°æœåŠ¡å™¨çš„å¤šä¸ªçˆ¬è™«ä½¿ç”¨åŒä¸€ä¸ª Redis URL é˜Ÿåˆ—ï¼Œå– URL æˆ–è€…æ·»åŠ  URL éƒ½æ˜¯åŒä¸€ä¸ªã€‚</p><p>åˆå› ä¸ºæ˜¯ WebMagic åœ¨å¸®åŠ©æˆ‘ä»¬ç®¡ç† Schedulerï¼Œæ‰€ä»¥ URL çš„ç»´æŠ¤ä¹Ÿæ˜¯ WebMagic åœ¨åšã€‚</p><p>å…ˆçœ‹ä¸€æ®µ WebMagic çš„æºç </p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>    checkRunningStat();<br>    initComponent();<br>    logger.info(<span class="hljs-string">&quot;Spider &#123;&#125; started!&quot;</span>,getUUID());<br>    <span class="hljs-keyword">while</span> (!Thread.currentThread().isInterrupted() &amp;&amp; stat.get() == STAT_RUNNING) &#123;<br>        <span class="hljs-keyword">final</span> Request request = scheduler.poll(<span class="hljs-keyword">this</span>);<br>        <span class="hljs-keyword">if</span> (request == <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-keyword">if</span> (threadPool.getThreadAlive() == <span class="hljs-number">0</span> &amp;&amp; exitWhenComplete) &#123;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>            <span class="hljs-comment">// wait until new url added</span><br>            waitNewUrl();<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// ......</span><br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// ......</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° WebMagic æŠ“å–çš„æ—¶å€™é€šè¿‡è¿™è¡Œä»£ç è·å–é˜Ÿåˆ—ä¸­å¾…æŠ“å–çš„ URL åœ°å€ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">Request request = scheduler.poll(<span class="hljs-keyword">this</span>);<br></code></pre></div></td></tr></table></figure><p>è€Œè¿™ä¸ª this æ˜¯æŒ‡å®ç°äº† Task æ¥å£çš„å¯¹è±¡ï¼Œå³æŠŠå½“å‰çš„ Spider å¯¹è±¡ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚</p><p>å› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº† RedisSchedulerï¼Œæ‰€ä»¥è¿›å…¥è¯¥ç±»çš„ poll() æ–¹æ³•æŸ¥çœ‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">String url = jedis.lpop(getQueueKey(task));<br></code></pre></div></td></tr></table></figure><p>é€šè¿‡ task çš„ UUID è·å–åˆ°é˜Ÿåˆ—çš„ keyï¼Œç„¶ååˆ©ç”¨ redis çš„ list çš„ lpop å‘½ä»¤ä»é˜Ÿåˆ—å·¦ä¾§å¼¹å‡ºä¸€ä¸ªå¸¦æŠ“å–çš„ URLï¼Œæ„é€  Request å¯¹è±¡ã€‚</p><p>åŒæ ·çš„æŸ¥çœ‹ poll ä¸Šé¢çš„ pushWhenNoDuplicate æ–¹æ³•ï¼Œæ˜¯å°†å¾…æŠ“å–è¯·æ±‚çš„ URL pushåˆ°é˜Ÿåˆ—çš„å³ä¾§ï¼Œè€Œè¿™ä¸ªé˜Ÿåˆ—ä¹Ÿæ˜¯é€šè¿‡ Spider çš„ UUID é‡Œå”¯ä¸€ç¡®å®šçš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">jedis.rpush(getQueueKey(task), request.getUrl());<br></code></pre></div></td></tr></table></figure><p><strong>æ‰€ä»¥ï¼Œå¦‚æœè¦å®ç°åˆ†å¸ƒå¼åŒæ—¶æŠ“å–åŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œå°±éœ€è¦ä¿æŒ å¤šä¸ª Spider çš„ UUID æ˜¯ä¸€è‡´çš„</strong></p><h2 id="å®ç°åˆ†å¸ƒå¼æŠ“å–"><a href="#å®ç°åˆ†å¸ƒå¼æŠ“å–" class="headerlink" title="å®ç°åˆ†å¸ƒå¼æŠ“å–"></a>å®ç°åˆ†å¸ƒå¼æŠ“å–</h2><p>ç”¨è¿‡ WebMagic çš„äººéƒ½çŸ¥é“ï¼Œçˆ¬è™«å¯åŠ¨éœ€è¦ç»™ä»–ä¸€ä¸ªèµ·å§‹ URLï¼Œç„¶åé€šè¿‡è¿™ä¸ª URL è·å–æ–°çš„ URLï¼›æ‰€ä»¥å¦‚æœéœ€è¦è¿›è¡Œåˆ†å¸ƒå¼æŠ“å–ï¼Œè‚¯å®šçˆ¬è™«çš„èµ·å§‹ URL æ˜¯ä¸èƒ½ç›¸åŒçš„ï¼Œå› ä¸ºWebMagic ä¼šå¯¹é‡å¤çš„ URL è¿›è¡Œè‡ªåŠ¨å»é‡ã€‚</p><p>å› æ­¤çˆ¬è™«çš„æ¶æ„å›¾ä»</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180804153339577157412.png"></p><p>å˜æˆäº†å¦‚ä¸‹æ¶æ„</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180804153339572932005.png"></p><p>å³ä¿è¯å¤šä¸ªçˆ¬è™«ä½¿ç”¨åŒä¸€ä¸ª Redis é˜Ÿåˆ—ã€‚å…·ä½“æ€è·¯å°±æ˜¯ç¬¬ä¸€åªé€šè¿‡èµ·å§‹ URL çˆ¬è™«å¯åŠ¨çš„æ—¶å€™ï¼Œè®°å½•å¯åŠ¨çˆ¬è™«çš„è®¾ç½®UUIDï¼Œç„¶åå¯åŠ¨å…¶ä»–çˆ¬è™«çš„æ—¶å€™ï¼Œè®¾ç½®çˆ¬è™«çš„ UUID ä¸ºè®°å½•çš„ UUID çš„å€¼ã€‚</p><p>ä»£ç ä¸­ä½“ç°çš„å°±æ˜¯å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180804153339696246963.png"></p><p>å¯åŠ¨å…¶ä»–çˆ¬è™«çš„æ—¶å€™ï¼Œæ‰‹åŠ¨ä»é˜Ÿåˆ—ä¸­è·å– URL è®¾ç½®ä¸ºå¯åŠ¨ URL å³å¯ã€‚</p><h2 id="åˆ†å¸ƒå¼çˆ¬è™«ä»»åŠ¡è°ƒåº¦"><a href="#åˆ†å¸ƒå¼çˆ¬è™«ä»»åŠ¡è°ƒåº¦" class="headerlink" title="åˆ†å¸ƒå¼çˆ¬è™«ä»»åŠ¡è°ƒåº¦"></a>åˆ†å¸ƒå¼çˆ¬è™«ä»»åŠ¡è°ƒåº¦</h2><p>ç¬”è€…å®ç°çš„çˆ¬è™«å¯åŠ¨æ˜¯é€šè¿‡å®šæ—¶ä»»åŠ¡å¯åŠ¨çš„ï¼Œå› ä¸ºå…¶ä»–çˆ¬è™«ä¸ç¬¬ä¸€åªçˆ¬è™«çš„å…¥å£ä¸åŒï¼Œå› æ­¤å®šä¹‰äº†ä¸¤ä¸ªä»»åŠ¡å»è°ƒåº¦ï¼Œå¹¶ä¸”ä¸¤ä¸ªä»»åŠ¡ä¹‹é—´æœ‰ 30s çš„é—´éš”æ—¶é—´ï¼Œé˜²æ­¢ç¬¬ä¸€åªçˆ¬è™«è¿˜æœªæ·»åŠ  URL åˆ°é˜Ÿåˆ—å½“ä¸­ï¼Œè€Œé€ æˆå…¶ä»–çˆ¬è™«æ—  URL å¯æŠ“å–æƒ…å†µçš„å‘ç”Ÿã€‚</p><p>åŸºäºè¿™ä¸ªæ€è·¯ï¼Œå›  URL æ”¾åœ¨ Redis ä¹‹ä¸­ï¼Œæ‰€ä»¥åŒæ—¶ä¹Ÿå¯ä»¥å®ç° <strong>æ–­ç‚¹æŠ“å–ã€‚</strong></p><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>WebMagic çš„æºç å¾ˆç®€æ´æ˜“æ‡‚ï¼Œå¯ä»¥å­¦ä¹ åˆ°å¾ˆå¤šä¸œè¥¿ï¼Œå°¤å…¶æ˜¯å¤šçº¿ç¨‹ä»¥åŠé”çš„åº”ç”¨ï¼Œå¾ˆå€¼å¾—å€Ÿé‰´å­¦ä¹ ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>WebMagic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WebMagicåˆ†å¸ƒå¼æŠ“å–</tag>
      
      <tag>WebMagicæ–­ç‚¹æŠ“å–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>IDEAè¿œç¨‹è°ƒè¯•Tomcat</title>
    <link href="/IDEA%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95Tomcat.html"/>
    <url>/IDEA%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95Tomcat.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¼€å‘æ–°åŠŸèƒ½æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°åœ¨æœ¬åœ°ç¯å¢ƒè¿è¡Œæ²¡é—®é¢˜ï¼Œä½†æ˜¯éƒ¨ç½²åˆ°äº† Linux æœåŠ¡å™¨ä¸Šè·‘çš„æ—¶å€™å°±å‡ºç°é—®é¢˜è¿™ç§æƒ…å†µï¼›è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯éœ€è¦å®šä½çº¿ä¸Šé—®é¢˜ï¼Œè¿™ä¸¤ç§æƒ…å†µä»¥å‰çš„åšæ³•å°±æ˜¯åŠ  log æ—¥å¿—è¾“å‡ºï¼Œæ€»æ˜¯ä¸èƒ½ç²¾å‡†å®šä½é—®é¢˜æ‰€åœ¨ï¼Œå¦‚æœèƒ½å¤Ÿåƒæœ¬åœ°ç¯å¢ƒä¸€æ ·è°ƒè¯•ä»£ç ï¼Œé‚£è¿™ä¸ªé—®é¢˜ä¹Ÿå°±è¿åˆƒè€Œè§£äº†ã€‚</p><a id="more"></a><h2 id="å¼€å§‹ä¹‹å‰"><a href="#å¼€å§‹ä¹‹å‰" class="headerlink" title="å¼€å§‹ä¹‹å‰"></a>å¼€å§‹ä¹‹å‰</h2><p>æœ¬æ–‡ä»‹ç» IDEA ä¸ Tomcat çš„è¿œç¨‹è°ƒè¯•ï¼Œä¸”<strong>ç¬”è€…åœ¨æ—¥å¸¸å·¥ä½œå½“ä¸­ä¹Ÿæ˜¯è¿™ä¹ˆåšçš„</strong>ï¼Œç½‘ä¸Šå¾ˆå¤šéƒ½æ˜¯äº’ç›¸æŠ„è¢­ï¼Œæ²¡æœ‰ç»è¿‡éªŒè¯çš„ä¼ªåŸåˆ›ï¼Œè®©äººä¸å¿«ã€‚</p><h2 id="ä¸€ã€æ·»åŠ è¿è¡Œé¡¹"><a href="#ä¸€ã€æ·»åŠ è¿è¡Œé¡¹" class="headerlink" title="ä¸€ã€æ·»åŠ è¿è¡Œé¡¹"></a>ä¸€ã€æ·»åŠ è¿è¡Œé¡¹</h2><p>IDEA æ·»åŠ è¿œç¨‹è°ƒè¯•é¡¹</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180508/155321907.png?imageslim"></p><p>å¡«å†™æœåŠ¡å™¨ IP ï¼Œç«¯å£ä½¿ç”¨é»˜è®¤çš„å³å¯ï¼Œå¤åˆ¶ç¬¬äºŒè¡Œå‚æ•°</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180508/160344543.png?imageslim"></p><h2 id="äºŒã€ä¿®æ”¹æœåŠ¡å™¨ä¸­çš„-Tomcat-é…ç½®"><a href="#äºŒã€ä¿®æ”¹æœåŠ¡å™¨ä¸­çš„-Tomcat-é…ç½®" class="headerlink" title="äºŒã€ä¿®æ”¹æœåŠ¡å™¨ä¸­çš„ Tomcat é…ç½®"></a>äºŒã€ä¿®æ”¹æœåŠ¡å™¨ä¸­çš„ Tomcat é…ç½®</h2><p>è¿æ¥è¿œç¨‹æœåŠ¡å™¨ï¼Œè¿›å…¥ Tomcat æ ¹ç›®å½•ä¸‹çš„ <code>bin</code> ç›®å½•ï¼Œä¿®æ”¹ <code>catalina.sh</code> æ–‡ä»¶</p><p>å®šä½åˆ° 108 è¡Œå·¦å³ï¼Œæ‰¾åˆ° <code>cygwin=false</code> è¿™ä¸€è¡Œï¼Œ</p><p>åœ¨è¿™ä¸€è¡Œçš„å‰ä¸€è¡Œæ·»åŠ </p><p><code>JAVA_OPTS=&quot;&quot;</code></p><p>ç„¶åå°†ä» IDEA ä¸­å¤åˆ¶çš„é‚£ä¸²å‚æ•°ç²˜è´´åˆ°åŒå¼•å·ä¹‹é—´ï¼Œä¿å­˜é€€å‡ºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180727/102842589.png?imageslim"></p><p>ç„¶åå¯åŠ¨ Tomcatï¼Œå¦‚æœ Tomcat æ˜¯å·²ç»å¯åŠ¨çš„è¯ï¼Œå¿…é¡»è¦<strong>é‡å¯</strong>ä¸€ä¸‹ã€‚</p><h2 id="ä¸‰ã€è°ƒè¯•ç¯å¢ƒä¿®æ”¹"><a href="#ä¸‰ã€è°ƒè¯•ç¯å¢ƒä¿®æ”¹" class="headerlink" title="ä¸‰ã€è°ƒè¯•ç¯å¢ƒä¿®æ”¹"></a>ä¸‰ã€è°ƒè¯•ç¯å¢ƒä¿®æ”¹</h2><p>ä¸ºäº†è°ƒè¯•æ–¹ä¾¿ï¼Œéœ€è¦æš‚æ—¶å…³é—­æ‰é˜²ç«å¢™ï¼Œå¦åˆ™å¯èƒ½æ— æ³•è¿æ¥ã€‚</p><figure class="highlight arduino"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arduino">service iptables <span class="hljs-built_in">stop</span><br></code></pre></div></td></tr></table></figure><h2 id="å››ã€IDEA-è¿œç¨‹è°ƒè¯•"><a href="#å››ã€IDEA-è¿œç¨‹è°ƒè¯•" class="headerlink" title="å››ã€IDEA è¿œç¨‹è°ƒè¯•"></a>å››ã€IDEA è¿œç¨‹è°ƒè¯•</h2><p>å›åˆ° IDEAï¼Œç‚¹å‡» Debug æŒ‰é’®ï¼Œå¯åŠ¨åˆšæ‰æ·»åŠ çš„ Remoteï¼Œå¦‚æœä»¥ä¸Šæ²¡æœ‰é…ç½®é”™ï¼Œé‚£ä¹ˆæ§åˆ¶å°å°†æ‰“å°å‡º</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180508/161146521.png?imageslim"></p><p>æ­¤æ—¶å°±å’Œæœ¬åœ°è°ƒè¯•ä¸€æ ·æ‰“æ–­ç‚¹è°ƒè¯•å°±è¡Œäº†</p><h2 id="äº”ã€è§£å†³IDEA-æ— æ³•è¿æ¥è¿œç¨‹-Tomcat"><a href="#äº”ã€è§£å†³IDEA-æ— æ³•è¿æ¥è¿œç¨‹-Tomcat" class="headerlink" title="äº”ã€è§£å†³IDEA æ— æ³•è¿æ¥è¿œç¨‹ Tomcat"></a>äº”ã€è§£å†³IDEA æ— æ³•è¿æ¥è¿œç¨‹ Tomcat</h2><p>å¦‚æœæç¤ºæ— æ³•è¿æ¥ï¼Œå¦‚ä¸‹å›¾  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180508/164001814.png?imageslim"></p><p>åˆ™æ£€æŸ¥ä»¥ä¸Šé…ç½®æ˜¯å¦æ­£ç¡®ï¼Œç¡®è®¤éƒ½æ­£ç¡®çš„è¯ï¼Œå¯èƒ½æ˜¯æœåŠ¡å™¨é˜²ç«å¢™çš„åŸå› å¯¼è‡´ï¼Œéœ€è¦å…³é—­é˜²ç«å¢™ã€‚</p><p><strong>å¦‚æœæœåŠ¡å™¨æ˜¯é˜¿é‡Œäº‘çš„ï¼Œè¿˜éœ€è¦é…ç½® ECS æœåŠ¡å™¨çš„å®‰å…¨ç»„ï¼Œå¼€æ”¾ <code>5005</code> è¿œç¨‹è°ƒè¯•ç«¯å£ã€‚ è¯¦è§ç¬¬å…«æ¡</strong></p><h2 id="å…­ã€è§£å†³æ–­ç‚¹ä¸ç”Ÿæ•ˆ"><a href="#å…­ã€è§£å†³æ–­ç‚¹ä¸ç”Ÿæ•ˆ" class="headerlink" title="å…­ã€è§£å†³æ–­ç‚¹ä¸ç”Ÿæ•ˆ"></a>å…­ã€è§£å†³æ–­ç‚¹ä¸ç”Ÿæ•ˆ</h2><p>æ³¨æ„ï¼š</p><p>å¯åŠ¨ Remote çš„ Debug ä¹‹åï¼Œéœ€è¦ç­‰å¾…æ–­ç‚¹å˜æˆå¦‚ä¸‹å›¾æ—¶ï¼Œå†å»è®¿é—®æ¥å£ï¼›å¦‚æœæ–­ç‚¹ä¸­é—´æ²¡æœ‰å‡ºç°å¯¹å·ï¼Œè¯´æ˜æ–­ç‚¹è¿˜æœªç”Ÿæ•ˆï¼Œéœ€è¦ç­‰å¾…ä¸€ä¼šå„¿ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180508/163525309.png?imageslim"></p><p>å¦‚æœæœ‰æ—¶å€™æ­»æ´»ä¹Ÿæ²¡æ³•æ–­ç‚¹ï¼Œå°±æŠŠæœåŠ¡å™¨ä¸Šçš„ Tomcat é‡å¯ä¸€ä¸‹è¯•è¯•ï¼</p><h2 id="ä¸ƒã€å…¶ä»–é—®é¢˜"><a href="#ä¸ƒã€å…¶ä»–é—®é¢˜" class="headerlink" title="ä¸ƒã€å…¶ä»–é—®é¢˜"></a>ä¸ƒã€å…¶ä»–é—®é¢˜</h2><p>å› ä¸ºåœ¨ catalina.sh ä¸­æ·»åŠ äº†è¿œç¨‹è°ƒè¯•çš„å‚æ•°ï¼Œå¯¼è‡´ä½¿ç”¨ tomcat çš„ bin/shutdown.sh æ—¶ï¼Œå¯èƒ½æ— æ³•å®Œå…¨åœæ­¢æœåŠ¡å™¨ã€‚å¯ä»¥ç›´æ¥ kill æ‰æœåŠ¡å™¨ï¼Œå¦‚æœä¸å†è¿›è¡Œè¿œç¨‹è°ƒè¯•ï¼Œæœ€åæŠŠè¿œç¨‹è°ƒè¯•å‚æ•°æ³¨é‡Šæ‰é‡å¯ã€‚</p><h2 id="å…«ã€é˜¿é‡Œäº‘-ECS-å®‰å…¨ç»„è®¾ç½®"><a href="#å…«ã€é˜¿é‡Œäº‘-ECS-å®‰å…¨ç»„è®¾ç½®" class="headerlink" title="å…«ã€é˜¿é‡Œäº‘ ECS å®‰å…¨ç»„è®¾ç½®"></a>å…«ã€é˜¿é‡Œäº‘ ECS å®‰å…¨ç»„è®¾ç½®</h2><p>è¿›å…¥ ECS æ§åˆ¶å°ï¼Œç‚¹å‡»å®‰å…¨ç»„</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180727/103855731.png?imageslim"></p><p>ç„¶åé€‰æ‹© åˆ›å»ºå®‰å…¨ç»„</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180727/104030559.png?imageslim"></p><p>ç„¶åé…ç½®è¯¥å®‰å…¨ç»„çš„è§„åˆ™</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180727/104112424.png?imageslim"></p><p><strong>ç‚¹å‡»å…¬ç½‘å…¥æ ‡ç­¾</strong>ï¼Œå†ç‚¹å‡»å³ä¸Šè§’ æ·»åŠ å®‰å…¨ç»„è§„åˆ™</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180727/104517431.png?imageslim"></p><p>æˆæƒå¯¹è±¡ å¡«å†™ä½ çš„ ip åœ°å€å³å¯ã€‚</p><p>æ·»åŠ å®Œå®‰å…¨ç»„ä¹‹åï¼Œè¿›å…¥ ECS å®ä¾‹</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180727/103740709.png?imageslim"></p><p>é€‰æ‹©å³ä¾§ åŠ å…¥å®‰å…¨ç»„ï¼Œé€‰æ‹©åŠ å…¥åˆšæ‰æ·»åŠ çš„å®‰å…¨ç»„å³å¯ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å·¥å…·ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Tomcatè¿œç¨‹è°ƒè¯•</tag>
      
      <tag>è§£å†³IDEAæ— æ³•è¿œç¨‹è°ƒè¯•Tomcat</tag>
      
      <tag>è§£å†³IDEAè¿œç¨‹è°ƒè¯•æ–­ç‚¹ä¸ç”Ÿæ•ˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¾®ä¿¡å…¬ä¼—å·å¼ºåˆ¶å…³æ³¨</title>
    <link href="/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E5%BC%BA%E5%88%B6%E5%85%B3%E6%B3%A8%E7%9A%84%E5%AE%9E%E7%8E%B0.html"/>
    <url>/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E5%BC%BA%E5%88%B6%E5%85%B3%E6%B3%A8%E7%9A%84%E5%AE%9E%E7%8E%B0.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¾®ä¿¡å®˜æ–¹è§„å®šæ˜¯ä¸å…è®¸è¯±å¯¼å…³æ³¨çš„ï¼Œæ‰€ä»¥å¼ºåˆ¶å…³æ³¨å°±æ›´åŠ ä¸å¯èƒ½çš„ï¼Œä½†æ˜¯é“é«˜ä¸€ä¸ˆé­”é«˜ä¸€ä¸ˆï¼Œæ€»æ˜¯æœ‰å„ç§å¯¹ç­–æ¥ç»•è¿‡è¿™äº›è§„å®šã€‚</p><p>æ¯”å¦‚ç¬”è€…æ‰€åœ¨çš„å…¬å¸è¡Œä¸šï¼Œæœ‰å…¬å¸å¼€å‘åŠŸèƒ½è¿›è¡Œæ¨å¹¿å°è¯´ï¼Œè®¿é—®æ¨å¹¿é“¾æ¥åï¼Œé˜…è¯»åˆ°æŸä¸€ç« æ—¶ï¼Œå¼¹å‡ºäºŒç»´ç æ‰èƒ½ç»§ç»­é˜…è¯»ï¼Œå…¶å®è¿™é‡Œå°±æ˜¯å˜ç›¸çš„å¾®ä¿¡å…¬ä¼—å·å¼ºåˆ¶å…³æ³¨äº†ã€‚å…³æ³¨ä»–çš„äºŒç»´ç ä¹‹åï¼Œå…¬ä¼—å·å°±ä¼šè‡ªåŠ¨å‘é€æ¶ˆæ¯ï¼Œç»™å‡ºç»§ç»­é˜…è¯»çš„é“¾æ¥åœ°å€ï¼Œè¯»è€…ç‚¹è¿›å»ä¹‹åæ‰å¯ä»¥æ¥ç€è¯»ã€‚</p><p>å…¶å®è¿™ä¸ªåŠŸèƒ½æˆ‘ä¹‹å‰ä¹Ÿå†™è¿‡ä¸€ç¯‡åšæ–‡ï¼Œ<a href="http://nullpointer.pw/%E5%9F%BA%E4%BA%8E%E5%BE%AE%E4%BF%A1%E4%BA%8B%E4%BB%B6%E4%BA%8C%E7%BB%B4%E7%A0%81%E6%8E%A8%E5%B9%BF.html">åŸºäºå¾®ä¿¡äº‹ä»¶äºŒç»´ç æ¨å¹¿</a>ï¼Œå®ç°çš„åŠŸèƒ½å°±å’Œä¸Šè¿°ä¸€è‡´ï¼Œä½†æ˜¯ï¼Œç”±äºä½¿ç”¨åˆ°äº†å¾®ä¿¡äº‹ä»¶äºŒç»´ç ï¼Œæ‰€ä»¥<strong>åªèƒ½ä½¿ç”¨å¾®ä¿¡çš„æœåŠ¡å·</strong>ï¼Œè€Œæ™®é€šçš„è®¢é˜…å·æ²¡æœ‰è¿™ä¸ªæ¥å£æƒé™ã€‚é‚£ä¹ˆè®¢é˜…å·æ€ä¹ˆå®ç°å‘¢ï¼Ÿä¹Ÿæ˜¯è¢«æˆ‘ç”Ÿç”Ÿæƒ³å‡ºäº†ä¸ªæ³•å­ï¼Œæ¥è¾¾åˆ°ç±»ä¼¼æœåŠ¡å·ä½¿ç”¨å‚æ•°äºŒç»´ç çš„æ•ˆæœï¼Œè€Œä¸”æœåŠ¡å·ä¸è®¢é˜…å·é€šç”¨ã€‚</p><a id="more"></a><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>å…¬å¸æ–°å¼€å‘äº†ä¸€ä¸ªåˆ†é”€å¹³å°é¡¹ç›®ï¼Œå¯ä»¥è®©å•†æˆ·å³ä¸ªäººå…¬ä¼—å·ä¸»æ‹¥æœ‰è‡ªå·±çš„å°è¯´ç½‘ç«™ï¼Œæ”¶å…¥ä¸å…¬å¸è¿›è¡Œåˆ†æˆï¼Œä»è€Œè¾¾åˆ°äº†åŒæ”¶çš„æ•ˆæœã€‚</p><p>å•†æˆ·ä¸ºäº†å¢åŠ ç²‰ä¸æ•°é‡ï¼Œäºæ˜¯æˆ‘ä»¬å¼€å‘äº†ä¸Šè¿°éœ€æ±‚çš„åŠŸèƒ½ã€‚ä½†æ˜¯è¿™äº›å•†æˆ·åŸºæœ¬ä¸Šéƒ½ç”¨çš„æ˜¯è®¢é˜…å·ï¼Œå‰æ–‡ä¹Ÿæåˆ°ï¼Œè®¢é˜…å·æ— æ³•ä½¿ç”¨å‚æ•°äºŒç»´ç æ¥å£ï¼Œæ‰€ä»¥åªèƒ½å¦è¾Ÿè¹Šå¾„ã€‚</p><h2 id="æµç¨‹å›¾"><a href="#æµç¨‹å›¾" class="headerlink" title="æµç¨‹å›¾"></a>æµç¨‹å›¾</h2><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180705/141232778.png?imageslim"></p><h2 id="æµç¨‹æ¢³ç†"><a href="#æµç¨‹æ¢³ç†" class="headerlink" title="æµç¨‹æ¢³ç†"></a>æµç¨‹æ¢³ç†</h2><p>é¦–å…ˆæˆ‘ä»¬åœ¨åå°é…ç½®å¾®ä¿¡äºŒç»´ç ï¼Œç„¶åé’ˆå¯¹æŸä¸€æœ¬å°è¯´ï¼ŒæŒ‡å®šå¼€å§‹ç« èŠ‚ä¸æ˜¾ç¤ºäºŒç»´ç ç« èŠ‚çš„ IDï¼Œç”Ÿæˆæ¨å¹¿é“¾æ¥ï¼Œå¦‚ä¸‹æ ¼å¼ï¼š<br><code>http://m.domain.com/link?code=7788</code>ï¼Œä»¥ä¸‹ç®€ç§° A é“¾æ¥ã€‚<br>ç„¶åå•†æˆ·å‘æ¨æ–‡ï¼Œè®¾ç½®é˜…è¯»åŸæ–‡çš„é“¾æ¥åœ°å€ä¸º A é“¾æ¥ã€‚</p><p>å½“ç”¨æˆ·è®¿é—®è¿™ä¸ª A é“¾æ¥çš„æ—¶å€™ï¼Œè·³è½¬é˜…è¯»é¡µï¼Œå¾…å…¶é˜…è¯»åˆ°äºŒç»´ç ç« èŠ‚æ—¶ï¼Œå°†äºŒç»´ç ç« èŠ‚çš„ä¸‹ä¸€ç« èŠ‚ ID å†™å…¥ Cookie ä¹‹ä¸­ï¼ŒåŒæ—¶å¼¹å‡ºäºŒç»´ç æç¤ºå…³æ³¨ã€‚</p><p>ç”¨æˆ·å…³æ³¨ï¼Œè§¦å‘äº†å¾®ä¿¡çš„ <strong>SUBSCRIBE</strong> äº‹ä»¶ï¼Œç»™ç”¨æˆ·å‘é€ç»§ç»­é˜…è¯»çš„æ¶ˆæ¯ï¼Œå¦‚ä¸‹æ ¼å¼ï¼š<br><code>http://m.domain.com/reading</code>ï¼Œä»¥ä¸‹ç®€ç§° B é“¾æ¥ï¼Œè¯¥é“¾æ¥æ˜¯å›ºå®šä¸å˜çš„ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180705/135619684.png?imageslim"></p><p>å¦‚æœç”¨æˆ·ç‚¹å‡»äº†è¯¥æ¶ˆæ¯ï¼Œåˆ™æ‰“å¼€äº† B é“¾æ¥ï¼Œè¯»å–ä¹‹å‰å­˜å‚¨çš„ Cookie ä¿¡æ¯ï¼Œå¾—åˆ°ç»§ç»­é˜…è¯»çš„ç« èŠ‚ IDï¼Œç„¶åç»„è£…é˜…è¯» URLï¼Œé€šè¿‡ redirect è·³è½¬å³å¯ã€‚ï¼ˆå¦‚æœç”¨æˆ·æ˜¯æ­£å¸¸å…³æ³¨ï¼Œä¹Ÿä¼šå‘é€æ¶ˆæ¯ï¼Œå¦‚æœç‚¹å‡»ï¼Œæ‰¾ä¸åˆ°è¯¥ Cookieï¼Œè·³è½¬é¦–é¡µå³å¯ï¼‰</p><p>è¿™æ˜¯é’ˆå¯¹å…¬å¸éœ€æ±‚å¼€å‘çš„ï¼Œå…¶å®ï¼Œä¸»è¦çš„åœ°æ–¹åœ¨äºå‚æ•°çš„ä¼ é€’ã€‚é™¤äº†å…³æ³¨äº‹ä»¶ï¼Œå¾®ä¿¡è¿˜æœ‰è®¸å¤šå…¶ä»–äº‹ä»¶å¯ä¾›ä½¿ç”¨ï¼Œæ¯”å¦‚èœå•ç‚¹å‡»äº‹ä»¶ï¼Œè‡³äºæ€ä¹ˆç”¨ï¼Œå°±çœ‹ä½ çš„äº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å¾®ä¿¡å¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¾®ä¿¡å…¬ä¼—å·å¼ºåˆ¶å…³æ³¨</tag>
      
      <tag>è®¢é˜…å·å‚æ•°äºŒç»´ç </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå®ç°æ’è¡Œæ¦œåŸºäºRedis</title>
    <link href="/Java%E5%AE%9E%E7%8E%B0%E6%8E%92%E8%A1%8C%E6%A6%9C%E5%9F%BA%E4%BA%8ERedis.html"/>
    <url>/Java%E5%AE%9E%E7%8E%B0%E6%8E%92%E8%A1%8C%E6%A6%9C%E5%9F%BA%E4%BA%8ERedis.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ’è¡Œæ¦œä½œä¸ºäº’è”ç½‘åº”ç”¨ä¸­å‡ ä¹å¿…ä¸å¯å°‘çš„ä¸€ä¸ªå…ƒç´ ï¼Œå…¶èƒ½å¤Ÿå‹¾èµ·äººç±»è‡ªèº«å¯¹æ¯”çš„æ¬²æœ›ï¼Œä»è€Œæ¥å¢åŠ å•†å“çš„é”€é‡ã€‚æ’è¡Œæ¦œçš„å®ç°æ–¹å¼åŸºæœ¬å¤§åŒå°å¼‚ï¼Œå¤§éƒ¨åˆ†éƒ½åŸºäº Redis çš„æœ‰åºé›†åˆ sorted set æ¥å®ç°ã€‚ä¸ä¹…å‰ï¼Œè´Ÿè´£å¼€å‘ä¸€ä¸ªæ´»åŠ¨ï¼Œå°±æœ‰æ’è¡Œæ¦œè¿™ä¸ªéœ€æ±‚ï¼Œç¬”è€…ä¹Ÿä½¿ç”¨ Redis è¿›è¡Œäº†å®ç°ã€‚æœ¬æ–‡é€šè¿‡äº†å•†å“é”€å”®æ’è¡Œæ¦œè¿™ä¸€æ¨¡å‹ï¼Œæ¥è¿›è¡Œæ¼”ç¤ºã€‚</p><h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><ol><li>æŒ‰ç…§å•†å“é”€é‡è¿›è¡Œæ’è¡Œ</li><li>å¯ä»¥è·å¾—æŒ‡å®šå•†å“çš„æ’å</li><li>æ˜¾ç¤ºå®æ—¶é”€å”®åŠ¨æ€æƒ…å†µ</li></ol><h2 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ"></a>éœ€æ±‚åˆ†æ</h2><p>åˆ†æéœ€æ±‚ï¼Œä»¥ä¸Šè¿™äº›éƒ½å¯ä»¥é€šè¿‡ Redis çš„æœ‰åºé›†åˆç›¸å…³å‘½ä»¤è¿›è¡Œå®ç°ï¼Œé¦–å…ˆçœ‹ä¸€ä¸‹ä½¿ç”¨åˆ°çš„å…·ä½“ Redis å‘½ä»¤ã€‚</p><figure class="highlight vala"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vala">redis&gt; ZADD bangdan <span class="hljs-number">1</span> <span class="hljs-string">&quot;one&quot;</span><br>(integer) <span class="hljs-number">1</span><br><span class="hljs-meta"># å¯¹æœ‰åºé›†åˆä¸­æŒ‡å®šæˆå‘˜çš„åˆ†æ•°åŠ ä¸Šå¢é‡</span><br><br>redis&gt; zadd bangdan <span class="hljs-number">1</span> <span class="hljs-string">&quot;one&quot;</span> <span class="hljs-number">4</span> <span class="hljs-string">&quot;three&quot;</span> <span class="hljs-number">3</span> <span class="hljs-string">&quot;two&quot;</span><br>(integer) <span class="hljs-number">2</span><br><span class="hljs-meta"># å°†ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ä»¥åŠåˆ†æ•°åŠ å…¥åˆ°æœ‰åºé›†åˆä¸­</span><br><br>redis&gt; zrange bangdan <span class="hljs-number">0</span> <span class="hljs-number">1</span><br><span class="hljs-number">1</span>) <span class="hljs-string">&quot;one&quot;</span><br><span class="hljs-number">2</span>) <span class="hljs-string">&quot;three&quot;</span><br><span class="hljs-meta"># æŒ‰ç…§ score å‡åºæ’åˆ— ,å–å‡ºå‰ä¸¤å</span><br><br>redis&gt; zscore bangdan three<br><span class="hljs-string">&quot;4&quot;</span><br><span class="hljs-meta"># è·å¾—æ¦œå•ä¸­æŒ‡å®šå…ƒç´ çš„score</span><br><br>redis&gt; zrank bangdan one<br>(integer) <span class="hljs-number">0</span><br><span class="hljs-meta"># åœ¨å‡åºæ¦œä¸­çš„åæ¬¡ ç¬¬ä¸€è¿”å›0</span><br><br><span class="hljs-meta"># ç¬¬ä¸‰ä¸ªéœ€æ±‚éœ€è¦ä½¿ç”¨ Redis çš„ list æ¥è¿›è¡Œå®ç°</span><br><br>redis&gt; LPUSH dynamic abc<br>(integer) <span class="hljs-number">1</span><br><span class="hljs-meta"># å‘é˜Ÿåˆ—å·¦ä¾§å¤´éƒ¨ push æ•°æ®</span><br><br>redis&gt; LINDEX dynamic <span class="hljs-number">0</span><br><span class="hljs-string">&quot;abc&quot;</span><br><span class="hljs-meta"># é€šè¿‡ç´¢å¼•è·å–åˆ—è¡¨ä¸­çš„å…ƒç´ </span><br><br>redis&gt; LTRIM dynamic <span class="hljs-number">0</span> <span class="hljs-number">2</span><br><span class="hljs-string">&quot;abc&quot;</span><br><span class="hljs-meta"># å¯¹ä¸€ä¸ªåˆ—è¡¨è¿›è¡Œä¿®å‰ª(trim)ï¼Œå°±æ˜¯è¯´ï¼Œè®©åˆ—è¡¨åªä¿ç•™æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ ï¼Œä¸åœ¨æŒ‡å®šåŒºé—´ä¹‹å†…çš„å…ƒç´ éƒ½å°†è¢«åˆ é™¤</span><br><br></code></pre></div></td></tr></table></figure><h2 id="æ’è¡Œæ¦œé¢„è§ˆ"><a href="#æ’è¡Œæ¦œé¢„è§ˆ" class="headerlink" title="æ’è¡Œæ¦œé¢„è§ˆ"></a>æ’è¡Œæ¦œé¢„è§ˆ</h2><p>æŒ‰ç…§éœ€æ±‚å¼€å‘ï¼Œæœ€åçš„æ•ˆæœå¦‚ä¸‹ï¼š  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180610152859148695744.png"></p><p>ä»¥ä¸‹é€šè¿‡ Java ä»£ç å®ç°ã€‚</p><h2 id="é€šè¿‡-Java-å®ç°æ’è¡Œæ¦œ"><a href="#é€šè¿‡-Java-å®ç°æ’è¡Œæ¦œ" class="headerlink" title="é€šè¿‡ Java å®ç°æ’è¡Œæ¦œ"></a>é€šè¿‡ Java å®ç°æ’è¡Œæ¦œ</h2><h3 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h3><p>é¡¹ç›®ä¸­ä½¿ç”¨åˆ°äº† Redisï¼Œå› æ­¤éœ€è¦å¼•å…¥ç›¸å…³ä¾èµ–ï¼Œä¸ºäº†ç®€æ˜æ¼”ç¤ºï¼Œè¿™é‡Œæ²¡æœ‰ä½¿ç”¨ JedisPoolã€‚</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>redis.clients<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jedis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.7.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h3 id="å¼€å‘é€»è¾‘"><a href="#å¼€å‘é€»è¾‘" class="headerlink" title="å¼€å‘é€»è¾‘"></a>å¼€å‘é€»è¾‘</h3><ol><li><p>é¡µé¢ä¸Šç‚¹å‡»ä¸€æ¬¡è´­ä¹°æŒ‰é’®ï¼Œåˆ™å¯¹è¯¥æ‰‹æœºçš„é”€é‡åŠ  1ï¼ŒåŒæ—¶å°†é”€å”®åŠ¨æ€æ·»åŠ åˆ°é˜Ÿåˆ—å½“ä¸­</p> <figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">jedis.zincrby(Constants.SALES_LIST, <span class="hljs-number">1</span>, String.valueOf(phoneId));<br>jedis.lpush(Constants.BUY_DYNAMIC, msg);<br></code></pre></div></td></tr></table></figure></li><li><p>è·å¾—æ’è¡Œæ¦œ</p> <figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">// æŒ‰ç…§scopeå‡åºæ’åï¼Œå–å‡ºå‰äº”</span><br>jedis.zrevrangeWithScores(Constants.SALES_LIST, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>);<br></code></pre></div></td></tr></table></figure></li><li><p>è·å¾—æŒ‡å®šæ‰‹æœºçš„æ’åæƒ…å†µ</p> <figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">jedis.zrevrank(Constants.SALES_LIST, String.valueOf(phoneId));<br></code></pre></div></td></tr></table></figure></li><li><p>è·å¾—é”€å”®åŠ¨æ€ï¼Œæ­¤å¤„åªå– 3 æ¡ï¼ŒåŒæ—¶é˜Ÿåˆ—åªä¿å­˜æœ€æ–°çš„ 20 æ¡åŠ¨æ€</p> <figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">List&lt;DynamicVO&gt; dynamicList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) &#123;<br>        String result = jedis.lindex(Constants.BUY_DYNAMIC, i);<br>        <span class="hljs-keyword">if</span> (StringUtils.isEmpty(result)) &#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        String[] arr = result.split(Constants.separator);<br>        <span class="hljs-keyword">long</span> time = Long.valueOf(arr[<span class="hljs-number">0</span>]);<br>        String phone = arr[<span class="hljs-number">1</span>];<br>        DynamicVO vo = <span class="hljs-keyword">new</span> DynamicVO();<br>        vo.setPhone(phone);<br>        vo.setTime(StringUtil.showTime(<span class="hljs-keyword">new</span> Date(time)));<br>        dynamicList.add(vo);<br>&#125;<br>jedis.ltrim(Constants.BUY_DYNAMIC, <span class="hljs-number">0</span>, <span class="hljs-number">19</span>);<br><br></code></pre></div></td></tr></table></figure></li><li><p>å› ä¸ºæ’è¡Œæ¦œè¿™ç§å®æ—¶æ€§æ¯”è¾ƒå¼ºçš„æ•°æ®ï¼Œæ›´æ–°æ¯”è¾ƒå¿«ï¼Œä¸ªäººè§‰å¾—æ²¡æœ‰å¿…è¦è¿›è¡ŒæŒä¹…åŒ–ï¼Œå¦‚æœ Redis çš„æ’è¡Œæ¦œæ•°æ®ä¸¢å¤±ï¼Œå¯ä»¥é€šè¿‡ä»£ç é‡æ–°è®¡ç®—æ’è¡Œï¼Œé€šè¿‡ zadd å‘½ä»¤ï¼Œé‡æ–°æ·»åŠ åˆ° Redis ä¸­å³å¯ã€‚</p> <figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">Map&lt;String, Double&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;&gt;();<br>    map.put(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-number">4.0</span>);<br>    map.put(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-number">2.0</span>);<br>    map.put(<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-number">3.0</span>);<br>jedis.zadd(Constants.SALES_LIST, map);<br></code></pre></div></td></tr></table></figure><h2 id="æºç ä¸‹è½½"><a href="#æºç ä¸‹è½½" class="headerlink" title="æºç ä¸‹è½½"></a>æºç ä¸‹è½½</h2><p><a href="https://github.com/Mosiki/RedisListExample">ç‚¹æˆ‘ä¸‹è½½</a></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redisæ’è¡Œæ¦œ</tag>
      
      <tag>Javaæ’è¡Œæ¦œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dom4jç”ŸæˆXML</title>
    <link href="/Dom4J%E7%94%9F%E6%88%90XML.html"/>
    <url>/Dom4J%E7%94%9F%E6%88%90XML.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨çœ‹æœ¬ç¯‡æ–‡ç« ä¹‹å‰ï¼Œå…ˆæ¢è®¨ä¸€ä¸‹å¸¸è§çš„ä¸¤ç§æ•°æ®æ ¼å¼ï¼Œä¸€ç§æ˜¯ JSONï¼Œå¦å¤–ä¸€ç§å°±æ˜¯ XMLï¼Œåœ¨æ—¥å¸¸å·¥ä½œä¸­ä¸å¯é¿å…åœ°éƒ½ä¼šå¯¹è¿™ä¸¤ç§æ•°æ®æ ¼å¼è¿›è¡Œæ¥è§¦ã€‚</p><p>JSON æ ¼å¼çµæ´»ï¼Œæœ‰å¤§é‡çš„æ”¯æŒåº“ï¼Œæ“ä½œèµ·æ¥æä¸ºæ–¹ä¾¿ï¼›è€Œ XML æ“ä½œèµ·æ¥å°±ä¸æ˜¯å¾ˆé¡ºæ‰‹äº†ã€‚ JSON æ ¼å¼çµæ´»çš„å°±ä¼šå¯¼è‡´ç»“æ„ä¸å¤Ÿç»Ÿä¸€è§„èŒƒï¼Œè€Œ XML æœ‰äº† XML Schema ä»¥åŠ DTD çº¦æŸè¿›è¡Œæ ¡éªŒï¼Œä¹Ÿå‡å°‘äº†æ•°æ®æ ¼å¼ä¸è§„èŒƒçš„é—®é¢˜ã€‚</p><p>å¯¹äºä»¥ä¸Šè¿™ç‚¹ï¼Œä¸ªäººæ˜¯æ·±æœ‰ä½“ä¼šï¼Œå› ä¸ºåœ¨å·¥ä½œä¸­éœ€è¦ç»å¸¸å’Œå…¶ä»–å…¬å¸çš„æŠ€æœ¯æ‰“äº¤é“ã€‚å…¬å¸åˆä½œæœ‰å†…å®¹è¾“å‡ºä»¥åŠå†…å®¹å¼•å…¥ä¸¤ç§ï¼Œå†…å®¹å¼•å…¥å°±æ˜¯å»æŠ“å–å…¶ä»–å…¬å¸çš„æˆæƒæ¥å£å†…å®¹ï¼Œæ–‡æ¡£åˆ¶å®šçš„æ•°æ®æ ¼å¼æ˜¯ JSON çš„ï¼Œä½†æ˜¯å¯èƒ½å¯¹æ–¹å‚ç…§æˆ‘æ–¹æ–‡æ¡£è¿›è¡Œæ¥å£å¼€å‘æ—¶ï¼Œä¼šå¿½ç•¥æ‰ä¸€äº›äº‹é¡¹ï¼Œæ¯”å¦‚æ•°æ®ç±»å‹ã€æ—¶é—´æ ¼å¼ç­‰ç­‰ï¼Œé€ æˆæˆ‘æ–¹æŠ“å–ä¹‹åï¼Œå‡ºç°é”™è¯¯çš„æƒ…å†µï¼›</p><p>è€Œåœ¨å’Œç™¾åº¦å†…å®¹è¾“å‡ºè¿›è¡Œæ¥å£å¯¹æ¥çš„æ—¶å€™ï¼Œç™¾åº¦éœ€è¦ XML æ ¼å¼çš„æ•°æ®ï¼Œå¦‚æœæˆ‘æ–¹æ¥å£ä¸­çš„æ•°æ®ä¸ç¬¦åˆå¯¹æ–¹çš„ XML çº¦æŸçš„è¯ï¼Œå¯¹æ–¹å°±èƒ½é©¬ä¸Šåœæ­¢æŠ“å–ï¼Œåé¦ˆé—®é¢˜ï¼Œç”±æ­¤é¿å…é”™è¯¯æƒ…å†µçš„å‘ç”Ÿã€‚</p><p>å¹³æ—¶ä¸ºäº†å›¾æ–¹ä¾¿ï¼Œå¾ˆå¤šæ¥å£éƒ½ä½¿ç”¨ JSONï¼Œå¯¹äº XML ä¹Ÿæ¯”è¾ƒç”Ÿç–ï¼Œä½†è¿˜æ˜¯ä¸å¯é¿å…æ¥è§¦åˆ°ä½¿ç”¨ï¼Œå¼€å‘è¿‡å¾®ä¿¡å…¬ä¼—å·çš„éƒ½çŸ¥é“ï¼Œå¾®ä¿¡æ¥å£åŸºæœ¬éƒ½ä½¿ç”¨çš„æ˜¯ XMLã€‚åœ¨å¼€å‘äº†å¾®ä¿¡å›¾æ–‡å›å¤ä¹‹åï¼Œéœ€è¦ç»„è£… XML å‘é€ç»™å¾®ä¿¡æœåŠ¡å™¨ï¼Œå¯èƒ½æœ‰äººè¯´ï¼Œé‚£ç”¨å­—ç¬¦ä¸²æ‹¼è£…ä¸ä¹Ÿæ˜¯å¯ä»¥çš„ä¹ˆï¼Œå¹²å˜›é‚£ä¹ˆéº»çƒ¦éè¦ç”¨ DOM4J å‘¢ï¼Ÿç¡®å®å…¬å¸ä¸­ä¸€äº›é¡¹ç›®çš„å¾®ä¿¡æ”¯ä»˜ï¼Œä¹Ÿä½¿ç”¨çš„æ˜¯å­—ç¬¦ä¸²æ‹¼æ¥ XML çš„æ–¹å¼ï¼Œä½†æ˜¯å¤šæŒæ¡ä¸€äº›æŠ€æœ¯ä¹Ÿå¹¶ä¸æ˜¯ä»€ä¹ˆåäº‹ï¼</p><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><p>é¦–å…ˆå¼•å…¥ dom4j ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.dom4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>dom4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>æ¥åˆ°éœ€æ±‚ï¼Œè¦æ±‚ç”¨æˆ·å‘é€ä½œå“åç§°ï¼Œè‡ªåŠ¨å›¾æ–‡å›å¤æœç´¢ç›¸å…³ä½œå“ï¼Œå¾®ä¿¡çš„æ¥å£æ˜¯è¿™æ ·çš„ï¼š  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180426/155812049.png?imageslim"></p><p>éœ€è¦çš„ XML æ–‡æ¡£æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">xml</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ToUserName</span>&gt;</span>&lt;![CDATA[toUser]]&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">ToUserName</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">FromUserName</span>&gt;</span>&lt;![CDATA[fromUser]]&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">FromUserName</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">CreateTime</span>&gt;</span>12345678<span class="hljs-tag">&lt;/<span class="hljs-name">CreateTime</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">MsgType</span>&gt;</span>&lt;![CDATA[news]]&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">MsgType</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">ArticleCount</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">ArticleCount</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Articles</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">item</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">Title</span>&gt;</span>&lt;![CDATA[title]]&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">Title</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">Description</span>&gt;</span>&lt;![CDATA[description]]&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">Description</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">PicUrl</span>&gt;</span>&lt;![CDATA[picurl]]&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">PicUrl</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">Url</span>&gt;</span>&lt;![CDATA[url]]&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">Url</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">item</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">Title</span>&gt;</span>&lt;![CDATA[title]]&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">Title</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">Description</span>&gt;</span>&lt;![CDATA[description]]&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">Description</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">PicUrl</span>&gt;</span>&lt;![CDATA[picurl]]&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">PicUrl</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">Url</span>&gt;</span>&lt;![CDATA[url]]&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">Url</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">item</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Articles</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">xml</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h2 id="éœ€æ±‚å®ç°"><a href="#éœ€æ±‚å®ç°" class="headerlink" title="éœ€æ±‚å®ç°"></a>éœ€æ±‚å®ç°</h2><p>å…¶å®è¿™ä¸ªæ¥å£ä¹Ÿå°±æ˜¯ç»„è£…æ•°æ®ï¼Œç„¶åå‘é€ç»™å¾®ä¿¡å°±å¯ä»¥äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br><br>    <span class="hljs-comment">// 1. åˆ›å»ºæ–‡æ¡£å¯¹è±¡</span><br>    Document doc = DocumentHelper.createDocument();<br><br>    <span class="hljs-comment">// 2. æ–°å¢æ ¹èŠ‚ç‚¹</span><br>    Element rootXML = doc.addElement(<span class="hljs-string">&quot;xml&quot;</span>);<br><br>    <span class="hljs-comment">// 3. å‘æ ¹èŠ‚ç‚¹æ·»åŠ å­èŠ‚ç‚¹</span><br>    rootXML.addElement(<span class="hljs-string">&quot;ToUserName&quot;</span>).addCDATA(<span class="hljs-string">&quot;toUser&quot;</span>);<br>    rootXML.addElement(<span class="hljs-string">&quot;FromUserName&quot;</span>).addCDATA(<span class="hljs-string">&quot;fromUser&quot;</span>);<br>    rootXML.addElement(<span class="hljs-string">&quot;CreateTime&quot;</span>).setText(<span class="hljs-string">&quot;12345678&quot;</span>);<br>    rootXML.addElement(<span class="hljs-string">&quot;MsgType&quot;</span>).addCDATA(<span class="hljs-string">&quot;news&quot;</span>);<br>    rootXML.addElement(<span class="hljs-string">&quot;ArticleCount&quot;</span>).setText(<span class="hljs-string">&quot;2&quot;</span>);<br><br>    <span class="hljs-comment">// åˆ›å»ºèŠ‚ç‚¹</span><br>    Element subElement = DocumentHelper.createElement(<span class="hljs-string">&quot;Articles&quot;</span>);<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">2</span>; i++) &#123;<br>        Element itemElement = DocumentHelper.createElement(<span class="hljs-string">&quot;item&quot;</span>);<br>        itemElement.addElement(<span class="hljs-string">&quot;Title&quot;</span>).addCDATA(<span class="hljs-string">&quot;title&quot;</span>);<br>        itemElement.addElement(<span class="hljs-string">&quot;Description&quot;</span>).addCDATA(<span class="hljs-string">&quot;description&quot;</span>);<br>        itemElement.addElement(<span class="hljs-string">&quot;PicUrl&quot;</span>).addCDATA(<span class="hljs-string">&quot;picurl&quot;</span>);<br>        itemElement.addElement(<span class="hljs-string">&quot;Url&quot;</span>).addCDATA(<span class="hljs-string">&quot;url&quot;</span>);<br>        subElement.add(itemElement);<br>    &#125;<br>    <span class="hljs-comment">// å‘æ ¹èŠ‚ç‚¹è¿½åŠ èŠ‚ç‚¹</span><br>    rootXML.add(subElement);<br><br>    <span class="hljs-comment">// 4. è¾“å‡ºxmlå­—ç¬¦ä¸²</span><br>    System.out.println(rootXML.asXML());<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>æœ€è¿‘åšå®¢æ–‡ç« éƒ½æ˜¯ä¸ªäººçš„æ€»ç»“æ€§æ–‡ç« ï¼Œæ²¡æœ‰æ¶‰åŠä»€ä¹ˆéš¾çš„æŠ€æœ¯ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼</p>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>XML ç”Ÿæˆ</tag>
      
      <tag>Dom4j</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jsonpathè§£æ</title>
    <link href="/jsonpath%E8%A7%A3%E6%9E%90.html"/>
    <url>/jsonpath%E8%A7%A3%E6%9E%90.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨å·¥ä½œä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°ä»ä¸€ä¸² JSON ä¸­æå–ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µçš„æƒ…å†µï¼Œå¸¸ç”¨çš„åšæ³•å°±æ˜¯å°†å…¶ååºåˆ—åŒ–ä¸º JSONObject å¯¹è±¡ï¼Œç„¶åä»å¯¹è±¡ä¸­è·å–ï¼Œå¦‚æœæ˜¯ JSONArray å°±è¿›è¡Œè¿­ä»£è·å–ï¼Œæ€»ä¹‹æ¯”è¾ƒéº»çƒ¦ã€‚å¯ä»¥ä½¿ç”¨ <strong>JsonPath</strong> å¿«é€Ÿæå–æ‰€éœ€ä¿¡æ¯ã€‚</p><a id="more"></a><h2 id="JSONPATH-ç®€æ˜è¯­æ³•"><a href="#JSONPATH-ç®€æ˜è¯­æ³•" class="headerlink" title="JSONPATH ç®€æ˜è¯­æ³•"></a>JSONPATH ç®€æ˜è¯­æ³•</h2><table><thead><tr><th align="center">JsonPath</th><th>æè¿°</th></tr></thead><tbody><tr><td align="center">$</td><td>æ ¹èŠ‚ç‚¹</td></tr><tr><td align="center">@</td><td>å½“å‰èŠ‚ç‚¹</td></tr><tr><td align="center">.or[]</td><td>å­èŠ‚ç‚¹</td></tr><tr><td align="center">..</td><td>é€‰æ‹©æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹</td></tr><tr><td align="center">*</td><td>æ‰€æœ‰èŠ‚ç‚¹</td></tr><tr><td align="center">[]</td><td>è¿­ä»£å™¨æ ‡ç¤ºï¼Œå¦‚æ•°ç»„ä¸‹æ ‡</td></tr><tr><td align="center">[,]</td><td>æ”¯æŒè¿­ä»£å™¨ä¸­åšå¤šé€‰</td></tr><tr><td align="center">[start:end:step]</td><td>æ•°ç»„åˆ‡ç‰‡è¿ç®—ç¬¦</td></tr><tr><td align="center">?()</td><td>æ”¯æŒè¿‡æ»¤æ“ä½œ</td></tr><tr><td align="center">()</td><td>æ”¯æŒè¡¨è¾¾å¼è®¡ç®—</td></tr></tbody></table><h2 id="å°è¯•-JsonPath-å‰æå‡†å¤‡"><a href="#å°è¯•-JsonPath-å‰æå‡†å¤‡" class="headerlink" title="å°è¯• JsonPath å‰æå‡†å¤‡"></a>å°è¯• JsonPath å‰æå‡†å¤‡</h2><p>maven å·¥ç¨‹å¼•å…¥ jsonpath çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.jayway.jsonpath<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>json-path<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.4.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>æœ‰äººè¯´ï¼ŒFastJson è‡ªå¸¦äº† JSONPathï¼Œä¸ºä»€ä¹ˆä¸ç”¨è¦ç”¨è¿™ä¸ªå‘¢ï¼Ÿæˆ‘åªèƒ½å› FastJson ç¡®å®å¾ˆå¥½ç”¨ï¼Œä½†æ˜¯ FastJson çš„ JsonPath æ˜¯çœŸéš¾ç”¨ï¼</p><h2 id="JsonPath-ç®€å•å…¥é—¨ç‰ˆ"><a href="#JsonPath-ç®€å•å…¥é—¨ç‰ˆ" class="headerlink" title="JsonPath ç®€å•å…¥é—¨ç‰ˆ"></a>JsonPath ç®€å•å…¥é—¨ç‰ˆ</h2><p>ç»™å®šä¸€ä¸² JSON å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;store&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;book&quot;</span>: [<br>      &#123;<br>        <span class="hljs-attr">&quot;category&quot;</span>: <span class="hljs-string">&quot;æ–‡å­¦&quot;</span>,<br>        <span class="hljs-attr">&quot;author&quot;</span>: <span class="hljs-string">&quot;æ›¹é›ªèŠ¹&quot;</span>,<br>        <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;çº¢æ¥¼æ¢¦&quot;</span>,<br>        <span class="hljs-attr">&quot;price&quot;</span>: <span class="hljs-number">47.20</span><br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">&quot;category&quot;</span>: <span class="hljs-string">&quot;å¿ƒç†&quot;</span>,<br>        <span class="hljs-attr">&quot;author&quot;</span>: <span class="hljs-string">&quot;å‡¯åˆ©Â·éº¦æ ¼å°¼æ ¼å°”&quot;</span>,<br>        <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;è‡ªæ§åŠ›&quot;</span>,<br>        <span class="hljs-attr">&quot;price&quot;</span>: <span class="hljs-number">30.20</span><br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">&quot;category&quot;</span>: <span class="hljs-string">&quot;åŠ±å¿—&quot;</span>,<br>        <span class="hljs-attr">&quot;author&quot;</span>: <span class="hljs-string">&quot;å²è’‚èŠ¬Â·æŸ¯ç»´&quot;</span>,<br>        <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;é«˜æ•ˆèƒ½äººå£«çš„ä¸ƒä¸ªä¹ æƒ¯&quot;</span>,<br>        <span class="hljs-attr">&quot;isbn&quot;</span>: <span class="hljs-string">&quot;7515326395&quot;</span>,<br>        <span class="hljs-attr">&quot;price&quot;</span>: <span class="hljs-number">51</span><br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">&quot;category&quot;</span>: <span class="hljs-string">&quot;å°è¯´&quot;</span>,<br>        <span class="hljs-attr">&quot;author&quot;</span>: <span class="hljs-string">&quot;æ¯›å§†&quot;</span>,<br>        <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;æœˆäº®ä¸å…­ä¾¿å£«&quot;</span>,<br>        <span class="hljs-attr">&quot;isbn&quot;</span>: <span class="hljs-string">&quot;7533936027&quot;</span>,<br>        <span class="hljs-attr">&quot;price&quot;</span>: <span class="hljs-number">19.50</span><br>      &#125;<br>    ],<br>    <span class="hljs-attr">&quot;bicycle&quot;</span>: &#123;<br>      <span class="hljs-attr">&quot;color&quot;</span>: <span class="hljs-string">&quot;red&quot;</span>,<br>      <span class="hljs-attr">&quot;price&quot;</span>: <span class="hljs-number">19.95</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>éœ€è¦æŒ‰ç…§æ¡ä»¶æå–ä¿¡æ¯</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JsonPathExample</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-comment">// è¯»å–ä¸Šé¢çš„é‚£ä¸² JSON </span><br>        File file = <span class="hljs-keyword">new</span> File(JsonPathExample.class.getClassLoader().getResource(<span class="hljs-string">&quot;store.json&quot;</span>).getPath());<br>        String storeJson = FileUtils.readFileToString(file);<br>        <br>        <span class="hljs-comment">// æ³¨æ„ä½¿ç”¨ JsonPath ï¼Œä¸è¦ä½¿ç”¨ FastJson çš„ JSONPath</span><br>        <span class="hljs-comment">// è¾“å‡ºç¬¬ä¸€æœ¬ä¹¦çš„ä½œè€…</span><br>        println(JsonPath.read(storeJson, <span class="hljs-string">&quot;$.store.book[0].author&quot;</span>).toString());<br>        <span class="hljs-comment">// è¾“å‡ºç»“æœï¼š æ›¹é›ªèŠ¹</span><br><br>        <span class="hljs-comment">// è¾“å‡ºæ‰€æœ‰ä¹¦çš„ä½œè€…</span><br>        println(JsonPath.read(storeJson, <span class="hljs-string">&quot;$.store.book[*].author&quot;</span>).toString());<br>        <span class="hljs-comment">// è¾“å‡ºç»“æœï¼š [&quot;æ›¹é›ªèŠ¹&quot;,&quot;å‡¯åˆ©Â·éº¦æ ¼å°¼æ ¼å°”&quot;,&quot;å²è’‚èŠ¬Â·æŸ¯ç»´&quot;,&quot;æ¯›å§†&quot;]</span><br><br>        <span class="hljs-comment">// è¾“å‡ºåˆ†ç±»ä¸ºæ–‡å­¦çš„ä¹¦ä¿¡æ¯</span><br>        println(JsonPath.read(storeJson, <span class="hljs-string">&quot;$.store.book[?(@.category ==&#x27;æ–‡å­¦&#x27;)]&quot;</span>).toString());<br>        <span class="hljs-comment">// è¾“å‡ºç»“æœï¼š [&#123;&quot;author&quot;:&quot;æ›¹é›ªèŠ¹&quot;,&quot;price&quot;:47.2,&quot;category&quot;:&quot;æ–‡å­¦&quot;,&quot;title&quot;:&quot;çº¢æ¥¼æ¢¦&quot;&#125;]</span><br><br>        <span class="hljs-comment">// è¾“å‡ºä»·æ ¼å¤§äº 50 çš„ä¹¦</span><br>        println(JsonPath.read(storeJson, <span class="hljs-string">&quot;$.store.book[?(@.price &gt; 50)]&quot;</span>).toString());<br>        <span class="hljs-comment">// è¾“å‡ºç»“æœ: [&#123;&quot;author&quot;:&quot;å²è’‚èŠ¬Â·æŸ¯ç»´&quot;,&quot;price&quot;:51,&quot;isbn&quot;:&quot;7515326395&quot;,&quot;category&quot;:&quot;åŠ±å¿—&quot;,&quot;title&quot;:&quot;é«˜æ•ˆèƒ½äººå£«çš„ä¸ƒä¸ªä¹ æƒ¯&quot;&#125;]</span><br><br>        <span class="hljs-comment">// è¾“å‡º book[*] ä¸­åŒ…å« isbn çš„ä¹¦</span><br>        println(JsonPath.read(storeJson, <span class="hljs-string">&quot;$.store.book[?(@.isbn)]&quot;</span>).toString());<br>        <span class="hljs-comment">// è¾“å‡ºç»“æœ: [&#123;&quot;author&quot;:&quot;å²è’‚èŠ¬Â·æŸ¯ç»´&quot;,&quot;price&quot;:51,&quot;isbn&quot;:&quot;7515326395&quot;,&quot;category&quot;:&quot;åŠ±å¿—&quot;,&quot;title&quot;:&quot;é«˜æ•ˆèƒ½äººå£«çš„ä¸ƒä¸ªä¹ æƒ¯&quot;&#125;,&#123;&quot;author&quot;:&quot;æ¯›å§†&quot;,&quot;price&quot;:19.5,&quot;isbn&quot;:&quot;7533936027&quot;,&quot;category&quot;:&quot;å°è¯´&quot;,&quot;title&quot;:&quot;æœˆäº®ä¸å…­ä¾¿å£«&quot;&#125;]</span><br><br>        <span class="hljs-comment">// è¾“å‡º json ä¸­æ‰€æœ‰çš„ price</span><br>        println(JsonPath.read(storeJson, <span class="hljs-string">&quot;$..price&quot;</span>).toString());<br>        <span class="hljs-comment">// è¾“å‡ºç»“æœ: [19.95,47.2,30.2,51,19.5]</span><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">println</span><span class="hljs-params">(String str)</span> </span>&#123;<br>        System.out.println(str);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä»¥ä¸ŠåŸºæœ¬ä¸Šï¼Œç®€å•æå–éœ€è¦ JSON ä¸­çš„ä¿¡æ¯ä¾¿å·²ç»è¶³å¤Ÿäº†ï¼Œä»¥ä¸‹ä¸ºæ‰©å±•å†…å®¹ï¼Œä¹Ÿæ˜¯æˆ‘åœ¨å·¥ä½œä¸­ä½¿ç”¨åˆ°çš„ã€‚</p><h2 id="JsonPath-å¤æ‚ç»“æ„ç‰ˆ"><a href="#JsonPath-å¤æ‚ç»“æ„ç‰ˆ" class="headerlink" title="JsonPath å¤æ‚ç»“æ„ç‰ˆ"></a>JsonPath å¤æ‚ç»“æ„ç‰ˆ</h2><p>ç»™å®šä¸€ä¸² JSON å¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;bookId&quot;</span>: <span class="hljs-number">7333</span>,<br>  <span class="hljs-attr">&quot;volumeDetailList&quot;</span>: [<br>    &#123;<br>      <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;å·ä¸€ æ¢å¼˜ä¸–ç•Œ&quot;</span>,<br>      <span class="hljs-attr">&quot;volumeId&quot;</span>: <span class="hljs-number">28585</span>,<br>      <span class="hljs-attr">&quot;chapterDetailList&quot;</span>: [<br>        &#123;<br>          <span class="hljs-attr">&quot;chapterId&quot;</span>: <span class="hljs-number">11719110</span>,<br>          <span class="hljs-attr">&quot;free&quot;</span>: <span class="hljs-literal">true</span>,<br>          <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;ç¬¬1ç«  ä¸Šä¹å¤©&quot;</span>,<br>          <span class="hljs-attr">&quot;price&quot;</span>: <span class="hljs-number">0</span>,<br>          <span class="hljs-attr">&quot;words&quot;</span>: <span class="hljs-number">1678</span>,<br>          <span class="hljs-attr">&quot;contentId&quot;</span>: <span class="hljs-number">2930434</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;chapterId&quot;</span>: <span class="hljs-number">1719111</span>,<br>          <span class="hljs-attr">&quot;free&quot;</span>: <span class="hljs-literal">true</span>,<br>          <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;ç¬¬2ç« ï¼šæ½æœˆ&quot;</span>,<br>          <span class="hljs-attr">&quot;price&quot;</span>: <span class="hljs-number">0</span>,<br>          <span class="hljs-attr">&quot;words&quot;</span>: <span class="hljs-number">2390</span>,<br>          <span class="hljs-attr">&quot;contentId&quot;</span>: <span class="hljs-number">2930444</span><br>        &#125;<br>      ]<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;å·äºŒ åœ¨äººå®¶&quot;</span>,<br>      <span class="hljs-attr">&quot;volumeId&quot;</span>: <span class="hljs-number">285852</span>,<br>      <span class="hljs-attr">&quot;chapterDetailList&quot;</span>: [<br>        &#123;<br>          <span class="hljs-attr">&quot;chapterId&quot;</span>: <span class="hljs-number">1719120</span>,<br>          <span class="hljs-attr">&quot;free&quot;</span>: <span class="hljs-literal">false</span>,<br>          <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;ç¬¬3ç« ï¼šåƒå¹´åä¹‹å§‹&quot;</span>,<br>          <span class="hljs-attr">&quot;price&quot;</span>: <span class="hljs-number">19</span>,<br>          <span class="hljs-attr">&quot;words&quot;</span>: <span class="hljs-number">2989</span>,<br>          <span class="hljs-attr">&quot;contentId&quot;</span>: <span class="hljs-number">29540933</span><br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">&quot;chapterId&quot;</span>: <span class="hljs-number">17133111</span>,<br>          <span class="hljs-attr">&quot;free&quot;</span>: <span class="hljs-literal">false</span>,<br>          <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;ç¬¬4ç« ï¼šç ´å†°è€Œç”Ÿ&quot;</span>,<br>          <span class="hljs-attr">&quot;price&quot;</span>: <span class="hljs-number">30</span>,<br>          <span class="hljs-attr">&quot;words&quot;</span>: <span class="hljs-number">3409</span>,<br>          <span class="hljs-attr">&quot;contentId&quot;</span>: <span class="hljs-number">29540988</span><br>        &#125;<br>      ]<br>    &#125;<br>  ]<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¯»å–éœ€è¦çš„ç›¸å…³ä¿¡æ¯</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JsonPathExample2</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-comment">// ç”¨äºè¯»å–ä¸Šé¢çš„é‚£ä¸² JSON</span><br>        File file = <span class="hljs-keyword">new</span> File(JsonPathExample2.class.getClassLoader().getResource(<span class="hljs-string">&quot;chapterlist.json&quot;</span>).getPath());<br>        String chapterlistJson = FileUtils.readFileToString(file);<br><br>        <span class="hljs-comment">// å¾—åˆ°ä¹¦çš„æ‰€æœ‰å·åç§°</span><br>        println(JsonPath.read(chapterlistJson, <span class="hljs-string">&quot;$..title&quot;</span>).toString());<br>        <span class="hljs-comment">// è¾“å‡ºç»“æœ: [&quot;å·ä¸€ æ¢å¼˜ä¸–ç•Œ&quot;,&quot;å·äºŒ åœ¨äººå®¶&quot;]</span><br><br>        <span class="hljs-comment">// å¾—åˆ°ä¹¦çš„æ‰€æœ‰ç« èŠ‚åç§°</span><br>        println(JsonPath.read(chapterlistJson, <span class="hljs-string">&quot;$..name&quot;</span>).toString());<br>        <span class="hljs-comment">// è¾“å‡ºç»“æœ: [&quot;ç¬¬1ç«  ä¸Šä¹å¤©&quot;,&quot;ç¬¬2ç« ï¼šæ½æœˆ&quot;,&quot;ç¬¬3ç« ï¼šåƒå¹´åä¹‹å§‹&quot;,&quot;ç¬¬4ç« ï¼šç ´å†°è€Œç”Ÿ&quot;]</span><br><br>        <span class="hljs-comment">// ä¸Šé¢ä¸¤ä¸ªéå¸¸ç®€å•ï¼Œä¸‹é¢è¿™ä¸ªéœ€è¦æ³¨æ„ volumeDetailList ä¸ chapterDetailList éƒ½æ˜¯æ•°ç»„ï¼Œä¸”æ˜¯æ•°ç»„åµŒå¥—</span><br>        <span class="hljs-comment">// å¾—åˆ° chapterId ä¸º 17133111 çš„ contentId</span><br>        println(JsonPath.read(chapterlistJson, <span class="hljs-string">&quot;$.volumeDetailList[*].chapterDetailList[?(@.chapterId == &#x27;17133111&#x27;)].contentId&quot;</span>).toString());<br>        <span class="hljs-comment">// ç®€åŒ–å†™æ³•</span><br>        println(JsonPath.read(chapterlistJson, <span class="hljs-string">&quot;$..[?(@.chapterId == &#x27;17133111&#x27;)].contentId&quot;</span>).toString());<br>        <span class="hljs-comment">// è¾“å‡ºç»“æœ: 29540988</span><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">println</span><span class="hljs-params">(String str)</span> </span>&#123;<br>        System.out.println(str);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="å¸¸ç”¨JsonPathåœ¨çº¿è§£æå·¥å…·ç½‘ç«™"><a href="#å¸¸ç”¨JsonPathåœ¨çº¿è§£æå·¥å…·ç½‘ç«™" class="headerlink" title="å¸¸ç”¨JsonPathåœ¨çº¿è§£æå·¥å…·ç½‘ç«™"></a>å¸¸ç”¨JsonPathåœ¨çº¿è§£æå·¥å…·ç½‘ç«™</h2><ul><li><a href="http://jsonpath.com/">http://jsonpath.com/</a></li><li><a href="http://jsonpath.herokuapp.com/">http://jsonpath.herokuapp.com/</a></li></ul><p>è¿™ä¸¤ä¸ªç½‘ç«™éƒ½å¯ä»¥åœ¨çº¿å†™ JsonPath è¯­å¥ï¼Œå¯ä»¥ç”¨æ¥æ ¡éªŒå†™çš„æ˜¯å¦æ­£ç¡®è€Œä¸ç”¨å»è·‘ä»£ç ç¨‹åºï¼Œæ¯”è¾ƒæ–¹ä¾¿</p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><ul><li><a href="http://goessner.net/articles/JsonPath/">http://goessner.net/articles/JsonPath/</a></li><li><a href="https://www.cnblogs.com/weilunhui/p/3857366.html">https://www.cnblogs.com/weilunhui/p/3857366.html</a></li></ul><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>åœ¨å·¥ä½œä¸­ä½¿ç”¨åˆ°çš„æ—¶å€™ï¼Œä¹Ÿä¸ç†Ÿæ‚‰ JsonPath çš„è¯­æ³•ï¼Œå†™å‡ºäº†æ¯”è¾ƒå¤æ‚çš„ JsonPathï¼Œä½†æ˜¯åœ¨å†™è¿™ç¯‡åšå®¢çš„æ—¶å€™ï¼Œåˆå†™äº†ä¸€èˆ¬ï¼Œå‘ç°äº†æœ‰å¾ˆå¤šè‡ªå·±å†™çš„ JsonPath è¯­å¥æ˜¯å¯ä»¥ç²¾ç®€çš„ï¼Œæ¯”å¦‚å€’æ•°ç¬¬äºŒæ¡ JsonPath è¯­å¥å¯ä»¥ç²¾ç®€ä¸ºå®ƒä¸‹é¢é‚£å¥ã€‚</p><p>åœ¨è¾“å‡ºçš„æ—¶å€™ï¼Œå¯ä»¥å‘ç°è‡ªå·±è®¤çŸ¥ä¸­ä¸è¶³ä¹‹å¤„ï¼Œå†™åšå®¢è¿˜æ˜¯èƒ½ç»™è‡ªå·±å¸¦æ¥å¾ˆå¤šå¥½å¤„çš„ï¼Œå¸Œæœ›è‡ªå·±èƒ½å¤Ÿç¬”è€•ä¸æ¯~</p>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JSONPathè§£æ</tag>
      
      <tag>JSONPathåœ¨çº¿è§£æ</tag>
      
      <tag>JSONPathå¤šå±‚åµŒå¥—è§£æ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è§£å†³WebMagicæŠ“HTTPSæ—¶å‡ºç°SSLException</title>
    <link href="/%E8%A7%A3%E5%86%B3WebMagic%E6%8A%93HTTPS%E6%97%B6%E5%87%BA%E7%8E%B0SSLException.html"/>
    <url>/%E8%A7%A3%E5%86%B3WebMagic%E6%8A%93HTTPS%E6%97%B6%E5%87%BA%E7%8E%B0SSLException.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨ä»Šå¹´äºŒæœˆä»½åœ¨é¡¹ç›®ä¸­å¼•å…¥äº† <strong>WebMagic</strong> æŠ€æœ¯ï¼Œç”¨æ¥æŠ“å–åˆä½œæ–¹çš„ä¹¦ç±ï¼Œè¯¦è§ä¹‹å‰æ–‡ç« ï¼š<a href="http://nullpointer.pw/WebMagic%E4%B9%8B%E7%88%AC%E8%99%AB%E7%9B%91%E6%8E%A7.html">WebMagicä¹‹çˆ¬è™«ç›‘æ§</a>ï¼Œè¿™ä¸¤å¤©æ–°æ¥å…¥äº†ä¸€ä¸ªåˆä½œå•†ï¼Œå¯¹æ–¹æ¥å£é‡‡å–çš„æ˜¯ HTTPS åè®®ï¼Œè€Œä»¥å‰åˆä½œå•†çš„æ¥å£å…¨éƒ½æ˜¯ HTTP çš„ï¼Œåœ¨æ¥å…¥è¿™å®¶åˆä½œå•†çš„æ—¶å€™ï¼Œå‘ç°äº†é—®é¢˜ï¼Œåªè¦æ˜¯ HTTPS çš„ URL å…¨éƒ¨æ— æ³•çˆ¬å–ã€‚</p><a id="more"></a><h2 id="ä¸€ã€é—®é¢˜å¤ç°"><a href="#ä¸€ã€é—®é¢˜å¤ç°" class="headerlink" title="ä¸€ã€é—®é¢˜å¤ç°"></a>ä¸€ã€é—®é¢˜å¤ç°</h2><p>åœ¨ WebMagic-core åŒ…ä¸­ï¼Œ<code>us.codecraft.webmagic.processor.example.GithubRepoPageProcessor</code> è¿™ä¸ªåŒ…ä¸‹é¢æ˜¯ä½œè€…æ”¾çš„ç¤ºä¾‹ä»£ç ï¼Œæ‹·è´è¿™ä¸ªç±»ä»£ç åˆ°æ–°å»ºçš„ç±»ä¸­ï¼Œå³é”®è¿è¡Œè¿™ä¸ªç±»ï¼Œè¿è¡Œåæ§åˆ¶å°æŠ¥å‡ºé”™è¯¯ï¼š<br><code>[WARN ] 2018-05-12 13:28:11,828 download page https://github.com/code4craft error [us.codecraft.webmagic.downloader.HttpClientDownloader.download(HttpClientDownloader.java:91)]</code></p><p>è¿›å…¥è¿™ä¸ªç±»ï¼Œå®šä½åˆ° <strong>HttpClientDownloader</strong> æºä»£ç  85 è¡Œ</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> Page <span class="hljs-title">download</span><span class="hljs-params">(Request request, Task task)</span> </span>&#123;<br>    ......<br>    <span class="hljs-keyword">try</span> &#123;<br>        httpResponse = httpClient.execute(requestContext.getHttpUriRequest(), requestContext.getHttpClientContext());<br>        page = handleResponse(request, task.getSite().getCharset(), httpResponse, task);<br>        onSuccess(request);<br>        logger.info(<span class="hljs-string">&quot;downloading page success &#123;&#125;&quot;</span>, request.getUrl());<br>        <span class="hljs-keyword">return</span> page;<br>    &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>        logger.warn(<span class="hljs-string">&quot;download page &#123;&#125; error&quot;</span>, request.getUrl(), e);<br>        onError(request);<br>        <span class="hljs-keyword">return</span> page;<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>      ...<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>åœ¨ 85 è¡Œæ­¤å¤„æ–­ç‚¹ Debug è¿è¡Œï¼Œå‘ç°æ­¤è¡ŒæŠ›å‡ºäº† SSLException å¼‚å¸¸ã€‚å¼‚å¸¸çš„å†…å®¹æ˜¯ï¼š<br><code>javax.net.ssl.SSLException: Received fatal alert: protocol_version</code></p><h2 id="äºŒã€è§£å†³é—®é¢˜æ–¹æ³•ï¼ˆä¸€ï¼‰"><a href="#äºŒã€è§£å†³é—®é¢˜æ–¹æ³•ï¼ˆä¸€ï¼‰" class="headerlink" title="äºŒã€è§£å†³é—®é¢˜æ–¹æ³•ï¼ˆä¸€ï¼‰"></a>äºŒã€è§£å†³é—®é¢˜æ–¹æ³•ï¼ˆä¸€ï¼‰</h2><p>å‡ºç°å¼‚å¸¸åï¼Œé€šè¿‡ Google æœç´¢äº†ä¸€ä¸‹ï¼Œæ‰¾åˆ°äº† WebMagic ä½œè€…é»„å¤§çš„è§£å†³æ–¹å¼ï¼Œè¯¦è§ <a href="https://github.com/code4craft/webmagic/issues/701">Httpsä¸‹æ— æ³•æŠ“å–åªæ”¯æŒTLS1.2çš„ç«™ç‚¹</a></p><p>äºæ˜¯æŒ‰ç…§é»„å¤§è¯´çš„æ–¹å¼æ¥åš</p><ol><li><p>é¦–å…ˆå¤åˆ¶æºç ä¸­çš„ <strong>HttpClientGenerator</strong> ä¸ <strong>HttpClientDownloader</strong> åˆ°è‡ªå·±çš„é¡¹ç›®ä¸­ã€‚</p></li><li><p>ä¿®æ”¹ <strong>HttpClientGenerator</strong> çš„ä»£ç ï¼Œåªéœ€è¦ä¿®æ”¹ <strong>buildSSLConnectionSocketFactory</strong> è¿™ä¸ªæ–¹æ³•ä¸ºå¦‚ä¸‹å³å¯ã€‚    </p> <figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">    ...<br><span class="hljs-function"><span class="hljs-keyword">private</span> SSLConnectionSocketFactory <span class="hljs-title">buildSSLConnectionSocketFactory</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> SSLConnectionSocketFactory(createIgnoreVerifySSL(), <span class="hljs-keyword">new</span> String[]&#123;<span class="hljs-string">&quot;SSLv3&quot;</span>, <span class="hljs-string">&quot;TLSv1&quot;</span>, <span class="hljs-string">&quot;TLSv1.1&quot;</span>, <span class="hljs-string">&quot;TLSv1.2&quot;</span>&#125;,<br>                <span class="hljs-keyword">null</span>,<br>                <span class="hljs-keyword">new</span> DefaultHostnameVerifier()); <span class="hljs-comment">// ä¼˜å…ˆç»•è¿‡å®‰å…¨è¯ä¹¦</span><br>&#125; <span class="hljs-keyword">catch</span> (KeyManagementException e) &#123;<br>        logger.error(<span class="hljs-string">&quot;ssl connection fail&quot;</span>, e);<br>    &#125; <span class="hljs-keyword">catch</span> (NoSuchAlgorithmException e) &#123;<br>        logger.error(<span class="hljs-string">&quot;ssl connection fail&quot;</span>, e);<br>    &#125;<br><span class="hljs-keyword">return</span> SSLConnectionSocketFactory.getSocketFactory();<br>&#125;<br>...<br></code></pre></div></td></tr></table></figure><p> <strong>æ³¨æ„ï¼š</strong> DefaultHostnameVerifier éœ€è¦ä½¿ç”¨ **<code>org.apache.http.conn.ssl.DefaultHostnameVerifier</code>**ï¼Œè€Œä¸è¦ä½¿ç”¨ <del><code>sun.net.www.protocol.https.DefaultHostnameVerifier</code></del> </p></li><li><p>ä¿®æ”¹ <strong>HttpClientDownloader</strong> ä¸­å¼•ç”¨çš„ <strong>HttpClientGenerator</strong> ä¸ºä½ ä¿®æ”¹åçš„ç±»ã€‚</p></li><li><p>è®¾ç½®çˆ¬è™« Spider çš„ Downloader ä¸º ä½ ä¿®æ”¹çš„ <strong>HttpClientDownloader</strong>ã€‚  </p> <figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">Spider.create(<span class="hljs-keyword">new</span> GithubRepoPageProcessor()).setDownloader(<span class="hljs-keyword">new</span> HttpClientDownloader()).addUrl(<span class="hljs-string">&quot;https://github.com/code4craft&quot;</span>).thread(<span class="hljs-number">5</span>).run();<br></code></pre></div></td></tr></table></figure></li><li><p>è¿è¡Œåï¼Œå‘ç°æ§åˆ¶å°å·²ç»å¯ä»¥æ­£å¸¸è¾“å‡ºæ‰€æŠ“å–ç½‘é¡µçš„å†…å®¹äº†</p></li></ol><h2 id="ä¸‰ã€è§£å†³é—®é¢˜æ–¹æ³•ï¼ˆäºŒï¼‰"><a href="#ä¸‰ã€è§£å†³é—®é¢˜æ–¹æ³•ï¼ˆäºŒï¼‰" class="headerlink" title="ä¸‰ã€è§£å†³é—®é¢˜æ–¹æ³•ï¼ˆäºŒï¼‰"></a>ä¸‰ã€è§£å†³é—®é¢˜æ–¹æ³•ï¼ˆäºŒï¼‰</h2><p>æ—¢ç„¶å¯¹æ–¹æ¥å£åœ°å€æ˜¯ HTTPS çš„ï¼Œé‚£æˆ‘ä»¬è®¿é—®ä»–çš„ HTTP æ¥å£ä¸å°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜äº†ä¹ˆï¼Ÿä½†æ˜¯äº‹å®æ˜¯ï¼Œè®¿é—®å¯¹æ–¹ HTTP æ¥å£æ—¶ï¼Œä¼šè‡ªåŠ¨è·³è½¬åˆ° HTTPS ç½‘å€ï¼Œæ‰€ä»¥è¿™æ¡è·¯è¡Œä¸é€šã€‚è¿™æ—¶æˆ‘å¿½ç„¶æƒ³åˆ°ï¼Œä¹‹å‰ä½¿ç”¨ Nginx è§£å†³å‰ç«¯è·¨åŸŸçš„æ–¹æ³•ï¼Œä½¿ç”¨æˆ‘æ–¹çš„ HTTP åŸŸåï¼Œåå‘ä»£ç†åˆ°å¯¹æ–¹çš„ HTTPS ç½‘å€æ˜¯ä¸æ˜¯å°±è§£å†³äº†é—®é¢˜å‘¢ï¼Ÿäºæ˜¯å¯¹ Nginx è¿›è¡Œé…ç½®ã€‚  </p><figure class="highlight plain"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs conf">server &#123;<br>    listen       80;<br>    server_name  partner.domain.com;<br><br>      location &#x2F; &#123;<br>          proxy_set_header Host github.com;<br>          proxy_pass https:&#x2F;&#x2F;github.com&#x2F;;<br>      &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¯åŠ¨/é‡å¯ Nginxï¼Œå°†çˆ¬è™«çš„åœ°å€ç”± <strong><code>https://github.com/code4craft</code></strong> ä¿®æ”¹ä¸º **<code>http://partner.domain.com/code4craft</code>**ï¼Œä½¿ç”¨ WebMagic é»˜è®¤çš„ Downloaderï¼Œå¯åŠ¨çˆ¬è™«  </p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GithubRepoPageProcessor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">PageProcessor</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> Site site = Site.me().setRetryTimes(<span class="hljs-number">3</span>).setSleepTime(<span class="hljs-number">1000</span>).setTimeOut(<span class="hljs-number">10000</span>);<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">process</span><span class="hljs-params">(Page page)</span> </span>&#123;<br>        System.out.println(page.getRawText());<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Site <span class="hljs-title">getSite</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> site;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        Spider.create(<span class="hljs-keyword">new</span> GithubRepoPageProcessor()).addUrl(<span class="hljs-string">&quot;http://partner.domain.com/code4craft&quot;</span>).thread(<span class="hljs-number">5</span>).run();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å‘ç°æ§åˆ¶å°æˆåŠŸæ‰“å°å‡ºäº†é¡µé¢çš„å†…å®¹ï¼Œæµ‹è¯•ä¸­ï¼Œå¦‚æœé¡µé¢ï¼Œé¡µé¢çš„å…¶ä»–è¯·æ±‚è¿˜æ˜¯ä¼šé”™è¯¯ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªé¡µé¢æ˜¯æ­£ç¡®çš„ï¼Œå› æ­¤æ­¤æ–¹æ³•<strong>åªé€‚åˆä¸ Ajax ç±»ä¼¼çš„æ¥å£</strong>ï¼Œæˆ‘ä»¬æ˜¯è¿™æ ·å¤„ç†æŠ“å– Https é—®é¢˜çš„ï¼Œå› ä¸ºç¬¬ä¸€ç§æ–¹æ³•å¯¹äºæˆ‘ä»¬ JDK1.6 é¡¹ç›®æ— æ•ˆï¼Œç¬¬ä¸€ç§æ–¹æ³•åœ¨ JDK 1.8 æµ‹è¯•æ—¶å¯ä»¥æ­£å¸¸æŠ“å–çš„ã€‚</p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>å¦‚æœç¬¬ä¸€ç§æ–¹æ³•è§£å†³ä¸äº†ä½ çš„é—®é¢˜ï¼Œé‚£å°±è·Ÿæˆ‘ä¸€æ ·å¼„ä¸€ä¸ªä¸´æ—¶åŸŸååå‘ä»£ç†å§ï¼ŒNginx åœ¨è¿™æ–¹é¢è¿˜æ˜¯è›®å¥½ç”¨çš„ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>WebMagic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WebMagicå‡ºç°SSLException</tag>
      
      <tag>çˆ¬è™«å¼‚å¸¸</tag>
      
      <tag>åå‘ä»£ç†åˆ°å…¶ä»–åŸŸå</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CharlesæŠ“åŒ…å®æˆ˜è¯¦è§£</title>
    <link href="/Charles%E6%8A%93%E5%8C%85%E5%AE%9E%E6%88%98%E8%AF%A6%E8%A7%A3.html"/>
    <url>/Charles%E6%8A%93%E5%8C%85%E5%AE%9E%E6%88%98%E8%AF%A6%E8%A7%A3.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>é€šè¿‡ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæƒ³å¿…ä½ å·²ç»æŒæ¡äº†å¦‚ä½•æ­£ç¡®å®‰è£…æŠ“åŒ…ç¥å™¨ Charlesï¼Œå¦‚æœè¿˜æ˜¯æŠ“ä¸äº†åŒ…ï¼Œå¯ä»¥å†çœ‹çœ‹ã€‚</p><p>ä»Šå¤©è¦åšæ˜¯æŠ“åŒ…å®æˆ˜ï¼Œå› ä¸ºæˆ‘åœ¨åšç½‘ç»œæ–‡å­¦çš„å…¬å¸å°±èŒï¼Œæ‰€ä»¥å°±æ‹¿ç½‘ç»œæ–‡å­¦çš„ APP <strong>æŒé˜…</strong>å¼€åˆ€å¥½äº†ï¼Œä»¥ä¸‹è¿›å…¥æŠ“åŒ…å®æˆ˜ï¼Œä½“ä¼š Charles çš„å¼ºå¤§ä¹‹å¤„ï¼ã€‚</p><p>æŒæ¡äº†ä¸‹é¢çš„æŠ“åŒ…æŠ€å·§ï¼Œå¯¹äºæŸäº›æ ¡éªŒå¹¶ä¸æ˜¯ååˆ†ä¸¥æ ¼çš„ APP æ¥è¯´ï¼Œç ´è§£ä»–ä»¬çš„æ¥å£å®åœ¨æ˜¯è½»è€Œæ˜“ä¸¾ã€‚æ¯”å¦‚ä¿®æ”¹ä¸ª isVip å‚æ•°ä¸º trueï¼Œå°±å˜èº«è¶…çº§ VIPç­‰ï¼›ä¹‹å‰ç”¨è¿™å¥—æŠ“åŒ…æŠ€å·§ï¼Œæ‰¾äº†ä¸€ä¸ªç½‘æ ¡éšä¾¿ä¿®æ”¹ï¼Œå‘ç°è¦ä»·ä¸Šåƒè‡³ä¸Šä¸‡çš„è¯¾ç¨‹ç«Ÿç„¶å¯ä»¥è·³è¿‡æ ¡éªŒç›´æ¥è¢«æˆ‘æ’­æ”¾ä¸‹è½½ï¼Œä¹Ÿæ˜¯é†‰äº†ã€‚</p><p>å¸Œæœ›å¤§å®¶æŒæ¡äº†æŠ“åŒ…ä¸è¦å¹²è¿æ³•çš„äº‹æƒ…ï¼Œæœ¬æ–‡ç›®çš„åœ¨äºè®©æŠ€æœ¯äººå‘˜äº†è§£æ¼æ´ï¼ŒåŠ å›ºæ ¡éªŒï¼Œä¸è¢«ä»–äººæœ‰æœºå¯ä¹˜ï¼Œä»¥å…é€ æˆå…¬å¸æŸå¤±ã€‚</p><h2 id="æµ‹è¯•ç¯å¢ƒ"><a href="#æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="æµ‹è¯•ç¯å¢ƒ"></a>æµ‹è¯•ç¯å¢ƒ</h2><p>ç¯å¢ƒï¼š</p><ul><li>Windows </li><li>Charles</li><li>iphone 7</li><li>æŒé˜… APP 7.4.2</li></ul><p><strong>å‰æï¼šæ‰‹æœºå·²ç»è¿æ¥ Charles ä»£ç†ï¼Œå¹¶å¯ä»¥æŠ“å– HTTPS æ•°æ®åŒ…ã€‚</strong></p><h2 id="ä¸€ã€Charles-çš„æ–­ç‚¹åŠŸèƒ½-Breakpoints-å®æˆ˜"><a href="#ä¸€ã€Charles-çš„æ–­ç‚¹åŠŸèƒ½-Breakpoints-å®æˆ˜" class="headerlink" title="ä¸€ã€Charles çš„æ–­ç‚¹åŠŸèƒ½ Breakpoints å®æˆ˜"></a>ä¸€ã€Charles çš„æ–­ç‚¹åŠŸèƒ½ Breakpoints å®æˆ˜</h2><p>é¦–å…ˆç™»å½•æŒé˜… APP ï¼Œæ¸…ç©ºCharles çš„æŠ“åŒ…åˆ—è¡¨ï¼Œä»¥é˜²æ­¢å¹²æ‰°å®éªŒï¼Œç„¶åè¿›å…¥ APP çš„ä¸ªäººä¸­å¿ƒï¼Œå¯ä»¥çœ‹åˆ°å›¾ä¸­åœˆå‡ºçš„æ•°å€¼ï¼Œè¿™é‡Œæˆ‘ä»¬å¯¹å…¶æ•°å€¼è¿›è¡Œä¿®æ”¹ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180425/172739449.png?imageslim"></p><p>æ­¤æ—¶çœ‹åˆ° Charles çš„è¯·æ±‚åˆ—è¡¨ä¸­å‡ºç°äº† APP çš„è¯·æ±‚ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180425/173517796.png?imageslim">  </p><p>é€šè¿‡ç®€å•åˆ†æï¼Œå¯ä»¥çŸ¥é“ä¸ªäººä¸­å¿ƒçš„é‚£äº›æ•°æ®æ˜¯ä»è¿™ä¸ªè¯·æ±‚ä¸­è·å–åˆ°çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¾¿ä¿®æ”¹è¿™ä¸ªè¯·æ±‚ï¼Œå³é”®è¿™ä¸ªè¯·æ±‚ï¼Œé€‰æ‹© <strong>Breakpoints</strong>ï¼Œè¿™æ ·å°±ç»™è¿™ä¸ªè¯·æ±‚åŠ ä¸Šäº†æ–­ç‚¹ã€‚æ­¤æ—¶åˆ‡æ¢ App åˆ° ä¹¦æ¶å†åˆ‡æ¢å›ä¸ªäººä¸­å¿ƒï¼Œä¼šå†æ¬¡å‘é€è¯¥è¯·æ±‚ï¼ŒCharles ä¼šå¼¹å‡ºè¯·æ±‚çš„æ–­ç‚¹ï¼Œå› ä¸ºè¿™é‡Œä¸éœ€è¦ä¿®æ”¹è¯·æ±‚å‚æ•°ï¼Œç›´æ¥æ”¾è¡Œå³å¯ï¼Œé€‰æ‹© <strong>Execute</strong>ï¼›æ”¾è¡Œåï¼Œä¼šå†æ¬¡å¼¹å‡ºæ–­ç‚¹ï¼Œæ­¤æ—¶å°±æ˜¯å“åº”è¿”å›çš„æ–­ç‚¹äº†ï¼Œé€‰æ‹© <strong>Edit Response</strong>ï¼Œ åº•éƒ¨é€‰æ‹© JSON text å¯ä»¥ä¿®æ”¹è¿”å›å€¼ï¼Œ<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180425/174223787.png?imageslim"></p><p>æˆ‘è¿™é‡ŒæŠŠ 2 ä¿®æ”¹æˆäº† 2222ï¼Œä¿®æ”¹å®Œä¹‹åï¼Œç‚¹å‡»<strong>Execute</strong>ï¼Œå›åˆ° App å‘ç°å·²ç»æ›´æ”¹äº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180425/174139868.png?imageslim"></p><p>æµ‹è¯•ä¸­å‘ç°ï¼ŒæŒé˜… App çš„è¯·æ±‚æ—¶é—´å¦‚æœè¿‡é•¿ï¼Œä¿®æ”¹ä¹‹åä¹Ÿä¼šä¸ç”Ÿæ•ˆã€‚<br>è¿™å°±éœ€è¦ä½¿ç”¨ Charles çš„ä¸‹ä¸€ä¸ªç‰› X çš„åŠŸèƒ½äº†ï¼ŒMap æ˜ å°„ï¼Œè®© Charles è‡ªåŠ¨è¿”å›æˆ‘ä»¬æƒ³è¦çš„è¿”å›å€¼ã€‚</p><h2 id="äºŒã€Charles-çš„æ˜ å°„åŠŸèƒ½-Map-å®æˆ˜"><a href="#äºŒã€Charles-çš„æ˜ å°„åŠŸèƒ½-Map-å®æˆ˜" class="headerlink" title="äºŒã€Charles çš„æ˜ å°„åŠŸèƒ½ Map å®æˆ˜"></a>äºŒã€Charles çš„æ˜ å°„åŠŸèƒ½ Map å®æˆ˜</h2><p>ä¸Šä¸€ä¸ªå®éªŒè¿›è¡Œçš„æ—¶å€™ï¼Œå¦‚æœè¯·æ±‚çš„å“åº”æ—¶é—´è¿‡é•¿ï¼ŒæŒé˜…çš„ App å°±ä¼šæŠ›å¼ƒæœ¬æ¬¡è¯·æ±‚çš„ç»“æœï¼Œä¸å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ›´å¿«çš„å»ä¿®æ”¹è¿”å›å€¼ã€‚</p><p>ä»¥å‰ç”¨ Fiddler å¯¹äºè¿™ç§å“åº”æ—¶é—´æœ‰è¦æ±‚çš„ Appï¼Œåæ­£æˆ‘æ˜¯æŸæ‰‹æ— ç­–çš„ï¼ŒAPP æ€»æ˜¯æç¤ºç½‘ç»œå¼‚å¸¸ï¼Œå“åº”è¶…æ—¶ç­‰ã€‚å¦‚æœæ˜¯æ›´æ”¹ä¸€ä¸¤ä¸ªè¿”å›å€¼è¿˜å¯ä»¥ï¼Œå¦‚æœæ˜¯å¤šä¸ªï¼Œæ˜¯çœŸæ²¡è¾™äº†ï¼Œæ‰€ä»¥ Charles çš„ Map åŠŸèƒ½æ˜¯å¾ˆå¼ºå¤§çš„ã€‚</p><p>é‡å¤ä¸Šä¸€æ­¥ï¼ŒæŠ“åˆ°ä¸ªäººä¸­å¿ƒçš„æ•°æ®åŒ…ï¼Œå°±æ˜¯è¿™ä¸ªè¯·æ±‚ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180425/173517796.png?imageslim">  </p><p>å³é”®é€‰æ‹© <strong>Save Response</strong> åˆ°ä¸€ä¸ªæ–‡ä»¶å½“ä¸­å»ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180425/175550942.png?imageslim"></p><p>å†æ¬¡å³é”®ï¼Œé€‰æ‹©è¯¥è¯·æ±‚ï¼Œä¸ºäº†ä¸å¹²æ‰°å®éªŒï¼Œå–æ¶ˆå‹¾é€‰ä¸Šä¸€æ­¥ä¸­çš„<strong>Breakpoints</strong>ï¼Œç„¶åå†å³é”®è¯¥è¯·æ±‚ï¼Œé€‰æ‹©æœ€ä¸‹æ–¹ <strong>Map Local</strong>ï¼Œé€‰æ‹©åˆšæ‰ä¿å­˜çš„æ–‡ä»¶ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180425/180202513.png?imageslim"></p><p>æ³¨æ„è¿™é‡Œçš„ <strong>Query</strong>ï¼Œå› ä¸ºæŒé˜… APP åœ¨è¯·æ±‚æ—¶ï¼Œé™„å¸¦äº†ç­¾åæ—¶é—´æˆ³ç­‰å‚æ•°ï¼Œè¿™é‡Œè®¾ç½®ä¸º * ä¹‹åï¼Œå°±ä¼šå¿½ç•¥è¿™äº›å‚æ•°ã€‚<br>è®¾ç½®å®Œæˆåï¼Œä¿®æ”¹åˆšæ‰ä¿å­˜çš„æ–‡ä»¶ï¼Œä½¿ç”¨ NotePad++ ç­‰ç¼–è¾‘å™¨æ‰“å¡ï¼Œä¿®æ”¹é‡Œé¢çš„ JSON å†…å®¹ã€‚<br>æˆ‘æ”¹äº†éƒ¨åˆ†æ•°æ®ï¼Œé‡æ–°è¿›å…¥ä¸ªäººä¸­å¿ƒï¼ŒæŸ¥çœ‹ Charles çš„è¯·æ±‚å†…å®¹ï¼Œå‘ç°å·²ç»ä¿®æ”¹äº†<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180425/180114345.png?imageslim"></p><p>åŒæ—¶çœ‹ App çš„ä¸ªäººä¸­å¿ƒä¹Ÿå·²ç»ä¿®æ”¹äº†ï¼Œå¯ä»¥æ”¹å¾ˆå¤§çš„å€¼ï¼Œç„¶åå‘ä¸æ‡‚çš„äººç‚«è€€ç‚«è€€äº†å“ˆå“ˆå“ˆ~<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180425/180817131.png?imageslim"></p><h2 id="ä¸‰ã€Charles-çš„-Rewrite-å®æˆ˜"><a href="#ä¸‰ã€Charles-çš„-Rewrite-å®æˆ˜" class="headerlink" title="ä¸‰ã€Charles çš„ Rewrite å®æˆ˜"></a>ä¸‰ã€Charles çš„ Rewrite å®æˆ˜</h2><p>Rewrite æ˜¯å¯¹äº map åŠŸèƒ½çš„ä¸€ä¸ªè¡¥å……ï¼Œå¯ä»¥è®¾ç½®è¾ƒä¸ºå¤æ‚çš„è§„åˆ™ï¼Œä¸‹é¢æ¼”ç¤ºæ›¿æ¢ Body å†…çš„ç”¨æˆ·åç§°</p><p>é€‰æ‹©èœå•æ  Tools -&gt; Rewriteï¼Œé€‰æ‹©å¼€å¯ Rewrite, å¹¶æ·»åŠ ä¸€æ¡è§„åˆ™ã€‚æ›¿æ¢ Body ä½“å†…çš„ We Jan ä¸º CCTV<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180425152466495838315.png"></p><p>APPå†æ¬¡å‘èµ·è¯·æ±‚ï¼Œå“åº”å¦‚ä¸‹<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180425152466522079125.png"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>å…¶å®æ—¥å¸¸ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„åœ°æ–¹åŸºæœ¬ä»¥ä¸Šä¸‰ä¸ªéƒ½å¯ä»¥åŒ…å«åˆ°äº†ï¼Œå…¶ä»–æ·±å…¥å­¦ä¹ çš„ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„é“¾æ¥ã€‚</p><ul><li><a href="http://www.heyuan110.com/2015/08/15/Charles%E8%BE%85%E5%8A%A9%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3/">http://www.heyuan110.com/2015/08/15/Charles%E8%BE%85%E5%8A%A9%E8%B0%83%E8%AF%95%E6%8E%A5%E5%8F%A3/</a></li><li><a href="http://blog.devtang.com/2015/11/14/charles-introduction/">http://blog.devtang.com/2015/11/14/charles-introduction/</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å·¥å…·ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CharlesæŠ“åŒ…</tag>
      
      <tag>æŠ“åŒ…ç ´è§£</tag>
      
      <tag>æŠ“åŒ…å®æˆ˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CharlesæŠ“åŒ…ä¹‹HTTPSæŠ“åŒ…é…ç½®</title>
    <link href="/Charles%E6%8A%93%E5%8C%85%E4%B9%8BHTTPS%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE.html"/>
    <url>/Charles%E6%8A%93%E5%8C%85%E4%B9%8BHTTPS%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç”±äºå·¥ä½œä¸­ç»å¸¸éœ€è¦é…ç½®å®¢æˆ·ç«¯å¼€å‘äººå‘˜å¯¹æ¥æ¥å£ï¼Œæœ‰æ—¶å€™å¯¹æ¥åœ°ä¸å¤ªé¡ºåˆ©ï¼Œå› æ­¤éœ€è¦ç»å¸¸æ€§åœ°å¯¹å…¬å¸ APP è¿›è¡ŒæŠ“åŒ…çœ‹è¯·æ±‚ï¼Œæ‰¾å‡ºå…·ä½“çš„åŸå› ã€‚</p><p>åœ¨å…¬å¸ä¸­å¼€å‘ä½¿ç”¨çš„ Windows å°å¼ç”µè„‘ï¼ŒæŠ“åŒ…å·¥å…·é€‰æ‹©äº† Fiddlerï¼Œè¿™ä¸ªå·¥å…·åˆšå¼€å§‹å­¦ä¼šæŠ“åŒ…çš„æ—¶å€™ï¼Œè§‰å¾—çœŸä¹ƒç¥å™¨ï¼åœ¨ç»è¿‡å‡ æ¬¡å¼€å‘ç”µè„‘å‡çº§ä¹‹åï¼Œé‡æ–°å®‰è£… Fiddler åï¼Œå’Œä¹‹å‰çš„è®¾ç½®ç›¸åŒï¼Œä½†æ˜¯æ­»æ´»æŠ“ä¸äº†åŒ…ï¼Œæˆ–è€…æŠ“ä¸äº† Https çš„åŒ…ï¼Œ æ€»ä¹‹æ€»ä¼šå‡ºç°å„ç§å¥‡æ€ªçš„é—®é¢˜ï¼Œå¦‚æœå‡ºäº†é—®é¢˜ï¼Œç®€ç›´è®©äººæŠ“ç‹‚ï¼</p><a id="more"></a><p>å»å¹´å¹´åº•ï¼Œç»™è‡ªå·±æ¢äº†ä¸€å° MBPï¼Œæ—¥å¸¸å­¦ä¹ ä¸­ä¹Ÿéœ€è¦ç”¨åˆ°æŠ“åŒ…ï¼Œä¸ºäº†å’Œå…¬å¸ä¸­çš„å·¥å…·ä¿æŒä¸€è‡´ï¼Œæƒ³ä¸‹è½½ Fiddler çš„ Mac ç‰ˆï¼Œç»“æœå¹¶æ²¡æœ‰ã€‚äºæ˜¯ä¸‹è½½äº† Charles (èŠ±ç“¶)ï¼Œç”¨äº†èŠ±ç“¶ä¹‹åï¼Œå‘ç°å…¶æ¯” Fiddler æ›´åŠ å¥½ç”¨~</p><p>åœ¨ä¸€æ¬¡å—å¤Ÿäº† Fiddler çš„è«åå…¶å¦™åœ°æŠ“ä¸äº† Httpsï¼Œæ€’å¸è½½ä¹‹ï¼Œå¯»å¯»è§…è§…ï¼Œæ‰¾åˆ°äº† Win ç‰ˆçš„ Charles (ä¹‹å‰è¿˜ä»¥ä¸ºæ²¡æœ‰ Win ç‰ˆå‘¢)ï¼Œç»è¿‡ç®€å•é…ç½®ï¼Œå¼€å§‹äº†æ„‰å¿«çš„æŠ“åŒ…~</p><h2 id="æŠ“åŒ…å‡†å¤‡ä¹‹-Charles-ä¸‹è½½ä»¥åŠæ¿€æ´»"><a href="#æŠ“åŒ…å‡†å¤‡ä¹‹-Charles-ä¸‹è½½ä»¥åŠæ¿€æ´»" class="headerlink" title="æŠ“åŒ…å‡†å¤‡ä¹‹ Charles ä¸‹è½½ä»¥åŠæ¿€æ´»"></a>æŠ“åŒ…å‡†å¤‡ä¹‹ Charles ä¸‹è½½ä»¥åŠæ¿€æ´»</h2><p><a href="https://www.charlesproxy.com/latest-release/download.do">Charles è½¯ä»¶ä¸‹è½½</a></p><p>ä¸‹è½½å®‰è£…å®Œï¼Œåœ¨å¼€å§‹èœå•ä¸­æ‰¾åˆ° Charles æ‰“å¼€ï¼Œæç¤ºæœ‰ 30 å¤©çš„è¯•ç”¨æœŸã€‚å¦‚æœ 30 å¤©åˆ°æœŸçš„è¯ï¼Œå¯ä»¥é€‰æ‹©è´­ä¹°ä¸€ä¸ª license ï¼Œ30 åˆ€ã€‚å¦‚æœä¸æƒ³ä¹°ï¼Œå¯ä»¥å‚è€ƒæ­¤æ–‡ç»§ç»­è¯•ç”¨ï¼Œ<a href="https://zhile.io/2017/07/07/charles-proxy-usage-and-license.html">Charles Proxyä½¿ç”¨ç¬”è®°ï¼ˆæ–‡å†…æœ‰å¥½ç¤¼ï¼‰</a>ã€‚é€‰æ‹© Help-Registered å¡«å…¥ license å³å¯æ¿€æ´»ã€‚</p><h2 id="æŠ“åŒ…å‡†å¤‡ä¹‹-Charles-é…ç½®-HTTPS-æŠ“åŒ…åŸºç¡€é…ç½®"><a href="#æŠ“åŒ…å‡†å¤‡ä¹‹-Charles-é…ç½®-HTTPS-æŠ“åŒ…åŸºç¡€é…ç½®" class="headerlink" title="æŠ“åŒ…å‡†å¤‡ä¹‹ Charles é…ç½® HTTPS æŠ“åŒ…åŸºç¡€é…ç½®"></a>æŠ“åŒ…å‡†å¤‡ä¹‹ Charles é…ç½® HTTPS æŠ“åŒ…åŸºç¡€é…ç½®</h2><p>å¦‚ä»Š Https å¤§è¡Œå…¶é“ï¼Œè‹¹æœæ›´æ˜¯å¼ºåˆ¶è¦æ±‚ APP é€šä¿¡å¿…é¡»è¦ä½¿ç”¨ Https åè®®ï¼Œå¦‚æœåªæ˜¯æŠ“æ™®é€šçš„ HTTP è¯·æ±‚ï¼Œæ— éœ€å¤æ‚é…ç½®å³å¯æŠ“åŒ…ï¼Œè¿™ä¹Ÿè¡¨æ˜äº† HTTP çš„å®‰å…¨æ€§å¾ˆä½ã€‚</p><p>Charles é»˜è®¤ä¸å¯¹ HTTPS çš„è¯·æ±‚å¼€å¯æŠ“åŒ…ï¼Œæ‰€ä»¥ï¼Œéœ€è¦å…ˆå¼€å¯æ‰€æœ‰ HTTPS è¯·æ±‚çš„æŠ“åŒ…ã€‚</p><p>è¿›å…¥èœå• Proxy-SSL Proxying Settings<br>é€‰æ‹©å¼€å¯ SSL Proxyï¼Œå¹¶ Add ä¸€æ¡ Location è®°å½•ï¼ŒHost å¡«å†™ <code>*</code>ï¼Œä»£è¡¨åŒ¹é…æ‰€æœ‰ç½‘å€ï¼Œç«¯å£ Portï¼Œå¡«å†™443ï¼Œå³ HTTPS ç«¯å£ã€‚  é€‰æ‹©ä¿å­˜ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180415/192924472.png"></p><p>åŸºç¡€é…ç½®åˆ°æ­¤å°±å®Œæˆäº†ï¼Œä»¥ä¸‹æœ¬æ–‡æŒ‰ç…§ä¸¤æ–¹é¢æ¥æè¿°ï¼ŒCharles æŠ“ HTTPSã€‚</p><h2 id="Charles-æŠ“-Windows-ä¸Šçš„-HTTPS-è¯·æ±‚"><a href="#Charles-æŠ“-Windows-ä¸Šçš„-HTTPS-è¯·æ±‚" class="headerlink" title="Charles æŠ“ Windows ä¸Šçš„ HTTPS è¯·æ±‚"></a>Charles æŠ“ Windows ä¸Šçš„ HTTPS è¯·æ±‚</h2><p>è¿›å…¥ Help ä¸­ï¼Œé€‰æ‹© SSL Proxying è®¾ç½®ï¼Œå®‰è£…æ ¹è¯ä¹¦  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180413/175314107.png?imageslim">  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180413/175426039.png?imageslim"></p><p>æ³¨æ„è¿™ä¸€æ­¥ä¸€å®šè¦å°†è¯ä¹¦å­˜å‚¨åˆ° <strong>å—ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„</strong>ï¼Œå¦åˆ™æŠ“åŒ… HTTPS ä¼šæç¤ºè¯ä¹¦ä¸å—ä¿¡ä»»ï¼ï¼ï¼å—¯ï¼Œæäº†å¥½ä¹…ï¼Œè¡€ä¸€èˆ¬çš„æ•™è®­ï¼ </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180413/175511643.png?imageslim">  </p><p>å®‰è£…æœŸé—´ä¼šæœ‰å®‰å…¨è­¦å‘Šï¼Œé€‰æ‹©æ˜¯å³å¯ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180413/175547783.png?imageslim"></p><p>è®¿é—® <a href="https://www.baidu.com/">https://www.baidu.com</a>åï¼ŒæŸ¥çœ‹ Charlesï¼Œå·²ç»å¯ä»¥çœ‹åˆ° Https è¯·æ±‚ä¸‹çš„æ•°æ®äº†ã€‚  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180415152379485069600.png"></p><h2 id="Charles-æŠ“-APP-çš„-HTTPS-è¯·æ±‚"><a href="#Charles-æŠ“-APP-çš„-HTTPS-è¯·æ±‚" class="headerlink" title="Charles æŠ“ APP çš„ HTTPS è¯·æ±‚"></a>Charles æŠ“ APP çš„ HTTPS è¯·æ±‚</h2><p>æƒ³è¦ Charles æŠ“ HTTPS çš„æ•°æ®åŒ…ï¼Œéœ€è¦è®¾ç½®ä»£ç†å¹¶å®‰è£… Charles çš„ä¸­é—´ SSL è¯ä¹¦ã€‚</p><p>é€‰æ‹© Help-SSL Proxying  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180415152379262077868.png"></p><p>ç‚¹å‡»ä¼šå¼¹å‡ºå¯¹è¯æ¡†å¦‚ä¸‹  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/2018041515237927135136.png"></p><p>æŒ‰ç…§æç¤ºï¼Œå°†æ‰‹æœºè¿å…¥ç”µè„‘åŒä¸€ä¸ªç½‘ç»œï¼ŒWIFI å¤„è®¾ç½®ä»£ç†ï¼Œä»£ç†çš„åœ°å€ä»¥åŠç«¯å£æŒ‰ç…§å¯¹è¯æ¡†ä¸­è¿›è¡Œè®¾ç½®ã€‚ </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180415152379295633941.png"></p><p>è®¾ç½®æˆåŠŸè¿”å›ä¹‹åï¼Œæ­¤æ—¶ç”µè„‘ä¸Š Charles ä¼šè‡ªåŠ¨å¼¹å‡ºæé†’ï¼Œæç¤ºæ˜¯å¦å…è®¸è¯·æ±‚ä»£ç†é€šè¿‡ï¼Œé€‰æ‹© <code>Allow</code> å…è®¸å³å¯ã€‚  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180415152379304426547.png"></p><p>è¿ä¸Šä»£ç†ä¹‹åï¼Œä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦æµè§ˆå™¨( iPhone ä½¿ç”¨ Safari)è®¿é—®åœ°å€ <code>chls.pro/ssl</code>ï¼Œå¦‚æœæ˜¯ iPhone ä¼šè‡ªåŠ¨å¼¹å‡ºå®‰è£…æè¿°æ–‡ä»¶ï¼Œé€‰æ‹©å®‰è£…è¾“å…¥å¯†ç åæ— è§†è­¦å‘Šå®‰è£…å³å¯ã€‚å› ä¸ºæ‰‹è¾¹æ²¡æœ‰å®‰å“è®¾å¤‡ï¼Œä¸è¿‡æµç¨‹åº”è¯¥ç±»ä¼¼ï¼Œå°±æ˜¯å®‰è£…ä¸€ä¸ª CA è¯ä¹¦æ–‡ä»¶ã€‚</p><p>æ‰‹æœºè®¿é—® <code>https://m.baidu.com</code>ï¼ŒæŸ¥çœ‹ Charles ï¼Œå‘ç°æ­¤æ—¶å·²ç»å¯ä»¥æ‹¿åˆ° HTTPS æ•°æ®å†…å®¹äº†ï¼Œå¦‚æœæ²¡è®¾ç½®æˆåŠŸï¼Œé‡Œé¢éƒ½å°†ä¼šæ˜¯ unknownã€‚  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180415152379397996806.jpg"></p><h2 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h2><ol><li><p>å¼€å¯ SSL Proxy ä»£ç†åï¼Œæç¤ºè¯ä¹¦ä¸å—ä¿¡ä»»æˆ–è€…æ— æ•ˆï¼ŒPC ç«¯ä¸€èˆ¬éƒ½æ˜¯å› ä¸ºè¯ä¹¦æ”¾é”™äº†ä½ç½®ã€‚</p></li><li><p>åœ¨ IOS11ä¸Šæµ‹è¯•æ—¶ï¼ŒæŠ“åŒ…<strong>æ˜¾ç¤ºunknown</strong>  éœ€è¦è¿›å…¥é€šç”¨-å…³äºæœ¬æœº-è¯ä¹¦ä¿¡ä»»è®¾ç½®ï¼Œå°†æ–°å¢çš„è¯ä¹¦è¿›è¡Œå¼€å¯æ“ä½œã€‚</p><p> <img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180413/165008375.png?imageslim"><br><del>1. å°ç±³ç³»ç»Ÿçš„æ‰‹æœºå®‰è£…è¯ä¹¦æ–¹å¼æ¯”è¾ƒç¹çï¼Œéœ€è¦è¿›å…¥å¼€å‘è€…é€‰é¡¹ä¸­ï¼Œåœ¨ä¿¡ç”¨è¯ä¹¦ä¸­è¿›è¡Œå®‰è£…ï¼ˆFiddlerå®‰è£…è¯ä¹¦æ˜¯è¿™æ ·çš„ï¼ŒCharles åº”è¯¥ä¹Ÿå·®ä¸å¤šï¼‰</del></p></li></ol><h2 id="æœ€åè¯´å‡ å¥"><a href="#æœ€åè¯´å‡ å¥" class="headerlink" title="æœ€åè¯´å‡ å¥"></a>æœ€åè¯´å‡ å¥</h2><p>å–„ç”¨æœç´¢å¼•æ“ï¼Œå› ä¸ºä½ é‡åˆ°çš„é—®é¢˜è‚¯å®šæœ‰åˆ«äººéƒ½é‡åˆ°è¿‡äº†ï¼Œå¦‚æœä½ æœä¸åˆ°ï¼Œè‚¯å®šæ˜¯ä½ çš„æœç´¢å§¿åŠ¿ä¸å¯¹~</p><p>å®åœ¨æœ‰é—®é¢˜è§£å†³ä¸äº†ï¼Œå¯ä»¥æ‰¾æˆ‘å“Ÿ! </p><p><a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=JVNGSFRlQ0pdSERMSQtGSkg">ç»™æˆ‘å†™ä¿¡</a></p>]]></content>
    
    
    <categories>
      
      <category>å·¥å…·ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CharlesæŠ“åŒ…</tag>
      
      <tag>HTTPSæŠ“åŒ…</tag>
      
      <tag>WindowsæŠ“åŒ…</tag>
      
      <tag>æŠ“åŒ…æ˜¾ç¤ºunknown</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¾®ä¿¡åŸŸåé˜²æ­¢å±è”½</title>
    <link href="/%E5%BE%AE%E4%BF%A1%E5%9F%9F%E5%90%8D%E9%98%B2%E6%AD%A2%E5%B1%8F%E8%94%BD.html"/>
    <url>/%E5%BE%AE%E4%BF%A1%E5%9F%9F%E5%90%8D%E9%98%B2%E6%AD%A2%E5%B1%8F%E8%94%BD.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™å‡ æ—¥ï¼Œç”±äºé­åˆ°ä»–äººçš„æ¶æ„æŠ•è¯‰ä¸¾æŠ¥ï¼Œå¯¼è‡´äº†å¾®ä¿¡ä¸­é˜…è¯»ä¸šåŠ¡çš„æ ¹åŸŸåè¢«å±è”½ï¼Œæç¤ºå¦‚å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180326/160535526.png?imageslim"></p><p>ç”±äºæˆ‘å¸æ˜¯åšç½‘ç»œæ–‡å­¦çš„ï¼Œä½œè€…çš„å†…å®¹ä¸­ä¸å¯é¿å…åœ°ä¼šå‡ºç°äº›å¾®éœ²éª¨çš„å†…å®¹ï¼Œä½†æ˜¯è¿™äº›å†…å®¹æ˜¯ç»è¿‡äº†ç¼–è¾‘å®¡æ ¸ä¹‹åæ‰å…¬å¼€çš„ï¼Œä¹Ÿä¸è‡³äºå¤ªéœ²éª¨ï¼Œä½†ä¸¾æŠ¥å°±è¢«å°ç¦äº†ã€‚</p><p>å…¬å¸çš„ç”¨æˆ·æœ‰å¾ˆå¤šæ˜¯é€šè¿‡å¾®ä¿¡å…¬ä¼—å·è¿›è¡Œé˜…è¯»ï¼Œè¿™ä¸€å°ï¼Œå°±è®¸å¤šç”¨æˆ·è¿‡æ¥åé¦ˆäº†ã€‚</p><a id="more"></a><h2 id="åˆ‡æ¢åŸŸåä¹‹ç—›"><a href="#åˆ‡æ¢åŸŸåä¹‹ç—›" class="headerlink" title="åˆ‡æ¢åŸŸåä¹‹ç—›"></a>åˆ‡æ¢åŸŸåä¹‹ç—›</h2><p>æ—¢ç„¶æ ¹åŸŸåè¢«å°äº†ï¼Œå°±åªèƒ½åˆ‡æ¢åŸŸåäº†ï¼Œå› ä¸ºä¹‹å‰ä»£ç ä¸­æœ‰ä¸å°‘çš„åœ°æ–¹åŸŸåå†™æ­»äº†ï¼Œæ²¡æœ‰æå–æˆå…¬å…±å˜é‡ï¼Œæ”¹äº†å¥½ä¹…ï¼Œæ‰æ›¿æ¢æˆäº†æ–°çš„åŸŸåã€‚</p><p>çœ¼çœ‹å·²ç»ä¿®æ”¹å®Œäº†ï¼Œçº¿ä¸Šä¹Ÿæ­£å¸¸äº†ï¼Œéƒ½å·²ç»æ™šä¸Š9ç‚¹å¤šï¼Œå‡†å¤‡ä¸‹ç­å›å®¶äº†ã€‚å°±è¿™æ—¶å€™ï¼Œç¾¤é‡Œåˆåé¦ˆç½‘ç«™è¿›ä¸å»äº†ï¼Œæ‰“å¼€ä¸€å¼€ï¼Œåˆ**è¢«å°äº†ï¼Œå½“æ—¶çš„å¿ƒæƒ…çœŸæ˜¯æƒ³é—®å€™ä¸€ä¸‹æ¶æ„ä¸¾æŠ¥äººçš„å…¨å®¶äº†ï¼</p><p>æ²¡æ³•å­ï¼Œç»§ç»­æ¢åŸŸåï¼Œè¿˜å¥½ä¹‹å‰æå‰å¤‡æ¡ˆäº†å‡ ä¸ªåŸŸåï¼Œæ²¡æƒ³åˆ°ç°åœ¨å…¨ç”¨ä¸Šäº†ã€‚</p><p>æœ‰äº†ä¸Šä¸€æ¬¡çš„ç»éªŒï¼Œç°åœ¨ä¿®æ”¹èµ·æ¥ä¹Ÿå¿«å¤šäº†ï¼Œä¿®æ”¹ä¸Šçº¿å®Œäº‹éƒ½å·²ç» 10 ç‚¹å¤šäº†ï¼Œæ¶æ„ä¸¾æŠ¥çš„äººè¿™æ—¶å€™ä¹Ÿæ¶ˆåœäº†ä¸‹æ¥æ²¡æœ‰ç»§ç»­æŠ•è¯‰äº†ï¼Œæˆ‘ä»¬ä¹Ÿç»ˆäºå¯ä»¥ä¸‹ç­ï¼Œå®³çš„æˆ‘ä»¬å¤§å‘¨å…­çš„è¿‡æ¥åŠ äº†ä¸€å¤©çš„ç­ï¼</p><p>ç¬¬äºŒå¤©ï¼Œä¹Ÿå°±æ˜¯å‘¨æ—¥ã€‚ç¾¤é‡Œåˆååº”è¢«å°äº†ï¼ŒçœŸæ˜¯å´©æºƒã€‚<br>æœ€å¼€å§‹çš„åŸŸåè¢«å¾®ä¿¡å°ç¦åï¼Œå…¬å¸ç¬¬ä¸€æ—¶é—´è¿›è¡Œäº†ç”³è¯‰ï¼Œæ­¤æ—¶æ”¶åˆ°é€šçŸ¥ï¼Œè¯´æ£€æµ‹åæ²¡æœ‰è¿è§„å†…å®¹ï¼Œå°±è¿›è¡Œäº†è§£å°ã€‚<br>å¯èƒ½æ˜¯åˆ«äººæ¶æ„åˆ©ç”¨äº†å¾®ä¿¡çš„å°ç¦ç³»ç»Ÿï¼Œæ­¤æ—¶è§‰å¾—å¾®ä¿¡çš„è¿™å¥—ç³»ç»Ÿåšçš„çœŸçƒ‚ï¼äºæ˜¯æˆ‘ä»¬å¼€å‘äººå‘˜åˆæ˜¯ä¸€ç•ªæ›¿æ¢ï¼ŒæŠŠç°åœ¨è¢«å°çš„åŸŸååˆ‡æ¢äº†å›å»ã€‚</p><p>ç»è¿‡è¿™å‡ æ³¢æ“ä½œï¼Œè¿™ä¸¤å¤©ç½‘ç«™çš„æ”¶å…¥éª¤å‡ï¼Œé‚£å¸®ä½¿åçš„äººæ˜¯è¶ä½ ç—…è¦ä½ å‘½çš„èŠ‚å¥ï¼</p><h2 id="ç—›å®šæ€è¿‡"><a href="#ç—›å®šæ€è¿‡" class="headerlink" title="ç—›å®šæ€è¿‡"></a>ç—›å®šæ€è¿‡</h2><p>æ€»ç»“äº†ä¸€ä¸‹è¿™æ¬¡äº‹ä»¶çš„æ•™è®­ï¼Œä¸»è¦çš„åŸå› å°±æ˜¯å› ä¸ºå°è¯´çš„å†…å®¹é¡µè¢«é¢‘ç¹æ¶æ„ä¸¾æŠ¥å¯¼è‡´åŸŸåè¢«å°ã€‚ è¿™å°±å¯¼è‡´äº†å³ä½¿æ¢äº†åŸŸåï¼Œæ¯”å¦‚æ”¯ä»˜ï¼Œç™»å½•éƒ½å—åˆ°äº†å½±å“ï¼Œè€Œä¸”å¾®ä¿¡æ”¯ä»˜é™åˆ¶äº†æ¯ä¸ªæœˆä¿®æ”¹æ”¯ä»˜åŸŸåçš„æ¬¡æ•°ï¼Œä¸å¾—å·²æˆ‘ä»¬åªå¥½æ¢äº†å¦å¤–ä¸€ä¸ªæœåŠ¡å·æ‰é‡æ–°æ‰“é€šäº†æ”¯ä»˜ã€‚</p><p>æ¥ä¸‹æ¥éœ€è¦åšçš„å°±æ˜¯ï¼Œå°†å¯èƒ½è¿˜ä¼šè¢«ä¸¾æŠ¥çš„å°è¯´å†…å®¹é¡µçš„åŸŸåæ‹†åˆ†å‡ºå»ï¼Œä¸å’Œç½‘ç«™ä¸»è¦åŸŸåä¸€æ ·ã€‚</p><p>æ¯”å¦‚é¦–é¡µã€ä¸ªäººä¸­å¿ƒæ˜¯ <code>m.aaa.com</code>, å°†å†…å®¹é¡µçš„åŸŸåä¿®æ”¹æˆ <code>m.bbb.com</code>ã€‚</p><p>æˆ‘ä»¬çš„é˜…è¯»é¡µ URL åœ°å€ä¸º <code>https://m.aaa.com/book/1010545066/385773672</code>ï¼Œåˆ™åœ¨ nginx åŒ¹é…åˆ° <code>^/book/([0-9]+)/([0-9]+)</code> å°±è¿›è¡Œè·³è½¬åˆ° <code>http://m.bbb.com/book/1010545066/385773672</code>ï¼Œäºæ˜¯ï¼Œä¿®æ”¹ nginx çš„é…ç½®ï¼Œå¯¹ URL è¿›è¡ŒåŒ¹é…ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs conf">server &#123;<br>    listen       443;<br>    server_name  m.aaa.com;<br>    <br>    # ...<br>    set $temp_content_host &quot;http:&#x2F;&#x2F;m.bbb.com&quot;;<br>    location ~ ^&#x2F;book&#x2F;([0-9]+)&#x2F;([0-9]+) &#123;<br>        # If WeChat browser, jump to temporary domain name<br>        if ($http_user_agent ~* (Micromessenger) ) &#123;<br>            return 301 $temp_content_host$request_uri;<br>        &#125;<br>        proxy_pass http:&#x2F;&#x2F;domainAserver;<br>    &#125;<br><br>    location &#x2F; &#123;<br>        proxy_pass http:&#x2F;&#x2F;domainAserver;<br>    &#125;<br>&#125;<br><br>server &#123;<br>    listen       80;<br>    server_name  m.bbb.com;<br>    <br>    # ...<br><br>    location &#x2F; &#123;<br>        proxy_pass http:&#x2F;&#x2F;domainAserver;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å› ä¸ºåªæœ‰åœ¨å¾®ä¿¡æµè§ˆå™¨å†…éƒ¨ï¼Œæ‰å­˜åœ¨è¢«å°ç¦çš„é£é™©ï¼Œè€Œåœ¨å…¶ä»–æµè§ˆå™¨å†…æ²¡æœ‰ï¼Œä¸€æ—¦è¢«å¾®ä¿¡å°ç¦ï¼Œå†…å®¹é¡µçš„åŸŸåéœ€è¦ä¸€èµ·æ›´æ¢ï¼Œè¿™æ ·å¯èƒ½ä¼šä¸åˆ©äºæœç´¢å¼•æ“çš„æ”¶å½•ï¼Œå› æ­¤åŠ äº†ä¸€ä¸ªåˆ¤æ–­<br>æµè§ˆå™¨ UAï¼Œå¾®ä¿¡çš„ UA æ˜¯ <em>Micromessenger</em> å¦‚æœæ˜¯åœ¨å¾®ä¿¡æµè§ˆå™¨å†…éƒ¨ï¼Œnginx æ‰ 301 è·³è½¬åˆ° <code>m.bbb.com</code>ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ä¿æŒä¹‹å‰çš„åŸŸåä¸å˜ã€‚</p><p>è¿™æ ·å°±è§£å†³äº†é—®é¢˜ï¼Œä¸€æ—¦ <code>m.bbb.com</code> åŸŸåè¢«å°ç¦äº†ï¼Œå°±æ˜¯ aaa åŸŸåçš„ nginx ä¿®æ”¹ <em>$temp_content_host</em> è¿™ä¸ªå˜é‡çš„å€¼ä¸ºæ–°çš„åŸŸåç„¶å reload ä¸€ä¸‹ nginx å³å¯ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¯èƒ½æ˜¯å…¬å¸æˆ˜ç•¥ä¸Šçš„é—®é¢˜ï¼Œå¤ªè¿‡äºä¾èµ–å¾®ä¿¡çš„å…¬ä¼—å·ï¼Œåœ¨å¾®ä¿¡çš„ç”Ÿæ€ä¸­ï¼Œå¾®ä¿¡æƒ³å¼„æ­»ä½ è½»è€Œæ˜“ä¸¾ï¼Œä½ å´æ— å¯å¥ˆä½•ï¼Œå°½é‡æŠŠç”¨æˆ·å¼•å¯¼åˆ°å®¢æˆ·ç«¯ä¸Šæ‰æ˜¯ä¸Šä¸Šç­–ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="http://www.ttlsa.com/nginx/how-to-block-user-agents-using-nginx/">http://www.ttlsa.com/nginx/how-to-block-user-agents-using-nginx/</a></li><li><a href="http://lzl124631x.github.io/2016/04/08/check-wechat-user-agent.html">http://lzl124631x.github.io/2016/04/08/check-wechat-user-agent.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¾®ä¿¡å¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¾®ä¿¡åŸŸåå°ç¦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¾®ä¿¡åˆ†äº«è¸©å‘ä¹‹æ—…</title>
    <link href="/%E5%BE%AE%E4%BF%A1%E5%88%86%E4%BA%AB%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85.html"/>
    <url>/%E5%BE%AE%E4%BF%A1%E5%88%86%E4%BA%AB%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸‰æœˆä¼Šå§‹ï¼Œæ­¤æœˆä»»åŠ¡é‡å¿ƒåœ¨äºç”¨æˆ·çš„æ‹‰æ–°ä¸ä¼ æ’­ï¼Œè‡ªç„¶ä¹Ÿå°‘ä¸äº†æ–°å¢åŠ äº›è®¸éœ€æ±‚ã€‚ç”±æˆ‘è´Ÿè´£ç”¨æˆ·åˆ†äº«ä¼ æ’­çš„éœ€æ±‚ï¼Œä¸»è¦ä»»åŠ¡å°±æ˜¯åœ¨äºå¾®ä¿¡åˆ†äº«ã€‚<br>åœ¨åšä¹‹å‰è§‰å¾—è¿™ä¸ªå¾ˆç®€å•ï¼Œå°±å‡ ä¸ªæ¥å£çš„äº‹æƒ…ç½¢ï¼Œå®é™…ä¸Šåšèµ·æ¥ï¼Œå´æ˜¯ä¸å¦‚æ„æ–™é‚£èˆ¬ç®€å•ï¼Œè¸©å‘é¢‡å¤šã€‚</p><a id="more"></a><p>åœ¨åšè¿™ä¸ªåˆ†äº«éœ€æ±‚ä¹‹å‰ï¼Œå’ŒåŒäº‹ä»¬ä¹Ÿå·²ç»è®¨è®ºè¿‡å¤§è‡´çš„æµç¨‹ã€‚æ— éå¸¸ç”¨çš„æ‰‹æ³•ï¼Œé’ˆå¯¹ç”¨æˆ·ç”Ÿæˆå”¯ä¸€äºŒç»´ç ï¼Œé€šè¿‡å¾®ä¿¡åˆ†äº«å‡ºå»ï¼Œç„¶åå…¶ä»–äººæ³¨å†Œå¡«å†™é‚€è¯·ç è·å–å¥–åŠ±ã€‚</p><p>åœ¨å¡«å†™é‚€è¯·ç è¿™é‡Œï¼Œæˆ‘å‚è€ƒäº†ä¸€äº›ä¸»æµ APP çš„åšæ³•ã€‚æ­£å¸¸æ˜¯å¤åˆ¶é‚€è¯·ç ç„¶åç”¨æˆ·æ‰¾åˆ°å…¥å£ç²˜è´´é‚€è¯·ç å¹¶è¿›è¡Œæ¿€æ´»ï¼Œä½†æ˜¯å‘ç°æœ‰ä¸ªåˆ«çš„ APP ä½“éªŒå¾ˆå¥½ï¼Œå¯ä»¥åšåˆ°å¤åˆ¶é‚€è¯·ç åï¼Œç›´æ¥æŠµè¾¾ APPï¼ˆç½‘æ˜“èœ—ç‰›è¯»ä¹¦ï¼‰ å†…éƒ¨ WebView ä¸­è‡ªåŠ¨å¡«å†™é‚€è¯·ç ã€‚</p><p>åœ¨å¯¹è¿™ä¸ª APP æŠ“åŒ…åˆ†æä¹‹åå‘ç°äº†å…¶ä¸­çš„å¥¥å¦™æ‰€åœ¨ï¼Œè¿™æ˜¯ä»–ä»¬åˆ†äº«é¡µé¢çš„åœ°å€ï¼š</p><p><code>https://du.163.com/static/wechatFallback.html?openurl=nesnailreader://webview?url=https://du.163.com/invite?code=EPPEG&amp;inside=true&amp;downloadurl=https://du.163.com/download</code></p><p>åŸæ¥ä»–ä»¬ä½¿ç”¨äº†ä¸€ç§å«åš schema çš„æŠ€æœ¯ï¼Œå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ APPã€‚äºæ˜¯å¼€å§‹äº†æ¨¡ä»¿ä¹‹æ—…ã€‚ </p><p>çŸ¥é“äº†å…¶ä»– APP çš„åšæ³•åï¼Œä¾¿è¯¢é—®äº†å®¢æˆ·ç«¯çš„åŒäº‹ï¼Œèƒ½ä¸èƒ½å®ç°åŒæ ·çš„æ•ˆæœï¼Œä»–ä»¬éƒ½æ˜¯è¯´ä»¥å‰æ²¡æœ‰è¿™æ ·åšè¿‡ï¼Œä½†æ˜¯å¯ä»¥åšã€‚åè°ƒäº†å‰ç«¯ä¸å®¢æˆ·ç«¯åŒäº‹ï¼Œå…±åŒå¼€å‘è¿™ä¸ªçœ‹èµ·æ¥æŒºç®€å•çš„åŠŸèƒ½éœ€æ±‚ã€‚å®¢æˆ·ç«¯åŒäº‹éƒ½å¾ˆç»™åŠ›ï¼Œè™½ç„¶å‡ºç°äº†ä¸€äº›å°æ’æ›²ï¼Œä½†å¾ˆå¿«ä¾¿è°ƒé€šäº†åŠŸèƒ½ï¼Œå‰©ä¸‹äº† WAP ç‰ˆæœ¬å¾®ä¿¡åˆ†äº«ï¼Œç”±äºä¹‹å‰éƒ½æ²¡æœ‰åšè¿‡ï¼Œè¸©äº†ä¸å°‘çš„å‘ï¼Œåˆ†äº«è¿™æ¬¡è¸©å‘ï¼Œè¿™ä¹Ÿæ˜¯æœ¬æ–‡é‡å¿ƒæ‰€åœ¨ã€‚</p><h2 id="å‘ä¸€"><a href="#å‘ä¸€" class="headerlink" title="å‘ä¸€"></a>å‘ä¸€</h2><p>åå°ä»£ç å¼€å‘ä¸å¿…å¤šè¯´ï¼Œè·Ÿç€æ–‡æ¡£å¼€å‘ï¼Œå› ä¸ºéœ€è¦è·å– å¾®ä¿¡å…¬ä¼—å·çš„ AccessToken æ‰€æœ‰éœ€è¦åœ¨å¾®ä¿¡åå¤©ç™½åå•å¤„æ·»åŠ æœ¬æœº IP ã€‚</p><p>åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ï¼Œè°ƒè¯•å¾®ä¿¡ JSSDK æ—¶ï¼Œå‘ç° JS-SDK æç¤ºç­¾åé”™è¯¯<code>ï½›errmsgï¼šconfig: invalid signatureï½</code>ï¼Œä½†æ˜¯é€šè¿‡ <a href="https://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=jsapisign">å¾®ä¿¡ JS æ¥å£ç­¾åæ ¡éªŒå·¥å…·</a> æäº¤ç›¸å…³å‚æ•°è¿›è¡Œæ ¡éªŒåï¼Œå‘ç°ç¨‹åºç”Ÿæˆçš„å’Œå¾®ä¿¡ç½‘é¡µç”Ÿæˆçš„ç­¾åæ˜¯ä¸€æ ·çš„,ä½†æ˜¯è¿™é‡Œå°±ä¸€ç›´æç¤ºæ˜¯æ— æ•ˆçš„ç­¾åã€‚</p><p>æˆ‘æŸ¥çœ‹äº† JS-SDK ä¸‹æ³¨å†Œ config ä¿¡æ¯å¤„çš„è¾“å…¥å‚æ•°ï¼Œå‘ç°æœ¬è¯¥æäº¤äº”ä¸ªå‚æ•°ï¼Œä½†æ˜¯åªæäº¤äº†å››ä¸ªï¼Œæ¼æäº¤äº†<strong>nonceStr</strong> å‚æ•°ï¼Œå¦‚æœä½ å‘ç°ç¨‹åºç”Ÿæˆçš„å’Œå¾®ä¿¡ç½‘é¡µç”Ÿæˆçš„ç­¾åæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æç¤ºæ— æ•ˆç­¾åï¼ŒåŠ¡å¿…æ£€æŸ¥æ˜¯å¦æ˜¯è¿™é‡Œçš„é—®é¢˜ã€‚è¿˜æœ‰æäº¤äº†äº”ä¸ªå‚æ•°ï¼Œä½†æ˜¯å‚æ•°çš„å¤§å°å†™ä¸æ­£ç¡®çš„çš„ï¼Œæ¯”å¦‚ <strong>nonceStr</strong> å†™æˆäº† <strong>nonceStr</strong> ä¹Ÿæ˜¯ä¸è¡Œçš„ã€‚å¯ä»¥å¯¹æ¯”ä¸‹å›¾è¿›è¡Œæ ¡éªŒã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20180314/100655619.png?imageslim"></p><h2 id="å‘äºŒ"><a href="#å‘äºŒ" class="headerlink" title="å‘äºŒ"></a>å‘äºŒ</h2><p>å‘ä¸€ç§æåˆ°äº† AccessTokenï¼Œä½¿ç”¨ JSSDK æ—¶è¿˜éœ€è¦å¦å¤–ä¸€ä¸ª ticketï¼Œè¿™äºŒè€…éƒ½æœ‰è¶…æ—¶æ—¶é—´çš„é™åˆ¶ï¼Œå¦‚æœè¿‡æœŸäº†ï¼Œé‚£ä¹ˆ config æ˜¯æ— è®ºå¦‚ä½•ä¹Ÿä¸ä¼šåˆå§‹åŒ–æˆåŠŸçš„ã€‚</p><h2 id="å‘ä¸‰"><a href="#å‘ä¸‰" class="headerlink" title="å‘ä¸‰"></a>å‘ä¸‰</h2><p>è¸©äº†å‰ä¸¤ä¸ªå‘ä¹‹å¤–ï¼Œå…¶å® WAP ç‰ˆçš„å¼€å‘ä¹Ÿéƒ½å·®ä¸å¤šè°ƒé€šäº†ï¼Œä½†æ˜¯åˆ†äº«ä¹‹åï¼Œåˆ†äº«äººè¿›å…¥åˆ†äº«çš„é“¾æ¥åï¼ŒäºŒæ¬¡åˆ†äº«æ—¶ï¼Œä¾¿åˆå‡ºç°äº†æ— æ•ˆç­¾åçš„æƒ…å†µï¼Œä»”ç»†æ’æŸ¥ä¹‹åï¼Œå‘ç°æ˜¯åˆ†äº«åï¼Œå¾®ä¿¡ä¼šåœ¨åˆ†äº«çš„é“¾æ¥åé¢è‡ªåŠ¨åŠ ä¸Šäº†ä¸€äº›å‚æ•°ï¼Œæ­£æ˜¯å› ä¸ºè¿™äº›å‚æ•°çš„å­˜åœ¨ï¼Œå¯¼è‡´ç­¾åå¤±è´¥ã€‚</p><p>åˆšå¼€å§‹æ²¡æœ‰ç»†çœ‹æ–‡æ¡£ï¼Œå› æ­¤åˆ†äº« URL çš„åœ°å€å°±æ²¡æœ‰è¿›è¡ŒåŠ¨æ€ä¼ é€’åˆ°åå°è¿›è¡Œç­¾åï¼Œæ‰€ä»¥å¯¼è‡´äº†äºŒæ¬¡åˆ†äº«å‡ºç°äº†é—®é¢˜ï¼Œäºæ˜¯ä¿®æ”¹ä¸ºäº†åŠ¨æ€ä¼ é€’å½“å‰ URL åˆ°åå°è¿›è¡Œç­¾åï¼Œæ‰è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœå½“å‰çš„ URL ä¸­åŒ…å«äº†ä¸­æ–‡ï¼Œéœ€è¦è¿›è¡Œ<br> <strong>encodeURIComponent</strong> åä¼ é€’ï¼Œå†åœ¨åå°è¿›è¡Œ URL è§£ç å¤„ç†ã€‚å¦å¤–ç¼–ç ä¹‹åæœ€å¥½å†å°†å‚æ•°ä¸­çš„ <strong>&amp;</strong> ä¸´æ—¶æ›¿æ¢ä¸º <strong>%26</strong>ï¼Œåå°å†æ›¿æ¢ä¸º **&amp;**ï¼Œå¦‚æœç›´æ¥ä¼ åˆ°åå°ï¼Œå­˜åœ¨å¤šä¸ªå‚æ•°çš„æƒ…å†µä¸‹ï¼Œåå°å°†åªä¼šæ¥æ”¶åˆ°ç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p><h2 id="å°æ’æ›²"><a href="#å°æ’æ›²" class="headerlink" title="å°æ’æ›²"></a>å°æ’æ›²</h2><p> å®‰å“å®¢æˆ·ç«¯è¿›è¡Œå¼€å‘çš„æ—¶å€™ï¼Œå‡ºç°äº†å¾ˆå¥‡æ€ªçš„çŠ¶å†µï¼Œå°±æ˜¯åœ¨ WebView é‡Œé¢æ— æ³•è·å–å½“å‰ APP ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå³ WebView å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œå‘ç°è·å–ä¸åˆ° Cookie ä¸­ç™»å½•ç”¨æˆ·ä¿¡æ¯çš„å€¼ï¼Œè€Œ IOS å®¢æˆ·ç«¯ä¾¿æ²¡æœ‰å‡ºç°è¿™ç§æƒ…å†µã€‚</p><p> ä¹‹å‰å®‰å“åœ¨åšç­¾åˆ°åŠŸèƒ½çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯ä½¿ç”¨çš„ WebViewï¼Œè´Ÿè´£ç­¾åˆ°åå°å¼€å‘çš„åŒäº‹ä¹Ÿé‡åˆ°äº†è¿™ç§æƒ…å†µï¼Œå½“æ—¶æ²¡æœ‰å½»åº•è§£å†³è¿™ç§é—®é¢˜ï¼Œä½¿ç”¨äº†ä¸€ç§æŠ˜ä¸­çš„æ–¹æ³•æ¥å®ç°ï¼Œè®©å®‰å“å®¢æˆ·ç«¯ä¼ é€’ä¸€ä¸²åŒ…å«ç”¨æˆ·ä¿¡æ¯çš„åŠ å¯†ä¸²å‚æ•°ï¼Œåå°è§£æè¿™ä¸ªå‚æ•°åˆ¤æ–­ç”¨æˆ·ã€‚</p><p> è°·æ­ŒæŸ¥æ‰¾è¿™ç§æƒ…å†µä¹‹åï¼Œå‘ç°å®‰å“éœ€è¦å°† Cookie åŒæ­¥åˆ° WebView ä¸­ï¼Œè¯¢é—®å®‰å“åŒäº‹ä¹‹åï¼Œä»–è¯´åŒæ­¥è¿‡äº†å•Šï¼Œè¿™å°±å¾ˆå¥‡æ€ªäº†ï¼</p><p>ç»§ç»­ä¸‡èƒ½è°·æ­ŒæŸ¥æ‰¾ï¼Œç„¶åçœ‹äº†ä¸€ä¸‹åŒäº‹çš„å®¢æˆ·ç«¯ä»£ç ï¼Œå‘ç°ä»–åŒæ­¥ Cookie åˆ° WebView éƒ¨åˆ†çš„ä»£ç å¹¶æ²¡æœ‰è®¾ç½® Cookie çš„ <strong>domain</strong> ä¸ <strong>path</strong>ï¼Œè€Œåå°è·å–ç™»å½•ç”¨æˆ·ä¿¡æ¯æ—¶ï¼Œåªå»è·å–æŒ‡å®šåŸŸåæŒ‡å®šè·¯å¾„ä¸‹çš„ Cookie å€¼ï¼Œè‡ªç„¶æ˜¯è·å–ä¸åˆ° WebView é‡Œç™»å½•ç”¨æˆ·ä¿¡æ¯çš„å€¼äº†ã€‚</p><p>çŸ¥é“äº†é—®é¢˜ï¼Œè§£å†³èµ·æ¥å°±ç®€å•å¤šäº†ï¼Œåªè¦å°†éœ€è¦åŒæ­¥çš„æ¯ä¸€æ¡ Cookie ä¿¡æ¯è®¾ç½® <strong>Domain</strong> ä¸ <strong>Path</strong> å³å¯ï¼Œåå°ä¹Ÿå°±å¯ä»¥æ‹¿åˆ°åŒæ­¥çš„ Cookie ä¿¡æ¯äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">syncCookie</span><span class="hljs-params">(String url, String cookie)</span> </span>&#123;<br>    cookie += <span class="hljs-string">&quot;;Max-Age=3600&quot;</span> + <span class="hljs-string">&quot;;Domain=.cctv.com&quot;</span> + <span class="hljs-string">&quot;;Path = /&quot;</span>  <br>    cookieManager.setCookie(url, cookie);<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å¾®ä¿¡å¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¾®ä¿¡åˆ†äº«</tag>
      
      <tag>WebViewåŒæ­¥Cookieé—®é¢˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBootä¸WebSocketé›†æˆ</title>
    <link href="/SpringBoot%E4%B8%8EWebSocket%E9%9B%86%E6%88%90.html"/>
    <url>/SpringBoot%E4%B8%8EWebSocket%E9%9B%86%E6%88%90.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç›®å‰ï¼Œå…¬å¸çš„é¡¹ç›®éƒ¨ç½²æ–¹å¼è¿˜æ˜¯ä½¿ç”¨çš„åŸå§‹çš„æ–¹å¼ï¼Œé€šè¿‡æ‰‹åŠ¨è¿è¡Œè„šæœ¬å»éƒ¨ç½²ã€‚æ¯æ¬¡å…¨éƒ¨æœåŠ¡å™¨éƒ¨ç½²ä¸€éï¼Œéœ€è¦è€—è´¹çš„æ—¶é—´å¾ˆé•¿ï¼Œå¦‚æœé‡åˆ°é”™è¯¯ï¼Œä¹Ÿä¸èƒ½ç«‹åˆ»è¿›è¡Œå›æ»šï¼Œåªèƒ½å°†é”™è¯¯è§£å†³æäº¤æˆ–è€…å°†å¤‡ä»½ä»£ç è¿›è¡Œè¿˜åŸã€‚</p><p>åœ¨æŒç»­é›†æˆå¤§è¡Œå…¶é“çš„ä»Šå¤©ï¼Œè¿™ç§åŸå§‹çš„æ–¹å¼å®åœ¨æ˜¯ä¸åº”è¯¥å†ä½¿ç”¨äº†ï¼åœ¨è°ƒç ”äº† Jekins ç­‰å¼€æºæŒç»­é›†æˆå·¥å…·ä¹‹åï¼Œå‘ç°å¯¹äºæˆ‘ä»¬å…¬å¸è€Œè¨€ï¼Œæ¯”å¦‚ Jekins çš„ä¸Šæ‰‹éš¾åº¦è¿˜æ˜¯è¾ƒé«˜çš„ï¼Œé…ç½®ä¹Ÿæ¯”è¾ƒå¤æ‚ç¹çï¼Œä¹Ÿå°±æ²¡æœ‰é‡‡ç”¨ã€‚</p><p>äºæ˜¯æƒ³ç€è‡ªå·±èƒ½ä¸èƒ½ä¹Ÿæä¸€ä¸ªç®€åŒ–ç‰ˆé€‚ç”¨äºå…¬å¸çš„è‡ªåŠ¨åŒ–éƒ¨ç½²ç³»ç»Ÿå‘¢ï¼Ÿäºæ˜¯åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†æœ¬æ–‡çš„é—®é¢˜ï¼Œä¸ºäº†<strong>å®æ—¶å±•ç¤ºæœåŠ¡å™¨å‘½ä»¤è¾“å‡ºæƒ…å†µ</strong>ï¼Œæˆ‘ä½¿ç”¨äº† WebSocket æŠ€æœ¯æ¥å®ç°ï¼ŒåŒæ—¶ä½¿ç”¨ SpringBoot æ¡†æ¶è¿›è¡Œå¿«é€Ÿæ­å»ºé¡¹ç›®ï¼Œè¯¥éƒ¨ç½²ç³»ç»Ÿç›®å‰æœªå¼€å‘å®Œæˆï¼Œå§‘ä¸”ä½œä¸ºä¸€ä¸ªç»ƒæ‰‹é¡¹ç›®ã€‚</p><a id="more"></a><h2 id="WebSocket-ä»‹ç»"><a href="#WebSocket-ä»‹ç»" class="headerlink" title="WebSocket ä»‹ç»"></a>WebSocket ä»‹ç»</h2><p>å¯¹äº WebSocket å°±ä¸å¤šè¯´ä»€ä¹ˆäº†ï¼Œç›´æ¥å¼•ç”¨ç»´åŸºç™¾ç§‘çš„è§£é‡Šã€‚  </p><blockquote><p>WebSocketæ˜¯HTML5å¼€å§‹æä¾›çš„ä¸€ç§æµè§ˆå™¨ä¸æœåŠ¡å™¨é—´è¿›è¡Œå…¨åŒå·¥é€šè®¯çš„ç½‘ç»œæŠ€æœ¯ã€‚ WebSocketé€šä¿¡åè®®äº2011å¹´è¢«IETFå®šä¸ºæ ‡å‡†RFC 6455ï¼ŒWebSocketAPIè¢«W3Cå®šä¸ºæ ‡å‡†ã€‚ åœ¨WebSocket APIä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦è¦åšä¸€ä¸ªæ¡æ‰‹çš„åŠ¨ä½œï¼Œç„¶åï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´å°±å½¢æˆäº†ä¸€æ¡å¿«é€Ÿé€šé“ã€‚ä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥æ•°æ®äº’ç›¸ä¼ é€ã€‚</p></blockquote><p>æ˜“äºç†è§£çš„ç‰ˆæœ¬ï¼Œå¯ä»¥çœ‹çœ‹é˜®ä¸€å³°çš„ <a href="http://www.ruanyifeng.com/blog/2017/05/websocket.html">WebSocket æ•™ç¨‹</a></p><p>ä¸‹é¢è®²è§£ WebSocket ä¸ SpringBoot çš„é›†æˆä½¿ç”¨ã€‚</p><h2 id="æœåŠ¡ç«¯ç¯å¢ƒå‡†å¤‡"><a href="#æœåŠ¡ç«¯ç¯å¢ƒå‡†å¤‡" class="headerlink" title="æœåŠ¡ç«¯ç¯å¢ƒå‡†å¤‡"></a>æœåŠ¡ç«¯ç¯å¢ƒå‡†å¤‡</h2><ol><li><p>SpringBoot é¡¹ç›®å¼•å…¥ WebSocket ä¾èµ–  </p> <figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-websocket<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure></li><li><p>æ–°å»º WebSocketHandlerï¼Œ ç”¨äºå¤„ç†è¯·æ±‚ï¼Œä»¥åŠå‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯</p> <figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WebSocketHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractWebSocketHandler</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> CopyOnWriteArraySet&lt;WebSocketSession&gt; webSocketSet = <span class="hljs-keyword">new</span> CopyOnWriteArraySet&lt;&gt;();<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterConnectionEstablished</span><span class="hljs-params">(WebSocketSession session)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        <span class="hljs-comment">// æ¥æ”¶åˆ°WebSocketä¼šè§¦å‘</span><br>        System.out.println(session.getUri().getQuery());<br>        webSocketSet.add(session);<br>        session.sendMessage(<span class="hljs-keyword">new</span> TextMessage(<span class="hljs-string">&quot;æ¬¢è¿ï¼ï¼ï¼&quot;</span>));<br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterConnectionClosed</span><span class="hljs-params">(WebSocketSession session, CloseStatus closeStatus)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        <span class="hljs-comment">// å…³é—­WebSocketä¼šè§¦å‘</span><br>        System.out.println(<span class="hljs-string">&quot;å…³é—­WebSocketä¼šè§¦å‘&quot;</span>);<br>    &#125;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleTransportError</span><span class="hljs-params">(WebSocketSession session, Throwable exception)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        exception.printStackTrace();<br>    &#125;<br>    <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¹¿æ’­æ¶ˆæ¯</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sendMessage</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        <span class="hljs-keyword">for</span> (WebSocketSession session : webSocketSet) &#123;<br>            session.sendMessage(<span class="hljs-keyword">new</span> TextMessage(<span class="hljs-string">&quot;æ¬¢è¿ä½ æ¥å•¦ï¼&quot;</span>));<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li><p>æ–°å»º Config ç±»ï¼Œç”¨äºæ¥æ”¶ WebSocket è¯·æ±‚</p> <figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@EnableWebSocket</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WebSocketConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">WebSocketConfigurer</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> WebSocketHandler webSocketHandler;<br>    <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">registerWebSocketHandlers</span><span class="hljs-params">(WebSocketHandlerRegistry webSocketHandlerRegistry)</span> </span>&#123;<br>        webSocketHandlerRegistry.addHandler(webSocketHandler,<span class="hljs-string">&quot;/webSocket&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="å®¢æˆ·ç«¯ç¯å¢ƒå‡†å¤‡"><a href="#å®¢æˆ·ç«¯ç¯å¢ƒå‡†å¤‡" class="headerlink" title="å®¢æˆ·ç«¯ç¯å¢ƒå‡†å¤‡"></a>å®¢æˆ·ç«¯ç¯å¢ƒå‡†å¤‡</h2></li><li><p>æ–°å»ºé¡µé¢</p> <figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span> <span class="hljs-comment">&lt;!--æ ‡å‡†HTML5--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;zh-CN&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello World!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="javascript">    <span class="hljs-keyword">var</span> websocket = <span class="hljs-literal">null</span>;</span><br><span class="javascript">    <span class="hljs-keyword">if</span>(<span class="hljs-string">&#x27;WebSocket&#x27;</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">window</span>) &#123;</span><br><span class="javascript">        websocket = <span class="hljs-keyword">new</span> WebSocket(<span class="hljs-string">&#x27;ws://localhost:8080/webSocket?code=abcd&#x27;</span>);</span><br><span class="handlebars"><span class="xml">        <span class="hljs-comment">&lt;!--æ­¤å¤„çš„åœ°å€å³ç¬¬äºŒæ­¥æŒ‡å®šçš„æ¥å£åœ°å€ï¼Œå¯ä»¥ä¼ é€’å‚æ•°--&gt;</span></span></span><br><span class="javascript">    &#125;<span class="hljs-keyword">else</span> &#123;</span><br><span class="javascript">        alert(<span class="hljs-string">&#x27;è¯¥æµè§ˆå™¨ä¸æ”¯æŒwebsocket!&#x27;</span>);</span><br>    &#125;<br><span class="javascript">    websocket.onopen = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>&#123;</span><br><span class="javascript">        alert(<span class="hljs-string">&#x27;å»ºç«‹è¿æ¥&#x27;</span>);</span><br>    &#125;<br><span class="javascript">    websocket.onclose = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>&#123;</span><br><span class="javascript">        alert(<span class="hljs-string">&#x27;è¿æ¥å…³é—­&#x27;</span>);</span><br>    &#125;<br><span class="javascript">    websocket.onmessage = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>&#123;</span><br><span class="javascript">        alert(<span class="hljs-string">&#x27;æ”¶åˆ°æ¶ˆæ¯:&#x27;</span> + event.data)</span><br>    &#125;<br><span class="javascript">    websocket.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">        alert(<span class="hljs-string">&#x27;websocketé€šä¿¡å‘ç”Ÿé”™è¯¯ï¼&#x27;</span>);</span><br>    &#125;<br><span class="javascript">    <span class="hljs-built_in">window</span>.onbeforeunload = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br>        websocket.close();<br>    &#125;<br><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p> æ³¨æ„ï¼šå¦‚æœwebsocket çš„ urlå†™çš„æ˜¯localhost:8080ï¼Œåˆ™å½“å‰é¡µé¢çš„åœ°å€ä¹Ÿåº”æ˜¯localhost:8080åŸŸåä¸‹ï¼Œä¸å¯ä»¥æ˜¯127.0.0.1:8080 ï¼Œå¦åˆ™ä¼šæç¤º 403ï¼Œå¦‚æœç”¨çœŸå®åŸŸåä¹ŸåŒç†ã€‚</p></li><li><p>æ–°å»º Controller è·³è½¬åˆ°è¯¥é¡µé¢</p> <figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HomeController</span> </span>&#123;<br><br>    <span class="hljs-meta">@GetMapping(value = &quot;/home&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelAndView <span class="hljs-title">home</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView(<span class="hljs-string">&quot;home&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="è¿›è¡Œæµ‹è¯•"><a href="#è¿›è¡Œæµ‹è¯•" class="headerlink" title="è¿›è¡Œæµ‹è¯•"></a>è¿›è¡Œæµ‹è¯•</h2></li><li><p>å¯åŠ¨é¡¹ç›®</p></li><li><p>è®¿é—® <a href="http://localhost:8080/home">http://localhost:8080/home</a></p></li><li><p>æµè§ˆå™¨æ§åˆ¶å°æ‰“å°ç»“æœï¼š<br> <img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180228151982725368692.png"></p></li></ol><h2 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h2><ul><li>æœåŠ¡å™¨å‘æµè§ˆå™¨å‘é€é€šçŸ¥å¯ä»¥ä½¿ç”¨ WebSocket</li><li>èŠå¤©å®¤</li></ul><h2 id="èµ„æºä¸‹è½½"><a href="#èµ„æºä¸‹è½½" class="headerlink" title="èµ„æºä¸‹è½½"></a>èµ„æºä¸‹è½½</h2><ul><li><a href="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/websocket.zip">ç‚¹æˆ‘ä¸‹è½½ç¤ºä¾‹æºç </a></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="http://www.ruanyifeng.com/blog/2017/05/websocket.html">http://www.ruanyifeng.com/blog/2017/05/websocket.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>SpringBoot</tag>
      
      <tag>WebSocket</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebMagicä¹‹çˆ¬è™«ç›‘æ§</title>
    <link href="/WebMagic%E4%B9%8B%E7%88%AC%E8%99%AB%E7%9B%91%E6%8E%A7.html"/>
    <url>/WebMagic%E4%B9%8B%E7%88%AC%E8%99%AB%E7%9B%91%E6%8E%A7.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¹´å‰é—²ç€æ— èŠï¼Œç ”ç©¶äº†ä¸€é˜µå­çˆ¬è™«æŠ€æœ¯ï¼Œæ¥è§¦åˆ°çˆ¬è™«æ¡†æ¶ <a href="http://webmagic.io/">WebMagic</a>ï¼Œæ„Ÿè§‰å¾ˆå¥½ç”¨ã€‚<br>åœ¨ä¹‹åçš„å·¥ä½œä¸­ï¼Œæ¥æ‰‹äº†æ–°ç«™ä¸ç¬¬ä¸‰æ–¹æ¥å£å¯¹æ¥çš„å·¥ä½œï¼Œä¸»è¦çš„å·¥ä½œæ˜¯å»æŠ“å–å¯¹æ–¹æ¥å£çš„å†…å®¹ï¼›åˆå§‹çš„æ—¶å€™ï¼Œä¹‹å‰è´Ÿè´£è¯¥å·¥ä½œçš„åŒäº‹ï¼Œæ˜¯æ‰‹åŠ¨ä½¿ç”¨å¤šçº¿ç¨‹å»æŠ“å–ï¼Œåœ¨åº”ç”¨çš„è¿‡ç¨‹å½“ä¸­æš´éœ²äº†ä¸å°‘é—®é¢˜ã€‚æ¯”å¦‚å¯¹äºæ¥å£å†…å®¹è¶…çº§å¤šçš„æ—¶å€™ï¼Œè™½ç„¶ä½¿ç”¨äº†å¤šçº¿ç¨‹ï¼Œä½†æ˜¯æŠ“å–çš„æ•ˆç‡å¾ˆä½ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰å®ç°å¢é‡æŠ“å–ï¼Œæ¯æ¬¡éƒ½éœ€è¦å»å…¨é‡æŠ“å–ï¼Œè·‘ä¸€æ¬¡åŸºæœ¬éœ€è¦å¥½å‡ å¤©-.-ï¼›å°è¯´æ˜¯è¿è½½çš„æƒ…å†µä¸‹ï¼Œè¿™ç§é—®é¢˜æ˜¯äºŸéœ€è§£å†³çš„ã€‚</p><a id="more"></a><p>è¶ç€ç†Ÿæ‚‰äº†æ–°å…µå™¨ WebMagic, æœæ–­åœ¨é¡¹ç›®ä¸­è¿›è¡Œå¼•å…¥ï¼Œè§£å†³ä»¥ä¸Šé—®é¢˜ã€‚åŠŸèƒ½ä¸Šçº¿åï¼Œæ›¿æ¢äº†åŸæœ‰çš„å¤šçº¿ç¨‹æŠ“å–ï¼Œç›®å‰å·²ç»ååˆ†ç¨³å®šï¼Œ åŸºæœ¬ä¸Šé…ç½®å¥½ä»»åŠ¡ä¹‹åï¼Œå°±æ— éœ€å†äººå·¥å¹²é¢„äº†ã€‚</p><p>ä»¥ä¸‹ï¼Œæ­£æ–‡æ˜¯åŸºäºæˆ‘å­¦ä¹  WebMagic æ—¶ç»ƒæ‰‹é¡¹ç›®ï¼ŒåŠŸèƒ½å’Œåœ¨å…¬å¸å¼€å‘çš„å·®ä¸å¤šï¼Œåªä¸è¿‡æˆ‘æœ¬åœ°å¼€å‘çš„æ˜¯å»æŠ“å–ç›—ç‰ˆç½‘ç«™çš„å†…å®¹ã€‚</p><h2 id="é¡¹ç›®é¢„è§ˆ"><a href="#é¡¹ç›®é¢„è§ˆ" class="headerlink" title="é¡¹ç›®é¢„è§ˆ"></a>é¡¹ç›®é¢„è§ˆ</h2><ol><li><p>èœå•ç®¡ç†<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180226151959640216787.png"></p></li><li><p>çˆ¬è™«ä»»åŠ¡ç®¡ç†<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180226151959624621624.png"></p></li><li><p>å®ç°äº†çˆ¬è™«çš„çŠ¶æ€ç›‘æ§ï¼Œä»¥åŠå¯è§†åŒ–å¯åœ<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180226151959631369334.png"></p></li></ol><h2 id="åˆå…¥æ‰‹å…µå™¨-åŸºæœ¬ä½¿ç”¨"><a href="#åˆå…¥æ‰‹å…µå™¨-åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åˆå…¥æ‰‹å…µå™¨-åŸºæœ¬ä½¿ç”¨"></a>åˆå…¥æ‰‹å…µå™¨-åŸºæœ¬ä½¿ç”¨</h2><ol><li><p>çˆ¬è™«å¥—è·¯åˆ†æ<br>å…ˆçœ‹å®˜æ–¹æ–‡æ¡£çš„æ€»ä½“æ¶æ„å›¾<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180226151959718557253.png">  </p><blockquote><p>å¤§éƒ¨åˆ†æ¨¡å—WebMagicå·²ç»æä¾›äº†é»˜è®¤å®ç°ã€‚   </p><div class="hljs code-wrapper"><pre><code> ä¸€èˆ¬æ¥è¯´ï¼Œå¯¹äºç¼–å†™ä¸€ä¸ªçˆ¬è™«ï¼ŒPageProcessoræ˜¯éœ€è¦ç¼–å†™çš„éƒ¨åˆ†ï¼Œè€ŒSpideråˆ™æ˜¯åˆ›å»ºå’Œæ§åˆ¶çˆ¬è™«çš„å…¥å£ã€‚  </code></pre></div></blockquote><p> å¾—ç›Šäº WebMagic æ¡†æ¶çš„è‰¯å¥½å°è£…ï¼Œå¯¹äºæ¡†æ¶çš„ä½¿ç”¨è€…æ¥è¯´ï¼Œæ‰€éœ€è¦ç¼–å†™çš„ä»£ç å‡ ä¹åªæœ‰çˆ¬è™«çš„é€»è¾‘ä»£ç ï¼Œè€Œå¯¹äºæ€ä¹ˆçˆ¬ï¼Œç»´æŠ¤ä»»åŠ¡é˜Ÿåˆ—çš„äº‹æƒ…ï¼ŒWebMagic éƒ½å¯ä»¥æ›¿æˆ‘ä»¬åšå¥½ã€‚å¼€å§‹æˆ‘ä»¬çš„çˆ¬è™«ä¹‹æ—…å§ï¼</p></li></ol><ol><li><p>å¼•å…¥ä¾èµ–<br>æœ¬æ–‡ä¸­æ‰€ä½¿ç”¨åˆ°çš„é¡¹ç›®æ˜¯åŸºäº Maven çš„ SSM é¡¹ç›®ï¼Œåœ¨ pom.xml ä¸­å¼•å…¥ WebMagic çš„ä¾èµ–ã€‚</p> <figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>us.codecraft<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>webmagic-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.7.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>us.codecraft<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>webmagic-extension<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.7.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure></li><li><p>åŸºæœ¬ç±»å›¾<br> å…ˆå°†å¯¹åº”çš„å¤„ç†ç±»è¿›è¡ŒæŠ½è±¡å‡ºæ¥ï¼Œæ–¹ä¾¿ç»Ÿä¸€å¤„ç†ã€‚<br> <img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/2018022615195977045471.png"></p></li><li><p>æ¯ä¸ªçˆ¬è™«éƒ½æœ‰å…¶å¯¹åº”çš„é…ç½®ä¿¡æ¯<br> <img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180226151959825374564.png"><br> Site æ˜¯ æŠ“å–ç½‘ç«™çš„ç›¸å…³é…ç½®ï¼ŒåŒ…æ‹¬ç¼–ç ã€æŠ“å–é—´éš”ã€é‡è¯•æ¬¡æ•°  </p></li><li><p>å¯¹åº”çš„å®ç°ç±»é‡å†™ process æ–¹æ³•ï¼Œåœ¨æ–¹æ³•ä¸­å®ç°å¯¹åº”çš„çˆ¬è™«é€»è¾‘å¤„ç†<br> <img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180226151959811438600.png"></p></li><li><p>å¯åŠ¨çˆ¬è™«<br> <img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180226151959883679762.png"></p></li><li><p>çˆ¬è™«çš„ä½¿ç”¨å°±ç®€å•å¸¦è¿‡ï¼Œå…·ä½“å¯ä»¥å°†æœ¬æ–‡ä¸å®˜æ–¹æ–‡æ¡£ç»“åˆä½¿ç”¨ï¼Œå®˜æ–¹æ–‡æ¡£çš„ç¤ºä¾‹åªæ˜¯åŸºäº main æ–¹æ³•ã€‚</p></li></ol><h2 id="çˆ¬è™«ç›‘æ§"><a href="#çˆ¬è™«ç›‘æ§" class="headerlink" title="çˆ¬è™«ç›‘æ§"></a>çˆ¬è™«ç›‘æ§</h2><ol><li><p>æ‰©å±•æºç <br> ä¸ºäº†å®ç°é¡¹ç›®é¢„è§ˆçš„æ•ˆæœï¼Œå®ç°çˆ¬è™«çš„çŠ¶æ€ç›‘æ§ï¼Œéœ€è¦å¯¹çˆ¬è™«è¿›è¡Œæ‰©å±•ã€‚å› ä¸ºå®˜ç½‘æä¾›çš„æ–¹å¼åŠŸèƒ½ä¸è¶³ä»¥è¾¾åˆ°åœ¨é¡µé¢å±•ç¤ºçš„æ•ˆæœã€‚  </p><blockquote><p>æ·»åŠ ç›‘æ§éå¸¸ç®€å•ï¼Œè·å–ä¸€ä¸ª SpiderMonitor çš„å•ä¾‹ SpiderMonitor.instance()ï¼Œå¹¶å°†ä½ æƒ³è¦ç›‘æ§çš„ Spider æ³¨å†Œè¿›å»å³å¯ã€‚ä½ å¯ä»¥æ³¨å†Œå¤šä¸ª Spider åˆ° SpiderMonitor ä¸­ã€‚</p></blockquote><p> æŸ¥çœ‹ SpiderMonitor æºä»£ç åï¼Œå¦‚æœè°ƒç”¨çš„æ˜¯ è·å–ä¸€ä¸ª SpiderMonitor çš„å•ä¾‹ SpiderMonitor  çš„ æ³¨å†Œæ–¹æ³•ï¼Œå‘ç° WebMagic å°†æ¯åªçˆ¬è™«çš„çŠ¶æ€å¯¹è±¡ SpiderStatusMXBean å…¨éƒ¨æ·»åŠ åˆ°ä¸€ä¸ª List é›†åˆå½“ä¸­å»ï¼Œè¿™æ ·å°±éš¾ä»¥åŒºåˆ†å…·ä½“æ˜¯å“ªä¸€åªçˆ¬è™«çš„çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹ SpiderMonitor è¿›è¡Œæ‰©å±•ã€‚</p><p> å°† SpiderMonitor ä¸­çš„<br> <code>private List&lt;SpiderStatusMXBean&gt; spiderStatuses = new ArrayList&lt;SpiderStatusMXBean&gt;();</code><br> ä¿®æ”¹ä¸º Map é›†åˆï¼Œkey é€‰æ‹© Spider çš„ UUID ä½œä¸ºå”¯ä¸€åŒºåˆ†çˆ¬è™«çš„æ ‡è®°ã€‚</p> <figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Experimental</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MySpiderMonitor</span> </span>&#123;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> MySpiderMonitor INSTANCE = <span class="hljs-keyword">new</span> MySpiderMonitor();<br><br><span class="hljs-keyword">private</span> AtomicBoolean started = <span class="hljs-keyword">new</span> AtomicBoolean(<span class="hljs-keyword">false</span>);<br><br><span class="hljs-keyword">private</span> Logger logger = LoggerFactory.getLogger(getClass());<br><br><span class="hljs-keyword">private</span> MBeanServer mbeanServer;<br><br><span class="hljs-keyword">private</span> String jmxServerName;<br><br><span class="hljs-keyword">private</span> Map&lt;String,MySpiderStatus&gt; spiderStatuses = <span class="hljs-keyword">new</span> HashMap&lt;String,MySpiderStatus&gt;();<br><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-title">MySpiderMonitor</span><span class="hljs-params">()</span> </span>&#123;<br>jmxServerName = <span class="hljs-string">&quot;WebMagic&quot;</span>;<br>mbeanServer = ManagementFactory.getPlatformMBeanServer();<br>&#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Map&lt;String,MySpiderStatus&gt; <span class="hljs-title">getSpiderStatuses</span><span class="hljs-params">()</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> spiderStatuses;<br>    &#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Register spider for monitor.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> spiders spiders</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> this</span><br><span class="hljs-comment"> */</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> MySpiderMonitor <span class="hljs-title">register</span><span class="hljs-params">(Spider... spiders)</span> <span class="hljs-keyword">throws</span> JMException </span>&#123;<br><span class="hljs-keyword">for</span> (Spider spider : spiders) &#123;<br>MyMonitorSpiderListener monitorSpiderListener = <span class="hljs-keyword">new</span> MyMonitorSpiderListener();<br><span class="hljs-keyword">if</span> (spider.getSpiderListeners() == <span class="hljs-keyword">null</span>) &#123;<br>List&lt;SpiderListener&gt; spiderListeners = <span class="hljs-keyword">new</span> ArrayList&lt;SpiderListener&gt;();<br>spiderListeners.add(monitorSpiderListener);<br>spider.setSpiderListeners(spiderListeners);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>spider.getSpiderListeners().add(monitorSpiderListener);<br>&#125;<br>            MySpiderStatus spiderStatusMBean = getSpiderStatusMBean(spider, monitorSpiderListener);<br>registerMBean(spiderStatusMBean);<br>spiderStatuses.put(spider.getUUID(),spiderStatusMBean);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">protected</span> MySpiderStatus <span class="hljs-title">getSpiderStatusMBean</span><span class="hljs-params">(Spider spider, MyMonitorSpiderListener monitorSpiderListener)</span> </span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MySpiderStatus(spider, monitorSpiderListener);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> MySpiderMonitor <span class="hljs-title">instance</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> INSTANCE;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMonitorSpiderListener</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">SpiderListener</span> </span>&#123;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AtomicInteger successCount = <span class="hljs-keyword">new</span> AtomicInteger(<span class="hljs-number">0</span>);<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AtomicInteger errorCount = <span class="hljs-keyword">new</span> AtomicInteger(<span class="hljs-number">0</span>);<br><br><span class="hljs-keyword">private</span> List&lt;String&gt; errorUrls = Collections.synchronizedList(<span class="hljs-keyword">new</span> ArrayList&lt;String&gt;());<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">(Request request)</span> </span>&#123;<br>successCount.incrementAndGet();<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onError</span><span class="hljs-params">(Request request)</span> </span>&#123;<br>errorUrls.add(request.getUrl());<br>errorCount.incrementAndGet();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> AtomicInteger <span class="hljs-title">getSuccessCount</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> successCount;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> AtomicInteger <span class="hljs-title">getErrorCount</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> errorCount;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">getErrorUrls</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">return</span> errorUrls;<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">registerMBean</span><span class="hljs-params">(SpiderStatusMXBean spiderStatus)</span> <span class="hljs-keyword">throws</span> MalformedObjectNameException, InstanceAlreadyExistsException, MBeanRegistrationException, NotCompliantMBeanException </span>&#123;<br>ObjectName objName = <span class="hljs-keyword">new</span> ObjectName(jmxServerName + <span class="hljs-string">&quot;:name=&quot;</span> + spiderStatus.getName());<br>        <span class="hljs-keyword">if</span>(mbeanServer.isRegistered(objName)==<span class="hljs-keyword">false</span>)<br>        &#123;<br>            mbeanServer.registerMBean(spiderStatus, objName);<br>        &#125;<br>&#125;<br><br>&#125;<br></code></pre></div></td></tr></table></figure><p> éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSpiderMonitor ä¸­ä½¿ç”¨çš„ SpiderStatus ä¹Ÿéœ€è¦è¿›è¡Œä¸€åŒæ‰©å±•ã€‚    </p> <figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MySpiderStatus</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">SpiderStatusMXBean</span> </span>&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> Spider spider;<br><br>    <span class="hljs-keyword">protected</span> Logger logger = LoggerFactory.getLogger(getClass());<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> MySpiderMonitor.MyMonitorSpiderListener monitorSpiderListener;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MySpiderStatus</span><span class="hljs-params">(Spider spider, MySpiderMonitor.MyMonitorSpiderListener monitorSpiderListener)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.spider = spider;<br>        <span class="hljs-keyword">this</span>.monitorSpiderListener = monitorSpiderListener;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Spider <span class="hljs-title">getSpider</span><span class="hljs-params">()</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.spider;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> spider.getUUID();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getLeftPageCount</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (spider.getScheduler() <span class="hljs-keyword">instanceof</span> MonitorableScheduler) &#123;<br>            <span class="hljs-keyword">return</span> ((MonitorableScheduler) spider.getScheduler()).getLeftRequestsCount(spider);<br>        &#125;<br>        logger.warn(<span class="hljs-string">&quot;Get leftPageCount fail, try to use a Scheduler implement MonitorableScheduler for monitor count!&quot;</span>);<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getTotalPageCount</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (spider.getScheduler() <span class="hljs-keyword">instanceof</span> MonitorableScheduler) &#123;<br>            <span class="hljs-keyword">return</span> ((MonitorableScheduler) spider.getScheduler()).getTotalRequestsCount(spider);<br>        &#125;<br>        logger.warn(<span class="hljs-string">&quot;Get totalPageCount fail, try to use a Scheduler implement MonitorableScheduler for monitor count!&quot;</span>);<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getSuccessPageCount</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> monitorSpiderListener.getSuccessCount().get();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getErrorPageCount</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> monitorSpiderListener.getErrorCount().get();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title">getErrorPages</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> monitorSpiderListener.getErrorUrls();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getStatus</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> spider.getStatus().name();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getThread</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> spider.getThreadAlive();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">start</span><span class="hljs-params">()</span> </span>&#123;<br>        spider.start();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">stop</span><span class="hljs-params">()</span> </span>&#123;<br>        spider.stop();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Date <span class="hljs-title">getStartTime</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> spider.getStartTime();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getPagePerSecond</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> runSeconds = (<span class="hljs-keyword">int</span>) (System.currentTimeMillis() - getStartTime().getTime()) / <span class="hljs-number">1000</span>;<br>        <span class="hljs-keyword">return</span> getSuccessPageCount() / runSeconds;<br>    &#125;<br><br>&#125;<br></code></pre></div></td></tr></table></figure></li><li><p>é‡å†™çˆ¬è™«å¯åŠ¨å¤„ä»£ç </p> <figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WebMagicService</span> </span>&#123;<br>    <br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> ApplicationContext context;<br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> TaskService taskService;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">(TaskDTO taskDTO, <span class="hljs-keyword">boolean</span> runAsync)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        MySpiderMonitor spiderMonitor = MySpiderMonitor.instance();<br>        String ruleJson = taskDTO.getTaskRuleJson();<br>        WebMagicConfig config = JSONObject.parseObject(ruleJson, WebMagicConfig.class);<br>        SpiderConfig spiderConfig = config.getSpider();<br>        AbstractPageProcess pageProcess = context.getBean(spiderConfig.getProcesser(), AbstractPageProcess.class);<br>    <br>        pageProcess.init(config);<br>        pageProcess.setUuid(taskDTO.getSpiderUUID());<br>    <br>        Spider spider = Spider.create(pageProcess).thread(spiderConfig.getThread());<br>        spider.setUUID(taskDTO.getSpiderUUID());<br>    <br>        List&lt;String&gt; pipelines = spiderConfig.getPipeline();<br>        <span class="hljs-keyword">for</span> (String pipeline : pipelines) &#123;<br>            Pipeline bean = context.getBean(pipeline, Pipeline.class);<br>            <span class="hljs-keyword">if</span> (bean != <span class="hljs-keyword">null</span>) &#123;<br>                spider.addPipeline(bean);<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// è®¾ç½®Downloader</span><br>        <span class="hljs-comment">// è®¾ç½®Scheduler</span><br>    <br>        <span class="hljs-comment">// æ³¨å†Œçˆ¬è™«</span><br>        spiderMonitor.register(spider);<br>        spider.addUrl(spiderConfig.getStartUrl());<br>    <br>        <span class="hljs-keyword">if</span> (runAsync) &#123;<br>            spider.runAsync();<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            spider.run();<br>        &#125;<br>    &#125;<br>    <br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * çˆ¬è™«çŠ¶æ€ç›‘æ§</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;TaskDTO&gt; <span class="hljs-title">runTaskList</span><span class="hljs-params">()</span> </span>&#123;<br>    <br>        MySpiderMonitor spiderMonitor = MySpiderMonitor.instance();<br>        Map&lt;String, MySpiderStatus&gt; spiderStatuses = spiderMonitor.getSpiderStatuses();<br>    <br>        List&lt;TaskDTO&gt; taskDTOList = taskService.findAll();<br>        <span class="hljs-keyword">for</span> (TaskDTO taskDTO : taskDTOList) &#123;<br>            MySpiderStatus spiderStatus = spiderStatuses.get(taskDTO.getSpiderUUID());<br>            <span class="hljs-keyword">if</span> (spiderStatus == <span class="hljs-keyword">null</span>) &#123;<br>                taskDTO.setRunState(Spider.Status.Stopped.name());<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                taskDTO.setRunState(spiderStatus.getStatus());<br>            &#125;<br>        &#125;<br>    <br>        <span class="hljs-keyword">return</span> taskDTOList;<br>    &#125;<br>    <br>    <span class="hljs-function"><span class="hljs-keyword">public</span> TaskDTO <span class="hljs-title">stop</span><span class="hljs-params">(TaskDTO taskDTO)</span> </span>&#123;<br>        MySpiderMonitor spiderMonitor = MySpiderMonitor.instance();<br>        Map&lt;String, MySpiderStatus&gt; spiderStatuses = spiderMonitor.getSpiderStatuses();<br>        MySpiderStatus spiderStatus = spiderStatuses.get(taskDTO.getSpiderUUID());<br>    <br>        <span class="hljs-keyword">if</span> (spiderStatus != <span class="hljs-keyword">null</span>) &#123;<br>            spiderStatus.stop();<br>            spiderStatus.getSpider().close();<br>        &#125;<br>    <br>        <span class="hljs-keyword">return</span> taskDTO;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p> åˆ›å»ºçˆ¬è™«æ—¶ï¼Œå°†çˆ¬è™«æ³¨å†Œåˆ° MySpiderMonitor ä¸­ï¼Œä¹‹åé€šè¿‡ getSpiderStatuses æ–¹æ³•å³å¯è·å–æ‰€æœ‰çˆ¬è™«çš„çŠ¶æ€äº†ã€‚</p></li></ol><h2 id="èµ„æºä¸‹è½½"><a href="#èµ„æºä¸‹è½½" class="headerlink" title="èµ„æºä¸‹è½½"></a>èµ„æºä¸‹è½½</h2><ul><li><a href="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/solam.zip">ç‚¹æˆ‘ä¸‹è½½æºç </a></li></ul>]]></content>
    
    
    <categories>
      
      <category>WebMagic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>webmagic</tag>
      
      <tag>çˆ¬è™«ç›‘æ§</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringDataJPAå¿«é€Ÿå…¥é—¨</title>
    <link href="/SpringDataJPA%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html"/>
    <url>/SpringDataJPA%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹‹å‰åœ¨å­¦ä¹  SpringBoot æ¡†æ¶çš„æ—¶å€™ï¼Œä½¿ç”¨åˆ°äº† SpringData JPAï¼Œä½†æ˜¯å½“æ—¶åªæ˜¯ç®€å•çš„æŸ¥è¯¢ï¼Œæ²¡æœ‰ç”¨åˆ°ç¨å¾®å¤æ‚çš„æŸ¥è¯¢ã€‚  </p><p>JPA çš„ JPQL è¯­æ³•è§„åˆ™å¯¹äºç®€å•çš„æŸ¥è¯¢å®å±åˆ©å™¨ï¼Œå¤§å¤§åŠ å¿«äº†å¼€å‘é€Ÿåº¦ã€‚ä¸ä¹…å‰ï¼Œåœ¨å…¬å¸å°†ç”¨æˆ·æ¨èåŠŸèƒ½å•ç‹¬æŠ½å–å‡ºä¸ºä¸€ä¸ªç‹¬ç«‹é¡¹ç›®ï¼Œç”±äºå…¬å¸ä¸€ç›´æ²¿ç”¨çš„åº•å±‚æ¡†æ¶å¤ªè€ï¼Œåªèƒ½ä½¿ç”¨ JDK1.6ï¼ŒJDK 1.9éƒ½å‡ºæ¥äº†ï¼Œå®åœ¨ä¸èƒ½å¿ğŸ˜…ï¼Œæœæ–­å¼•å…¥äº† SpringData JPAã€‚  </p><p>ç„¶åæœ€è¿‘å…¬å¸å…¶ä»–åŒäº‹æ¥æ‰‹äº†è¯¥é¡¹ç›®ï¼Œä½†æ˜¯ä¸å¤ªäº†è§£ SpringData JPA çš„ä½¿ç”¨ï¼Œäºæ˜¯æœ‰äº†æ­¤æ–‡ï¼Œä¸ä¼šå°±å¯ä»¥ç›´æ¥è®©ä»–çœ‹æœ¬ç¯‡åšå®¢äº†å“ˆå“ˆã€‚</p><a id="more"></a><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><p>è¿™é‡Œä¸è®²è§£ SpringData JPA ä¸æ¡†æ¶çš„æ•´åˆï¼Œåªè®²è§£ JPA è¯­æ³•çš„ä½¿ç”¨</p><h3 id="Entity-å®ä½“ç±»"><a href="#Entity-å®ä½“ç±»" class="headerlink" title="Entity å®ä½“ç±»"></a>Entity å®ä½“ç±»</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Entity</span> <span class="hljs-comment">// è¡¨ç¤ºä¸ºä¸€ä¸ªå®ä½“ç±»</span><br><span class="hljs-meta">@Table(&quot;employee&quot;)</span> <span class="hljs-comment">// è¡¨å</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Employee</span> </span>&#123;<br><br>    <span class="hljs-meta">@Id</span> <span class="hljs-comment">//ä¸»é”®æ ‡è¯†æ³¨è§£</span><br>    <span class="hljs-meta">@GeneratedValue</span> <span class="hljs-comment">// ä¸»é”®ç”Ÿæˆæ–¹å¼</span><br>    <span class="hljs-keyword">private</span> Integer id;<br><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-keyword">private</span> Integer age;<br>    <br>    <span class="hljs-comment">//Getter/Setterçœç•¥</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="Repository-æ¥å£"><a href="#Repository-æ¥å£" class="headerlink" title="Repository æ¥å£"></a>Repository æ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">// ç»§æ‰¿ JpaRepository æ¥å£ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæŸ¥è¯¢çš„å®ä½“ç±»ï¼Œç¬¬äºŒä¸ªä¸ºå®ä½“ç±»çš„ä¸»é”®æ•°æ®ç±»å‹</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">EmployeeRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">JpaRepository</span>&lt;<span class="hljs-title">Employee</span>, <span class="hljs-title">Integer</span>&gt;</span>&#123;<br><br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="æ’å…¥æµ‹è¯•æ•°æ®"><a href="#æ’å…¥æµ‹è¯•æ•°æ®" class="headerlink" title="æ’å…¥æµ‹è¯•æ•°æ®"></a>æ’å…¥æµ‹è¯•æ•°æ®</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testAdd</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) &#123;<br>        Employee employee = <span class="hljs-keyword">new</span> Employee();<br>        employee.setAge(i);<br>        employee.setName(<span class="hljs-string">&quot;test&quot;</span> + i);<br>        employeeRepository.save(employee);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="JPA-æŸ¥è¯¢è¯­æ³•è®²è§£"><a href="#JPA-æŸ¥è¯¢è¯­æ³•è®²è§£" class="headerlink" title="JPA æŸ¥è¯¢è¯­æ³•è®²è§£"></a>JPA æŸ¥è¯¢è¯­æ³•è®²è§£</h2><h3 id="ä½¿ç”¨-JPQL-è¿›è¡ŒæŸ¥è¯¢"><a href="#ä½¿ç”¨-JPQL-è¿›è¡ŒæŸ¥è¯¢" class="headerlink" title="ä½¿ç”¨ JPQL è¿›è¡ŒæŸ¥è¯¢"></a>ä½¿ç”¨ JPQL è¿›è¡ŒæŸ¥è¯¢</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">// æ–°å¢</span><br>employeeRepository.save(employee);<br><br><span class="hljs-comment">// where name = ?1</span><br>employeeRepository.findByName(<span class="hljs-string">&quot;test1&quot;</span>)<br><br><span class="hljs-comment">// where name = ?1 and age = ?2</span><br>employeeRepository.findByNameAndAge(<span class="hljs-string">&quot;test1&quot;</span>, <span class="hljs-number">20</span>);<br><br><span class="hljs-comment">// where age between ?1 and ?2 ã€åŒ…å«å¤´å°¾ã€‘</span><br>List&lt;Employee&gt; byAgeBetween = employeeRepository.findByAgeBetween(<span class="hljs-number">10</span>, <span class="hljs-number">16</span>);<br><br><span class="hljs-comment">// where age &lt; ?1</span><br>List&lt;Employee&gt; list = employeeRepository.findByAgeLessThan(<span class="hljs-number">10</span>);<br><br><span class="hljs-comment">// where age &gt; ?1</span><br>List&lt;Employee&gt; list = employeeRepository.findByAgeGreaterThan(<span class="hljs-number">90</span>);<br><br><span class="hljs-comment">// where name is null  ã€ä¸åŒ…å«ä¸ºç©ºå­—ç¬¦ä¸²çš„æ•°æ®ã€‘</span><br>List&lt;Employee&gt; list = employeeRepository.findByNameIsNull();<br><br><span class="hljs-comment">// where name like &quot;test9%&quot; ä»¥test9ä¸ºå¼€å¤´çš„name</span><br>List&lt;Employee&gt; list = employeeRepository.findByNameLike(<span class="hljs-string">&quot;test9%&quot;</span>);<br>æˆ–è€…<br>List&lt;Employee&gt; employees = employeeRepository.findByNameStartingWith(<span class="hljs-string">&quot;test&quot;</span>)<br><br><span class="hljs-comment">// where name like &quot;test_&quot; ä»¥testå¼€å¤´ï¼Œä¸”åé¢åªæ¨¡ç³ŠåŒ¹é…ä¸€ä½</span><br>List&lt;Employee&gt; list2 = employeeRepository.findByNameLike(<span class="hljs-string">&quot;test_&quot;</span>);<br><br><span class="hljs-comment">// where name like &quot;%6&quot; æ¨¡ç³ŠåŒ¹é…ä»¥6ç»“å°¾çš„</span><br>List&lt;Employee&gt; employees = employeeRepository.findByNameEndingWith(<span class="hljs-number">6</span>)<br><br><span class="hljs-comment">// where name in (?1, ?2)</span><br>List&lt;String&gt; names = Arrays.asList(<span class="hljs-string">&quot;test1&quot;</span>, <span class="hljs-string">&quot;test2&quot;</span>);<br>List&lt;Employee&gt; employees = employeeRepository.findByNameIn(names);<br><br><span class="hljs-comment">// where age &lt;&gt; ?1</span><br>List&lt;Employee&gt; employees = employeeRepository.findByAgeNot(<span class="hljs-number">99</span>);<br><br><span class="hljs-comment">// where name = ?1 order by age desc </span><br><span class="hljs-function">List&lt;Employee&gt; <span class="hljs-title">findByNameOrderByAgeDesc</span><span class="hljs-params">(<span class="hljs-string">&quot;test&quot;</span>)</span></span>;<br><br></code></pre></div></td></tr></table></figure><h3 id="ä½¿ç”¨è‡ªå®šä¹‰-Sql-ä»¥åŠ-åŸç”Ÿ-Sql-æŸ¥è¯¢"><a href="#ä½¿ç”¨è‡ªå®šä¹‰-Sql-ä»¥åŠ-åŸç”Ÿ-Sql-æŸ¥è¯¢" class="headerlink" title="ä½¿ç”¨è‡ªå®šä¹‰ Sql ä»¥åŠ åŸç”Ÿ Sql æŸ¥è¯¢"></a>ä½¿ç”¨è‡ªå®šä¹‰ Sql ä»¥åŠ åŸç”Ÿ Sql æŸ¥è¯¢</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/** EmployeeRepository.java æ·»åŠ æ–¹æ³• */</span><br><br><span class="hljs-comment">// æ ¹æ®å§“åä¸å¹´é¾„æŸ¥æ‰¾ï¼Œ[é€šè¿‡å ä½ç¬¦è·å–å‚æ•°å€¼]</span><br><span class="hljs-meta">@Query(&quot;select o from Employee o where name = ?1 and age = ?2&quot;)</span><br><span class="hljs-function">List&lt;Employee&gt; <span class="hljs-title">queryEmployeeByParams</span><span class="hljs-params">(String name, Integer age)</span></span>;<br><br><span class="hljs-comment">// æ ¹æ®å§“åä¸å¹´é¾„æŸ¥æ‰¾ï¼Œ[é€šè¿‡å‘½åå‚æ•°è·å–å‚æ•°å€¼]ï¼Œå¿…é¡»ä½¿ç”¨ @Param æ³¨è§£</span><br><span class="hljs-meta">@Query(&quot;select o from Employee o where name = :name and age = :age&quot;)</span><br><span class="hljs-function">List&lt;Employee&gt; <span class="hljs-title">queryEmployeeByParams2</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;name&quot;)</span> String name, <span class="hljs-meta">@Param(&quot;age&quot;)</span> Integer age)</span></span>;<br><br><span class="hljs-comment">// åŸç”ŸSQLï¼Œä¸ä¸Šé¢ä¸åŒçš„æ˜¯ï¼Œä¸Šé¢ä½¿ç”¨çš„æ˜¯å¯¹è±¡åç§°ä»¥åŠå¯¹è±¡å±æ€§åç§°ï¼ŒNative SQLä½¿ç”¨æ•°æ®åº“è¡¨åä»¥åŠå­—æ®µå</span><br><span class="hljs-meta">@Query(nativeQuery = true, value = &quot;select * from employee where name = :name and age = :age&quot;)</span><br><span class="hljs-function">List&lt;Employee&gt; <span class="hljs-title">queryEmployeeByParams3</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;name&quot;)</span> String name, <span class="hljs-meta">@Param(&quot;age&quot;)</span> Integer age)</span></span>;<br><br></code></pre></div></td></tr></table></figure><hr><h3 id="JPA-æ›´æ–°æ“ä½œ"><a href="#JPA-æ›´æ–°æ“ä½œ" class="headerlink" title="JPA æ›´æ–°æ“ä½œ"></a>JPA æ›´æ–°æ“ä½œ</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/** éœ€è¦æ­é…ä½¿ç”¨ <span class="hljs-doctag">@Query</span> ä¸ <span class="hljs-doctag">@Modifying</span> å’Œ <span class="hljs-doctag">@Transactional</span> æ³¨è§£ä½¿ç”¨*/</span><br><br><span class="hljs-meta">@Modifying</span><br><span class="hljs-meta">@Query(&quot;update Employee o set o.age = ?2 where o.id = ?1&quot;)</span><br><span class="hljs-function">Integer <span class="hljs-title">updateAge</span><span class="hljs-params">(Integer id, Integer age)</span></span>;<br><br></code></pre></div></td></tr></table></figure><p>åœ¨ Service å±‚è°ƒç”¨</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br><span class="hljs-keyword">private</span> EmployeeRepository employeeRepository;<br><br><span class="hljs-meta">@Transactional</span> <span class="hljs-comment">// å¿…é¡»å¼€å¯äº‹åŠ¡</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">(Integer id, Integer age)</span> </span>&#123;<br>    employeeRepository.update(id, age);<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="åˆ†é¡µæŸ¥è¯¢"><a href="#åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="åˆ†é¡µæŸ¥è¯¢"></a>åˆ†é¡µæŸ¥è¯¢</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">// EmployeeRepository æ¥å£å®šä¹‰</span><br><span class="hljs-function">Page&lt;Employee&gt; <span class="hljs-title">findByNameStartingWith</span><span class="hljs-params">(String name, Pageable pageable)</span></span>;<br><br><span class="hljs-comment">// æµ‹è¯•ç±» EmployeeRepositoryTest.java</span><br><span class="hljs-comment">// æ™®é€šåˆ†é¡µæŸ¥è¯¢</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindByNameStartingWith</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-comment">// æ³¨æ„ page ä» 0 å¼€å§‹</span><br>    Pageable request = <span class="hljs-keyword">new</span> PageRequest(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>);<br>    Page&lt;Employee&gt; result = employeeRepository.findByNameStartingWith(<span class="hljs-string">&quot;test&quot;</span>, request);<br>    <span class="hljs-keyword">for</span> (Employee employee : result.getContent()) &#123;<br>        System.out.println(employee);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// å¸¦æ’åºæ¡ä»¶çš„åˆ†é¡µæŸ¥è¯¢</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testFindByNameStartingWith</span><span class="hljs-params">()</span> </span>&#123;<br>    Sort.Order order = <span class="hljs-keyword">new</span> Sort.Order(Sort.Direction.DESC, <span class="hljs-string">&quot;id&quot;</span>);<br>    Sort sort = <span class="hljs-keyword">new</span> Sort(order);<br>    Pageable request = <span class="hljs-keyword">new</span> PageRequest(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>, sort);<br>    Page&lt;Employee&gt; result = employeeRepository.findByNameStartingWith(<span class="hljs-string">&quot;test&quot;</span>, request);<br>    <span class="hljs-keyword">for</span> (Employee employee : result.getContent()) &#123;<br>        System.out.println(employee);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="åŠ¨æ€-SQL-æŸ¥è¯¢"><a href="#åŠ¨æ€-SQL-æŸ¥è¯¢" class="headerlink" title="åŠ¨æ€ SQL æŸ¥è¯¢"></a>åŠ¨æ€ SQL æŸ¥è¯¢</h3><p>åœ¨ Java å¼€å‘ä¸­ï¼ŒåŠ¨æ€ SQL æ˜¯å¿…ä¸å¯å°‘çš„ï¼ŒJPA ä¹Ÿå¯ä»¥å®ç°ï¼ŒRepository å¤šç»§æ‰¿ä¸€ä¸ªæ¥å£ <code>JpaSpecificationExecutor</code> å³å¯ã€‚</p><figure class="highlight haxe"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs haxe"><span class="hljs-comment">// ä¿®æ”¹ä¹‹å‰çš„ EmployeeRepository, ä½¿å…¶å¤šç»§æ‰¿ JpaSpecificationExecutor æ¥å£</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">EmployeeRepository</span> <span class="hljs-keyword"><span class="hljs-keyword">extends</span> <span class="hljs-type">JpaRepository</span></span>&lt;<span class="hljs-title">Employee</span>, <span class="hljs-title">Integer</span>&gt;, <span class="hljs-title">JpaSpecificationExecutor</span>&lt;<span class="hljs-title">Employee</span>&gt;</span>&#123;<br><br>    <span class="hljs-comment">// ......</span><br>&#125;<br><br><br>Pageable request = <span class="hljs-keyword">new</span> <span class="hljs-type">PageRequest</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>);<br>Specification&lt;Employee&gt; specification = <span class="hljs-keyword">new</span> <span class="hljs-type">Specification</span>&lt;Employee&gt;() &#123;<br><span class="hljs-keyword">public</span> Predicate toPredicate(Root&lt;Employee&gt; root, CriteriaQuery&lt;?&gt; query, CriteriaBuilder cb) &#123;<br>        Path&lt;Integer&gt; path = root.<span class="hljs-keyword">get</span>(<span class="hljs-string">&quot;age&quot;</span>);<br>                <span class="hljs-keyword">return</span> cb.gt(path, <span class="hljs-number">50</span>);<br>            &#125;<br>        &#125;;<br>Page&lt;Employee&gt; all = employeeRepository.findAll(specification, request);<br></code></pre></div></td></tr></table></figure><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>è¿™é‡Œæ„Ÿè°¢ä¸€ä¸‹<a href="https://www.imooc.com/">æ…•è¯¾ç½‘</a>ï¼Œå¿«é€Ÿå…¥é—¨å¤šäºäº† imooc ä¸Šçš„è¯¾ç¨‹ã€‚</p><p>å‚è€ƒè¯¾ç¨‹ï¼š    </p><ul><li><a href="https://www.imooc.com/learn/821">https://www.imooc.com/learn/821</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JPA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Macä¸‹VMwareFusionå®‰è£…CentOSå¹¶è®¾ç½®é™æ€IP</title>
    <link href="/Mac%E4%B8%8BVMwareFusion%E5%AE%89%E8%A3%85CentOS%E5%B9%B6%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81IP.html"/>
    <url>/Mac%E4%B8%8BVMwareFusion%E5%AE%89%E8%A3%85CentOS%E5%B9%B6%E8%AE%BE%E7%BD%AE%E9%9D%99%E6%80%81IP.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>MACä¸‹VMwareFusionå®‰è£…CentOSåŠè®¾ç½®å›ºå®šIP<br>ä¹‹å‰å†™è¿‡ä¸€ç¯‡æ–‡ç« ï¼Œå…³äºè™šæ‹Ÿæœºçš„å¿«é€Ÿå®‰è£…çš„æ•™ç¨‹ <a href="http://nullpointer.pw/CentOS%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85.html">CentOSå¿«é€Ÿå®‰è£…</a>ï¼Œå½“æ—¶æ˜¯å­¦ä¹ ä¸­ç”¨åˆ°äº† Linux ç¯å¢ƒï¼Œä¸ºäº†ä»¥åæ— éœ€é‡å¤è¿›è¡Œè™šæ‹Ÿæœºç¹æ‚é…ç½®ï¼Œæ¯”å¦‚é…ç½®ç½‘ç»œè¿æ¥å¤–ç½‘ï¼Œæ‰åˆ¶ä½œçš„é•œåƒã€‚ä¸ºäº†å¼€å‘è°ƒè¯•æ–¹ä¾¿ï¼Œé•œåƒè®¾ç½®ä¸ºäº†å›ºå®š IPï¼Œæ‰€ä»¥å¯¼å…¥è¯¥é•œåƒçš„æ—¶å€™ï¼Œéœ€è¦ç®€å•è®¾ç½®ä»¥ä¸‹å³å¯ è®¿é—®å¤–ç½‘ç¯å¢ƒã€‚<br>å½“æ—¶ä½¿ç”¨çš„æ˜¯ Windows ç¯å¢ƒï¼Œå‰ä¸ä¹…å…¥æ‰‹äº† MBPï¼Œä¹Ÿéœ€è¦ç”¨åˆ°è™šæ‹Ÿæœºç¯å¢ƒï¼Œä½†æ˜¯ MAC ç¯å¢ƒä¸‹å¹¶æ²¡æœ‰ <code>è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨</code>,æ‰€ä»¥è®¾ç½®é™æ€ IP è´¹äº†å¥½ä¸€èˆ¬åŠŸå¤«ã€‚æœ¬æ–‡ä»‹ç»è™šæ‹Ÿæœºå¿«é€Ÿå¯¼å…¥é•œåƒï¼Œä¿®æ”¹é™æ€IPã€‚</p><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><ul><li>VMware Fusion </li><li>CentOS é•œåƒ(é“¾æ¥ï¼š<a href="http://pan.baidu.com/s/1nuKxhpf">http://pan.baidu.com/s/1nuKxhpf</a> å¯†ç ï¼š8dt8)</li></ul><h2 id="å¯¼å…¥è™šæ‹Ÿæœºé•œåƒ"><a href="#å¯¼å…¥è™šæ‹Ÿæœºé•œåƒ" class="headerlink" title="å¯¼å…¥è™šæ‹Ÿæœºé•œåƒ"></a>å¯¼å…¥è™šæ‹Ÿæœºé•œåƒ</h2><p>ä¸‹è½½é•œåƒåè§£å‹ï¼Œæ‰“å¼€ Vmware Fusion è½¯ä»¶ï¼Œé€‰æ‹©å¯¼å…¥</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180121151651476447145.png"></p><p>é€‰æ‹©é•œåƒæ–‡ä»¶ï¼Œé€‰æ‹© ovf æ–‡ä»¶åæ‰“å¼€ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/2018012115165148637891.png"></p><p>å¯¼å…¥è¿‡ç¨‹ä¸å†èµ˜è¿°ã€‚</p><hr><h2 id="ä¸ºé™æ€IPåšå‡†å¤‡"><a href="#ä¸ºé™æ€IPåšå‡†å¤‡" class="headerlink" title="ä¸ºé™æ€IPåšå‡†å¤‡"></a>ä¸ºé™æ€IPåšå‡†å¤‡</h2><p>æ‰“å¼€ VMware Fusion è®¾ç½®ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180121151652247955860.png"></p><p>è¿›å…¥ç½‘ç»œé€‰é¡¹å¡ï¼Œæ·»åŠ ä¸€ä¸ªç½‘å¡ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180121151652276054517.png"></p><p>æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/Library/</span>Preferences<span class="hljs-regexp">/VMware\ Fusion/</span><br><br>sudo vim networking<br><br></code></pre></div></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180121151652307377122.png"></p><p>çº¢è‰²åœˆå†…æ˜¯æˆ‘ä»¬éœ€è¦å…³æ³¨çš„åœ°æ–¹,ä¿®æ”¹å®Œä¹‹åä¿å­˜é€€å‡ºã€‚</p><p>å†ä¿®æ”¹å¦å¤–ä¸€ä¸ªæ–‡ä»¶ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">cd <span class="hljs-regexp">/Library/</span>Preferences<span class="hljs-regexp">/VMware\ Fusion/</span>vmnet2<br>sudo vim nat.conf<br></code></pre></div></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/2018012115165233457757.png"></p><hr><h2 id="ä½¿ç½‘ç»œé…ç½®ç”Ÿæ•ˆ"><a href="#ä½¿ç½‘ç»œé…ç½®ç”Ÿæ•ˆ" class="headerlink" title="ä½¿ç½‘ç»œé…ç½®ç”Ÿæ•ˆ"></a>ä½¿ç½‘ç»œé…ç½®ç”Ÿæ•ˆ</h2><p>é‡æ–°æ‰“å¼€VMwareçš„ç½‘ç»œé…ç½®ï¼Œä¸ºäº†ä½¿åˆšæ‰çš„ä¿®æ”¹ç”Ÿæ•ˆï¼Œæˆ‘ä»¬é‡æ–°è®¾ç½®ä¿å­˜ä¸€ä¸‹ã€‚æ­¥éª¤æ˜¯ï¼Œå…ˆå–æ¶ˆå‹¾é€‰<code>å°† Mac ä¸»æœºè¿æ¥åˆ°è¯¥ç½‘ç»œ</code> ç‚¹å‡»åº”ç”¨ï¼›å†å‹¾é€‰ä¸Š <code>å°† Mac ä¸»æœºè¿æ¥åˆ°è¯¥ç½‘ç»œ</code>ï¼Œç‚¹å‡»åº”ç”¨ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/2018012115165234489139.png"></p><hr><h2 id="ä¿®æ”¹è™šæ‹Ÿæœºçš„é™æ€-IP"><a href="#ä¿®æ”¹è™šæ‹Ÿæœºçš„é™æ€-IP" class="headerlink" title="ä¿®æ”¹è™šæ‹Ÿæœºçš„é™æ€ IP"></a>ä¿®æ”¹è™šæ‹Ÿæœºçš„é™æ€ IP</h2><p>æ‰“å¼€è™šæ‹Ÿæœº</p><figure class="highlight makefile"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs makefile"><span class="hljs-section">è´¦å·: root</span><br><span class="hljs-section">å¯†ç : 123456</span><br></code></pre></div></td></tr></table></figure><p>ä¿®æ”¹ç¬¬ä¸€ä¸ªæ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">vi <span class="hljs-regexp">/etc/</span>sysconfig<span class="hljs-regexp">/network-scripts/i</span>fcfg-eth0<br></code></pre></div></td></tr></table></figure><p>ä¿®æ”¹ <code>DEVICE</code> ä¸º <code>eth1</code>;<br>ä¿®æ”¹ <code>IPADDR</code> åœ°å€ä¸º <code>192.168.200.3 ~ 192.168.200.254</code> ä¹‹é—´çš„å€¼;<br>ä¿®æ”¹ <code>GATEWAY</code> ä¸º <code>nat.conf</code> ä¸­é…ç½®çš„ ip åœ°å€ <code>192.168.200.2</code></p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180121151652365148908.png"></p><p>ä¿®æ”¹å¦å¤–ä¸€ä¸ªæ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">vi <span class="hljs-regexp">/etc/u</span>dev<span class="hljs-regexp">/rules.d/</span><span class="hljs-number">70</span>-persistent-net.rules<br></code></pre></div></td></tr></table></figure><figure class="highlight sqf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sqf">æ³¨é‡Šæ‰ eth0 æ‰€åœ¨è¡Œï¼Œç»“æœæ˜¯<br><span class="hljs-meta"># PCI device 0x8086:0x100f (e1000)</span><br><span class="hljs-meta">#SUBSYSTEM==<span class="hljs-meta-string">&quot;net&quot;</span>, ACTION==<span class="hljs-meta-string">&quot;add&quot;</span>, DRIVERS==<span class="hljs-meta-string">&quot;?*&quot;</span>, ATTR&#123;address&#125;==<span class="hljs-meta-string">&quot;00:0c:29:30:a4:b5&quot;</span>, ATTR&#123;type&#125;==<span class="hljs-meta-string">&quot;1&quot;</span>, KERNEL==<span class="hljs-meta-string">&quot;eth*&quot;</span>, NAME=<span class="hljs-meta-string">&quot;eth0&quot;</span></span><br><span class="hljs-meta"># PCI device 0x8086:0x100f (e1000)</span><br>SUBSYSTEM==<span class="hljs-string">&quot;net&quot;</span>, <span class="hljs-built_in">ACTION</span>==<span class="hljs-string">&quot;add&quot;</span>, DRIVERS==<span class="hljs-string">&quot;?*&quot;</span>, ATTR&#123;address&#125;==<span class="hljs-string">&quot;00:0c:29:cd:05:ea&quot;</span>, ATTR&#123;<span class="hljs-built_in">type</span>&#125;==<span class="hljs-string">&quot;1&quot;</span>, KERNEL==<span class="hljs-string">&quot;eth*&quot;</span>, <span class="hljs-built_in">NAME</span>=<span class="hljs-string">&quot;eth1&quot;</span><br></code></pre></div></td></tr></table></figure><p>é‡å¯ è™šæ‹Ÿæœº</p><figure class="highlight ebnf"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ebnf"><span class="hljs-attribute">reboot</span><br></code></pre></div></td></tr></table></figure><p>é‡å¯æˆåŠŸåï¼Œè¾“å…¥ <code>ifconfig</code> æç¤ºï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180121151652403427361.png"></p><p>æ­¤æ—¶å·²ç»ä¹Ÿå¯ä»¥ ping é€šå¤–ç½‘äº†ï¼Œåœ¨ mac çš„ç»ˆç«¯ä¸­ä¹Ÿå¯ä»¥ ping é€šè™šæ‹Ÿæœºã€‚</p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>ä¸ºäº†åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œè™šæ‹Ÿæœºç¯å¢ƒè¢«æŠ˜è…¾åï¼Œå¯ä»¥åšä¸€ä¸‹å¿«ç…§ã€‚åˆ°æ—¶å€™å¯ä»¥ç›´æ¥æ¢å¤åˆ°æ­¤å¿«ç…§ï¼Œå…å»å†æ¬¡å®‰è£…çš„æ­¥éª¤ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180121151651578018201.png"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="http://blog.csdn.net/zhishengqianjun/article/details/77046796">http://blog.csdn.net/zhishengqianjun/article/details/77046796</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å·¥å…·ä½¿ç”¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>VMware Fusion</tag>
      
      <tag>é™æ€IP</tag>
      
      <tag>mac</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸºäºå¾®ä¿¡äº‹ä»¶äºŒç»´ç æ¨å¹¿</title>
    <link href="/%E5%9F%BA%E4%BA%8E%E5%BE%AE%E4%BF%A1%E4%BA%8B%E4%BB%B6%E4%BA%8C%E7%BB%B4%E7%A0%81%E6%8E%A8%E5%B9%BF.html"/>
    <url>/%E5%9F%BA%E4%BA%8E%E5%BE%AE%E4%BF%A1%E4%BA%8B%E4%BB%B6%E4%BA%8C%E7%BB%B4%E7%A0%81%E6%8E%A8%E5%B9%BF.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹‹å‰å†™äº†ä¸€ç¯‡å…³äºæ¨å¹¿ç³»ç»Ÿè®¾è®¡çš„åšå®¢ï¼Œåœ¨é‚£ç¯‡åšå®¢ä¸­ä»‹ç»äº†ç»Ÿä¸€çš„æ¨å¹¿åœ°å€ç”Ÿæˆçš„æ–¹æ³•ï¼Œåªä¸¾ä¾‹è¯´æ˜äº†ä¸€ç§æ¨å¹¿çš„æ–¹å¼ï¼Œæœ¬ç¯‡åšå®¢è®²è§£å¦å¤–ä¸€ç§æ¨å¹¿æ–¹å¼ï¼ŒåŸºäº<strong>å¾®ä¿¡äº‹ä»¶äºŒç»´ç </strong>çš„æ–¹å¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œäº‹ä»¶äºŒç»´ç <strong>åªæœ‰æœåŠ¡å·æœ‰æ­¤æ¥å£æƒé™ï¼Œè®¢é˜…å·æ˜¯æ²¡æœ‰è¯¥æ¥å£æƒé™çš„</strong>ï¼Œå½“ç„¶å¦‚æœæ²¡æœ‰æœåŠ¡å·çš„è¯ï¼Œæƒ³å­¦ä¹ ä¸€ä¸‹æ¥å£çš„ä½¿ç”¨ï¼Œå¾®ä¿¡å®˜æ–¹æä¾›çš„<strong>æµ‹è¯•å·</strong>å¯ä»¥ä½¿ç”¨è¯¥æ¥å£ã€‚</p><a id="more"></a><h2 id="è°ˆè°ˆäº‹ä»¶äºŒç»´ç "><a href="#è°ˆè°ˆäº‹ä»¶äºŒç»´ç " class="headerlink" title="è°ˆè°ˆäº‹ä»¶äºŒç»´ç "></a>è°ˆè°ˆäº‹ä»¶äºŒç»´ç </h2><p>äºŒç»´ç çš„ä¾¿åˆ©æ€§æ¯‹åº¸ç½®ç–‘ï¼Œå°¤å…¶æ˜¯åœ¨å¾®ä¿¡ä¸­å¯ä»¥é€šè¿‡é•¿æŒ‰è¯†åˆ«çš„æ–¹å¼è¯†åˆ«äºŒç»´ç ï¼Œè®©äºŒç»´ç çš„ä½¿ç”¨æ›´åŠ ä¾¿æ·é¢‘ç¹ã€‚å¾®ä¿¡æ¨å‡ºçš„äº‹ä»¶äºŒç»´ç å¤§å¤§æé«˜äºŒç»´ç çš„äº¤äº’èƒ½åŠ›ï¼Œä»¥ä¸‹å†…å®¹æ‘˜è‡ªå®˜ç½‘ä»‹ç»ã€‚</p><blockquote><p>ä¸ºäº†æ»¡è¶³ç”¨æˆ·æ¸ é“æ¨å¹¿åˆ†æå’Œç”¨æˆ·å¸å·ç»‘å®šç­‰åœºæ™¯çš„éœ€è¦ï¼Œå…¬ä¼—å¹³å°æä¾›äº†ç”Ÿæˆå¸¦å‚æ•°äºŒç»´ç çš„æ¥å£ã€‚ä½¿ç”¨è¯¥æ¥å£å¯ä»¥è·å¾—å¤šä¸ªå¸¦ä¸åŒåœºæ™¯å€¼çš„äºŒç»´ç ï¼Œç”¨æˆ·æ‰«æåï¼Œå…¬ä¼—å·å¯ä»¥æ¥æ”¶åˆ°äº‹ä»¶æ¨é€ã€‚</p></blockquote><p>äº‹ä»¶äºŒç»´ç å¯ä»¥äº§ç”Ÿäº‹ä»¶ï¼Œå¹¶ä¸”äºŒç»´ç æ˜¯å¯ä»¥æºå¸¦å‚æ•°çš„ï¼Œè¿™å°±å¯ä»¥ç”¨ä½œæ¨å¹¿ã€‚æ¯”å¦‚æˆ‘å¸ï¼Œé’ˆå¯¹æŸä¸€æœ¬ä¹¦çš„æŸä¸€ç« èŠ‚ç”Ÿæˆäº‹ä»¶äºŒç»´ç ï¼Œç”¨æˆ·æ‰«æäºŒç»´ç åï¼Œå¦‚æœæœªå…³æ³¨å…¬ä¼—å·ï¼Œä¼šè¿›å…¥å…³æ³¨å…¬ä¼—å·é¡µé¢ï¼Œæ–¹ä¾¿ç”¨æˆ·è¿›è¡Œå…³æ³¨ï¼Œå…³æ³¨åï¼Œåå°æ¥æ”¶åˆ°å¾®ä¿¡çš„äº‹ä»¶æ¨é€ï¼Œå¾—åˆ°äº†å­˜å‚¨çš„ä¹¦ä¸ç« èŠ‚çš„ä¿¡æ¯ï¼Œåˆ™å¯ä»¥ç›´æ¥å‘é€æ¶ˆæ¯ï¼Œå¼•å¯¼ç”¨æˆ·è¿›å…¥æ¨å¹¿çš„ç« èŠ‚é¡µé¢ï¼Œä»¥ä¸‹ä¸ºæˆ‘å¸å¾®ä¿¡æ¨å¹¿çš„æµç¨‹å›¾ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/2018010615152212998383.png"></p><h2 id="åˆ›å»ºäº‹ä»¶äºŒç»´ç "><a href="#åˆ›å»ºäº‹ä»¶äºŒç»´ç " class="headerlink" title="åˆ›å»ºäº‹ä»¶äºŒç»´ç "></a>åˆ›å»ºäº‹ä»¶äºŒç»´ç </h2><p>ä¸ºäº†ä¾¿äºæ¼”ç¤ºï¼Œæˆ‘çš„é¡¹ç›®æ˜¯åŸºäº SpringBoot æ­å»ºã€‚æœ¬é¡¹ç›®ä½¿ç”¨çš„æ˜¯å¾®ä¿¡æµ‹è¯•å·ï¼Œå¯ä»¥åœ¨æ­¤å¤„è¿›è¡Œç”³è¯· **<a href="https://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&t=sandbox/index">å¾®ä¿¡æµ‹è¯•å·</a>**ã€‚appID ä¸ appsecret åœ¨å¾®ä¿¡æµ‹è¯•å·ä¸­å¯ä»¥å¾—åˆ°ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/2018010615152200274759.png"></p><p>ä¹‹å‰åœ¨å…¬å¸å†™è¿™å¥—æ¨å¹¿ç³»ç»Ÿçš„æ—¶å€™ï¼Œéƒ½æ˜¯è‡ªå·±çœ‹å¾®ä¿¡å…¬ä¼—å¹³å°æ–‡æ¡£ï¼Œè‡ªå·±å†™çš„åŸºç¡€ä»£ç ï¼Œæ¯”å¦‚å°è£…è¯·æ±‚å‚æ•°ï¼Œå‚æ•°æ‹¼æ¥ï¼Œæœ€è¿‘åœ¨ Github ä¸Šå‘ç°äº†ä¸€ä¸ªå°è£…å¾—ä¸é”™çš„ å¾®ä¿¡å¼€å‘ SDKï¼Œå¯¹å¾®ä¿¡çš„å¼€æ”¾å¹³å°ã€å…¬ä¼—å¹³å°ã€å°ç¨‹åºéƒ½æœ‰å¯¹åº”çš„å­é¡¹ç›®ã€‚ç§‰ç€ä¸é‡å¤é€ è½®å­çš„åŸåˆ™ï¼Œæˆ‘ä»¬å¼•å…¥è¿™å¥— SDKï¼Œä¹Ÿå°±æ— éœ€è‡ªå·±å†è¿›è¡Œå°è£…äº†ï¼Œè¿˜å¯ä»¥å­¦ä¹ å°è£…çš„æºä»£ç ã€‚</p><ol><li><p>é¦–å…ˆæ·»åŠ  Maven ä¾èµ–ï¼Œè¿™é‡Œå¼•å…¥æ“ä½œå¾®ä¿¡å…¬ä¼—å·çš„ SDK</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.binarywang<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>weixin-java-mp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.8.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure></li><li><p>ç„¶åé…ç½®å¾®ä¿¡å…¬ä¼—å¹³å°å‚æ•° appID ä¸ appsecretï¼Œ<br>æ–°å»ºå¾®ä¿¡å¹³å°é…ç½®ä¿¡æ¯ Properties</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">import</span> lombok.Data;<br><span class="hljs-keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@ConfigurationProperties(prefix = &quot;wechat&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WechatProperties</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> String appId;<br><br>    <span class="hljs-keyword">private</span> String seecret;<br><br>    <span class="hljs-keyword">private</span> String token;<br>&#125;<br><br></code></pre></div></td></tr></table></figure></li><li><p>application.yml ä¸­æ·»åŠ  appID ä¸ appsecret</p><figure class="highlight yml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs yml"><span class="hljs-attr">wechat:</span><br>  <span class="hljs-attr">appId:</span> <span class="hljs-string">wx1234567890</span><br>  <span class="hljs-attr">seecret:</span> <span class="hljs-string">c912345678900987654321</span><br>  <span class="hljs-attr">token:</span> <span class="hljs-string">QAnEo9760zDywWMvTKCxx</span><br></code></pre></div></td></tr></table></figure></li><li><p>åˆ›å»ºå¾®ä¿¡é…ç½®ç±»ï¼Œå£°æ˜ä¸¤ä¸ª Beanã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WeChatConfig</span> </span>&#123;<br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> WechatProperties wechatProperties;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> WxMpService <span class="hljs-title">wxMpService</span><span class="hljs-params">()</span> </span>&#123;<br>        WxMpService wxMpService = <span class="hljs-keyword">new</span> WxMpServiceImpl();<br>        wxMpService.setWxMpConfigStorage(wxMpConfigStorage());<br>        <span class="hljs-keyword">return</span> wxMpService;<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> WxMpConfigStorage <span class="hljs-title">wxMpConfigStorage</span><span class="hljs-params">()</span> </span>&#123;<br>        WxMpInMemoryConfigStorage wxMpConfigStorage = <span class="hljs-keyword">new</span> WxMpInMemoryConfigStorage();<br>        wxMpConfigStorage.setAppId(wechatProperties.getAppId());<br>        wxMpConfigStorage.setSecret(wechatProperties.getSeecret());<br>        wxMpConfigStorage.setToken(wechatProperties.getToken());<br>        <span class="hljs-keyword">return</span> wxMpConfigStorage;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li><p>åˆ›å»º WechaptService ä»¥åŠå…¶å®ç°ç±»</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WechapServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">WechatService</span> </span>&#123;<br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> WxMpService wxMpService;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ›å»ºæ°¸ä¹…äº‹ä»¶äºŒç»´ç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> param é™„åŠ çš„å‚æ•°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> needShortUrl æ˜¯å¦è½¬æ¢ä¸ºçŸ­é“¾æ¥</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> å¾®ä¿¡äºŒç»´ç åœ°å€</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">createQrCode</span><span class="hljs-params">(String param, <span class="hljs-keyword">boolean</span> needShortUrl)</span> </span>&#123;<br>        WxMpQrcodeService qrService = wxMpService.getQrcodeService();<br>        <span class="hljs-keyword">try</span> &#123;<br>            WxMpQrCodeTicket ticket = qrService.qrCodeCreateLastTicket(param);<br>            String url = qrService.qrCodePictureUrl(ticket.getTicket(), needShortUrl);<br>            <span class="hljs-keyword">return</span> url;<br>        &#125; <span class="hljs-keyword">catch</span> (WxErrorException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ›å»ºä¸´æ—¶äº‹ä»¶äºŒç»´ç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> param é™„åŠ çš„å‚æ•°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> expireSeconds æœ‰æ•ˆæ—¶é—´ å•ä½ä¸ºç§’ï¼Œæœ€å¤§2592000ï¼ˆå³30å¤©ï¼‰</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> needShortUrl æ˜¯å¦è½¬æ¢ä¸ºçŸ­é“¾æ¥</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> å¾®ä¿¡äºŒç»´ç åœ°å€</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">createTempQrCode</span><span class="hljs-params">(String param, Integer expireSeconds, <span class="hljs-keyword">boolean</span> needShortUrl)</span> </span>&#123;<br>        WxMpQrcodeService qrService = wxMpService.getQrcodeService();<br>        <span class="hljs-keyword">try</span> &#123;<br>            WxMpQrCodeTicket ticket = qrService.qrCodeCreateTmpTicket(param, expireSeconds);<br>            String url = qrService.qrCodePictureUrl(ticket.getTicket(), needShortUrl);<br>            <span class="hljs-keyword">return</span> url;<br>        &#125; <span class="hljs-keyword">catch</span> (WxErrorException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    &#125;<br><br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œç®€å•çš„å‡ è¡Œè¯­å¥å°±å¯ä»¥ç”Ÿæˆäº‹ä»¶äºŒç»´ç äº†ã€‚è¿™é‡Œçš„å‚æ•° param å°±æ˜¯é™„åŠ åˆ°äºŒç»´ç ä¸­çš„å‚æ•°ï¼ˆå¯ä»¥æ”¾å…¥æ¨å¹¿ç›¸å…³å‚æ•°ï¼Œå¦‚æ¨å¹¿é“¾æ¥IDï¼‰ï¼Œç”¨æˆ·æ‰«æåï¼Œå¾®ä¿¡æœåŠ¡å™¨ä¼šæ¨é€ç›¸åº”çš„äº‹ä»¶ï¼Œå¯ä»¥åœ¨äº‹ä»¶å‚æ•°ä¸­å¯ä»¥è·å¾— paramã€‚</p></li><li><p>åˆ›å»º Spring Junit æµ‹è¯•è¯¥æ–¹æ³•ï¼Œç”Ÿæˆäº‹ä»¶äºŒç»´ç </p></li></ol><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@RunWith(SpringRunner.class)</span><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WechapServiceImplTest</span> </span>&#123;<br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> WechatService wechatService;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">createQrCode</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        String url = wechatService.createQrCode(<span class="hljs-string">&quot;hello wechat&quot;</span>, <span class="hljs-keyword">true</span>);<br>        System.out.println(url);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><ol start="7"><li>æ‰“å¼€ç”Ÿæˆçš„äºŒç»´ç é“¾æ¥ï¼ŒçŸ­é“¾æ¥ URL æ ¼å¼å¦‚ï¼š <strong><a href="https://w.url.cn/s/xxxxx">https://w.url.cn/s/xxxxx</a></strong> ä½¿ç”¨å¾®ä¿¡è¿›è¡Œæ‰«æï¼Œä¼šè¿›å…¥æç¤ºå…³æ³¨çš„é¡µé¢ã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/2018010615152206445930.png"></li></ol><h2 id="æ¥æ”¶å¾®ä¿¡äº‹ä»¶æ¨é€"><a href="#æ¥æ”¶å¾®ä¿¡äº‹ä»¶æ¨é€" class="headerlink" title="æ¥æ”¶å¾®ä¿¡äº‹ä»¶æ¨é€"></a>æ¥æ”¶å¾®ä¿¡äº‹ä»¶æ¨é€</h2><p>å‚æ•°äºŒç»´ç å·²ç»ç”Ÿæˆäº†ï¼Œä½†æ˜¯ä½ å‘ç°æ‰«æå…³æ³¨ä¹‹åï¼Œç¥é©¬äº‹æƒ…ä¹Ÿæ²¡æœ‰å‘ç”Ÿï¼Œè¯´å¥½çš„å‘é€æ¶ˆæ¯å‘¢ï¼è¿™æ˜¯å› ä¸ºä½ æ²¡æœ‰æ¥æ”¶å¾®ä¿¡çš„æ‰«ç å…³æ³¨äº‹ä»¶æ¨é€å’Œå¯¹å…¶è¿›è¡Œå¤„ç†å‘¢ã€‚</p><ol><li><p>åˆ›å»º Controller ç”¨äºå¾®ä¿¡æ¥å£è¯·æ±‚æ ¡éªŒï¼Œç„¶åå¯åŠ¨é¡¹ç›®</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Controller</span><br><span class="hljs-meta">@RequestMapping(value = &quot;/wechat/auth&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WeChatController</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> WxMpService wxService;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> WxMpMessageRouter router;<br><br>    <span class="hljs-meta">@GetMapping(produces = &quot;text/plain;charset=utf-8&quot;)</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">authGet</span><span class="hljs-params">(</span></span><br><span class="hljs-function"><span class="hljs-params">            <span class="hljs-meta">@RequestParam(name = &quot;signature&quot;,</span></span></span><br><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">                    required = false)</span> String signature,</span></span><br><span class="hljs-function"><span class="hljs-params">            <span class="hljs-meta">@RequestParam(name = &quot;timestamp&quot;,</span></span></span><br><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">                    required = false)</span> String timestamp,</span></span><br><span class="hljs-function"><span class="hljs-params">            <span class="hljs-meta">@RequestParam(name = &quot;nonce&quot;, required = false)</span> String nonce,</span></span><br><span class="hljs-function"><span class="hljs-params">            <span class="hljs-meta">@RequestParam(name = &quot;echostr&quot;, required = false)</span> String echostr,</span></span><br><span class="hljs-function"><span class="hljs-params">            HttpServletResponse response)</span> </span>&#123;<br><br>        <span class="hljs-keyword">if</span> (StringUtils.isAnyBlank(signature, timestamp, nonce, echostr)) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;è¯·æ±‚å‚æ•°éæ³•ï¼Œè¯·æ ¸å®!&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.wxService.checkSignature(timestamp, nonce, signature)) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                response.getWriter().print(echostr);<br>            &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        System.out.println(<span class="hljs-number">1111</span>);<br><br>    &#125;<br><br>    <span class="hljs-meta">@PostMapping(produces = &quot;application/xml; charset=UTF-8&quot;)</span><br>    <span class="hljs-meta">@ResponseBody</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">post</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> String requestBody,</span></span><br><span class="hljs-function"><span class="hljs-params">                       <span class="hljs-meta">@RequestParam(&quot;signature&quot;)</span> String signature,</span></span><br><span class="hljs-function"><span class="hljs-params">                       <span class="hljs-meta">@RequestParam(&quot;timestamp&quot;)</span> String timestamp,</span></span><br><span class="hljs-function"><span class="hljs-params">                       <span class="hljs-meta">@RequestParam(&quot;nonce&quot;)</span> String nonce,</span></span><br><span class="hljs-function"><span class="hljs-params">                       <span class="hljs-meta">@RequestParam(name = &quot;encrypt_type&quot;,</span></span></span><br><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">                               required = false)</span> String encType,</span></span><br><span class="hljs-function"><span class="hljs-params">                       <span class="hljs-meta">@RequestParam(name = &quot;msg_signature&quot;,</span></span></span><br><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">                               required = false)</span> String msgSignature)</span> </span>&#123;<br><br>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.wxService.checkSignature(timestamp, nonce, signature)) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;éæ³•è¯·æ±‚ï¼Œå¯èƒ½å±äºä¼ªé€ çš„è¯·æ±‚ï¼&quot;</span>);<br>        &#125;<br><br>        String out = <span class="hljs-keyword">null</span>;<br>        <span class="hljs-keyword">if</span> (encType == <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-comment">// æ˜æ–‡ä¼ è¾“çš„æ¶ˆæ¯</span><br>            WxMpXmlMessage inMessage = WxMpXmlMessage.fromXml(requestBody);<br>            WxMpXmlOutMessage outMessage = <span class="hljs-keyword">this</span>.route(inMessage);<br>            <span class="hljs-keyword">if</span> (outMessage == <span class="hljs-keyword">null</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>            &#125;<br><br>            out = outMessage.toXml();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;aes&quot;</span>.equals(encType)) &#123;<br>            <span class="hljs-comment">// aesåŠ å¯†çš„æ¶ˆæ¯</span><br>            <span class="hljs-comment">/*WxMpXmlMessage inMessage = WxMpXmlMessage.fromEncryptedXml(</span><br><span class="hljs-comment">                    requestBody, this.wxService.getWxMpConfigStorage(), timestamp,</span><br><span class="hljs-comment">                    nonce, msgSignature);</span><br><span class="hljs-comment">            WxMpXmlOutMessage outMessage = this.route(inMessage);</span><br><span class="hljs-comment">            if (outMessage == null) &#123;</span><br><span class="hljs-comment">                return &quot;&quot;;</span><br><span class="hljs-comment">            &#125;</span><br><span class="hljs-comment">            out = outMessage</span><br><span class="hljs-comment">                    .toEncryptedXml(this.wxService.getWxMpConfigStorage());*/</span><br>        &#125;<br><br>        <span class="hljs-keyword">return</span> out;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> WxMpXmlOutMessage <span class="hljs-title">route</span><span class="hljs-params">(WxMpXmlMessage message)</span> </span>&#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.router.route(message);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li><p>è®¾ç½®å¾®ä¿¡æ¶ˆæ¯æ¨é€æ¥å£ï¼Œç”¨äºæ¥æ”¶å¾®ä¿¡æ¨é€çš„è¯·æ±‚ï¼Œè¿™é‡Œéœ€è¦å¡«å†™å¤–ç½‘åŸŸåï¼Œå¦‚æœä½ æœ‰è‡ªå·±çš„æœåŠ¡å™¨å’ŒåŸŸåï¼Œå¯ä»¥ç›´æ¥å¡«å…¥ï¼›å¦‚æœä½ æ²¡æœ‰ï¼Œå¯ä»¥ä½¿ç”¨ <a href="https://ngrok.cc/">ngrok</a> è¿›è¡Œå†…ç½‘ç©¿é€ï¼Œå¾—åˆ°ä¸€ä¸ªå¤–ç½‘åŸŸåã€‚<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20180106151522725276515.png"><br>æ¯”å¦‚æˆ‘çš„å¾®ä¿¡è¯·æ±‚æ ¡éªŒåœ°å€ä¸º <code>127.0.0.1:8080/wechat/auth</code>ï¼Œ é€šè¿‡å†…ç½‘æ˜ å°„è½¬å‘åå¾—åˆ°çš„å¤–ç½‘åœ°å€ä¸º <code>http://vcmq.free.ngrok.cc/wechat/auth</code>ï¼Œå¡«å†™è¿™ä¸ªåŸŸåï¼Œ Token ç”¨äºæ ¡éªŒæœåŠ¡å™¨ï¼Œä¹‹å‰çš„ yml æ–‡ä»¶ä¸­å·²æŒ‡å®šäº† token çš„å€¼ï¼Œå¡«å†™è¯¥å€¼å³å¯ï¼Œç‚¹å‡»ç¡®è®¤ã€‚</p></li><li><p>å¾®ä¿¡æ‰«æäº‹ä»¶äºŒç»´ç ï¼Œå¾®ä¿¡æœåŠ¡å™¨æ¨é€è¯·æ±‚åˆ° post æ–¹æ³•ï¼Œè°ƒç”¨ route æ–¹æ³•ï¼Œè¿›è¡Œå¤„ç†ã€‚<br><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&id=mp1421140454">äº‹ä»¶äºŒç»´ç æ–‡æ¡£åœ°å€</a></p><blockquote><p>äº‹ä»¶KEYå€¼ï¼Œqrscene_ä¸ºå‰ç¼€ï¼Œåé¢ä¸ºäºŒç»´ç çš„å‚æ•°å€¼ã€‚</p></blockquote></li></ol><p>å¯ä»¥é’ˆå¯¹è¿™ç§æƒ…å†µçš„è¿›è¡Œå¤„ç†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SubscribeHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractHandler</span> </span>&#123;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> WxMpXmlOutMessage <span class="hljs-title">handle</span><span class="hljs-params">(WxMpXmlMessage wxMessage,</span></span><br><span class="hljs-function"><span class="hljs-params">                                  Map&lt;String, Object&gt; context, WxMpService weixinService,</span></span><br><span class="hljs-function"><span class="hljs-params">                                  WxSessionManager sessionManager)</span> <span class="hljs-keyword">throws</span> WxErrorException </span>&#123;<br><br>    <span class="hljs-keyword">this</span>.logger.info(<span class="hljs-string">&quot;æ–°å…³æ³¨ç”¨æˆ· OPENID: &quot;</span> + wxMessage.getFromUser());<br><br>    <span class="hljs-comment">/*// è·å–å¾®ä¿¡ç”¨æˆ·åŸºæœ¬ä¿¡æ¯</span><br><span class="hljs-comment">    WxMpUser userWxInfo = weixinService.getUserService()</span><br><span class="hljs-comment">        .userInfo(wxMessage.getFromUser(), null);</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">    if (userWxInfo != null) &#123;</span><br><span class="hljs-comment">      // TODO å¯ä»¥æ·»åŠ å…³æ³¨ç”¨æˆ·åˆ°æœ¬åœ°</span><br><span class="hljs-comment">    &#125;*/</span><br><br>    WxMpXmlOutMessage responseResult = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>      responseResult = handleSpecial(wxMessage);<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>      <span class="hljs-keyword">this</span>.logger.error(e.getMessage(), e);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (responseResult != <span class="hljs-keyword">null</span>) &#123;<br>      <span class="hljs-keyword">return</span> responseResult;<br>    &#125;<br><br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TextBuilder().build(<span class="hljs-string">&quot;æ„Ÿè°¢å…³æ³¨&quot;</span>, wxMessage, weixinService);<br>    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>      <span class="hljs-keyword">this</span>.logger.error(e.getMessage(), e);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>  &#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * å¤„ç†ç‰¹æ®Šè¯·æ±‚ï¼Œæ¯”å¦‚å¦‚æœæ˜¯æ‰«ç è¿›æ¥çš„ï¼Œå¯ä»¥åšç›¸åº”å¤„ç†</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-function"><span class="hljs-keyword">private</span> WxMpXmlOutMessage <span class="hljs-title">handleSpecial</span><span class="hljs-params">(WxMpXmlMessage wxMessage)</span></span><br><span class="hljs-function">      <span class="hljs-keyword">throws</span> Exception </span>&#123;<br><br>      <span class="hljs-comment">/* å¾®ä¿¡è¿”å›æ•°æ®ç¤ºä¾‹</span><br><span class="hljs-comment">      &#123;</span><br><span class="hljs-comment">              &quot;createTime&quot;: 1515235853,</span><br><span class="hljs-comment">              &quot;event&quot;: &quot;subscribe&quot;,</span><br><span class="hljs-comment">              &quot;eventKey&quot;: &quot;qrscene_hello wechat&quot;,</span><br><span class="hljs-comment">              &quot;fromUser&quot;: &quot;onbpEv3umpi7ihx381D-vpw1SEwE&quot;,</span><br><span class="hljs-comment">              &quot;msgType&quot;: &quot;event&quot;,</span><br><span class="hljs-comment">              &quot;ticket&quot;: &quot;gQA&quot;,</span><br><span class="hljs-comment">              &quot;toUser&quot;: &quot;gh_96fd4ea38axx&quot;</span><br><span class="hljs-comment">      &#125;*/</span><br>      <span class="hljs-comment">// å¦‚æœæ˜¯æ‰«æ</span><br>      <span class="hljs-keyword">if</span> (wxMessage.getEventKey().startsWith(<span class="hljs-string">&quot;qrscene_&quot;</span>)) &#123;<br>          <span class="hljs-comment">// åœ¨æ­¤å¤„è¿›è¡Œç»‘å®šæ“ä½œ</span><br>          System.out.println();<br>      &#125;<br>      System.out.println(JSONObject.toJSONString(wxMessage));<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="èµ„æºä¸‹è½½"><a href="#èµ„æºä¸‹è½½" class="headerlink" title="èµ„æºä¸‹è½½"></a>èµ„æºä¸‹è½½</h2><p><a href="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/wechat-simple-example.zip">ç¤ºä¾‹å·¥ç¨‹ä¸‹è½½</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://github.com/Wechat-Group/weixin-java-tools/blob/master/demo.md">https://github.com/Wechat-Group/weixin-java-tools/blob/master/demo.md</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¾®ä¿¡å¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¨å¹¿ç³»ç»Ÿ</tag>
      
      <tag>æ¨å¹¿</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2017å¹´ç»ˆæ€»ç»“</title>
    <link href="/2017%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93.html"/>
    <url>/2017%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸€å¹´æ—¶é—´å€ç„¶è€Œé€ï¼Œä»Šæ—¥å·²æ˜¯å¹´ç»ˆå²å°¾çŸ£ï¼  </p><p>æ€»æ˜¯æ„Ÿè§‰ä»Šå¹´è¿‡å¾—å¤ªå¿«äº†ï¼Œå¾ˆå¤šæ¬¡ä¸‹ç­çš„æ—¶å€™ï¼ŒåŒäº‹è¯´ï¼šâ€œæ˜å¤©å‘¨äº”äº†â€ï¼Œè€Œæˆ‘çš„ååº”å°±æ˜¯ï¼šâ€œè¯¶ï¼Ÿåˆè¦æ”¾å‡äº†å—ï¼Ÿæˆ‘æ€ä¹ˆæ„Ÿè§‰å‰å¤©æ‰ä¸Šç­çš„å•Šâ€ã€‚<br>ä»¥å‰è¿˜åœ¨ä¸Šå­¦çš„æ—¶å€™ï¼Œæ€»æ˜¯æ„Ÿå¹ï¼Œè¿™ä¸€å¤©å¤©ä¸ºä½•å¦‚æ­¤æ¼«é•¿å‘¢ï¼éšç€å¹´é¾„çš„å¢é•¿ï¼Œä»¿ä½›æ—¶é—´çš„æµé€Ÿä¹ŸåŒæ—¶åŠ å¿«äº†ä¸€èˆ¬ï¼Œæ¯å¤©æ€»æ˜¯è§‰å¾—æ˜¯åœ¨å’Œæ—¶é—´èµ›è·‘ï¼Œè®©æˆ‘æœ‰äº›ç„¦è™‘ã€‚</p><p>ä»Šå¹´è¿‡çš„è®©æˆ‘æ„Ÿè§‰å¾ˆå¿«ï¼Œä½†æ˜¯è§‰å¾—æ¯”ä»¥å‰å……å®ï¼Œå› ä¸ºåšåˆ°çš„äº‹æƒ…æ¯”ä»¥å‰å¤šå¾ˆå¤šã€‚</p><a id="more"></a><h2 id="2017-æˆ‘åšäº†å“ªäº›äº‹"><a href="#2017-æˆ‘åšäº†å“ªäº›äº‹" class="headerlink" title="2017 æˆ‘åšäº†å“ªäº›äº‹"></a>2017 æˆ‘åšäº†å“ªäº›äº‹</h2><ul><li><p><strong>è®°å½• 2017 æ•´å¹´æ”¶æ”¯</strong><br>ä» 2017 å¹´å¼€å§‹ï¼Œæ¯”è¾ƒè®¤çœŸçš„è®°å½•äº†è‡ªå·±çš„æ—¥å¸¸å¼€æ”¯æƒ…å†µï¼Œè®°è´¦ APP æ˜¾ç¤ºå·²ç»åšæŒ è®°è´¦ 575 å¤©äº†ã€‚æˆ‘ä¸ªäººè®°è´¦å°±æ˜¯ä¸ºäº†é˜²æ­¢è‡ªå·±è¿‡åº¦æ¶ˆè´¹ï¼Œæ¯•ç«Ÿç§»åŠ¨æ”¯ä»˜åœ¨ä¸­å›½è¿™ä¹ˆå‘è¾¾ï¼Œé’±å·²ç»å˜æˆäº†ä¸€ä¸²æ•°å­—ï¼Œä¸æ³¨æ„å°±å…¨èŠ±å…‰äº†ã€‚ä¸Šä¸ªæœˆä¹°äº†ä¸€å° MBPï¼Œç”¨äºæ—¥å¸¸å­¦ä¹ ï¼Œä¹‹å‰çš„æ—§ç”µè„‘å·²ç»å¸¦ä¸åŠ¨ IDE äº†ï¼Œç´¢æ€§æ¢äº†ï¼ŒçœŸçš„æ˜¯è¡€è´µï¼Œä¸è¿‡å†™ä»£ç çœŸçˆ½ï¼æœ‰çš„æ”¯å‡ºå°±æ˜¯æ— æ³•é¿å…ï¼Œèƒ½åšçš„å°±æ˜¯å‡å°‘ä¸å¿…è¦çš„æ”¯å‡ºï¼›è®°è´¦è¿™ä»¶äº‹æƒ…ä¸Šï¼Œåšçš„ä¸å¤ªå¥½çš„æ˜¯è™½ç„¶è®°å½•çš„æ¯”è¾ƒè¯¦å°½ï¼Œä½†æ˜¯ç¼ºå°‘æ€»ç»“ï¼›æ¥å¹´éœ€è¦åšé˜¶æ®µæ€§çš„æ€»ç»“ï¼Œæ¯”å¦‚æ¯ä¸ªæœˆæ€»ç»“ä¸€æ¬¡ï¼Œæ‰¾å‡ºä¸å¿…è¦æ”¯å‡ºï¼Œä¸‹æ¬¡å°½é‡é¿å…ï¼ŒåŠªåŠ›å®è¡Œâ€œå¼€æºèŠ‚æµâ€ã€‚</p></li><li><p><strong>å¼€å§‹åŸºé‡‘å®šæŠ•</strong><br>å¹´åˆçš„æ—¶å€™ï¼Œçœ‹äº†ä¸€äº›ç†è´¢çš„å…¥é—¨ä¹¦ç±ï¼ŒåŸºæœ¬çš„ç†è´¢æŠ€èƒ½è¿˜æ˜¯éœ€è¦æŒæ¡çš„ï¼Œäºæ˜¯ä»å››æœˆä»½å¼€å§‹èµ°ä¸Šäº†å…»åŸºä¹‹è·¯ï¼Œç›®å‰ä¸ºæ­¢åªå®šæŠ•äº†ä¸€åªè‚¡åŸºï¼Œæ”¶ç›Šå°šå¯ï¼Œåšçš„ä¸å¤ªå¥½çš„åœ°æ–¹å°±æ˜¯æŠŠé¸¡è›‹éƒ½æ”¾åœ¨äº†åŒä¸€ä¸ªç¯®å­é‡Œï¼Œæ˜å¹´è¦ç€æ‰‹äºåˆ†æ•£æŠ•èµ„ã€‚</p></li><li><p><strong>è®°å½• 2017 æ•´å¹´æ—¶é—´</strong><br>å»å¹´çœ‹äº†ã€Šå¥‡ç‰¹çš„ä¸€ç”Ÿã€‹è¿™æœ¬ä¹¦ï¼Œæ„Ÿè§‰æ—¶é—´ä¸å¤Ÿç”¨çš„æˆ‘ï¼Œå°è¯•å­¦ä¹  <a href="https://zh.wikipedia.org/wiki/%E4%BA%9A%E5%8E%86%E5%B1%B1%E5%A4%A7%C2%B7%E4%BA%9A%E5%8E%86%E5%B1%B1%E5%BE%B7%E7%BD%97%E7%BB%B4%E5%A5%87%C2%B7%E6%9F%B3%E6%AF%94%E6%AD%87%E5%A4%AB">æŸ³æ¯”æ­‡å¤«</a> çš„æ—¶é—´ç»Ÿè®¡æ³•ï¼Œè®°å½•è‡ªå·±æ¯å¤©çš„æ—¶é—´æ¸…å•ï¼Œç”¨çš„æ˜¯ IOS ä¸Šçš„ APPï¼šã€Œæ—¶é—´å—ã€<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20171230151461868391216.png"><br>é€šè¿‡è½¯ä»¶çš„ç»Ÿè®¡åŠŸèƒ½ï¼Œæ¯”è¾ƒç›´è§‚äº†åæ˜ äº†æˆ‘çš„æ—¶é—´éƒ½å»å“ªå„¿äº†ã€‚<br>è‡ªæˆ‘æ„Ÿè§‰æ¯”å¾€å¹´ç”¨åœ¨å­¦ä¹ ä¸Šçš„æ—¶é—´è¦å¤šå¾ˆå¤šï¼Œä½†æ˜¯é¢„æ–™ä¸åŠçš„æ˜¯æˆ‘åœ¨ç©ï¼ˆæ¸¸æˆã€åŠ¨æ¼«ã€å‡ºå¤–æ¸¸ç©ç­‰èŠ±è´¹çš„æ—¶é—´ï¼‰ä¸Šçš„æŠ•å…¥æ—¶é—´å’Œè¹‰è·çš„æ—¶é—´ï¼ˆå¦‚æ¼«æ— ç›®çš„åœ°ä¸Šç½‘æµè§ˆã€åšæ— ä»»ä½•æ„ä¹‰äº‹æƒ…çš„æ—¶é—´ï¼‰ä¹‹å’Œï¼Œç«Ÿç„¶ç‹‚ç”©å­¦ä¹ æ—¶é—´å‡ æ¡è¡—ï¼Œè¯´æ˜è‡ªå·±å¯¹äºæ—¶é—´çš„åˆ©ç”¨è¿˜æ˜¯å¤ªä½å¤ªä½ã€‚<br>æœ€è®©æˆ‘éœ‡æƒŠçš„æ˜¯ç”¨äºäº¤é€š(åè½¦ï¼Œæ­¥è¡Œï¼Œç­‰è½¦ç­‰)çš„æ—¶é—´ï¼Œå±…ç„¶è¾¾åˆ°äº†è¿‘ <code>850</code> å°æ—¶ï¼ä¸€å¹´åäºŒä¸ªæœˆ,å…¶ä¸­çš„ä¸€ä¸ªæœˆå…¨æ˜¯åœ¨è½¦ä¸Šåº¦è¿‡ï¼<strong>æ…æ€ææï¼</strong><br>æŸ³æ¯”æ­‡å¤«åœ¨æ¯å¤©æ¯ä¸ªå‘¨æœ«æ¯ä¸ªæœˆæ¯ä¸ªå­£åº¦æ¯å¹´ä»–éƒ½ä¼šæ±‡æ€»ç»Ÿè®¡è‡ªå·±çš„æ—¶é—´æ”¯å‡ºï¼Œæ ¸ç®—æœ‰æ•ˆæ—¶é—´å¹¶åŠ ä»¥æ€»ç»“ï¼Œè¿™ä¸€ç‚¹æˆ‘ç¡®å®æ˜¯æ²¡åšåˆ°ä»–è¿™ä¹ˆæè‡´ï¼Œä¹Ÿæ˜¯è‡ªå·±éœ€è¦è¿›è¡Œæ”¹è¿›çš„åœ°æ–¹ï¼Œæ¯”å¦‚ä»¥åæ¯ä¸ªæœˆæ€»ç»“ä¸€æ¬¡æ—¶é—´çš„æ¶ˆè´¹ï¼Œçœ‹çœ‹è‡ªå·±æœ‰æ²¡æœ‰åˆ©ç”¨å¥½è¿™ä¸ªæœˆã€‚</p></li><li><p><strong>å¼€å§‹æ—©èµ·</strong><br>åœ¨è®°å½•äº†åŠå¹´çš„æ—¶é—´æ¶ˆè´¹åï¼Œçœ‹äº†ç»Ÿè®¡åï¼Œæ·±è§‰æ—¶é—´çœŸçš„ä¸å¤Ÿç”¨ï¼Œäºæ˜¯ä»å…­æœˆä»½å¼€å§‹æ—©èµ·ï¼Œå·¥ä½œæ—¥åŸºæœ¬æ¯å¤© 5 ç‚¹èµ·åºŠã€‚<br>ä¸è¶³çš„åœ°æ–¹å°±æ˜¯æ—©èµ·åï¼Œåˆ°7ç‚¹æ´—æ¼±åƒé¥­å»ä¸Šç­ä¹‹å‰çš„è¿™æ®µæ—¶é—´ï¼Œæ—¶é—´çš„åˆ©ç”¨ä¸æ˜¯å¾ˆæœ‰æ•ˆç‡ï¼Œè¿˜æœ‰å°±æ˜¯å‘¨æœ«æœ‰æ—¶å€™å˜å¾—å¾ˆæ‡’ï¼Œç»å¸¸å¿«æ‹–åˆ° 8 ç‚¹å¤šæ‰èµ·åºŠï¼Œæ˜å¹´åŠªåŠ›ç»™è‡ªå·±æ‰¾äº‹æƒ…ï¼Œæé«˜æ—¶é—´çš„åˆ©ç”¨æ•ˆç‡ï¼Œå‘¨æœ«ç£ä¿ƒè‡ªå·±æ—©èµ·ã€‚</p></li><li><p><strong>å¼€å§‹è®¤çœŸå¯¹å¾…åšå®¢</strong><br>å…¶å®ä» 2016 å¹´ï¼Œä¾¿å¼€å§‹ç”¨ Hexo æ­å»ºäº†åšå®¢ï¼Œå¹¶å¼€å§‹å†™åšå®¢ï¼Œä½†æ˜¯å½“æ—¶åªæ˜¯å¥½å¥‡å¿ƒçš„é©±ä½¿ï¼Œéšä¾¿å†™å†™è§‰å¾—æœ‰è¶£ï¼Œæ‰€ä»¥å†™çš„å¾ˆæ°´ï¼Œä½†æ˜¯ä» 2017 å¹´å¼€å§‹ï¼Œå°±çº¦æŸè‡ªå·±è¦è®¤çœŸç‚¹å†™ï¼Œå¯¹è‡ªå·±å†™åšå®¢ä»˜å‡ºçš„æ—¶é—´è¿›è¡Œè´Ÿè´£ã€‚<br>æˆ‘è®¤ä¸ºå¯¹äºåšæŠ€æœ¯çš„äººè€Œè¨€ï¼Œå†™ä¸å†™åšå®¢æ˜¯ä¸¤ç§äººï¼Œå†™çš„åšå®¢å¥½ä¸å¥½ä¹Ÿæ˜¯ä¸¤ç§äººã€‚<br>ä¸è¶³ä¹‹å¤„å°±æ˜¯æ€»çš„åšå®¢æ–‡ç« ä¸å¤Ÿå¤šï¼Œå¤§å¤šä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ·±åº¦ï¼›æ˜å¹´å¤šå¤šå†™åšå®¢ï¼Œæå‡æŠ€æœ¯èƒ½åŠ›ï¼ŒæœŸæœ›å¯ä»¥å†™ä¸€äº›æ¯”è¾ƒæœ‰æ·±åº¦çš„åšå®¢ã€‚</p></li><li><p><strong>è‡ªå­¦æ–°çš„æŠ€æœ¯</strong><br>æŠ€æœ¯çš„æ›´è¿­é€Ÿåº¦å¾ˆå¿«ï¼Œä¸ºäº†ä¸è¢«æ·˜æ±°ï¼Œåªæœ‰é€šè¿‡ä¸æ–­å­¦ä¹ ï¼Œæ¥æé«˜æŠ€æœ¯èƒ½åŠ›ã€‚<br>ç›®å‰æ‰€åœ¨çš„å…¬å¸æ˜¯ä¸€å®¶ä»¥ä¸šåŠ¡é©±åŠ¨çš„å…¬å¸ï¼Œæ‰€ä»¥å¹³æ—¶å†™çš„ä¸šåŠ¡ä»£ç æ¯”è¾ƒå¤šä¸€äº›ï¼Œå¯¹äºæ–°çš„æŠ€æœ¯æ¥è§¦çš„æ¯”è¾ƒå°‘ï¼Œä½†æ˜¯é¢†å¯¼æ¯”è¾ƒé¼“åŠ±æˆ‘ä»¬å­¦ä¹ æ–°çš„æŠ€æœ¯ç”¨äºå·¥ä½œä¸­ã€‚<br>å…¬å¸çš„æŠ€æœ¯ä¸€æˆä¸å˜å¾€å¾€ä¸æ˜¯å…¬å¸çš„é—®é¢˜ï¼Œè€Œæ˜¯æˆ‘ä»¬åšæŠ€æœ¯çš„é—®é¢˜ï¼Œå°±ç®—å…¬å¸æƒ³ç”¨æ–°çš„æŠ€æœ¯ï¼Œä½†æ˜¯æ²¡æœ‰äººä¼šï¼Œè¿™ç§æŠ€æœ¯ä¹Ÿå°±ä¸ä¼šè¢«å¼•å…¥ï¼Œå› ä¸ºä½¿ç”¨æˆæœ¬å¤ªé«˜ï¼›ä½†æ˜¯è‹¥è¿™é¡¹æŠ€æœ¯ï¼Œæˆ‘ä»¬éƒ½ä¼šï¼Œè€Œä¸”åˆå¾ˆæœ‰åˆ©äºå…¬å¸ï¼Œç›¸ä¿¡ä¸€å®šä¼šå¾—åˆ°å…¬å¸æ¨è¡Œã€‚ä¸ºäº†ä¿æŒè¿›æ­¥ï¼Œè‡ªå­¦æ–°å…´çš„æŠ€æœ¯ï¼Œå¯¹äºè‡ªå­¦æ–°æŠ€æœ¯ï¼Œå‚ç›´æ•™è‚²ç½‘ç«™(ç¼–ç¨‹) <a href="http://www.imooc.com/">æ…•è¯¾ç½‘</a> å¾ˆä¸é”™ï¼å­¦ä¹ äº†æ–°çš„æŠ€æœ¯ï¼Œåœ¨æ°å½“çš„æ—¶æœºåˆé€‚çš„é¡¹ç›®è¿›è¡Œå¼•å…¥ï¼Œä¹Ÿæ˜¯å¯¹è‡ªå·±å­¦ä¹ æˆæœçš„ä¸€ç§å®è·µï¼</p></li><li><p><strong>ä¹° Kindle çœ‹ä¹¦</strong><br>å¹´åˆä¹°äº† Kindle ç”¨äºçœ‹ä¹¦ï¼Œå¼ºåˆ¶è‡ªå·±çœ‹ä¹¦ï¼›çœ‹ä¹¦çš„è¿‡ç¨‹ä¸­ï¼Œè¶Šå‘è§‰å¾—è‡ªå·±çš„é˜…è¯»èƒ½åŠ›å®åœ¨æ˜¯å¤ªå·®äº†ï¼Œå¾ˆå¤šåœ°æ–¹éƒ½è¯»ä¸æ‡‚ï¼Œè¿™ä¹Ÿåšå®šäº†æˆ‘è¦åšæŒçœ‹ä¹¦çš„æƒ³æ³•ã€‚<br>ä»Šå¹´çœ‹äº† 25 æœ¬å·¦å³çš„ä¹¦ï¼Œä½†æ˜¯ç²¾è¯»çš„å¤ªå°‘ï¼Œå¾ˆå¤šéƒ½æ˜¯å›«å›µåæ£ï¼Œçº ç»“äºè¯»ä¹¦çš„æ•°é‡ï¼Œè€Œä¸æ˜¯è´¨é‡ï¼Œæ¥å¹´å°½é‡æé«˜é˜…è¯»çš„è´¨é‡ã€‚</p></li></ul><h2 id="2017-åšçš„ä¸å¥½çš„åœ°æ–¹"><a href="#2017-åšçš„ä¸å¥½çš„åœ°æ–¹" class="headerlink" title="2017 åšçš„ä¸å¥½çš„åœ°æ–¹"></a>2017 åšçš„ä¸å¥½çš„åœ°æ–¹</h2><ul><li><p>é™¤äº†ä¸Šé¢æå‡ºçš„é—®é¢˜ï¼Œèº«ä¸Šè¿˜æœ‰ä¸€å †ç­‰ç€æˆ‘å»å…‹æœçš„ç¼ºç‚¹ã€‚</p></li><li><p>ä¸‹åŠå¹´çš„æ—¶å€™ï¼Œæäº†ä¸ªæœåŠ¡å™¨ï¼Œç»™ç”µè„‘è£…ä¸Šäº† SS çš„å®¢æˆ·ç«¯ï¼Œå¾—ä»¥éšæ—¶å¯ä»¥è®¿é—®è¢«å¢™çš„ Google ã€‚äºæ˜¯åœ¨ä¾¿åˆ©æŸ¥æ‰¾é—®é¢˜çš„ç¯å¢ƒä¸‹ï¼Œå‡ºç°äº†è¦åšä»€ä¹ˆå·¥ä½œçš„æ—¶å€™ï¼Œä¸å»æ€è€ƒï¼Œè€Œæ˜¯å…ˆå»è¿›è¡Œ Google æœç´¢ä¸€ç•ªçš„æƒ…å†µï¼Œå¤ªè¿‡ä¾èµ– Google ï¼Œéšæ—¶ç•ªç¾½å¢™å¯¹äºæˆ‘ä¹Ÿä¸æ˜¯ä¸€ä»¶å¥½äº‹ã€‚æ¥å¹´å¸Œæœ›å¯ä»¥å…»æˆä¸‡äº‹å…ˆç‹¬ç«‹æ€è€ƒçš„ä¹ æƒ¯ï¼Œä¸è¦æˆä¸ºä¸€ååªä¼š Google ä»£ç çš„ç å†œã€‚</p></li><li><p>å¿˜äº†ä»å‡ æœˆä»½å¼€å§‹ï¼Œç‹è€…è£è€€ç«äº†ï¼Œæˆ‘ä¹Ÿä¸å‡ºæ„å¤–åœ°é™·äº†è¿›å»ï¼Œå¤§æ¦‚ç©äº†ä¸¤ä¸‰ä¸ªæœˆï¼Œä¹‹åæ„è¯†åˆ°è‡ªå·±çš„åšæ³•ä¸å¯¹ï¼Œæ–¹æ‰å¸è½½äº†æ¸¸æˆã€‚å¤šäºäº†å®šåŠ›çš„å¢é•¿ï¼Œå¦åˆ™è¿˜å¯èƒ½æ²‰è¿·å…¶ä¸­ä¸å¯è‡ªæ‹”ï¼Œä»¥åå°±å°½é‡ä¸ç©æ¸¸æˆäº†å§ï¼Œæ¯•ç«Ÿè¿˜è¦é‚£ä¹ˆå¤šçš„çŸ¥è¯†ç­‰å¾…ç€æˆ‘å»å­¦å‘¢ï¼</p></li><li><p>æ¯å¹´éƒ½ä¼šçœ‹åˆ°ç¨‹åºå‘˜çŒæ­»çš„æ–°é—»ï¼Œè¿™ä¸ªè¡Œä¸šæœ‰çš„å…¬å¸é«˜å¼ºåº¦æ— ä¼‘æ­¢çš„åŠ ç­ï¼ŒåŠ ä¸Šç²¾ç¥å‹åŠ›ï¼Œä»¥åŠä¸ç»å¸¸é”»ç‚¼èº«ä½“çš„ä¹ æƒ¯ï¼Œå¯¼è‡´æ‚²å‰§çš„å‘ç”Ÿã€‚åœ¨å”å˜˜çš„åŒæ—¶ï¼Œå´æ²¡æœ‰æƒ³åˆ°è‡ªå·±ä¹Ÿæ²¡æœ‰é”»ç‚¼èº«ä½“çš„ä¹ æƒ¯ï¼Œå¹¸è¿çš„æ˜¯å…¬å¸ä¸åŠ ç­ã€‚ä¹Ÿæ›¾ç»åšæŒè·‘æ­¥é”»ç‚¼äº†ä¸€æ®µæ—¶é—´ï¼Œä½†æ˜¯æ²¡æœ‰åšæŒä¸‹æ¥ï¼Œè¿˜æ˜¯è¦åˆ¶å®šä¸€ä¸ªé”»ç‚¼çš„è®¡åˆ’ã€‚</p></li></ul><h2 id="2018-æˆ‘æƒ³è¦åšçš„äº‹"><a href="#2018-æˆ‘æƒ³è¦åšçš„äº‹" class="headerlink" title="2018 æˆ‘æƒ³è¦åšçš„äº‹"></a>2018 æˆ‘æƒ³è¦åšçš„äº‹</h2><ul><li>é”»ç‚¼èº«ä½“ï¼Œèº«ä½“å¥½æ˜¯ä¸€åˆ‡æ´»åŠ¨çš„å‰æ</li><li>å¤šå†™åšå®¢ï¼Œå¤šç²¾è¯»ä¹¦ï¼Œå¤šå†™è¯»ä¹¦ç¬”è®°</li><li>ç‹¬ç«‹æ€è€ƒï¼Œå¤šæ€»ç»“ï¼Œäº‰å–åšä¸€ä¸ªç²¾è¿›çš„äºº</li><li>é‡æ–°å­¦ä¹ è‹±è¯­ï¼Œè‹±è¯­èƒ½åŠ›å¤ªå·®äº†ï¼Œå¤šå­¦ç‚¹è‹±è¯­</li><li><del>æ‹¾èµ·æ—¥è¯­çš„å­¦ä¹ </del></li></ul><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>èµ„æºè¶Šå¤šè¶Šæµªè´¹ï¼Œèµ„æºè¶Šå°‘è¶Šçè´µï¼Œæ—¶é—´äº¦æ˜¯ï¼Œå‘¨æœ«æ—¶é—´å¾ˆå¤šä½†æ˜¯åˆ©ç”¨æ•ˆç‡å´ä½çš„å¯æ€•ï¼Œæ¯å¤©æ—©èµ·ä¸€ä¸ªå¤šå°æ—¶ï¼Œèƒ½å®Œæˆå‘¨æœ«å¥½å‡ ä¸ªå°æ—¶èƒ½å®Œæˆçš„äº‹æƒ…ã€‚æ¯æ¯æµªè´¹äº†å…‰é˜´ï¼Œåœ¨ä½™ä¸‹ä¸å¤šçš„æ—¶é—´é‡Œæƒ³è¦å¼€å§‹è®¤çœŸæ—¶ï¼Œå´æ€»æ˜¯åœ¨æ—¶é—´ä¸å¤Ÿç”¨çš„æŠ±æ€¨å£°é‡Œï¼Œè‰è‰ç»“æŸäº†æœ¬æ¬¡å‘¨æœ«ï¼Œæ‰€ä»¥ï¼Œæ—¶é—´éƒ½å»å“ªå„¿å‘¢ï¼Ÿ</p>]]></content>
    
    
    
    <tags>
      
      <tag>å¹´ç»ˆæ€»ç»“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>macç¼–è¯‘å®‰è£…Nginx</title>
    <link href="/mac%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85nginx.html"/>
    <url>/mac%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85nginx.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è™½ç„¶åç®€å•çš„æ–¹å¼å®‰è£…Nginxï¼Œä½†æ˜¯ä¹ æƒ¯äº†åœ¨linux ä¸Šçš„æ“ä½œï¼Œä¸ºäº†ä¿æŒä¸€è‡´ï¼Œå› æ­¤ä¹Ÿä½¿ç”¨ç¼–è¯‘å®‰è£…çš„æ–¹æ³•è¿›è¡Œå®‰è£…Nginxã€‚</p><a id="more"></a><h2 id="èµ„æºä¸‹è½½"><a href="#èµ„æºä¸‹è½½" class="headerlink" title="èµ„æºä¸‹è½½"></a>èµ„æºä¸‹è½½</h2><ul><li>nginx: <a href="http://nginx.org/download/nginx-1.12.2.tar.gz">http://nginx.org/download/nginx-1.12.2.tar.gz</a></li><li>zlib: <a href="http://zlib.net/zlib-1.2.11.tar.gz">http://zlib.net/zlib-1.2.11.tar.gz</a></li><li>pcre: <a href="https://ftp.pcre.org/pub/pcre/pcre-8.38.tar.gz">https://ftp.pcre.org/pub/pcre/pcre-8.38.tar.gz</a></li><li>openssl: <a href="https://www.openssl.org/source/openssl-1.1.0g.tar.gz">https://www.openssl.org/source/openssl-1.1.0g.tar.gz</a></li></ul><p>è¿™äº›éƒ½æ˜¯ Nginx ç¼–è¯‘éœ€è¦çš„ä¾èµ–ï¼Œä¸‹è½½ååˆ†åˆ«è§£å‹ï¼Œ æ³¨æ„è§£å‹çš„æ–‡ä»¶è¦åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹é¢</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">tar -zxvf nginx-1.12.2.tar.gz<br><br>tar -zxvf zlib-1.2.11.tar.gz<br><br>tar -zxvf pcre-8.38.tar.gz<br><br>tar -zxvf openssl-1.1.0g.tar.gz<br></code></pre></div></td></tr></table></figure><p>è¿›å…¥nginxç›®å½•åæ‰§è¡Œ</p><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli"><span class="hljs-string">./configure</span> <span class="hljs-params">--prefix=/usr/local/nginx</span> <span class="hljs-params">--with-zlib=</span><span class="hljs-string">../zlib-1.2.11</span> <span class="hljs-params">--with-pcre=</span><span class="hljs-string">../pcre-8.38</span> <span class="hljs-params">--with-openssl=</span><span class="hljs-string">../openssl-1.1.0g</span><br><br><br><span class="hljs-string">//</span> ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤<br><br>make<br><br>sudo make install<br></code></pre></div></td></tr></table></figure><p>ä»¥ä¸Šæ‰§è¡Œå®Œæ¯•åï¼Œ nginx å°±è¢«å®‰è£…åˆ° <code>/usr/local/nginx</code> ç›®å½•ä¸‹</p><h2 id="Nginxçš„å¯åœ"><a href="#Nginxçš„å¯åœ" class="headerlink" title="Nginxçš„å¯åœ"></a>Nginxçš„å¯åœ</h2><p>åœ¨ mac ä¸Šéšä¾¿ä¿®æ”¹ç‚¹ä¸œè¥¿ï¼Œå°±æç¤ºæ²¡æœ‰æƒé™ä¹Ÿæ˜¯é†‰äº†ï¼Œåªå¥½æ¯ä¸ªå‘½ä»¤å‰é¢éƒ½åŠ ä¸Š <strong>sudo</strong> äº†</p><p>å¯åŠ¨<br><code>sudo /usr/local/nginx/sbin/nginx</code></p><p>å…³é—­<br><code>sudo /usr/local/nginx/sbin/nginx -s stop</code></p><p>é‡å¯<br><code>sudo /usr/local/nginx/sbin/nginx -s reload</code></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="http://blog.csdn.net/tulies/article/details/77611409">http://blog.csdn.net/tulies/article/details/77611409</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æœåŠ¡å™¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginxå®‰è£…</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆ©ç”¨nginxè§£å†³è·¨åŸŸé—®é¢˜</title>
    <link href="/%E5%88%A9%E7%94%A8nginx%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98.html"/>
    <url>/%E5%88%A9%E7%94%A8nginx%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘é‡åˆ°äº†è·¨åŸŸé—®é¢˜ï¼Œç»“åˆä¹‹å‰ã€å¾®ä¿¡æ”¯ä»˜å¼€å‘æœ¬åœ°æ¥æ”¶å¼‚æ­¥é€šçŸ¥å›è°ƒã€‘çš„ç»éªŒï¼Œåˆ©ç”¨ Nginx å®ç°äº†è·¨åŸŸã€‚</p><p>å…¬å¸ä¹‹å‰ä¸ºäº†è§£å†³è·¨åŸŸé—®é¢˜ï¼Œç”¨çš„æ˜¯ iFrameï¼Œåæ­£å¯¹äºåªåšåç«¯çš„æˆ‘è€Œè¨€ï¼Œè§‰å¾—å¾ˆå¤æ‚ï¼Œä½†æ˜¯ç°åœ¨åˆ©ç”¨ nginx å¦‚æ­¤ç®€å•å°±å®ç°äº†è·¨åŸŸï¼Œæ„Ÿè§‰è¿˜æŒºæœ‰æˆå°±æ„Ÿï¼Œå“ˆå“ˆï¼</p><a id="more"></a><h2 id="ä¸ºä»€ä¹ˆä¼šå‡ºç°è·¨åŸŸé—®é¢˜ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä¼šå‡ºç°è·¨åŸŸé—®é¢˜ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šå‡ºç°è·¨åŸŸé—®é¢˜ï¼Ÿ"></a>ä¸ºä»€ä¹ˆä¼šå‡ºç°è·¨åŸŸé—®é¢˜ï¼Ÿ</h2><p>å‰äººå·²ç»æ€»ç»“å¾—å¾ˆå¥½äº†ï¼Œå°±å€Ÿé‰´ä¸€ä¸‹å§ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20171206151256895451444.png"></p><blockquote><p>å›¾ç‰‡æ¥æºåœ°å€ï¼š <a href="http://www.cnblogs.com/gabrielchen/p/5066120.html">http://www.cnblogs.com/gabrielchen/p/5066120.html</a></p></blockquote><p>æˆ‘ä»¬åœ¨å¼€å‘é¡¹ç›®ä¸­é‡åˆ°çš„è·¨åŸŸé—®é¢˜å…·ä½“æ˜¯è¿™æ ·çš„ï¼Œå…¬å¸çš„åŸŸåè‹¥æ˜¯ <strong><a href="http://www.domain.com/">www.domain.com</a></strong>ï¼Œé‚£ä¹ˆå¦‚æœæ˜¯å‘é€çš„ Ajax è¯·æ±‚å°±ä¸é€šè¿‡è¿™ä¸ªåŸŸåèµ°äº†ï¼Œè€Œæ˜¯é€šè¿‡ <strong>a.domain.com</strong>ï¼Œäºæ˜¯ä¾¿å‡ºç°äº†è·¨åŸŸé—®é¢˜ã€‚</p><p>æ¯”å¦‚åœ¨ <strong><a href="http://www.domain.com/">www.domain.com</a></strong> é¦–é¡µä¸­éœ€è¦é€šè¿‡ Ajax è·å–ç”¨æˆ·ç™»å½•ä¿¡æ¯ã€‚</p><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><h3 id="ä¸‹è½½æ¼”ç¤ºé¡¹ç›®"><a href="#ä¸‹è½½æ¼”ç¤ºé¡¹ç›®" class="headerlink" title="ä¸‹è½½æ¼”ç¤ºé¡¹ç›®"></a>ä¸‹è½½æ¼”ç¤ºé¡¹ç›®</h3><p>ä¸ºäº†æ¼”ç¤ºè¿™ä¸ªè·¨åŸŸé—®é¢˜ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ª SpringBoot é¡¹ç›®ï¼Œä¾¿äºæ¼”ç¤ºï¼Œå¦‚æœä¸ä¼š SpringBoot ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå› ä¸ºé‡ç‚¹åœ¨äº Nginx é…ç½®ä¸Šé¢ã€‚</p><p><strong><a href="https://pan.baidu.com/s/1pLifFBl">ã€ç‚¹æˆ‘ä¸‹è½½ã€‘</a>  æå–å¯†ç : 8e68</strong></p><h3 id="å¯åŠ¨æ¼”ç¤ºé¡¹ç›®"><a href="#å¯åŠ¨æ¼”ç¤ºé¡¹ç›®" class="headerlink" title="å¯åŠ¨æ¼”ç¤ºé¡¹ç›®"></a>å¯åŠ¨æ¼”ç¤ºé¡¹ç›®</h3><p>å› ä¸ºæ˜¯SpringBoot é¡¹ç›®ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ <strong>java -jar</strong> çš„æ–¹å¼ç›´æ¥å¯åŠ¨ï¼Œä¸ºäº†æ¼”ç¤ºè·¨åŸŸï¼Œå› æ­¤éœ€è¦å¯åŠ¨ä¸¤ä¸ªé¡¹ç›®ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ä¸¤ä¸ªç«¯å£æ¥åˆ†åˆ«å¯åŠ¨é¡¹ç›®ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># A é¡¹ç›®ï¼Œç«¯å£è®¾ç½®ä¸º8080</span></span><br>java -jar -Dserver.port=8080 demo.jar<br><br><span class="hljs-meta">#</span><span class="bash"><span class="hljs-comment"># B é¡¹ç›®ï¼Œç«¯å£è®¾ç½®ä¸º8090</span></span><br>java -jar -Dserver.port=8090 demo.jar<br></code></pre></div></td></tr></table></figure><h3 id="é…ç½®æœ¬åœ°-Host"><a href="#é…ç½®æœ¬åœ°-Host" class="headerlink" title="é…ç½®æœ¬åœ° Host"></a>é…ç½®æœ¬åœ° Host</h3><p>ä¸ºäº†æ¼”ç¤ºè¿˜éœ€è¦ä¸¤ä¸ªåŸŸåï¼Œä¸ç”¨çœŸæ­£çš„åŸŸåï¼Œä¿®æ”¹æœ¬åœ°çš„ Host å³å¯ï¼Œå°†ä¸¤ä¸ªåŸŸåçš„ Host éƒ½æ‰§è¡Œæœ¬åœ°ã€‚å¯ä»¥ä½¿ç”¨ <a href="https://oldj.github.io/SwitchHosts/">SwitchHosts</a> æ¥æ–¹ä¾¿åˆ‡æ¢ã€‚</p><figure class="highlight accesslog"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs accesslog"><span class="hljs-number">127.0.0.1</span> www.domain.com<br><span class="hljs-number">127.0.0.1</span> a.domain.com<br></code></pre></div></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20171206151256982730568.png"></p><h3 id="é…ç½®Nginx"><a href="#é…ç½®Nginx" class="headerlink" title="é…ç½®Nginx"></a>é…ç½®Nginx</h3><p>ç¼–è¯‘å®‰è£… Nginxåï¼Œ ä¿®æ”¹ nginx.conf é…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">user  nobody;</span><br>worker_processes  1;<br><br><span class="hljs-meta">#</span><span class="bash">error_log  logs/error.log;</span><br><span class="hljs-meta">#</span><span class="bash">error_log  logs/error.log  notice;</span><br><span class="hljs-meta">#</span><span class="bash">error_log  logs/error.log  info;</span><br><br><span class="hljs-meta">#</span><span class="bash">pid        logs/nginx.pid;</span><br><br><br>events &#123;<br>    worker_connections  1024;<br>&#125;<br><br><br>http &#123;<br>    include       mime.types;<br>    default_type  application/octet-stream;<br>    #log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;<br>    #                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;<br>    #                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;<br>    #access_log  logs/access.log  main;<br>    sendfile        on;<br>    keepalive_timeout  65;<br>    #gzip  on;<br><br>    upstream webServer &#123;<br>      server 127.0.0.1:8080;<br>    &#125;<br>    upstream ajaxServer &#123;<br>      server 127.0.0.1:8090;<br>    &#125;<br><br>    server &#123;<br>        listen       80;<br>        server_name  a.domain.com;<br><br>        location / &#123;<br>          proxy_pass http://ajaxServer;<br>        &#125;<br>    &#125;<br><br>    server &#123;<br>        listen       80;<br>        server_name  www.domain.com;<br><br>        location / &#123;<br>          proxy_pass http://webServer;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¿™é‡Œæ¥è¯¦ç»†è§£é‡Šä¸€ä¸‹è¿™é‡Œçš„é…ç½®ï¼Œ<strong>a.domain.com</strong> ä»£ç†åˆ° ajaxServerï¼Œå³ç«¯å£è®¾ç½®ä¸º 8090 çš„ B é¡¹ç›®ï¼›</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">server &#123;<br>    listen       80;<br>    server_name  a.domain.com;<br><br>    location / &#123;<br>          proxy_pass http://ajaxServer;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å†çœ‹çœ‹ <strong><a href="http://www.domain.com/">www.domain.com</a></strong> çš„é…ç½®ï¼Œåå‘ä»£ç†åˆ° webServer , å³ç«¯å£è®¾ç½®ä¸º 8080 çš„ A é¡¹ç›®ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">server &#123;<br>    listen       80;<br>    server_name  www.domain.com;<br><br>    location / &#123;<br>      proxy_pass http://webServer;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>è®¿é—®é¡¹ç›®åœ°å€ <strong><a href="http://www.domain.com/page">http://www.domain.com/page</a></strong>ï¼Œ è¿›å…¥ä»¥ä¸‹é¡µé¢ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20171206151257156452621.png"></p><p>å½“è¾“å…¥æ¡†ä¸è¾“å…¥æˆ–è€…è¾“å…¥çš„æ˜¯å½“å‰åŸŸå <strong><a href="http://www.domain.com/">http://www.domain.com</a></strong> æ—¶ï¼Œå¯ä»¥æ­£å¸¸æäº¤ï¼Œä¸ä¼šé‡åˆ°è·¨åŸŸé—®é¢˜ã€‚</p><p>å½“è¾“å…¥ <strong><a href="http://a.domain.com/">http://a.domain.com</a></strong> æ—¶ï¼Œç‚¹å‡»æŒ‰é’®è¿›è¡Œæäº¤ï¼Œä¼šå‡ºç°è·¨åŸŸé—®é¢˜ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20171207151259706233672.png"></p><h2 id="ä¿®æ”¹-Nginx-é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹-Nginx-é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹ Nginx é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹ Nginx é…ç½®æ–‡ä»¶</h2><p>ä¿®æ”¹ <strong><a href="http://www.domain.com/">www.domain.com</a></strong> çš„é…ç½®</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">server &#123;<br>    listen       80;<br>    server_name  www.domain.com;<br><br>    location /proxy/ &#123;<br>        proxy_set_header Host a.domain.com;<br>        proxy_pass http://ajaxServer/;<br>    &#125;<br><br>    location / &#123;<br>      proxy_pass http://webServer;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­è¿™é‡Œè¿™å¤„é…ç½®æ˜¯è¿™ç¯‡æ–‡ç« çš„å…³é”®ç‚¹ã€‚æ„æ€æ˜¯ <strong><a href="http://www.domain.com/proxy/">http://www.domain.com/proxy/</a></strong> å¼€å¤´çš„è¯·æ±‚å°†ä¼šè¢«åå‘ä»£ç†åˆ° <strong>B é¡¹ç›®</strong> å³ <strong><a href="http://a.domain.com/">http://a.domain.com</a></strong> åŸŸåï¼Œ<strong>proxy_set_header Host</strong> è¿™ä¸€è¡Œæ˜¯å¿…é¡»çš„ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸¤è¡Œçš„åŸŸåéœ€è¦ä¿æŒä¸€è‡´ï¼Œ**ä¸”ç¬¬äºŒè¡Œåé¢å¿…é¡»è¦æœ‰ä¸€ä¸ª /**ï¼Œè‡³äºåŸå› ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç«  <a href="http://nullpointer.pw/%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E5%BC%80%E5%8F%91%E6%9C%AC%E5%9C%B0%E6%8E%A5%E6%94%B6%E5%BC%82%E6%AD%A5%E9%80%9A%E7%9F%A5%E5%9B%9E%E8%B0%83%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91.html#%E5%BF%85%E7%9F%A5%E7%9A%84-Nginx-%E8%AF%AD%E6%B3%95">proxy_passåçš„urlåŠ ä¸åŠ /çš„åŒºåˆ«</a></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">location /proxy/ &#123;<br>    proxy_set_header Host a.domain.com;<br>    proxy_pass http://ajaxServer/;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä¿®æ”¹ä¹‹åä¿å­˜é…ç½®æ–‡ä»¶ï¼Œé‡å¯ Nginx</p><figure class="highlight jboss-cli"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jboss-cli"><span class="hljs-string">./nginx</span> -s <span class="hljs-keyword">reload</span><br></code></pre></div></td></tr></table></figure><h2 id="å†æ¬¡æµ‹è¯•"><a href="#å†æ¬¡æµ‹è¯•" class="headerlink" title="å†æ¬¡æµ‹è¯•"></a>å†æ¬¡æµ‹è¯•</h2><p>ä¿®æ”¹æäº¤ URL ä¸º <strong><a href="http://www.domain.com/proxy">http://www.domain.com/proxy</a></strong></p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20171207151259808430209.png"></p><p>ç‚¹å‡»æŒ‰é’®è¿›è¡Œæäº¤ï¼Œå‘ç°æ­¤æ—¶æ²¡æœ‰å‡ºç°è·¨åŸŸé—®é¢˜ã€‚è™½ç„¶æäº¤çš„URL åŸŸåæ˜¯ <strong><a href="http://www.domain.com/">http://www.domain.com</a></strong>ï¼Œè€Œè¯·æ±‚ç»è¿‡ Nginx çš„åå‘ä»£ç†ä¹‹åï¼Œå®é™…ä¸Šæäº¤åˆ°äº† B é¡¹ç›®ï¼Œå³ <strong><a href="http://a.domain.com/">http://a.domain.com</a></strong>ï¼Œ ä¹Ÿå¯ä»¥çœ‹åˆ° B é¡¹ç›®æ‰“å°äº†è¾“å‡ºè¯­å¥ userId: 12ï¼Œç”±æ­¤ä¾¿è§£å†³äº†è·¨åŸŸé—®é¢˜ã€‚</p><h2 id="èµ„æºä¸‹è½½"><a href="#èµ„æºä¸‹è½½" class="headerlink" title="èµ„æºä¸‹è½½"></a>èµ„æºä¸‹è½½</h2><p>æ–‡ç« æ¶‰åŠçš„jaræ–‡ä»¶æˆ‘æ‰“æˆä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå¯ä»¥è‡ªå·±ä¸‹è½½å°è¯•ä¸€ä¸‹ã€‚</p><p><strong><a href="https://pan.baidu.com/s/1pLifFBl">ã€ç‚¹æˆ‘ä¸‹è½½ã€‘</a>  æå–å¯†ç : 8e68</strong></p>]]></content>
    
    
    <categories>
      
      <category>æœåŠ¡å™¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
      <tag>è·¨åŸŸé—®é¢˜</tag>
      
      <tag>åå‘ä»£ç†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>javaæ¨å¹¿ç³»ç»Ÿè®¾è®¡</title>
    <link href="/java%E6%8E%A8%E5%B9%BF%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1.html"/>
    <url>/java%E6%8E%A8%E5%B9%BF%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å…¬å¸æ–°ç«™ç”±äºè¿è¥éœ€æ±‚ï¼Œéœ€è¦å¼€å‘ä¸€å¥—æ¨å¹¿ç³»ç»Ÿï¼Œç”¨äºç½‘ç«™ç”¨æˆ·å¼•æµï¼Œè¡ç”Ÿå‡ºçš„æ¨å¹¿å¥—è·¯ç›®å‰ä¾¿å·²ç»æœ‰å››ç§ï¼Œä¸ºäº†é™ä½è¿è¥ä¸Šæ‰‹æ¨å¹¿ç³»ç»Ÿçš„éš¾åº¦ï¼Œå› æ­¤æ¨å¹¿ç³»ç»ŸåŠ¡å¿…è¦ä¾¿äºä½¿ç”¨ï¼Œæ‰€ä»¥æ¯ç§æ¨å¹¿æ–¹å¼çš„é…ç½®éœ€è¦ä¿æŒè¶³å¤Ÿæ˜äº†ç®€å•ã€‚</p><a id="more"></a><h2 id="èŠèŠæ¨å¹¿"><a href="#èŠèŠæ¨å¹¿" class="headerlink" title="èŠèŠæ¨å¹¿"></a>èŠèŠæ¨å¹¿</h2><p>å¸¸è§çš„æ¨å¹¿å¥—è·¯å°±æ˜¯é’ˆå¯¹ä¸€ä¸ªæ¨å¹¿å‘˜ç”Ÿæˆæ¨å¹¿é“¾æ¥ï¼Œæ¨å¹¿å‘˜ç„¶åå…¶ä»–ç”¨æˆ·é€šè¿‡æ¨å¹¿é“¾æ¥ç‚¹å‡»è¿›æ¥æ³¨å†Œï¼Œä½†æ˜¯ä¸å¯èƒ½æ¨å¹¿çš„é¡µé¢æ˜¯æ³¨å†Œé¡µé¢ï¼Œæ‰€ä»¥éœ€è¦å…ˆè®°å½•ä¸‹ç”¨æˆ·çš„æ¥æºã€‚æ³¨å†ŒæˆåŠŸçš„åŒæ—¶ï¼Œç»‘å®šç”¨æˆ·ä¸æ¨å¹¿å‘˜çš„å…³ç³»ï¼Œä¾¿äºæ—¥åé€šè¿‡ç”¨æˆ·çš„å……å€¼æ¶ˆè´¹ç»Ÿè®¡æ¨å¹¿å‘˜çš„æ¨å¹¿è´¹ç”¨ï¼Œä»¥ä¸‹ä¸ºæ¨å¹¿çš„ç®€å•æµç¨‹å›¾ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20171203151228872026958.png"></p><h2 id="æ¨å¹¿ç³»ç»Ÿå®ç°"><a href="#æ¨å¹¿ç³»ç»Ÿå®ç°" class="headerlink" title="æ¨å¹¿ç³»ç»Ÿå®ç°"></a>æ¨å¹¿ç³»ç»Ÿå®ç°</h2><h3 id="æ¨å¹¿é“¾æ¥çš„ç”Ÿæˆ"><a href="#æ¨å¹¿é“¾æ¥çš„ç”Ÿæˆ" class="headerlink" title="æ¨å¹¿é“¾æ¥çš„ç”Ÿæˆ"></a>æ¨å¹¿é“¾æ¥çš„ç”Ÿæˆ</h3><p>æ•´ä¸ªæ¨å¹¿æµç¨‹æœ€ä¸»è¦çš„åœ°æ–¹å°±æ˜¯æ¨å¹¿é“¾æ¥çš„ç”Ÿæˆä¸ä½¿ç”¨ï¼Œä¸ºäº†æ–¹ä¾¿æ¨å¹¿é“¾æ¥çš„ç®¡ç†ï¼Œéœ€è¦å°†ç”Ÿæˆçš„æ¨å¹¿é“¾æ¥è¿›è¡Œä¿å­˜ã€‚é¦–å…ˆè¿›è¡Œæ¨å¹¿é“¾æ¥è¡¨çš„è®¾è®¡ã€‚æœ€åæä¾›ç»™æ¨å¹¿å‘˜çš„æ¨å¹¿é“¾æ¥æ ¼å¼å¦‚ï¼š<code>http://m.domain.com/cp?code=xx</code>ï¼Œå…¶ä¸­ code çš„å€¼ä¸ºæ¨å¹¿é“¾æ¥çš„ IDã€‚</p><table><thead><tr><th>å­—æ®µåç§°</th><th align="center">å­—æ®µç±»å‹</th><th>å­—æ®µæè¿°</th></tr></thead><tbody><tr><td>id</td><td align="center">int</td><td>æ¨å¹¿é“¾æ¥è‡ªå¢ä¸»é”®</td></tr><tr><td>title</td><td align="center">varcahr</td><td>æ¨å¹¿æ ‡é¢˜</td></tr><tr><td>partner_id</td><td align="center">int</td><td>æ¨å¹¿å‘˜ID</td></tr><tr><td>params</td><td align="center">text</td><td>æ¨å¹¿å‚æ•°</td></tr><tr><td>type</td><td align="center">tinyint</td><td>æ¨å¹¿ç±»å‹</td></tr><tr><td>url_type</td><td align="center">tinyint</td><td>URLç±»å‹</td></tr><tr><td>create_time</td><td align="center">timestamp</td><td>åˆ›å»ºæ—¶é—´</td></tr><tr><td>update_time</td><td align="center">timestamp</td><td>æ›´æ–°æ—¶é—´</td></tr><tr><td>status</td><td align="center">tinyint</td><td>å¯ç”¨çŠ¶æ€</td></tr></tbody></table><p>å­—æ®µè§£è¯»ï¼š  </p><ol><li><p>æˆ‘è¿™é‡Œçš„ id ç›´æ¥è®¾ç½®ä¸ºäº†è‡ªå¢ä¸»é”®çš„å€¼ï¼Œå½“ç„¶ä¸ºäº†å®‰å…¨ç‚¹ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸ºå…¶ä»–çš„å€¼ï¼Œæ¯”å¦‚ UUIDï¼›  </p></li><li><p>title å¯¹äºåŒä¸€ä¸ªæ¨å¹¿å‘˜ï¼Œå¯èƒ½ä¼šç”Ÿæˆå¤šæ¡æ¨å¹¿é“¾æ¥ï¼Œç”¨äºåŒºåˆ«ã€‚</p></li><li><p>partner_id è¿™ä¸ªå°±ä¸å¿…å¤šè¯´ï¼Œè¡¨æ˜æ¨å¹¿é“¾æ¥å±äºå“ªä¸€ä¸ªæ¨å¹¿å‘˜</p></li><li><p>params æ³¨æ„è¿™ä¸ªå‚æ•°ç±»å‹ä¸º <strong>text</strong>ï¼Œ å› ä¸ºä¸ºäº†æ–¹ä¾¿æ‰©å±•ä¸šåŠ¡å‚æ•°ï¼Œå› æ­¤æ­¤å­—æ®µå­˜å‚¨çš„æ˜¯ä¸€æ®µ JSONï¼Œè‹¥ä½¿ç”¨ varchar é•¿åº¦ä¼šä¸å¤Ÿç”¨ã€‚ä¸šåŠ¡å‚æ•°åœ¨æˆ‘å¸ï¼Œå¯ä»¥æ˜¯ï¼šèµ é€ VIP å¤©æ•°ï¼Œèµ é€é˜…è¯»åˆ¸æ•°é‡ï¼Œæ¨å¹¿è´¹ç”¨ç­‰ã€‚è¿™ä¸ªå­—æ®µå¯ä»¥è‡ªç”±å‘æŒ¥ï¼Œåœ¨ç»‘å®šç”¨æˆ·çš„æ—¶å€™è·å–è¯¥å­—æ®µï¼Œè§£ææˆ JSON å¯¹è±¡ï¼Œè¯»å–å¯¹åº”çš„ä¸šåŠ¡å‚æ•°ï¼Œè¿›è¡Œç›¸å¯¹åº”çš„è®¾ç½®ã€‚</p></li><li><p>å› ä¸ºè¿è¥åŒå­¦çš„è„‘æ´ä¸€èˆ¬éƒ½å¾ˆå¤§ï¼Œå› æ­¤æ¨å¹¿æ–¹å¼ä¼šæœ‰å¾ˆå¤šç§ï¼Œä¹Ÿæ˜¯ä¸ºäº†æ—¥ååˆ†ææ¨å¹¿æ•ˆæœï¼Œå› æ­¤åŠ ä¸Š type å­—æ®µç”¨äºåŒºåˆ†æ¨å¹¿ç±»å‹ï¼Œæ¨å¹¿ç±»å‹æœ‰æ¯”å¦‚ï¼š CPSæ¨å¹¿ã€å¾®ä¿¡å…¬ä¼—æ¨å¹¿ç­‰ï¼›</p></li><li><p>url_type ç”¨äºåŒºåˆ†éœ€è¦æ¨å¹¿çš„é¡µé¢æ˜¯ç›¸å¯¹è·¯å¾„è¿˜æ˜¯ç»å¯¹è·¯å¾„ã€‚</p></li><li><p>status ç”¨äºæ ‡è®°æ­¤æ¨å¹¿é“¾æ¥æ˜¯å¦æœ‰æ•ˆï¼Œæ¯”å¦‚ç»ˆæ­¢æ¨å¹¿åˆä½œï¼Œå°±å¯ä»¥è®¾ç½®ä¸ºå…³é—­ï¼Œä¸å†å°†ç”¨æˆ·ç»‘å®šåˆ°æ­¤é“¾æ¥ã€‚</p></li></ol><p>åå°æ¨å¹¿é“¾æ¥ç”Ÿæˆé¡µé¢å‚è€ƒï¼š  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20171203151228736175519.png"></p><h3 id="æ¨å¹¿é“¾æ¥çš„è·³è½¬"><a href="#æ¨å¹¿é“¾æ¥çš„è·³è½¬" class="headerlink" title="æ¨å¹¿é“¾æ¥çš„è·³è½¬"></a>æ¨å¹¿é“¾æ¥çš„è·³è½¬</h3><p>é¦–å…ˆå†çœ‹çœ‹æ¨å¹¿çš„æµç¨‹</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20171203151228877937882.png"></p><p>é¦–å…ˆç”¨æˆ·é€šè¿‡ç‚¹å‡»æ¨å¹¿é“¾æ¥ï¼Œè¿›å…¥äº†æ¨å¹¿çš„é¡µé¢ï¼Œæˆ‘å¸å°±æ˜¯å°è¯´çš„æŸä¸€å…è´¹ç« èŠ‚çš„é˜…è¯»é¡µé¢ï¼Œä¹‹ååˆ°æ”¶è´¹ç« èŠ‚çš„æ—¶å€™ï¼Œå°±ä¼šæç¤ºç”¨æˆ·è¿›è¡Œç™»å½•ã€‚<br>æ³¨å†Œçš„ç”¨æˆ·ï¼Œå¦‚ä½•çŸ¥é“æ˜¯ä»å“ªä¸€ä¸ªé“¾æ¥è¿‡æ¥çš„å‘¢ï¼Ÿè¿™å°±éœ€è¦åœ¨ç”¨æˆ·æ³¨å†Œä¹‹å‰å°±å°†æ¨å¹¿é“¾æ¥çš„æ ‡è®°è¿›è¡Œå­˜å‚¨ï¼Œæœ€å¥½çš„æ–¹å¼å°±æ˜¯å†™å…¥ Cookieã€‚ä¹‹å‰å…¬å¸é¡¹ç›®å†™ Cookie æ˜¯åœ¨å‰ç«¯è¿›è¡Œï¼Œä½†æ˜¯è¿è¡Œä¹‹åï¼Œå‘ç°ä¸å¤ªå¯é ï¼Œå› æ­¤æˆ‘ä»¬å°†å†™ Cookie çš„æ“ä½œæ”¾åœ¨åç«¯è¿›è¡Œã€‚</p><p>æ¨å¹¿é“¾æ¥åœ°å€æ˜¯ <code>http://m.domain.com/cp?code=xx</code>ï¼Œè®¿é—®å¦‚ä¸‹æ¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ç”¨äºæ¨å¹¿é“¾æ¥çš„ç»Ÿä¸€è·³è½¬</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@RequestMapping</span> (value = <span class="hljs-string">&quot;/cp&quot;</span>, method = RequestMethod.GET)<br><span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">companionRedirect</span><span class="hljs-params">(String code,</span></span><br><span class="hljs-function"><span class="hljs-params">        HttpServletRequest request, Model m, HttpServletResponse response)</span> </span>&#123;<br><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">int</span> id = Integer.parseInt(code);<br>        <span class="hljs-comment">// æŸ¥è¯¢å‡ºæ¨å¹¿é“¾æ¥è®°å½•</span><br>        CompanionLink link = companionService.getCompanionLink(id);<br>        <span class="hljs-keyword">if</span> (link != <span class="hljs-keyword">null</span> &amp;&amp; link.getStatus() != Constants.STATUS_DELETE) &#123;<br>            JSONObject obj = JSONObject.parseObject(link.getParams());<br>            <span class="hljs-comment">// è·å–æ¨å¹¿é¡µé¢çš„åœ°å€</span><br>            String url = obj.getString(<span class="hljs-string">&quot;url&quot;</span>);<br>            <span class="hljs-comment">// å°† code å€¼å³æ¨å¹¿é“¾æ¥çš„ id å†™å…¥Cookie ä¸­ï¼Œ EXPä¸ºæœ‰æ•ˆæœŸ 3 å¤©</span><br>            CookieUtil.setCookie(request, response, Constants.COMPANION_COOKIE_NAME, code, EXP);<br><br>            <span class="hljs-comment">// è·³è½¬åˆ°æ¨å¹¿é¡µé¢</span><br>            <span class="hljs-keyword">if</span> (link.getUrlType() == Constants.ABS) &#123;<br>                <span class="hljs-comment">// ç»å¯¹è·¯å¾„ç›´æ¥è·³è½¬</span><br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;redirect:&quot;</span> + url;<br>            &#125;<span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-comment">// ç›¸å¯¹è·¯å¾„æ‹¼æ¥åŸŸååè·³è½¬</span><br>                <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;redirect:&quot;</span> + Constants.MOBILE_SERVER_DOMAIN + url;<br>            &#125;<br>        &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (NumberFormatException e) &#123;<br><br>    &#125;<br><br>    <span class="hljs-comment">// å‡ºç°å¼‚å¸¸ï¼Œè·³è½¬åˆ°é¦–é¡µ</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;redirect:&quot;</span> + Constants.MOBILE_SERVER_DOMAIN;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œå‘ç°ä¹‹å‰è®¾è®¡æ¨å¹¿é“¾æ¥çš„æ—¶å€™æœ‰æ‰€ç–æ¼ï¼Œæœ‰çš„æ¨å¹¿æ–¹å¼æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œè€Œæœ‰çš„æ˜¯ç»å¯¹è·¯å¾„ã€‚<br>è€Œæˆ‘åœ¨ä»£ç ä¸­æ˜¯é€šè¿‡ String çš„ Containsæ–¹æ³•æ˜¯å¦åŒ…å«åŸŸåæ¥åˆ¤æ–­æ˜¯ç›¸å¯¹çš„è¿˜æ˜¯ç»å¯¹çš„è·¯å¾„ï¼Œå…¶å®æ²¡æœ‰å¿…è¦ï¼Œå®Œå…¨å¯ä»¥æ·»åŠ ä¸€ä¸ªæ¨å¹¿é“¾æ¥çš„ url çš„è·¯å¾„ç±»å‹ã€‚åˆ¤æ–­ç±»å‹å³å¯ï¼Œå¦‚æœæ˜¯ç»å¯¹è·¯å¾„ç›´æ¥è·³è½¬ï¼Œå¦åˆ™æ‹¼æ¥åŸŸååè·³è½¬ã€‚</p><h3 id="æ¨å¹¿å…³ç³»çš„ç»‘å®š"><a href="#æ¨å¹¿å…³ç³»çš„ç»‘å®š" class="headerlink" title="æ¨å¹¿å…³ç³»çš„ç»‘å®š"></a>æ¨å¹¿å…³ç³»çš„ç»‘å®š</h3><p>ç”¨æˆ·æµè§ˆå™¨çš„ Cookie ä¸­å·²ç»ä¿å­˜å¥½äº†æ¨å¹¿é“¾æ¥çš„ code å€¼ï¼Œç»‘å®šå…³ç³»å°±å¥½åŠäº†ï¼Œå¯ä»¥åœ¨ç”¨æˆ·æ³¨å†Œçš„æ—¶å€™ï¼Œè¯»å–æµè§ˆå™¨çš„ Cookieï¼Œè·å–è¿™ä¸ª Cookieï¼Œå¾—åˆ°æ¨å¹¿é“¾æ¥çš„ id, å°†ç”¨æˆ·çš„ id ä¸æ¨å¹¿çš„ partner_id è¿›è¡Œç»‘å®šï¼Œä¿å­˜åˆ°ç»‘å®šå…³ç³»çš„è¡¨ä¸­å³å¯ï¼Œæ¯”å¦‚æˆ‘å¸çš„èµ é€æ“ä½œä¹Ÿä¸€åœ¨ç»‘å®šåæ‰§è¡Œã€‚</p><p>è‡³äºç»‘å®šå…³ç³»çš„è¡¨è®¾è®¡ï¼Œä¸»è¦å°† partner_id ä¸ user_id ä½œä¸ºè”åˆä¸»é”®ä¿å­˜ï¼Œå…¶ä»–å­—æ®µå¦‚ç»‘å®šæ—¶é—´å°±ä¸ç”¨å¤šè¯´äº†å§ã€‚</p><h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>å¦‚æœä½ çœ‹å®Œè§‰å¾—æœ‰ä»€ä¹ˆç–‘é—®ï¼Œå¯ä»¥ç•™è¨€è¯„è®ºï¼Œæœ‰éœ€è¦æ”¹è¿›çš„åœ°æ–¹ä¹Ÿè¯·æå‡ºï¼Œå…±åŒè¿›æ­¥ï¼</p>]]></content>
    
    
    <categories>
      
      <category>ç³»ç»Ÿè®¾è®¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ¨å¹¿ç³»ç»Ÿ</tag>
      
      <tag>æ¨å¹¿</tag>
      
      <tag>é“¾æ¥æ¨å¹¿</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Maven ç§æœä¸Šä¼ jaråŒ…</title>
    <link href="/Maven%20%E7%A7%81%E6%9C%8D%E4%B8%8A%E4%BC%A0jar%E5%8C%85.html"/>
    <url>/Maven%20%E7%A7%81%E6%9C%8D%E4%B8%8A%E4%BC%A0jar%E5%8C%85.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‰æ®µæ—¶é—´ï¼Œå…¬å¸å¼€äº†æ–°ç«™ï¼Œä¸»è¦ç”±æˆ‘æ¥è´Ÿè´£æ–°ç«™çš„æ­å»ºå·¥ä½œï¼ŒåŸºç¡€çš„ç³»ç»Ÿæ¯”å¦‚ç™»å½•ç³»ç»Ÿï¼Œæ”¯ä»˜ç³»ç»Ÿçš„æ­å»ºã€‚  </p><p>ä»Šå¤©åœ¨11æœˆæœ«å°¾è¡¥ä¸Šè¿™ä¸€ç¯‡æ–‡ç« ï¼Œä¸ç„¶æ”¾å‡ºå»çš„è¯åšä¸åˆ°å°±ä¸å¥½äº†ï¼ˆä¸€ä¸ªæœˆè‡³å°‘ä¸¤ç¯‡åšå®¢ï¼‰</p><a id="more"></a><p>åœ¨æ¥å…¥æ”¯ä»˜å®æ”¯ä»˜çš„æ—¶å€™ï¼Œé‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚  </p><p>æˆ‘ä»¬å…¬å¸çš„ä¹‹å‰é¡¹ç›®æ¥å…¥çš„æ˜¯æ”¯ä»˜å® mapi æ”¯ä»˜ï¼Œè¿™æ˜¯æ¯”è¾ƒæ—©çš„æ”¯ä»˜æ¥å£ï¼Œå‰ä¸€é˜µå­ï¼Œè¯¥æ¥å£çš„æˆæƒä¹Ÿåˆ°æœŸäº†ï¼Œæˆ‘ä¹Ÿè´Ÿè´£åç»­æ¥å£çš„å‡çº§ã€‚</p><p>æ¥å£å‡çº§åï¼Œæ”¯ä»˜å®å¯¹å…¶ SDK ä¹Ÿè¿›è¡Œäº†å‡çº§ï¼ŒæŒ‰ç…§ç½‘ç«™æ–‡æ¡£ç¼–å†™ä»£ç å‘ç°æœ‰äº›æ–¹æ³•ä¸å­˜åœ¨ï¼Œæ‰çŸ¥é“æ˜¯ç”±äº é¡¹ç›®ä¸­ SDK çš„ç‰ˆæœ¬è¿‡ä½å¯¼è‡´çš„ã€‚æ—¢ç„¶çŸ¥é“äº†é—®é¢˜ï¼Œå°±è¦è§£å†³é—®é¢˜ï¼Œäºæ˜¯åœ¨å®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆçš„ SDKã€‚</p><p>æˆ‘ä»¬å…¬å¸çš„é¡¹ç›®å…¨éƒ¨åŸºäº Maven è¿›è¡Œæ„å»ºï¼Œä½†æ˜¯å®˜ç½‘çš„ SDK åªæ˜¯ JAR åŒ…ï¼Œåœ¨ä¸­å¤®ä»“åº“æ˜¯æ²¡æœ‰çš„ï¼Œå› æ­¤ä½¿ç”¨çš„è¯éœ€è¦ä¸Šä¼ åˆ°å…¬å¸çš„ Maven ç§æœä¸Šã€‚</p><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><ul><li>éœ€è¦ä¸Šä¼ çš„ Jar åŒ…ï¼Œæˆ‘è¿™é‡Œæ˜¯æ”¯ä»˜å®çš„ SDK çš„ Jar åŒ…</li><li>ç§æœç¯å¢ƒï¼š <a href="http://www.jfrogchina.com/open-source/">Artifactory</a></li></ul><p>æˆ‘ä»¬å…¬å¸çš„ maven ç§æœå°±æ˜¯è¿™è´§å•¦  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20171130151204452196528.png"></p><h2 id="ä¸Šä¼ -Jar-åŒ…åˆ°-Maven"><a href="#ä¸Šä¼ -Jar-åŒ…åˆ°-Maven" class="headerlink" title="ä¸Šä¼  Jar åŒ…åˆ° Maven"></a>ä¸Šä¼  Jar åŒ…åˆ° Maven</h2><h3 id="é€‰æ‹©ä¸Šä¼ -Jar-åŒ…"><a href="#é€‰æ‹©ä¸Šä¼ -Jar-åŒ…" class="headerlink" title="é€‰æ‹©ä¸Šä¼  Jar åŒ…"></a>é€‰æ‹©ä¸Šä¼  Jar åŒ…</h3><p>ç™»å½• Artifactory åï¼Œé€‰æ‹© Deployï¼Œé€‰æ‹©è¦ä¸Šä¼ çš„ Jar åŒ…ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©ä¸Šä¼ æ”¯ä»˜å®çš„ SDK çš„ Jar åŒ…ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171102/113134666.png?imageslim"></p><h3 id="è®¾ç½®ä¸Šä¼ -Jar-åŒ…ä¿¡æ¯"><a href="#è®¾ç½®ä¸Šä¼ -Jar-åŒ…ä¿¡æ¯" class="headerlink" title="è®¾ç½®ä¸Šä¼  Jar åŒ…ä¿¡æ¯"></a>è®¾ç½®ä¸Šä¼  Jar åŒ…ä¿¡æ¯</h3><p>åœ¨è¿™é‡Œé€‰æ‹©è¦ä¸Šä¼ çš„ä»“åº“ï¼Œä»¥åŠè®¾ç½® â€œGAVâ€ å‚æ•°  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171102/113157073.png?imageslim"></p><p>ç”±äºæ”¯ä»˜å®çš„ Jar åŒ…åç§°å¤ªé•¿äº†ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œç²¾ç®€äº†ä¸å¿…è¦çš„ä¿¡æ¯ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171102/113402039.png?imageslim"></p><p>è®¾ç½®å®Œä¹‹åï¼Œç‚¹å‡»å®Œæˆå³å¯ã€‚</p><h3 id="æŸ¥æ‰¾ä¸Šä¼ -Jar-çš„-Maven-åæ ‡"><a href="#æŸ¥æ‰¾ä¸Šä¼ -Jar-çš„-Maven-åæ ‡" class="headerlink" title="æŸ¥æ‰¾ä¸Šä¼  Jar çš„ Maven åæ ‡"></a>æŸ¥æ‰¾ä¸Šä¼  Jar çš„ Maven åæ ‡</h3><p>æ‰¾åˆ°åˆšæ‰ä¿å­˜çš„åº“ï¼Œæ‰¾åˆ°ä¸Šä¼ çš„ Jar åŒ…  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171102/113450326.png?imageslim"></p><p>ç‚¹å‡» å¯¹åº”çš„ pom æ–‡ä»¶ï¼ŒæŸ¥çœ‹ Maven åæ ‡   </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171102/113512171.png?imageslim"></p><p>å°†æ­¤åæ ‡å†™å…¥ pom.xml ä¸­å³å¯ï¼Œéœ€è¦å…ˆå°†ç§æœçš„åœ°å€å†™åˆ° pom.xml æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">repositories</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>repos<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>http://192.168.1.222:8088/artifactory/repos<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">repositories</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h2 id="ä¸Šä¼ æºç -Jar-åŒ…åˆ°ç§æœä»“åº“"><a href="#ä¸Šä¼ æºç -Jar-åŒ…åˆ°ç§æœä»“åº“" class="headerlink" title="ä¸Šä¼ æºç  Jar åŒ…åˆ°ç§æœä»“åº“"></a>ä¸Šä¼ æºç  Jar åŒ…åˆ°ç§æœä»“åº“</h2><p>æƒ³è¦åœ¨å¼€å‘æ—¶çœ‹å¯ä»¥æŸ¥çœ‹æºç çš„æ—¶å€™ï¼Œéœ€è¦å°†å¯¹åº”çš„æºç  Jar åŒ…ä¸€èµ·ä¸Šä¼ åˆ°ç§æœä¸­å»ï¼Œä¸å‰é¢æ­¥éª¤ç›¸åŒï¼Œæ­¤æ—¶é€‰æ‹©å¯¹åº”çš„æºç çš„ Jar åŒ…ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171102/114351967.png?imageslim"></p><p>éœ€è¦æ³¨æ„è¿™é‡Œçš„ ç›®æ ‡ä»“åº“ä¸ GAV å‚æ•°ä¿æŒä¸ä¸Šé¢ä¸Šä¼ å¯¹åº”çš„ Jar åŒ…ä¿æŒä¸€è‡´ã€‚å”¯ä¸€ä¸åŒçš„åœ°æ–¹æ˜¯ <strong>Classifier</strong> ä¸º <strong>sources</strong>ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171102/133357044.png?imageslim"></p><p>ä¸Šä¼ æˆåŠŸåå¦‚å›¾ï¼Œæºç åŒ…ä¸å·¥ç¨‹åŒ…åœ¨åŒä¸€çº§ç›®å½•ä¸­ã€‚æ­¤æ—¶åœ¨é¡¹ç›®ä¸­å¯ä»¥åˆ·æ–° pom.xml æ–‡ä»¶åï¼Œå¯¹åº”çš„æºç å°±ä¼šä¸€åŒä¸‹è½½ä¸‹è½½ä¸‹æ¥äº†ï¼Œå¯ä»¥æ„‰å¿«çš„çœ‹æºç äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/20171130151204689848191.png"></p><p>End.</p>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Mavenç§æœ</tag>
      
      <tag>jaråŒ…ä¸Šä¼ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¾®ä¿¡æ”¯ä»˜å¼€å‘æœ¬åœ°æ¥æ”¶å¼‚æ­¥é€šçŸ¥å›è°ƒã€å®æˆ˜ã€‘</title>
    <link href="/%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E5%BC%80%E5%8F%91%E6%9C%AC%E5%9C%B0%E6%8E%A5%E6%94%B6%E5%BC%82%E6%AD%A5%E9%80%9A%E7%9F%A5%E5%9B%9E%E8%B0%83%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91.html"/>
    <url>/%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E5%BC%80%E5%8F%91%E6%9C%AC%E5%9C%B0%E6%8E%A5%E6%94%B6%E5%BC%82%E6%AD%A5%E9%80%9A%E7%9F%A5%E5%9B%9E%E8%B0%83%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘åœ¨è°ƒè¯•å¾®ä¿¡ç›¸å…³çš„æ¥å£ï¼Œä½†æ˜¯ç”±äºå¾®ä¿¡å®˜æ–¹å‡ºäºå®‰å…¨çš„è€ƒè™‘ï¼Œå¯¹äºè°ƒç”¨æ¥å£çš„åŸŸåæœ‰é™åˆ¶ã€‚å¾®ä¿¡æˆæƒä¸å¾®ä¿¡æ”¯ä»˜ç»Ÿä¸€ä¸‹å•æ¥å£åœ¨æœ¬åœ°å¯ä»¥é€šè¿‡æ›´æ”¹ host çš„æ–¹å¼æ¥è°ƒè¯•ï¼Œå¾®ä¿¡æœåŠ¡å™¨ä¹Ÿèƒ½è·³è½¬å›æ¥ï¼Œä½†æ˜¯å¾®ä¿¡æ”¯ä»˜å¼‚æ­¥é€šçŸ¥è¿™é‡Œï¼›å¾®ä¿¡å®˜æ–¹å¼ºåˆ¶è®©è®¾ç½®æ”¯ä»˜æˆæƒç›®å½•ï¼Œä¸”æ˜¯é€šè¿‡ ICP å¤‡æ¡ˆçš„åŸŸåï¼Œå› æ­¤ä¸é‡‡å–ç‰¹æ®Šæ‰‹æ®µï¼Œ<strong>æœ¬åœ°æ˜¯æ— æ³•æ¥æ”¶åˆ°å¾®ä¿¡çš„å¼‚æ­¥é€šçŸ¥å›è°ƒè¯·æ±‚çš„ï¼Œåªèƒ½éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒæµ‹è¯•</strong>ã€‚  </p><a id="more"></a><h2 id="å‰ç½®æ¡ä»¶"><a href="#å‰ç½®æ¡ä»¶" class="headerlink" title="å‰ç½®æ¡ä»¶"></a>å‰ç½®æ¡ä»¶</h2><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒæŠ˜è…¾äº†å¥½å‡ å¤©ï¼Œæ‰æå‡ºæ¥äº†ï¼Œç©¶å…¶æ ¹æœ¬åŸå› ï¼Œè¿˜æ˜¯å¯¹äº <strong>Nginx</strong> ä¸å¤ªç†Ÿæ‚‰ã€‚æ‰€ä»¥åœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚</p><h3 id="å†…ç½‘è½¬å‘"><a href="#å†…ç½‘è½¬å‘" class="headerlink" title="å†…ç½‘è½¬å‘"></a>å†…ç½‘è½¬å‘</h3><p>å¦‚æœæƒ³æœ¬åœ°è¿›è¡Œè°ƒè¯•ï¼Œå¹¶ä¸”æƒ³è®©å¾®ä¿¡æœåŠ¡å™¨è¯·æ±‚å›è°ƒå›æ¥ï¼Œåˆ™æœ¬åœ°å¿…é¡»è¦æœ‰ä¸€ä¸ªå¤–ç½‘åŸŸåï¼Œè¿™é‡Œæˆ‘ä»¬æ˜¯ç”¨ <a href="https://www.ngrok.cc/">Ngrokå†…ç½‘è½¬å‘</a> æ¥å®ç°ï¼›Ngrok çš„é…ç½®å°±æ˜¯å°†æœ¬åœ°é¡¹ç›®çš„ç«¯å£æ˜ å°„åˆ°åˆ†é…çš„å¤–ç½‘åŸŸåï¼Œå…·ä½“é…ç½®å‚è€ƒå®˜ç½‘æ•™ç¨‹æ–‡æ¡£ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚</p><p>æˆ‘çš„é…ç½®æ˜¯ï¼š</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">http</span>://<span class="hljs-selector-tag">vcmq</span><span class="hljs-selector-class">.free</span><span class="hljs-selector-class">.ngrok</span><span class="hljs-selector-class">.cc</span> <span class="hljs-selector-tag">-</span>&gt; 127.0.0.1<span class="hljs-selector-pseudo">:8080</span><br></code></pre></div></td></tr></table></figure><h3 id="é…ç½®æµ‹è¯•æ”¯ä»˜ç›®å½•"><a href="#é…ç½®æµ‹è¯•æ”¯ä»˜ç›®å½•" class="headerlink" title="é…ç½®æµ‹è¯•æ”¯ä»˜ç›®å½•"></a>é…ç½®æµ‹è¯•æ”¯ä»˜ç›®å½•</h3><p>å‰é¢æåˆ°äº†ï¼Œå¾®ä¿¡æ”¯ä»˜å¼‚æ­¥é€šçŸ¥ä¼šå¯¹æ”¯ä»˜åŸŸå<strong>ç›®å½•</strong>æœ‰è¦æ±‚ï¼Œå› æ­¤ï¼Œæ”¯ä»˜æ—¶çš„åŸŸåå¿…é¡»è¦åœ¨è®¾ç½®çš„æ”¯ä»˜åŸŸåç›®å½•ä¸‹ã€‚</p><p>é¦–å…ˆéœ€è¦åœ¨ <a href="https://pay.weixin.qq.com/">å¾®ä¿¡å•†æˆ·å¹³å°</a> ä¸­é…ç½® å•†æˆ·ç§˜é’¥ï¼Œæ”¯ä»˜æˆæƒç›®å½•ã€‚  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171108/215523458.png" alt="mark"></p><p>è¿™é‡Œæ”¯ä»˜æˆæƒç›®å½•é…ç½®çš„æ˜¯ä»¥åçº¿ä¸Šçš„æ”¯ä»˜æˆæƒç›®å½•</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>pay.domain.com<span class="hljs-regexp">/wechat/</span>public/<br></code></pre></div></td></tr></table></figure><p>ç„¶åå†åŠ ä¸€æ¡æœ¬åœ°æµ‹è¯•æ”¯ä»˜çš„ä¸´æ—¶æˆæƒç›®å½•ï¼Œè¿™ä¸ªç›®å½•æœ€å¥½åœ¨æœ¬åœ°æµ‹è¯•å®Œæˆåï¼Œè¿›è¡Œåˆ é™¤ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>pay.domain.com<span class="hljs-regexp">/testpay/</span><br></code></pre></div></td></tr></table></figure><h2 id="å¿…çŸ¥çš„-Nginx-è¯­æ³•"><a href="#å¿…çŸ¥çš„-Nginx-è¯­æ³•" class="headerlink" title="å¿…çŸ¥çš„ Nginx è¯­æ³•"></a>å¿…çŸ¥çš„ Nginx è¯­æ³•</h2><h3 id="proxy-pass-åçš„-url-åŠ ä¸åŠ -çš„åŒºåˆ«"><a href="#proxy-pass-åçš„-url-åŠ ä¸åŠ -çš„åŒºåˆ«" class="headerlink" title="proxy_pass åçš„ url åŠ ä¸åŠ  / çš„åŒºåˆ«"></a>proxy_pass åçš„ url åŠ ä¸åŠ  / çš„åŒºåˆ«</h3><p>è¿™é‡Œåˆ—ä¸¾ nginx çš„ proxy_pass è¯­æ³•ï¼Œæ˜¯ä¸ºäº†ä¸‹ä¸€æ­¥é’ˆå¯¹ nginx çš„é…ç½®è¿›è¡Œä¿®æ”¹ã€‚  </p><p>è¿™é‡Œè®¿é—® <code>http://127.0.0.1/proxy/test.html</code> æµ‹è¯• <strong>proxy_pass</strong> åé¢çš„ url åŠ ä¸ä¸åŠ  / çš„åŒºåˆ«</p><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span>       <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span> <span class="hljs-number">127.0.0.1</span>;<br><br>    <span class="hljs-attribute">location</span>  /proxy/ &#123;<br>          <span class="hljs-attribute">proxy_pass</span> http://192.168.0.100/;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä»¥ä¸Š location ä¼šä»£ç†åˆ° <strong><a href="http://192.168.0.100/test.html">http://192.168.0.100/test.html</a></strong> å³ç›¸å½“äºæ˜¯ç»å¯¹æ ¹è·¯å¾„ï¼Œåˆ™ Nginx ä¸ä¼šæŠŠ location ä¸­çš„è·¯å¾„éƒ¨åˆ†ä»£ç†èµ°ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span>       <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span> <span class="hljs-number">127.0.0.1</span>;<br><br>    <span class="hljs-attribute">location</span>  /proxy/ &#123;<br>          <span class="hljs-attribute">proxy_pass</span> http://192.168.0.100;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä»¥ä¸Š location ä¼šä»£ç†åˆ° <strong><a href="http://192.168.0.100/proxy/test.html">http://192.168.0.100/proxy/test.html</a></strong> å³ç›¸å½“äºç›¸å¯¹è·¯å¾„ã€‚</p><hr><h2 id="ä»£ç†æ”¯ä»˜åŸŸååˆ°ç¬¬ä¸‰æ–¹åŸŸå"><a href="#ä»£ç†æ”¯ä»˜åŸŸååˆ°ç¬¬ä¸‰æ–¹åŸŸå" class="headerlink" title="ä»£ç†æ”¯ä»˜åŸŸååˆ°ç¬¬ä¸‰æ–¹åŸŸå"></a>ä»£ç†æ”¯ä»˜åŸŸååˆ°ç¬¬ä¸‰æ–¹åŸŸå</h2><p>çŸ¥é“ä¸Šä¸€æ­¥ proxy_pass å / çš„ä½œç”¨åï¼Œå°±å¼€å§‹æ¥é…ç½®æ”¯ä»˜åŸŸåæŒ‡å‘çš„æœåŠ¡å™¨ä¸Šçš„ nginx çš„é…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span>       <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span> pay.domain.com;<br><br>    <span class="hljs-attribute">location</span> /testpay/ &#123;<br>        <span class="hljs-attribute">proxy_set_header</span> Host vcmq.free.ngrok.cc;<br>        <span class="hljs-attribute">proxy_pass</span> http://vcmq.free.ngrok.cc/wide/;<br>    &#125;<br>    <br>    <span class="hljs-attribute">location</span> / &#123;<br>        <span class="hljs-attribute">proxy_pass</span> http://payServer;<br>    &#125;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><p>é…ç½®ä¸­çš„ <em>wide</em> æ˜¯æˆ‘é¡¹ç›®çš„åç§°ï¼›<br>æ³¨æ„ï¼šè¿™é‡Œçš„ <strong>proxy_set_header Host</strong> å¿…é¡»é…ç½®ï¼Œå¦åˆ™è¿›å…¥ location å—åï¼Œä¼šæç¤º <code>tunnel pay.domain.com not found</code>ã€‚</p><p>å½“è®¿é—® <strong>pay.domain.com/testpay/create</strong> å¾®ä¿¡ç»Ÿä¸€ä¸‹å•æ¥å£æ—¶ï¼Œ ä¼šä»£ç†åˆ° <strong><a href="http://vcmq.free.ngrok.cc/wide/create">http://vcmq.free.ngrok.cc/wide/create</a></strong>ï¼›</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ç»Ÿä¸€ä¸‹å•æ¥å£ï¼Œè®¾ç½® <strong>notify_url</strong> çš„å€¼è¦ä¸ºé…ç½®çš„æ”¯ä»˜æˆæƒç›®å½•ï¼Œæ¯”å¦‚æˆ‘çš„ <strong><a href="http://pay.domain.com/testpay/notify">http://pay.domain.com/testpay/notify</a></strong>ï¼Œè¿™ä¸ªå¼‚æ­¥é€šçŸ¥å›è°ƒ URL é™å®šæ˜¯ POST è¯·æ±‚ï¼Œå¯ä»¥åœ¨å¼‚æ­¥å›è°ƒæ–¹æ³•æ‰“æ–­ç‚¹ï¼Œç„¶åé€šè¿‡ postman å·¥å…·å‘é€ post è¯·æ±‚åˆ° <strong><a href="http://pay.domain.com/testpay/notify">http://pay.domain.com/testpay/notify</a></strong>ï¼Œçœ‹æ˜¯å¦å¯ä»¥æ­£å¸¸è¿›å…¥æ–­ç‚¹ï¼Œå¦‚æœæ­£å¸¸è¿›å…¥æ–­ç‚¹ï¼Œæ­å–œä½ é…ç½®å¥½äº† Nginx å›è°ƒè¿™ä¸€å—ã€‚</p><blockquote><p>æ³¨æ„ï¼š ç»Ÿä¸€ä¸‹å•æ¥å£å‚æ•°ä¸­æäº¤çš„å‚æ•° notify_url ï¼Œå¦‚æœé“¾æ¥æ— æ³•è®¿é—®ï¼Œå•†æˆ·å°†æ— æ³•æ¥æ”¶åˆ°å¾®ä¿¡é€šçŸ¥ã€‚<br>é€šçŸ¥ url å¿…é¡»ä¸ºç›´æ¥å¯è®¿é—®çš„ url ï¼Œä¸èƒ½æºå¸¦å‚æ•°ã€‚ç¤ºä¾‹ï¼šnotify_urlï¼šâ€œ<a href="https://pay.weixin.qq.com/wxpay/pay.action%E2%80%9D">https://pay.weixin.qq.com/wxpay/pay.actionâ€</a></p></blockquote><p>å¦å¤–è¦æ³¨æ„ï¼Œå¦‚æœæ”¯ä»˜ç›®å½•ä¸­é…ç½®çš„æ˜¯ https çš„ï¼Œé‚£ä¹ˆ notify_url ä¹Ÿä¸€å®šè¦ä¿æŒä¸€è‡´æ˜¯ https çš„ã€‚</p><p>ç»Ÿä¸€ä¸‹å•å¹¶å®Œæˆæ”¯ä»˜å®Œæˆåï¼Œå¾®ä¿¡æœåŠ¡å™¨ä¼šè¯·æ±‚ç»Ÿä¸€ä¸‹å•æ¥å£ä¸­çš„ <strong>notify_url</strong>ï¼Œç»è¿‡æœåŠ¡å™¨ nginx è¿›è¡Œä»£ç†åï¼Œä¼šä»£ç†åˆ° æœ¬åœ°çš„å†…ç½‘è½¬å‘åŸŸåå¼‚æ­¥é€šçŸ¥å›è°ƒæ¥å£ <strong><a href="http://vcmq.free.ngrok.cc/wide/notify">http://vcmq.free.ngrok.cc/wide/notify</a></strong>ï¼Œ ä»è€Œè¾¾åˆ°äº†æœ¬åœ°æ¥æ”¶å¾®ä¿¡æ”¯ä»˜å¼‚æ­¥é€šçŸ¥å›è°ƒè¯·æ±‚çš„ç›®çš„ã€‚  </p><p>å¦‚æœåœ°å€ä¸åœ¨æ”¯ä»˜æˆæƒç›®å½•ä¸‹ï¼Œä¼šæç¤ºå½“å‰ Url æœªæ³¨å†Œã€‚å› ä¸ºæ˜¯ä»£ç†è¿‡å»ï¼Œå› æ­¤åœ°å€æ çš„åœ°å€ä¸ä¼šæ”¹å˜ï¼Œè¿™ä¹Ÿæ˜¯ä¸èƒ½ç®€å•ä½¿ç”¨ nginx çš„ rewrite çš„åŸå› ã€‚</p><p>å¦‚æœ‰ç–‘é—®ï¼Œå¯ä»¥è”ç³»æˆ‘ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><p><a href="http://www.cnop.net/html/web/nginx/2017/0330/4953.html">nginx proxy_passåçš„urlåŠ ä¸åŠ /çš„åŒºåˆ«</a></p></li><li><p><a href="http://blog.csdn.net/faye0412/article/details/75200607">è·³è½¬ç¬¬ä¸‰æ–¹åŸŸå</a></p></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¾®ä¿¡å¼€å‘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å®æˆ˜</tag>
      
      <tag>nginxè½¬å‘</tag>
      
      <tag>proxy_pass</tag>
      
      <tag>æœ¬åœ°æ¥æ”¶å¼‚æ­¥é€šçŸ¥</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nginxå›¾ç‰‡é˜²ç›—é“¾ã€å®æˆ˜ã€‘</title>
    <link href="/Nginx%E5%9B%BE%E7%89%87%E9%98%B2%E7%9B%97%E9%93%BE%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91.html"/>
    <url>/Nginx%E5%9B%BE%E7%89%87%E9%98%B2%E7%9B%97%E9%93%BE%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åšä¸»ç›®å‰åœ¨ä¸€å®¶åŸåˆ›å°è¯´ç½‘ç«™å…¬å¸å·¥ä½œï¼Œç”±äºç«™å†…çš„ä½œå“å…¨éƒ¨æ˜¯åŸåˆ›ï¼Œäºæ˜¯ä¹ä¸å¯é¿å…åœ°ä¼šè¢«ä¸€äº›ç›—ç‰ˆç½‘ç«™çˆ¬å–ç›—ç‰ˆï¼Œå¯¹äºé˜²ç›—ç‰ˆä¸€ç›´æ²¡æœ‰å¾ˆå¥½çš„å¯¹ç­–ï¼Œè®©å…¬å¸å¾ˆæ˜¯è‹¦æ¼ã€‚<br>æœ€è¿‘å»ä¸€äº›ç›—ç‰ˆç½‘ç«™ä¸Šæœç´¢æˆ‘ä»¬ç½‘ç«™ä½œå“æ—¶ï¼Œå‘ç°ä»–ä»¬æ‰€ç”¨çš„å°é¢å›¾ç‰‡çš„æ¥æºæ˜¯æˆ‘ä»¬ç½‘ç«™çš„åœ°å€ï¼Œå³æ‰€è°“çš„ç›—é“¾ï¼Œè¿™å¯¹äºæˆ‘ä»¬ç½‘ç«™æœåŠ¡å™¨çš„å¸¦å®½æ˜¯ä¸€ç§æŸå¤±ï¼Œå› æ­¤éœ€è¦é‡‡å–å¯¹åº”çš„æ‰‹æ®µåº”å¯¹ã€‚</p><a id="more"></a><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><p>è¿™é‡Œæˆ‘ä½¿ç”¨ä¸¤å°è™šæ‹Ÿæœº  è™šæ‹Ÿæœºçš„å¿«é€Ÿå®‰è£…å¯ä»¥å‚è€ƒæˆ‘å¦å¤–ä¸€ç¯‡åšæ–‡ <a href="http://nullpointer.pw/2017/08/19/CentOS%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85/">CentOSå¿«é€Ÿå®‰è£…</a></p><ul><li>æœåŠ¡å™¨ Aï¼š192.168.200.130</li><li>æœåŠ¡å™¨ Bï¼š192.168.200.131</li></ul><h2 id="Nginx-å®‰è£…"><a href="#Nginx-å®‰è£…" class="headerlink" title="Nginx å®‰è£…"></a>Nginx å®‰è£…</h2><p>å‚è€ƒåšæ–‡ <a href="http://nullpointer.pw/2017/08/20/Nginx%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE/">Nginxç¼“å­˜é…ç½®</a> çš„ Nginx ç¯å¢ƒæ­å»ºéƒ¨åˆ†ã€‚</p><h2 id="Nginx-é˜²ç›—é“¾è®¾ç½®"><a href="#Nginx-é˜²ç›—é“¾è®¾ç½®" class="headerlink" title="Nginx é˜²ç›—é“¾è®¾ç½®"></a>Nginx é˜²ç›—é“¾è®¾ç½®</h2><h3 id="ä¸€ã€é…ç½®-Nginx-çš„é˜²ç›—é“¾"><a href="#ä¸€ã€é…ç½®-Nginx-çš„é˜²ç›—é“¾" class="headerlink" title="ä¸€ã€é…ç½® Nginx çš„é˜²ç›—é“¾"></a>ä¸€ã€é…ç½® Nginx çš„é˜²ç›—é“¾</h3><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-comment"># ä¿®æ”¹ nginx.conf é…ç½®æ–‡ä»¶</span><br><span class="hljs-attribute">vim</span> /usr/local/nginx/conf/nginx.conf<br><br><span class="hljs-comment"># æ·»åŠ  server èŠ‚ç‚¹</span><br>server &#123;<br>    <span class="hljs-attribute">listen</span>       <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span>  www.vcmq.com;<br>    <span class="hljs-comment">#access_log  logs/host.access.log  main;</span><br><br>    <span class="hljs-attribute">location</span> <span class="hljs-regexp">~* \.(jpg|png|gif)$</span> &#123;<br>        <span class="hljs-attribute">root</span> /home/resources;<br>        <span class="hljs-attribute">valid_referers</span> <span class="hljs-literal">none</span> server_names <span class="hljs-regexp">*.test</span>1.com ~\.test2\.;<br>        <span class="hljs-attribute">if</span> ($invalid_referer)&#123;<br>            <span class="hljs-attribute">rewrite</span><span class="hljs-regexp"> ^/</span> https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171028/214345352.png;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-attribute">location</span> / &#123;<br><span class="hljs-attribute">root</span>   html;<br><span class="hljs-attribute">index</span>  index.html index.htm;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘æ–°å¢çš„ server çš„åœ°å€æ˜¯ <em><a href="http://www.vcmq.com/">www.vcmq.com</a></em>ã€‚  </p><figure class="highlight crmsh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs crmsh"><span class="hljs-keyword">location</span> <span class="hljs-title">~* \.(jpg</span>|png|gif)$<br></code></pre></div></td></tr></table></figure><p>æ­¤è¡Œé…ç½®çš„ä½œç”¨æ˜¯<strong>åŒ¹é…ä»¥ jpg/png/gif  ç»“å°¾çš„æ–‡ä»¶è¯·æ±‚</strong>ï¼Œ å¦‚æœåŒ¹é…å°±æ‰§è¡Œ æ‹¬å·å†…çš„ä»£ç ã€‚   </p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">valid_referers none server_names *.test1.com ~\.test2\.;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$invalid_referer</span>)&#123;<br>    rewrite ^<span class="hljs-regexp">/ https:/</span><span class="hljs-regexp">/cdn.jsdelivr.net/g</span>h<span class="hljs-regexp">/Mosiki/</span>blog-imgs<span class="hljs-regexp">/blog/</span><span class="hljs-number">20171028</span>/<span class="hljs-number">214345352</span>.png;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>é¦–å…ˆçœ‹ç¬¬ä¸€è¡Œï¼Œè¿™è¡Œçš„ä½œç”¨æ˜¯é…ç½®å¯ä»¥è¯†åˆ« referï¼Œå³å¯ä»¥æ­£å¸¸è·å–èµ„æºæ–‡ä»¶çš„è¯·æ±‚ï¼Œ<strong>åœ¨è¿™é‡Œé…ç½®åŠ å…¥ç™½åå•çš„è¯·æ±‚ refer åŸŸå</strong>ã€‚<br>å‚æ•°è¯´æ˜ï¼š    </p><ul><li><strong>none</strong> ä»£è¡¨è¯·æ±‚çš„ refer ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯ç›´æ¥è®¿é—®ï¼Œæ¯”å¦‚åœ¨æµè§ˆå™¨ä¸­ç›´æ¥è®¿é—®å›¾ç‰‡ <code>www.vcmq.com/test1.png</code>ï¼Œç›´æ¥è®¿é—®æ—¶ï¼Œrefer ä¼šä¸ºç©ºã€‚</li><li><strong>blocked</strong> refer æ¥æºä¸ä¸ºç©ºï¼Œä½†æ˜¯é‡Œé¢çš„å€¼è¢«ä»£ç†æˆ–è€…é˜²ç«å¢™åˆ é™¤äº†</li><li><strong>server_names</strong> refer æ¥æºåŒ…å«å½“å‰çš„ <code>server_names</code> å³ <code>location</code> çš„çˆ¶èŠ‚ç‚¹ <code>server</code> èŠ‚ç‚¹çš„ <code>server_name</code> çš„å€¼ã€‚</li><li><strong>å­—ç¬¦ä¸²</strong> å®šä¹‰æœåŠ¡å™¨åç§°ï¼Œæ¯”å¦‚ <code>*.test1.com</code>ï¼Œé…ç½®åï¼Œæ¥æºæ˜¯ä» <code>test1.com</code> å°±ä¼šè¢«è®¤ä¸ºæ˜¯åˆæ³•çš„è¯·æ±‚ã€‚</li><li><strong>æ­£åˆ™è¡¨è¾¾å¼</strong> åŒ¹é…åˆæ³•è¯·æ±‚æ¥æºï¼Œ å¦‚ <code>~\.test2\.</code></li></ul><p>å½“è¯·æ±‚çš„ <code>refer</code> æ˜¯åˆæ³•çš„ï¼Œå³å¯ä»¥è¢«åé¢ä»»ä¸€å‚æ•°æ‰€åŒ¹é…ï¼Œ <code>$invalid_referer</code> çš„å€¼ä¸º0ï¼Œ è‹¥ä¸åŒ¹é…åˆ™å€¼ä¸º 1ï¼Œ è¿›å…¥ <code>if</code> çš„ä»£ç ä¸­ã€‚æˆ‘è¿™é‡Œçš„è®¾ç½®æ˜¯ï¼Œå¦‚æœæ˜¯ä¸åˆæ³•çš„è¯·æ±‚ï¼Œå°±ç»Ÿä¸€è¿”å›ä¸€å¼ å›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¿”å› <code>403</code>ã€‚</p><h3 id="äºŒã€é…ç½®-html-æ–‡ä»¶"><a href="#äºŒã€é…ç½®-html-æ–‡ä»¶" class="headerlink" title="äºŒã€é…ç½® html æ–‡ä»¶"></a>äºŒã€é…ç½® html æ–‡ä»¶</h3><p>1.åœ¨ <code>/home</code> ç›®å½•ä¸‹åˆ›å»ºç›®å½• <code>resources</code> ,åœ¨ <code>/home/resources</code> ç›®å½•ä¸‹æ”¾å…¥ä¸€å¼ å›¾ç‰‡ <strong>test.png</strong>ã€‚  </p><p>2.ä¿®æ”¹ <code>nginx</code> å®‰è£…ç›®å½•ä¸‹ <code>html</code> ä¸­çš„ <code>index.html</code> æ–‡ä»¶ã€‚æ·»åŠ ä¸€ä¸ª <strong>img</strong> æ ‡ç­¾ï¼Œsrc è®¿é—®ä¸Šä¸€æ­¥ä¸­çš„å›¾ç‰‡æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;http://www.vcmq.com/test.png&quot;</span> /&gt;</span><br></code></pre></div></td></tr></table></figure><p>3.å¯åŠ¨ nginx</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/nginx/</span>sbin/nginx<br></code></pre></div></td></tr></table></figure><p>4.ä»¥ä¸Šæ‰€æœ‰é…ç½®æ˜¯å¯¹äºæœåŠ¡å™¨ A çš„é…ç½®ï¼Œä»¥ä¸‹è®²è§£æœåŠ¡å™¨ B çš„é…ç½®  </p><ol><li>æœåŠ¡å™¨ B å’Œ æœåŠ¡å™¨ Aä¸€æ ·å®‰è£…å¥½ nginx</li><li>ä¿®æ”¹ nginx.conf é…ç½®æ–‡ä»¶, æ·»åŠ ä¸¤ä¸ª server<figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span>       <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span>  www.test1.com;<br>    <span class="hljs-comment">#charset koi8-r;</span><br>    <span class="hljs-comment">#access_log  logs/host.access.log  main;</span><br>    <span class="hljs-attribute">location</span> / &#123;<br>        <span class="hljs-attribute">root</span>   html;<br>        <span class="hljs-attribute">index</span>  index.html index.htm;<br>    &#125;<br>&#125;   <br><br><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span>  <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span> www.test2.com;<br>    <span class="hljs-attribute">location</span> / &#123;<br>        <span class="hljs-attribute">root</span> html;<br>        <span class="hljs-attribute">index</span> index.html index.htm;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li>ä¿®æ”¹æœåŠ¡å™¨ B  Nginx å®‰è£…ç›®å½•ä¸‹ html ç›®å½•ä¸­çš„ index.html æ–‡ä»¶,åŒæ ·æ·»åŠ  img æ ‡ç­¾ã€‚<figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;http://www.vcmq.com/test.png&quot;</span> /&gt;</span><br></code></pre></div></td></tr></table></figure></li><li>å¯åŠ¨ æœåŠ¡å™¨ B çš„ Nginx</li></ol><h2 id="é…ç½®æ³¨æ„äº‹é¡¹"><a href="#é…ç½®æ³¨æ„äº‹é¡¹" class="headerlink" title="é…ç½®æ³¨æ„äº‹é¡¹"></a>é…ç½®æ³¨æ„äº‹é¡¹</h2><ol><li>é…ç½®èµ„æºçš„ <strong>location</strong> éœ€è¦åœ¨ <strong>location /</strong> ä¹‹å‰ã€‚</li><li>å¦‚æœåœ¨ <strong>location</strong> æˆ–è€…å…¶çˆ¶èŠ‚ç‚¹ <strong>server</strong> ä¸­æ²¡æœ‰é…ç½® <strong>root</strong> çš„å€¼ï¼Œ å½“è¯·æ±‚æ—¶åˆæ³•çš„æ—¶å€™ï¼Œä¼š 404 æ‰¾ä¸åˆ°èµ„æºæ–‡ä»¶ï¼Œå› æ­¤éœ€è¦åœ¨ <strong>location</strong> æˆ–è€… <strong>server</strong> èŠ‚ç‚¹è®¾ç½® <strong>root</strong> çš„å€¼</li><li>æ³¨æ„è°ƒè¯•çš„æ—¶å€™ï¼ŒåŠ¡å¿…ä½¿ç”¨ <strong>Ctrl + F5</strong> è¿›è¡Œåˆ·æ–°ç½‘é¡µï¼Œå› ä¸º nginx ä¼šç¼“å­˜å›¾ç‰‡ï¼</li></ol><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><p>æˆ‘ä¸Šé¢é…ç½®çš„ <strong>server_name</strong> é…ç½®çš„åŸŸåæ˜¯ <strong><a href="http://www.vcmq.com/">www.vcmq.com</a></strong> ï¼Œå› æ­¤æµ‹è¯•æ—¶ï¼Œéœ€è¦å°†æˆ‘ç”µè„‘çš„ host æŒ‡å‘è™šæ‹Ÿæœºçš„ ip, å¯ä»¥ä½¿ç”¨ <strong>SwitchHosts</strong> æ¥ä¾¿æ·åˆ‡æ¢ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-comment"># æŒ‡å‘æœåŠ¡å™¨A</span><br><span class="hljs-attribute">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">200</span>.<span class="hljs-number">130</span> www.vcmq.com<br><br><span class="hljs-comment"># æŒ‡å‘æœåŠ¡å™¨B</span><br><span class="hljs-attribute">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">200</span>.<span class="hljs-number">131</span> www.test<span class="hljs-number">1</span>.com www.test<span class="hljs-number">2</span>.com<br></code></pre></div></td></tr></table></figure><ol><li>æµè§ˆå™¨è®¿é—® <a href="http://www.vcmq.com,å›¾ç‰‡æ­£å¸¸åŠ è½½/">www.vcmq.comï¼Œå›¾ç‰‡æ­£å¸¸åŠ è½½</a>  </li></ol><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171029/130449251.png">  </p><ol start="2"><li>æµè§ˆå™¨è®¿é—® <code>www.test1.com</code> ä¸ <code>www.test2.com</code> è¿˜æœ‰ç›´æ¥è®¿é—®å›¾ç‰‡ <code>http://www.vcmq.com/test.png</code> éƒ½æ­£å¸¸åŠ è½½   </li></ol><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171029/140651035.png">  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171029/140624686.png">  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171029/140828400.png">  </p><ol start="3"><li>ä¿®æ”¹ æœåŠ¡å™¨ A çš„ nginx.conf é…ç½®æ–‡ä»¶</li></ol><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-tag">valid_referers</span> <span class="hljs-selector-tag">none</span> <span class="hljs-selector-tag">server_names</span> *<span class="hljs-selector-class">.test1</span><span class="hljs-selector-class">.com</span> ~\<span class="hljs-selector-class">.test2</span>\.;<br></code></pre></div></td></tr></table></figure><p>å°†æ­¤è¡Œä¿®æ”¹ä¸º</p><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-attribute">valid_referers</span> <span class="hljs-literal">none</span> server_names;<br></code></pre></div></td></tr></table></figure><p>å³åªå…è®¸å½“å‰ server_name ä¸ æ—  refer çš„è¯·æ±‚ï¼Œå…¶ä»–è¯·æ±‚éƒ½è¿”å› rewrite çš„å›¾ç‰‡, ç„¶åé‡å¯ nginx</p><figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk"><span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/nginx/</span>sbin/nginx -s reload<br></code></pre></div></td></tr></table></figure><p>å†æ¬¡åˆ†åˆ«è®¿é—® ,<strong>æ³¨æ„éœ€è¦ä½¿ç”¨ ctrl+F5 åˆ·æ–°ä¸€ä¸‹ç¼“å­˜</strong></p><p><code>www.vcmq.com</code>ã€<code>www.test1.com</code>ã€<code>www.test2.com</code>ã€<code>http://www.vcmq.com/test.png</code>ã€‚</p><p>å‘ç°åªæœ‰ <code>www.vcmq.com</code> ä¸ <code>http://www.vcmq.com/test.png</code> æ­£å¸¸æ˜¾ç¤ºï¼Œå…¶ä»–è¯·æ±‚çš†è¿”å› rewrite çš„å›¾ç‰‡  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171029/141839955.png"></p><p>åŒç†å†æ¬¡ä¿®æ”¹ nginx.conf æ–‡ä»¶, å…è®¸æ¥è‡ª test1 çš„è®¿é—®è¯·æ±‚</p><figure class="highlight nginx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nginx"><span class="hljs-attribute">valid_referers</span> <span class="hljs-literal">none</span> server_names <span class="hljs-regexp">*.test</span>1.com;<br></code></pre></div></td></tr></table></figure><p>ç»“æœå‘ç°<br><code>www.test1.com</code>å¯ä»¥è·å–æ­£å¸¸å›¾ç‰‡ï¼Œè€Œ<code>www.test2.com</code>è¿˜æ˜¯ rewrite ä¹‹åçš„å›¾ç‰‡</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171029/142030191.png"></p><p>è‡³æ­¤ï¼Œå·²ç»å®ç°äº†åŸºäº Nginx çš„ç®€å•å›¾ç‰‡é˜²ç›—é“¾ã€‚  </p><p>å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥è®¾ç½®å…è®¸æ¥è‡ªå…¬å¸ä¸‹çš„åŸŸåä¸ç©º refer çš„è¯·æ±‚é€šè¿‡ã€‚  </p><p>è¿™é‡Œå…è®¸ ç©º refer çš„è¯·æ±‚é€šè¿‡çš„åŸå› æ˜¯ï¼Œæœ‰äº›åˆæ³•çš„è¯·æ±‚å¯èƒ½ä¼šæ²¡æœ‰å¸¦ä¸Š referã€‚</p><h2 id="èµ„æºä¸‹è½½"><a href="#èµ„æºä¸‹è½½" class="headerlink" title="èµ„æºä¸‹è½½"></a>èµ„æºä¸‹è½½</h2><ul><li><a href="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.zip">æ–‡ç« æ¶‰åŠé…ç½®æ–‡ä»¶ä¸‹è½½</a></li></ul><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><ul><li><a href="https://www.bbsmax.com/A/xl56LLwxzr/">https://www.bbsmax.com/A/xl56LLwxzr/</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æœåŠ¡å™¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å®æˆ˜</tag>
      
      <tag>å›¾ç‰‡é˜²ç›—é“¾</tag>
      
      <tag>é˜²ç›—é“¾</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nginxé…ç½®èµ„æºä¸‹è½½ç›®å½•</title>
    <link href="/Nginx%E9%85%8D%E7%BD%AE%E8%B5%84%E6%BA%90%E4%B8%8B%E8%BD%BD%E7%9B%AE%E5%BD%95.html"/>
    <url>/Nginx%E9%85%8D%E7%BD%AE%E8%B5%84%E6%BA%90%E4%B8%8B%E8%BD%BD%E7%9B%AE%E5%BD%95.html</url>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰åœ¨ç½‘ä¸Šæ‰¾ CentOs çš„é•œåƒçš„æ—¶å€™ï¼Œå‘ç°äº†é˜¿é‡Œäº‘çš„è¿™ä¸ªé•œåƒæºï¼Œé€Ÿåº¦è›®å¿«çš„ã€‚ä»Šå¤©ä¹Ÿæ¥æ­å»ºä¸€ä¸ªç±»ä¼¼çš„ç«™ï¼Œä½¿ç”¨ nginx ä½œä¸ºèµ„æºä¸‹è½½æœåŠ¡å™¨ã€‚</p><a id="more"></a><p>å›¾ç‰‡è¯¦æƒ…ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171027/055339109.png"></p><h2 id="å®‰è£…-Nginx"><a href="#å®‰è£…-Nginx" class="headerlink" title="å®‰è£… Nginx"></a>å®‰è£… Nginx</h2><p><a href="http://nullpointer.pw/2017/08/20/Nginx%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE/">å‚è€ƒè¿™ç¯‡æ•™ç¨‹çš„ Nginx ç¯å¢ƒæ­å»ºéƒ¨åˆ†</a></p><h2 id="è®¾ç½®èµ„æºå­˜å‚¨è·¯å¾„"><a href="#è®¾ç½®èµ„æºå­˜å‚¨è·¯å¾„" class="headerlink" title="è®¾ç½®èµ„æºå­˜å‚¨è·¯å¾„"></a>è®¾ç½®èµ„æºå­˜å‚¨è·¯å¾„</h2><p>1ã€ èµ„æºå‡†å¤‡  </p><p>åœ¨ <strong>home</strong> çš„ç”¨æˆ·ç›®å½•ä¸‹ï¼Œå»ºç«‹æ–‡ä»¶å¤¹ï¼Œå¦‚ <strong>softs</strong> ,åœ¨ <strong>softs</strong> ç›®å½•ä¸­æ”¾å…¥æ–‡ä»¶å†…å®¹ã€‚</p><h2 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h2><p>2ã€ ä¿®æ”¹ Nginx é…ç½®æ–‡ä»¶</p><figure class="highlight vim"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vim"><span class="hljs-keyword">vim</span> <span class="hljs-keyword">conf</span>/nginx.<span class="hljs-keyword">conf</span><br></code></pre></div></td></tr></table></figure><p>æ·»åŠ  server</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">server &#123;<br>        listen       80;<br>        server_name  down.vcmq.com;<br>        #sendfile        on;<br>        location / &#123;<br>            alias  /home/softs/;<br>            sendfile on;<br>            autoindex on;<br>            autoindex_exact_size off;<br>            autoindex_localtime on;<br>        &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>alias è®¾ç½®ä¸ºç¬¬ä¸€æ­¥ä¸­çš„èµ„æºç›®å½•ï¼Œæˆ‘è¿™é‡Œæ˜¯ <strong>/home/softs/</strong></p><p>3ã€ è®¿é—®æµ‹è¯•<br>å°†æœ¬æœº hosts æŒ‡å‘æœåŠ¡å™¨ï¼Œ<br>è®¿é—®åœ°å€ down.vcmq.com  æ˜¾ç¤ºç›®å½•åˆ—è¡¨  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171027/061943005.png">  </p><p><strong>æ³¨æ„ä¸èƒ½æ˜¯/root ç›®å½•ä¸‹çš„æ–‡ä»¶è·¯å¾„ ï¼Œä¼šæ˜¾ç¤º403æ— æƒé™</strong></p>]]></content>
    
    
    <categories>
      
      <category>æœåŠ¡å™¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
      <tag>èµ„æºä¸‹è½½</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¦‚ä½•åšç¬”è®°ï¼Ÿ</title>
    <link href="/%E5%A6%82%E4%BD%95%E8%AE%B0%E7%AC%94%E8%AE%B0%EF%BC%9F.html"/>
    <url>/%E5%A6%82%E4%BD%95%E8%AE%B0%E7%AC%94%E8%AE%B0%EF%BC%9F.html</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨å…¬å¸å¼€ä¼šï¼Œæˆ‘åˆ†äº«äº†ä¸€äº›ä¸ªäººæ—¥å¸¸å…³äºå¦‚ä½•è®°ç¬”è®°çš„å¿ƒå¾—ï¼Œç»“åˆåœ¨ç½‘ä¸Šçœ‹çš„ç›¸å…³æ–‡ç« ï¼Œæ•´ç†ä¸€ä¸‹ï¼Œç„¶ååšäº†ä¸€äº›è¡¥å……ï¼Œå†™å‡ºè¿™ç¯‡åšæ–‡ï¼Œæ–‡ç« æ¶‰åŠå·¥å…·çš„é€‰æ‹©å’Œè®°ç¬”è®°çš„æ­¥éª¤ä»¥åŠè®°ç¬”è®°çš„æŠ€å·§ä¸æ³¨æ„äº‹é¡¹ï¼Œæ¬¢è¿ç•™è¨€æ¢è®¨ã€‚  </p><a id="more"></a>  <h2 id="å·¥å…·çš„é€‰æ‹©"><a href="#å·¥å…·çš„é€‰æ‹©" class="headerlink" title="å·¥å…·çš„é€‰æ‹©"></a>å·¥å…·çš„é€‰æ‹©</h2><p>å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œé¦–å…ˆè¯´è¯´å·¥å…·çš„é€‰æ‹©ï¼Œ<br>å¥½çš„å·¥å…·ä¼šè®©ä½ è®°ç¬”è®°å¾—å¿ƒåº”æ‰‹ï¼Œæ‹¥æœ‰è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œä¸å¥½çš„å·¥å…·åˆ™åšä¸åˆ°è¿™ç‚¹ï¼Œè¾¾ä¸åˆ°è®°ç¬”è®°çš„ç›®çš„ã€‚</p><p>å¸¸è§çš„ä¸»æµäº‘ç¬”è®°æœ‰ï¼š  </p><ol><li>æœ‰é“äº‘ç¬”è®°</li><li>OneNote  </li><li>ä¸ºçŸ¥ç¬”è®°  </li><li>å°è±¡ç¬”è®°  </li></ol><p>å…ˆè¯´è¯´æˆ‘æœ€ç†Ÿæ‚‰çš„ä¸ºçŸ¥ç¬”è®°ï¼Œåœ¨ä¸€å¹´ä»¥å‰ï¼Œä¸€ç›´ç”¨çš„æ˜¯ä¸ºçŸ¥ç¬”è®°ï¼Œè®°äº†ä¸Šåƒçš„ç¬”è®°ï¼Œç”¨çš„å¾ˆä¸é”™ï¼Œé€¢äººæ¨èé‚£ç§ï¼›ä½†æ˜¯æœ‰ä¸€å¤©ï¼Œä¸ºçŸ¥ç¬”è®°çªç„¶å°±å®£å¸ƒå¿…é¡»è¦ä»˜è´¹æ‰èƒ½ç»§ç»­ä½¿ç”¨ï¼Œå¦åˆ™çš„è¯ï¼Œç¬”è®°å°†ä¸èƒ½åŒæ­¥ï¼<br>å¯¹åº”ä¸€ä¸ªäº‘ç¬”è®°äº§å“æ¥è¯´ï¼Œæ²¡æœ‰äº†æœ€æœ€åŸºç¡€çš„åŒæ­¥åŠŸèƒ½ï¼Œå’Œåœ¨æœ¬åœ°æ–‡æ¡£é‡Œå†™æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿæ²¡æœ‰åˆé€‚çš„å˜ç°æ–¹å¼ï¼Œå°±å®Œå…¨æŠ›å¼ƒäº†å…è´¹ç”¨æˆ·ï¼Œç»™æˆ‘æ„Ÿè§‰è¿™å®¶å…¬å¸ä¸å¤ªé è°±ï¼Œæ‰€ä»¥æˆ‘å°±è½¬æˆ˜ä½¿ç”¨æœ‰é“äº‘ç¬”è®°ã€‚<br>ä½†æ˜¯ä¹‹å‰çš„ç¬”è®°è¿˜åœ¨ä¸ºçŸ¥ç¬”è®°é‡Œï¼Œæ‡’å¾—å»è½¬ç§»äº†ã€‚æ‰€ä»¥é€‰æ‹©ç¬”è®°è½¯ä»¶çš„æ—¶å€™ä¹Ÿè¦è€ƒè™‘è½¬ç§»æˆæœ¬ï¼Œä¸‡ä¸€ä¸€ä¸å°å¿ƒäº§å“å°±é»„äº†å‘¢ï¼å› æ­¤å°½é‡é€‰æ‹©å¤§å…¬å¸çš„æˆç†Ÿç¬”è®°äº§å“ã€‚  </p><p>å†è¯´è¯´ç°åœ¨ç”¨çš„æœ‰é“äº‘ç¬”è®°ï¼Œç”¨ä¸€ä¸ªè¯æ¥å½¢å®¹å°±æ˜¯å¾ˆé¸¡è´¼ï¼Œä»¥å‰å¯ä»¥å¯¼å‡ºç¬”è®°ä¸ºå…¶ä»–ç¬”è®°è½¯ä»¶è¯†åˆ«çš„æ ¼å¼ï¼Œç°åœ¨åªèƒ½å¯¼å‡ºæœ‰é“èƒ½è¯†åˆ«çš„æ ¼å¼ã€‚å‡å¦‚æ˜¯é‡åº¦ç”¨æˆ·ï¼Œæƒ³è½¬ç§»ç¬”è®°ï¼Œå¾ˆå›°éš¾ã€‚<br>å¥½åœ¨æœ‰é“äº‘ç¬”è®°æ”¯æŒ MarkDown ç¬”è®°ï¼Œæ‰€ä»¥æˆ‘ç°åœ¨å°½é‡å†™çš„ç¬”è®°éƒ½ç”¨ MarkDown æ–¹å¼ï¼Œå› ä¸º MarkDown æ ¼å¼çš„ç›´æ¥åœ¨ç¬”è®°ä¸­å°±èƒ½ç›´æ¥å¤åˆ¶èµ°ï¼Œè½¬ç§»ç¬”è®°å¾ˆè½»æ¾ã€‚MarkDownï¼Œè¯­æ³•å¾ˆç®€å•ï¼Œå¯ä»¥å­¦ä¹ ä¸€ä¸‹ï¼Œè½»æ¾æ’ç‰ˆï¼Œè¯­æ³•å¯ä»¥å‚è€ƒæœ‰é“äº‘çš„æ–‡æ¡£ï¼Œ è®°ç¬”è®°ä¸éœ€è¦å»å­¦ä¹ å¤ªå¤æ‚çš„è¯­æ³•,  çœ‹ä¸‹é¢é“¾æ¥çš„ç¬¬äºŒç‚¹å°±å¯ä»¥ã€‚</p><ul><li><a href="http://note.youdao.com/iyoudao/?p=2411">æœ‰é“äº‘ç¬”è®°Markdownç®€æ˜ç‰ˆ</a></li></ul><p>ç„¶åè¯´è¯´å°è±¡ç¬”è®°ï¼Œæ˜¯å›½å¤– EverNote çš„å¤§é™†ç‰ˆæœ¬ï¼Œå…¶å…è´¹ç‰ˆåªèƒ½æä¾›ä¸¤ä¸ªç»ˆç«¯åŒæ­¥ï¼Œå‡å¦‚ä½ å…¬å¸ç™»é™†ä¸€ä¸ªï¼Œå®¶é‡Œç™»é™†ä¸€ä¸ªï¼Œè¿˜æƒ³è¦åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šç™»å½•å°±éœ€è¦ä»˜è´¹ï¼Œè¿˜æœ‰æ¯æœˆä¸Šä¼ 60Mæµé‡çš„é™åˆ¶ï¼Œä»˜è´¹ç‰ˆä¸€å¹´ä¸€ç™¾å¤šï¼Œæƒ³è¦æœ€ç¨³å®šçš„å¯ä»¥è€ƒè™‘ä½¿ç”¨ã€‚</p><p>æœ€åè¯´è¯´ OneNote, å·¨ç¡¬å‡ºå“ï¼Œä½†æ˜¯å›½å†… GFW çš„å­˜åœ¨ï¼ŒåŒæ­¥å¾ˆæ…¢ï¼Œç„¶åä¹Ÿæ²¡å¤ªå¼„æ¸…æ¥šæ˜¯æ€ä¹ˆç”¨çš„ï¼Œå’Œä¸Šé¢ä»‹ç»çš„ç¬”è®°äº§å“ç»„ç»‡æ ¼å¼ä¸åŒï¼Œä¹Ÿæ²¡æ€ä¹ˆä¼šç”¨ï¼Œå°±ä¸ç½®ç‚¹è¯„äº†ã€‚</p><p><strong>æˆ‘æ¨èä½¿ç”¨æœ‰é“äº‘ç¬”è®°å’Œå°è±¡ç¬”è®°(æˆ–EverNote)</strong></p><h2 id="è®°ç¬”è®°çš„ä½œç”¨"><a href="#è®°ç¬”è®°çš„ä½œç”¨" class="headerlink" title="è®°ç¬”è®°çš„ä½œç”¨"></a>è®°ç¬”è®°çš„ä½œç”¨</h2><p>æœ€å¤§çš„ä½œç”¨å°±æ˜¯å¯¹æŠ—é—å¿˜ï¼Œç”¨å¥½äº†ç¬”è®°ï¼Œç¬”è®°å°±æ˜¯ä½ çš„ç¬¬äºŒå¤§è„‘ï¼Œäººçš„è®°å¿†åŠ›æœ‰é™ï¼Œæˆ‘ä»¬é€šè¿‡è®°ç¬”è®°æ¥æ‹“å±•ã€‚</p><p>è®°ç¬”è®°ä¸‰æ­¥èµ°ï¼š  </p><ol><li>æ”¶é›†</li><li>æ•´ç†</li><li>è¾“å‡º  </li></ol><p>ä»¥ä¸‹è¿›è¡Œè¯¦ç»†æ­¥éª¤å™è¿°ï¼š  </p><h2 id="è®°ç¬”è®°çš„æ­¥éª¤"><a href="#è®°ç¬”è®°çš„æ­¥éª¤" class="headerlink" title="è®°ç¬”è®°çš„æ­¥éª¤"></a>è®°ç¬”è®°çš„æ­¥éª¤</h2><h3 id="æ”¶é›†"><a href="#æ”¶é›†" class="headerlink" title="æ”¶é›†"></a>æ”¶é›†</h3><p>ç¬¬ä¸€æ­¥æ˜¯ç¡®å®šæ‰€è¦å†™çš„ç¬”è®°å†…å®¹ï¼Œå³æ”¶é›†ï¼Œæ”¶é›†è¿™é‡Œæˆ‘åˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚</p><ol><li><p>æ”¶é›†ä»–äººçš„å†…å®¹<br>ä»–äººçš„å†…å®¹æŒ‡çš„æ˜¯ä»–äººæ‰€äº§ç”Ÿçš„å†…å®¹ï¼Œæ¯”å¦‚åˆ«äººå†™çš„ä¹¦ï¼Œåšå®¢æ–‡ç« ï¼Œå…¬ä¼—å·æ–‡ç« ç­‰ç­‰ï¼Œå½“ä½ é‡åˆ°äº†æ¯”å¦‚ä¸€ç¯‡ä½ è§‰å¾—å†™çš„å¾ˆæœ‰é“ç†æˆ–è€…å¯¹ä½ æœ‰ç”¨çš„æ–‡ç« ï¼Œè§‰å¾—æœ‰ä¿å­˜ä¸‹æ¥çš„ä»·å€¼ï¼Œä½ å¯ä»¥å°†å…¶çº³å…¥ä½ çš„ç¬”è®°å½“ä¸­å»ã€‚</p></li><li><p>æ”¶é›†è‡ªå·±çš„å†…å®¹<br>è‡ªå·±çš„å†…å®¹æŒ‡çš„æ˜¯è‡ªå·±æ‰€äº§ç”Ÿçš„å†…å®¹ï¼Œæ¯”å¦‚çªå‘çš„çµå…‰ä¸€ç°ï¼Œå¦‚æœä¸ç«‹å³è®°å½•ä¸‹æ¥ï¼Œå¯èƒ½å°±å¿˜æ‰äº†ï¼Œç„¶åå†æƒ³çš„æ—¶å€™æ— è®ºå¦‚ä½•ä¹Ÿè®°ä¸èµ·æ¥äº†ï¼Œå°±æ„Ÿè§‰è‡ªå·±é”™è¿‡äº†ä¸€ä¸ªäº¿ã€‚æ‰€ä»¥è¦è¶ç€ä½ çš„æƒ³æ³•è¿˜æ²¡æœ‰æ¶ˆå¤±ä¹‹å‰ï¼Œç«‹å³è®°å½•åˆ°ç¬”è®°å½“ä¸­å»ã€‚ç°åœ¨äººæ‰‹éƒ½æœ‰ä¸€å‰¯æ‰‹æœºï¼Œè€Œäº‘ç¬”è®°éƒ½æœ‰å…¶å¯¹åº”çš„ç§»åŠ¨ç«¯ï¼Œè®°å½•èµ·æ¥å¾ˆæ–¹ä¾¿ã€‚</p></li><li><p>æ”¶é›†çš„è¯€çª<br>æœ‰æ—¶å€™åœ¨æŸä¸ªç½‘ç«™çœ‹åˆ°ä¸€ç¯‡æ–‡ç« æƒ³è¦ä¿å­˜ä¸‹æ¥æ—¶å€™ï¼Œä¸€èˆ¬äººçš„åšæ³•æ˜¯è®²æ–‡ç« é€‰æ‹©æ‹·è´åˆ°ç¬”è®°å½“ä¸­å»ï¼Œè¿™ä¹ˆåšæ˜¯å¯è¡Œï¼Œä½†æ˜¯ä¼šå®Œå…¨æ²¡æœ‰äº†æ’ç‰ˆï¼Œçœ‹èµ·æ¥ä¹±ç³Ÿç³Ÿçš„ä¸€ç‰‡ï¼Œæ‰€ä»¥éœ€è¦å€ŸåŠ©æµè§ˆå™¨æ’ä»¶æˆ–è€…åˆ†äº«åŠŸèƒ½æ¥å®ç°å¿«é€Ÿç¾è§‚åœ°ä¿å­˜ã€‚æœ‰é“äº‘ç¬”è®°çš„è°·æ­Œæµè§ˆå™¨æ’ä»¶å°±å¾ˆå¥½ç”¨ï¼Œåœ¨æ‰‹æœºä¸Šå¯ä»¥å…³æ³¨å…¬ä¼—å·ï¼Œåˆ†äº«åˆ°å…¬ä¼—å·ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åˆ†äº«åˆ°å¯¹åº”çš„ç¬”è®° App ä¸­ï¼Œä»è€Œå®ç°å¿«é€Ÿæ”¶é›†ã€‚</p></li></ol><h3 id="æ•´ç†"><a href="#æ•´ç†" class="headerlink" title="æ•´ç†"></a>æ•´ç†</h3><p>æ”¶é›†å®Œçš„å†…å®¹ï¼Œåªæ˜¯å †å åˆ°äº†ä½ çš„ç¬”è®°å½“ä¸­ï¼Œå¦‚æœä¸åŠ ä»¥æ•´ç†æ€»ç»“ï¼Œå…¶å®å’Œæ•£å¸ƒåœ¨ç½‘ç»œä¸Šçš„æ–‡ç« æ¯«æ— åŒºåˆ«ï¼Œå¯¹ä½ <strong>æ²¡æœ‰ä»»ä½•çš„æ„ä¹‰ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•çš„ä»·å€¼</strong>ï¼›<br>ä¹Ÿè®¸ä½ æƒ³æ‰¾ç¬”è®°é‡Œé¢æŸä¸€ç¯‡æ–‡ç« ï¼Œä½†æ˜¯ä½ å´æ­»æ´»ä¹Ÿæ‰¾ä¸åˆ°ï¼Œè¿™ç§æƒ…å†µä¸‹è®°ä¸ä¸è®°éƒ½ä¸€æ ·ï¼›æ­£å¦‚å»ä¸€åº§å›¾ä¹¦é¦†çœ‹ä¹¦ï¼Œä½†æ˜¯å›¾ä¹¦é¦†å´æ²¡æœ‰å›¾ä¹¦æŸ¥é˜…ç³»ç»Ÿï¼Œåœ¨æµ©æ¸ºä¹¦æµ·ä¸­æƒ³æ‰¾åˆ°ä¸€æœ¬ä¹¦çš„å›°éš¾ç¨‹åº¦å¯æƒ³è€ŒçŸ¥ï¼å› æ­¤æ”¶é›†åçš„æ•´ç†ååˆ†é‡è¦ã€‚     </p><p>æ•´ç†åˆ†ä¸ºé‡æ–°æ’ç‰ˆä¸åˆ†ç±»ä»¥åŠåŠ æ ‡ç­¾ï¼ˆ<strong>åœ¨ä¸‹æ–‡è¯¦è°ˆåˆ†ç±»ä¸æ ‡ç­¾</strong>ï¼‰ï¼š</p><ul><li><p>é€šè¿‡æµè§ˆå™¨æ’ä»¶ç­‰å·¥å…·æŠ“å–ä¿å­˜çš„å†…å®¹å¯èƒ½ä¼šä¸åŸæ–‡ä¸­çš„å†…å®¹æ’ç‰ˆç›¸å·®ç”šè¿œï¼Œæ¯”å¦‚æœ‰é“äº‘ç¬”è®°å¯¹äºä»£ç å—çš„æŠ“å–æ’ç‰ˆæ”¯æŒå°±å¾ˆå·®ï¼ˆå…¶ä»–å¾ˆä¸é”™ï¼‰ï¼Œè¿™ç§æƒ…å†µï¼Œå°±éœ€è¦æˆ‘ä»¬è‡ªå·±å¯¹å†…å®¹é‡æ–°æ’ç‰ˆï¼Œä¾¿äºä»¥åè‡ªå·±æŸ¥çœ‹ã€‚ä¸ªäººä¸€èˆ¬æ˜¯æ–°å»ºç«‹ä¸€ä¸ª Markdown ç¬”è®°ï¼Œæ‹·è´åŸæ–‡è¿›è¡Œç¼–æ’ï¼Œå¹¶åœ¨æ–‡æœ«æ ‡æ³¨æ–‡ç« æ¥æºé“¾æ¥ã€‚</p></li><li><p>è‰¯å¥½çš„ç¬”è®°åˆ†ç±»æœ‰åˆ©äºå¿«é€Ÿå‡†ç¡®åœ°å®šä½ç¬”è®°ï¼Œæå‡æ•ˆç‡ã€‚</p></li><li><p>ä¸€ç¯‡ç¬”è®°åªèƒ½æ”¾åœ¨ä¸€ä¸ªåˆ†ç±»ä¸­ï¼ˆå¯¹åº”ç¬”è®°çš„æ–‡ä»¶å¤¹)ï¼Œä½†æ˜¯å´èƒ½å¤Ÿæ·»åŠ å¤šä¸ªæ ‡ç­¾ï¼Œæˆ‘è®¤ä¸ºæ ‡ç­¾æ˜¯å¯¹åˆ†ç±»çš„ä¸€ç§è¡¥å……ã€‚å½“åˆ†ç±»ä¸è¶³ä»¥å‡†ç¡®å®šä½ç¬”è®°ï¼Œæ­¤æ—¶éœ€è¦é€šè¿‡æ·»åŠ æ ‡ç­¾æ¥å¼¥è¡¥ã€‚</p></li></ul><h3 id="è¾“å‡º"><a href="#è¾“å‡º" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h3><p>å•å•åªæ˜¯å°†å†…å®¹æ”¶é›†ï¼Œå½’ç±»åŠ æ ‡ç­¾ï¼Œå¹¶ä¸èƒ½å¤Ÿå¯¹è‡ªå·±äº§ç”Ÿå¾ˆå¤§çš„ç”¨å¤„ï¼Œæœ€å¤šçš„æ˜¯è‡ªå·±æƒ³èµ·æ¥å°±å»ç¬”è®°ä¸­å¯»æ‰¾ï¼Œæ­¤æ—¶ç¬”è®°çš„ä½œç”¨æœ€å¤šæ˜¯å……å½“å¤‡å¿˜å½•çš„ä½œç”¨ã€‚è€ŒçœŸæ­£æƒ³è¦åˆ©ç”¨å¥½ç¬”è®°ï¼Œå°±æ˜¯éœ€è¦æˆ‘ä»¬æ¥å¯¹ç¬”è®°è¿›è¡Œæ€»ç»“æ€è€ƒï¼Œæ¥è¾¾åˆ°åœ¨å¤´è„‘ä¸­æ·±åŒ–è¯¥ç¯‡ç¬”è®°çš„ä½œç”¨ã€‚  </p><p>ä¸¾ä¾‹è€Œè¨€ï¼Œç°åœ¨ä½ å†™äº†ä¸€ç¯‡ã€Šæ‹†æ‰æ€ç»´é‡Œçš„å¢™ã€‹çš„è¯»ä¹¦ç¬”è®°ï¼Œä½†ç¬”è®°çš„å†…å®¹åªæœ‰å¯¹äºä¹¦ä¸­åŸæ–‡çš„éƒ¨åˆ†æ‘˜æŠ„ï¼›å…¶å®è¿™æ ·çš„ç¬”è®°ä½œç”¨ä¸å¤§ï¼Œæ—¶é—´é•¿äº†ï¼Œä½ ç”šè‡³ä¸è®°å¾—ä½ æ›¾ç»è¯»è¿‡è¿™æœ¬ä¹¦å¹¶å†™è¿‡è¯»ä¹¦ç¬”è®°ã€‚ä½†æ˜¯ä½ å¯¹æ–‡ç« è¿›è¡Œäº†æ€è€ƒï¼Œæ¦‚æ‹¬ä¹¦çš„ä¸»è¦ä¸­å¿ƒæ€æƒ³ï¼Œå†™äº†è‡ªå·±çš„æ„Ÿå—ï¼Œåœ¨è±†ç“£ä¸Šç•™ä¸‹äº†ä¹¦è¯„ï¼Œå°±ç®—æ—¶é—´ä¹…äº†ï¼Œç¿»çœ‹ç¬”è®°ä¹Ÿèƒ½å¤Ÿå›æƒ³èµ·å½“æ—¶è‡ªå·±çš„æƒ³æ³•ï¼Œè¿™ä¹¦ä¹Ÿå°±æ²¡æœ‰ç™½è¯»ï¼Œç¬”è®°ä¹Ÿå°±æ²¡æœ‰ç™½å†™ã€‚</p><p>ä¸Šæ–‡æåˆ°äº†åœ¨è±†ç“£ä¸­å†™ä¹¦è¯„ï¼Œè¿™å’Œå†™ç¬”è®°è¿›è¡Œæ€»ç»“æ€è€ƒä¸€æ ·éƒ½æ˜¯å¯¹äºçŸ¥è¯†çš„ä¸€ç§è¾“å‡ºã€‚è¾“å‡ºçš„æ–¹å¼è¿˜æœ‰å¾ˆå¤šç§ï¼Œæ¯”å¦‚åœ¨ç®€ä¹¦ä¸Šã€ä¸ªäººåšå®¢ä¸Šã€CSDNã€åšå®¢å›­ç­‰åœ°æ–¹å‘è¡¨æ–‡ç« ã€‚</p><p>å½“ç„¶ï¼Œä¹Ÿå¹¶éæ‰€æœ‰çš„åˆ†ç±»ä¸‹é¢éƒ½éœ€è¦è¿›è¡Œè¿™ä¸‰æ­¥ã€‚</p><h2 id="ç»†è°ˆç¬”è®°åˆ†ç±»ä¸æ ‡ç­¾"><a href="#ç»†è°ˆç¬”è®°åˆ†ç±»ä¸æ ‡ç­¾" class="headerlink" title="ç»†è°ˆç¬”è®°åˆ†ç±»ä¸æ ‡ç­¾"></a>ç»†è°ˆç¬”è®°åˆ†ç±»ä¸æ ‡ç­¾</h2><h3 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»"></a>åˆ†ç±»</h3><p>æŒ‰ç…§ä¸ªäººçš„ä¹ æƒ¯ä¸ç»éªŒï¼Œæˆ‘å°†ç¬”è®°åˆ†ä¸ºäº†äº”å¤§ç±»ï¼Œå¦‚å›¾ï¼š        </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171026/211942811.png">  </p><p>1ã€ <strong>æ”¶é›†</strong>ï¼ˆæŒ‡çš„æ˜¯ä¸Šå›¾ä¸­çš„<em>æˆ‘çš„èµ„æº</em>æ–‡ä»¶å¤¹ï¼Œå› ä¸ºæ˜¯æœ‰é“äº‘ç¬”è®°è‡ªåŠ¨åˆ›å»ºçš„æ–‡ä»¶å¤¹ï¼Œæ”¹åå­—ä¹‹åä»–è¿˜ä¼šåˆ›å»ºè¿™ä¸ªï¼Œæ‰€ä»¥å°±æ²¡æœ‰æ”¹åå­—ï¼‰<br>æ”¶é›†ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„åˆ†ç±»ï¼Œç”¨äºå­˜æ”¾æœªè¿›è¡Œæ•´ç†çš„æ”¶é›†ï¼Œæœ‰é“äº‘ç¬”è®°ç”Ÿæˆçš„<em>æˆ‘çš„èµ„æº</em>è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œä¼šæ ¹æ®ä½ ä½¿ç”¨çš„æ’ä»¶ï¼Œè‡ªåŠ¨ç”Ÿæˆå¯¹åº”æ¥æºçš„å­æ–‡ä»¶å¤¹ï¼Œæ¯”å¦‚æ¥è‡ªç½‘é¡µå‰ªæŠ¥ã€å¾®ä¿¡æ”¶è—ç­‰ï¼Œæˆ‘æ–°å»ºäº†ä¸€ä¸ª <em>æ€ç»ªä¸‡åƒ</em>  æ–‡ä»¶å¤¹ï¼Œç”¨äºä¿å­˜çªå‘çš„æƒ³æ³•ã€‚</p><p>2ã€ <strong>å¤‡å¿˜</strong></p><p>é¡¾åæ€ä¹‰ï¼Œå¤‡å¿˜åˆ†ç±»ç”¨äºä¸€äº›éœ€è¦æŸ¥æ‰¾ä½¿ç”¨ï¼Œä½†åˆä¸éœ€è¦å®Œå…¨è®°å¿†çš„å†…å®¹ï¼Œæ¯”å¦‚å¾…åŠäº‹é¡¹ï¼Œå¾…è¯»ä¹¦å•ï¼Œè¿˜æœ‰ä¸€äº›çç¢çš„æ–‡æœ¬æ•°æ®å¤‡ä»½ç­‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171026/213837971.png">  </p><p>3ã€ <strong>å·¥ä½œ</strong></p><p>å·¥ä½œåˆ†ç±»ä¸‹é¢ä¸»è¦æ˜¯è®°å½•ä¸€äº›ä¸šåŠ¡éœ€æ±‚ï¼Œå·¥ä½œéš¾ç‚¹ä»¥åŠå·¥ä½œæŠ€å·§ã€‚</p><p>4ã€ <strong>å­¦ä¹ </strong></p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171026/214451709.png">  </p><p>ä¸»è¦æ˜¯ä¸€äº›å…³äºç¼–ç¨‹ç›¸å…³çš„å­åˆ†ç±»æ–‡ä»¶å¤¹ï¼Œè¿™é‡Œå’Œå·¥ä½œåˆ†ç±»éƒ½å› äººè€Œå¼‚ã€‚</p><p>5ã€ <strong>ç”Ÿæ´»</strong>  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171026/214954446.png">    </p><p>ç”Ÿæ´»åˆ†ç±»ä¸»è¦æ”¾ä¸€äº›ç”Ÿæ´»ä¸­å­¦ä¹ çš„å†…å®¹ï¼Œæ¯”å¦‚è¯»ä¹¦ç¬”è®°ã€æŠ•èµ„æŒ‡å—ï¼Œä¿é™©ç›¸å…³çš„çŸ¥è¯†ã€‚å…¶å®è¿™ä¸ªåˆ†ç±»å’Œå­¦ä¹ åˆ†ç±»å¾ˆåƒï¼Œå› ä¸ºæˆ‘å…³äºä»£ç çš„ç¬”è®°æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥å°†å…¶ä»–å’Œä»£ç ä¸ç›¸å…³çš„ç¬”è®°æ”¾åœ¨ç”Ÿæ´»åˆ†ç±»å½“ä¸­ã€‚</p><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåˆ†ç±»çš„å±‚çº§ä¸å®œåµŒå¥—å¤ªæ·±ï¼Œæœ€å¥½ä¿æŒåœ¨ä¸‰å±‚ä»¥å†…ï¼Œè¶…è¿‡åä¸åˆ©äºæŸ¥æ‰¾ã€‚(æ‰€ä»¥æˆ‘æŠŠä¸ä»£ç ä¸ç›¸å…³çš„æ”¾åˆ°ç”Ÿæ´»åˆ†ç±»ä¸‹)</strong></p><h3 id="æ ‡ç­¾"><a href="#æ ‡ç­¾" class="headerlink" title="æ ‡ç­¾"></a>æ ‡ç­¾</h3><p>å†è°ˆç¬”è®°çš„æ ‡ç­¾ï¼Œæ—¢ç„¶æ ‡ç­¾æ˜¯å¯¹åˆ†ç±»çš„ä¸€ç§è¡¥å……ï¼Œå› æ­¤æ˜¯éå¿…è¦çš„ï¼ŒåŒæ—¶æ ‡ç­¾ä¸èƒ½å’Œåˆ†ç±»é‡å¤ï¼Œå‚è€ƒæ·»åŠ è¿™äº›æ ‡ç­¾ã€‚</p><ol><li>æ–‡ç« æ¥æº ï¼ˆçŸ¥ä¹ã€ç®€ä¹¦ã€CSDNç­‰ï¼‰</li><li>å…³é”®è¯ ï¼ˆç¬”è®°çš„å…³é”®ç‚¹ï¼Œå¯ä»¥æå–å‡ ä¸ªè¯è¯­å‡ºæ¥ä½œä¸ºæ ‡ç­¾ï¼‰</li><li>ä¸è¦å¤ªå…·ä½“ ï¼ˆå¤ªå…·ä½“å°±ä¼šå¯¼è‡´æ ‡ç­¾è¿‡å¤šï¼Œåè€Œä¸åˆ©äºæ ‡ç­¾çš„ä½¿ç”¨ï¼‰</li></ol><h2 id="åè¨€"><a href="#åè¨€" class="headerlink" title="åè¨€"></a>åè¨€</h2><h3 id="æœ€åè¯´è¯´è®°ç¬”è®°çš„åŸåˆ™"><a href="#æœ€åè¯´è¯´è®°ç¬”è®°çš„åŸåˆ™" class="headerlink" title="æœ€åè¯´è¯´è®°ç¬”è®°çš„åŸåˆ™"></a>æœ€åè¯´è¯´è®°ç¬”è®°çš„åŸåˆ™</h3><ol><li>è®°ç¬”è®°æ˜¯ä¸ºäº†ç”¨ï¼Œä¸ç”¨çš„ç¬”è®°æ²¡æœ‰ä»»ä½•ä»·å€¼</li><li>ä¸èƒ½åªæ”¶é›†ä¸å­¦ä¹ </li><li>å®šæœŸå›é¡¾ï¼Œæ•´ç†ä¸å½’æ¡£ï¼ˆå®šæœŸå›é¡¾æœ‰åˆ©äºç¬”è®°å†…å®¹çš„è®°å¿†ï¼‰</li></ol><h3 id="è®°ç¬”è®°ä¼šé‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼Ÿ"><a href="#è®°ç¬”è®°ä¼šé‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼Ÿ" class="headerlink" title="è®°ç¬”è®°ä¼šé‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼Ÿ"></a>è®°ç¬”è®°ä¼šé‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼Ÿ</h3><ol><li>å¼ºè¿«ç—‡çŠ¯äº†ï¼Œä¸çŸ¥é“è¯¥æ”¾åœ¨å“ªä¸ªåˆ†ç±»ä¸‹é¢ï¼Œ åŸåˆ™æ˜¯ç”¨ï¼Œä½ è®¤ä¸ºæ”¾åœ¨å“ªä¸ªåˆ†ç±»ä¸‹é¢æœ€å¯èƒ½è¢«ç”¨åˆ°ï¼Œå°±æ”¾åœ¨é‚£ä¸ªåˆ†ç±»ä¸‹é¢ã€‚</li></ol><p><a href="http://nullpointer.pw/">Nullpointerçš„åšå®¢</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://www.zhihu.com/search?type=content&amp;q=%E7%AC%94%E8%AE%B0">https://www.zhihu.com/search?type=content&amp;q=%E7%AC%94%E8%AE%B0</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¯»ä¹¦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mysqlè¡Œè½¬åˆ—è¾“å‡ºã€å®æˆ˜ã€‘</title>
    <link href="/Mysql%E8%A1%8C%E8%BD%AC%E5%88%97%E8%BE%93%E5%87%BA%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91.html"/>
    <url>/Mysql%E8%A1%8C%E8%BD%AC%E5%88%97%E8%BE%93%E5%87%BA%E3%80%90%E5%AE%9E%E6%88%98%E3%80%91.html</url>
    
    <content type="html"><![CDATA[<p>åœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œéœ€è¦å°†ä¸€è¡Œä¸€è¡Œçš„æ•°æ®è½¬æ¢æˆä¸€åˆ—æ•°æ®ã€‚æ¯”å¦‚æ¯ä¸ªäººçš„æ¯ä¸ªç§‘ç›®éƒ½æœ‰ä¸€ä¸ªåˆ†æ•°ï¼Œå¹¶åˆ†åˆ«å¯¹åº”ä¸€ä¸ªåˆ†æ•°ï¼Œä½†æ˜¯ä¸ºäº†æ›´åŠ ç›´è§‚åœ°çœ‹åˆ°ä¸€ä¸ªäººçš„æ‰€æœ‰ç§‘ç›®æˆç»©ï¼Œæ‰€ä»¥éœ€è¦å°†æ¯ä¸ªç§‘ç›®æˆç»©ç”±è¡Œè½¬æ¢æˆåˆ—ã€‚</p><a id="more"></a><p><strong>åŸå§‹æ•°æ®</strong></p><table><thead><tr><th align="center">id</th><th align="center">stuid</th><th align="center">name</th><th align="center">subject</th><th align="center">score</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">110</td><td align="center">xiaoA</td><td align="center">è¯­æ–‡</td><td align="center">99</td></tr><tr><td align="center">2</td><td align="center">110</td><td align="center">xiaoA</td><td align="center">æ•°å­¦</td><td align="center">88</td></tr><tr><td align="center">3</td><td align="center">112</td><td align="center">xiaoB</td><td align="center">è¯­æ–‡</td><td align="center">69</td></tr><tr><td align="center">4</td><td align="center">112</td><td align="center">xiaoB</td><td align="center">æ•°å­¦</td><td align="center">100</td></tr></tbody></table><p><strong>è¡Œæ•°æ®è½¬æ¢æˆåˆ—æ•°æ®ä¹‹å</strong></p><table><thead><tr><th align="center">stuid</th><th align="center">name</th><th align="center">è¯­æ–‡</th><th align="center">æ•°å­¦</th></tr></thead><tbody><tr><td align="center">110</td><td align="center">xiaoA</td><td align="center">99</td><td align="center">88</td></tr><tr><td align="center">112</td><td align="center">xiaoB</td><td align="center">69</td><td align="center">100</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> stuid, `name`,<br>  <span class="hljs-built_in">MAX</span>(<span class="hljs-keyword">CASE</span> `subject` <span class="hljs-keyword">WHEN</span> <span class="hljs-string">&#x27;C001&#x27;</span> <span class="hljs-keyword">THEN</span> score <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;è¯­æ–‡&#x27;</span>,<br>  <span class="hljs-built_in">MAX</span>(<span class="hljs-keyword">CASE</span> `subject` <span class="hljs-keyword">WHEN</span> <span class="hljs-string">&#x27;C002&#x27;</span> <span class="hljs-keyword">THEN</span> score <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;æ•°å­¦&#x27;</span><br><span class="hljs-keyword">FROM</span> `sys_user` <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> stuid;<br></code></pre></div></td></tr></table></figure><hr><p>ä»¥ä¸‹é€šè¿‡ä¸¤ä¸ªåœ¨å·¥ä½œä¸­é‡åˆ°çš„å®ä¾‹ï¼Œæ¥ä½¿ç”¨ Mysql çš„è¡Œè½¬åˆ—ã€‚</p><h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><h3 id="å®ä¾‹ä¸€"><a href="#å®ä¾‹ä¸€" class="headerlink" title="å®ä¾‹ä¸€"></a>å®ä¾‹ä¸€</h3><p>ç½‘ç«™è¿›è¡Œæ¨å¹¿ï¼Œæ¯ä¸ªæ¨å¹¿å‘˜éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€ ID å³ <strong>pid</strong>ï¼Œç°åœ¨è¦ç»Ÿè®¡æ¯ä¸ªæ¨å¹¿å‘˜çš„æ¨å¹¿æ•°æ®ï¼›éœ€è¦ç»Ÿè®¡æ¨å¹¿è¿‡æ¥çš„æ–°å¢ç”¨æˆ·ï¼Œä»¥åŠæ–°å¢ç”¨æˆ·çš„å……å€¼ä»¥åŠæ¶ˆè´¹æ•°æ®ã€‚è¿™é‡Œç®€åŒ–äº†æ•°æ®ï¼Œä¾¿äºç†è§£ã€‚  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171009/165507766.png?imageslim">  </p><p><strong>æ•°æ®è¯´æ˜ï¼š</strong>  </p><ul><li>create_timeï¼š æ•°æ®ç”Ÿæˆæ—¶é—´</li><li>pidï¼š æ¨å¹¿å‘˜å”¯ä¸€ID</li><li>typeï¼š æ•°æ®ç±»å‹<ul><li>1ï¼š æ–°å¢ç”¨æˆ·</li><li>2ï¼š æ–°å¢å……å€¼</li><li>3ï¼š æ–°å¢æ¶ˆè´¹</li></ul></li><li>valueï¼š å¯¹åº”çš„æ•°æ®å€¼</li></ul><p><strong>éœ€æ±‚ç»“æœæ ·å¼ï¼š</strong>    </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171009/165921767.png?imageslim">  </p><p><strong>SQL æŸ¥è¯¢ï¼š</strong>  </p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span><br>create_time,<br><span class="hljs-built_in">MAX</span>(<span class="hljs-keyword">CASE</span> type <span class="hljs-keyword">WHEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">THEN</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-string">&#x27;æ–°å¢ç”¨æˆ·&#x27;</span>,<br><span class="hljs-built_in">MAX</span>(<span class="hljs-keyword">CASE</span> type <span class="hljs-keyword">WHEN</span> <span class="hljs-number">2</span> <span class="hljs-keyword">THEN</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-string">&#x27;æ–°å¢å……å€¼&#x27;</span>,<br><span class="hljs-built_in">MAX</span>(<span class="hljs-keyword">CASE</span> type <span class="hljs-keyword">WHEN</span> <span class="hljs-number">3</span> <span class="hljs-keyword">THEN</span> <span class="hljs-keyword">value</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-string">&#x27;æ–°å¢è®¢é˜…&#x27;</span><br><span class="hljs-keyword">FROM</span><br>wings_companion_analytics <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> create_time<br></code></pre></div></td></tr></table></figure><hr><h3 id="å®ä¾‹äºŒ"><a href="#å®ä¾‹äºŒ" class="headerlink" title="å®ä¾‹äºŒ"></a>å®ä¾‹äºŒ</h3><p>ç»Ÿè®¡ç½‘ç«™å•æœ¬ä¹¦çš„è´­ä¹°æ¬¡æ•°ä»¥åŠè´­ä¹°é‡‘é¢  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171009/172010156.png?imageslim">    </p><p><strong>æ•°æ®è¯´æ˜ï¼š</strong>  </p><ul><li>idï¼š ä¸»é”®</li><li>bookIdï¼š ä¹¦çš„ ID</li><li>task_idï¼š æ•°æ®ç±»å‹<ul><li>706ï¼š è´­ä¹°æ¬¡æ•°</li><li>707ï¼š è´­ä¹°é‡‘é¢</li></ul></li><li>timeï¼š æ•°æ®ç”Ÿæˆæ—¶é—´</li><li>valueï¼š å¯¹åº”çš„æ•°æ®å€¼</li></ul><p><strong>éœ€æ±‚ç»“æœæ ·å¼ï¼š</strong>      </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20171009/172401490.png?imageslim">  </p><p><strong>SQL æŸ¥è¯¢ï¼š</strong>  </p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> bookId <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;ä½œå“ID&#x27;</span>,<br>  DATE_FORMAT(<span class="hljs-type">time</span>,<span class="hljs-string">&#x27;%Y-%m-%d&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;æ—¥æœŸ&#x27;</span>,<br>  <span class="hljs-built_in">MAX</span>(<span class="hljs-keyword">CASE</span> task_id <span class="hljs-keyword">WHEN</span> <span class="hljs-number">706</span> <span class="hljs-keyword">THEN</span> `<span class="hljs-keyword">value</span>` <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;è´­ä¹°æ¬¡æ•°&#x27;</span>,<br>  <span class="hljs-built_in">MAX</span>(<span class="hljs-keyword">CASE</span> task_id <span class="hljs-keyword">WHEN</span> <span class="hljs-number">707</span> <span class="hljs-keyword">THEN</span> `<span class="hljs-keyword">value</span>` <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> <span class="hljs-string">&#x27;è´­ä¹°é‡‘é¢&#x27;</span><br><span class="hljs-keyword">from</span> `t_task_result_day`<br><span class="hljs-keyword">WHERE</span> task_id <span class="hljs-keyword">IN</span> (<span class="hljs-number">706</span>, <span class="hljs-number">707</span>)<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-type">time</span>, bookId<br><span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> bookId, <span class="hljs-type">time</span>;<br></code></pre></div></td></tr></table></figure><h2 id="èµ„æºä¸‹è½½"><a href="#èµ„æºä¸‹è½½" class="headerlink" title="èµ„æºä¸‹è½½"></a>èµ„æºä¸‹è½½</h2><ul><li><a href="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/data.sql">ç‚¹æˆ‘ä¸‹è½½å®ä¾‹æ‰€ç”¨æ•°æ®</a></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="http://blog.csdn.net/wulantian/article/details/52687640">http://blog.csdn.net/wulantian/article/details/52687640</a></li><li><a href="http://blog.csdn.net/u013938484/article/details/50552747">http://blog.csdn.net/u013938484/article/details/50552747</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysql</tag>
      
      <tag>è¡Œè½¬åˆ—</tag>
      
      <tag>å®æˆ˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nginxç¼“å­˜é…ç½®ä¹‹æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜</title>
    <link href="/Nginx%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE%E4%B9%8B%E6%89%8B%E5%8A%A8%E6%B8%85%E9%99%A4%E7%BC%93%E5%AD%98.html"/>
    <url>/Nginx%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE%E4%B9%8B%E6%89%8B%E5%8A%A8%E6%B8%85%E9%99%A4%E7%BC%93%E5%AD%98.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>å‰æ–‡ä»‹ç»äº†åˆ©ç”¨ nginx çš„ nginx_ngx_cache_purge æ¨¡å—æ¥å®ç°ç¼“å­˜åŠŸèƒ½ï¼Œå¹¶è®¾ç½®äº†ç¼“å­˜æ—¶é—´ä¸ºä¸€å¤©ã€‚</p><p>ä½†æ˜¯å¦‚æœå‰ç«¯ä¿®æ”¹äº†é¡µé¢ï¼Œæ¯”å¦‚é¦–é¡µï¼Œç”±äº Nginx ç¼“å­˜çš„å­˜åœ¨ï¼Œç½‘ç«™é¦–é¡µå¹¶ä¸ä¼šç«‹å³ç”Ÿæ•ˆï¼Œè€Œæ˜¯è¦ç­‰åˆ°ç¼“å­˜è¿‡æœŸã€‚è¿™æ ·æ˜æ˜¾ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œæ‰‹åŠ¨ä½¿ Nginx ç¼“å­˜å¤±æ•ˆã€‚ä»¥ä¸‹ä¸ºæ“ä½œè¯¦è§£ã€‚</p></blockquote><a id="more"></a><h2 id="åŸºç¡€ç¯å¢ƒ"><a href="#åŸºç¡€ç¯å¢ƒ" class="headerlink" title="åŸºç¡€ç¯å¢ƒ"></a>åŸºç¡€ç¯å¢ƒ</h2><ul><li>å·²ç»è®¾ç½®ç¼“å­˜çš„ Nginx æœåŠ¡å™¨ï¼Œ å‚ç…§æˆ‘ä¹‹å‰åšæ–‡ <a href="http://nullpointer.pw/2017/08/20/Nginx%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE/">Nginxç¼“å­˜é…ç½®</a></li></ul><h2 id="Nginx-é…ç½®æ–‡ä»¶æ‹†åˆ†"><a href="#Nginx-é…ç½®æ–‡ä»¶æ‹†åˆ†" class="headerlink" title="Nginx é…ç½®æ–‡ä»¶æ‹†åˆ†"></a>Nginx é…ç½®æ–‡ä»¶æ‹†åˆ†</h2><p>åœ¨ä¼ä¸š Nginx åº”ç”¨ä¸­ï¼ŒNginx é…ç½®æ–‡ä»¶åº”è¯¥æ ¹æ®åŸŸåä¸åŒæ¥è¿›è¡Œæ‹†åˆ†ï¼Œç„¶ååœ¨ <strong>nginx.conf</strong>ä¸­è¿›è¡Œ<strong>include</strong>å¼•å…¥ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ä¾¿äºç®¡ç†é…ç½®æ–‡ä»¶ï¼Œä¾¿äºä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œ è€Œ <strong>nginx.conf</strong> æ–‡ä»¶ä¸­åªä¿ç•™ <strong>upstream</strong> ä»¥åŠå…¶ä»–é€šç”¨é…ç½®ä¿¡æ¯ã€‚</p><p>åœ¨ Nginx çš„ <strong>conf</strong> ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶å¤¹ <strong>include</strong>ï¼Œ ç”¨äºä¿å­˜æ‹†åˆ†çš„é…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">mkdir include<br></code></pre></div></td></tr></table></figure><p>æ‹†åˆ†çš„è§„åˆ™å¯ä»¥å¦‚ä¸‹ï¼š</p><ul><li>æ¡Œé¢ç‰ˆï¼ˆWEBï¼‰çš„ Nginx é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å‘½åä¸º <strong>nginx_web.conf</strong></li><li>æ‰‹æœºç‰ˆï¼ˆWAPï¼‰çš„ Nginx é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å‘½åä¸º <strong>nginx_wap.conf</strong></li><li>å®‰å“çš„ Nginx é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å‘½åä¸º <strong>nginx_apk.conf</strong></li><li>è‹¹æœçš„ Nginx é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å‘½åä¸º <strong>nginx_ios.conf</strong></li><li>æ¸…é™¤ç¼“å­˜çš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å‘½åä¸º <strong>purge.conf</strong></li></ul><p>åœ¨ <strong>/usr/local/nginx/conf/nginx.conf</strong> ä¸­å¼•å…¥æ‹†åˆ†çš„é…ç½®æ–‡ä»¶ï¼Œ åœ¨é…ç½®æ–‡ä»¶ä¸­çš„ <strong>http</strong> èŠ‚ç‚¹ä¸‹è¿›è¡Œå¼•å…¥</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">http&#123;<br><br><span class="hljs-meta">  #</span><span class="bash">......</span><br><br><span class="hljs-meta">  #</span><span class="bash"> æ³¨æ„ purge.conf å¿…é¡»è¦ç¬¬ä¸€ä¸ªå¼•ç”¨ï¼ï¼ï¼</span><br>  include include/purge.conf;<br><span class="hljs-meta">  #</span><span class="bash"> å¼•å…¥å…¶ä»–é…ç½®æ–‡ä»¶</span><br>  include include/nginx_web.conf;<br><span class="hljs-meta">  #</span><span class="bash">include include/nginx_wap.conf;</span><br><span class="hljs-meta">  #</span><span class="bash">include include/nginx_apk.conf;</span><br><span class="hljs-meta">  #</span><span class="bash">include include/nginx_ios.conf;</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="é…ç½®ç¼“å­˜æ¸…é™¤"><a href="#é…ç½®ç¼“å­˜æ¸…é™¤" class="headerlink" title="é…ç½®ç¼“å­˜æ¸…é™¤"></a>é…ç½®ç¼“å­˜æ¸…é™¤</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cd /usr/local/nginx/conf/include<br>vi purge.conf<br><br><span class="hljs-meta">#</span><span class="bash">purge.conf æ–‡ä»¶å†…å®¹ä¸ºï¼š</span><br>server &#123;<br>    listen       80;<br>    server_name 192.168.200.129;# æ­¤å¤„æˆ‘é…ç½®çš„æ˜¯æœ¬æœºip<br>    charset utf8;<br><br>    location ~ /purge(/.*) &#123;<br>        allow   all;# è®¿é—®æ­¤æ¥å£çš„ç™½åå•ï¼Œallä»£è¡¨æ‰€æœ‰äººéƒ½å¯ä»¥è®¿é—®è¯¥è·¯å¾„<br>        # tmpcache ä¸ºå‰æ–‡ä¸­ proxy_cache_path é‡Œé…ç½®çš„ keys_zone çš„å€¼<br>        # www.domain.com$1$is_args$args è¡¨ç¤ºç¼“å­˜keyçš„åç§°ï¼Œæ¸…é™¤æŸä¸€åŸŸåä¸‹çš„ç¼“å­˜,å¯ä»¥æŒ‡å®šå‚æ•°<br>        # $1 ä»£è¡¨æ­£åˆ™åŒ¹é…ä¸­çš„ç¬¬ä¸€ç»„<br>        proxy_cache_purge cachefile www.domain.com$1$is_args$args;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">#</span><span class="bash"> ä¿å­˜ purge.conf æ–‡ä»¶</span><br></code></pre></div></td></tr></table></figure><h2 id="æµ‹è¯•æ¸…é™¤ç¼“å­˜"><a href="#æµ‹è¯•æ¸…é™¤ç¼“å­˜" class="headerlink" title="æµ‹è¯•æ¸…é™¤ç¼“å­˜"></a>æµ‹è¯•æ¸…é™¤ç¼“å­˜</h2><p>å¦‚æœè¦è¿›è¡Œç¼“å­˜æ¸…é™¤ï¼Œé¦–å…ˆéœ€è¦æœ‰ç¼“å­˜æ–‡ä»¶ï¼Œæ­¤å¤„å‚ç…§å‰æ–‡ <a href="http://nullpointer.pw/2017/08/20/Nginx%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE/">Nginxç¼“å­˜é…ç½®</a> ä¸­ï¼Œè®¿é—® <strong><a href="http://www.domain.com/testpage2">www.domain.com/testpage2</a></strong>  ï¼Œåˆ·æ–°é¡µé¢ï¼Œç›´åˆ°ç¼“å­˜å·²ç»ç”Ÿæˆï¼Œå³ <strong>X-Cache</strong> çš„çŠ¶æ€ä¸º <strong>HIT</strong>ã€‚</p><p>è¿›å…¥ <strong>cd /tmp/cache/</strong> ï¼ŒæŸ¥çœ‹å·²ç»ç”Ÿæˆäº†ç¼“å­˜æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170910/223443897.png" alt="mark">  </p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æµ‹è¯• nginx é…ç½®æ˜¯å¦æ­£ç¡®</span><br>/usr/local/nginx/sbin/nginx -t<br><span class="hljs-meta">#</span><span class="bash"> å¦‚æœæç¤º is okï¼Œè¯´æ˜é…ç½®æ²¡æœ‰é—®é¢˜ï¼Œå¦åˆ™éœ€è¦ä¿®æ”¹</span><br><br><span class="hljs-meta">#</span><span class="bash"> é‡å¯ Nginx</span><br>/usr/local/nginx/sbin/nginx -s reload<br></code></pre></div></td></tr></table></figure><p>æµè§ˆå™¨è®¿é—®ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡ curl å‘½ä»¤æ¥è®¿é—®ï¼‰ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> æ¸…é™¤keyä¸º www.domain.com/ çš„ç¼“å­˜</span><br>192.168.200.129/purge/    <br><span class="hljs-meta">#</span><span class="bash"> æ¸…é™¤ key ä¸º www.domain.com/testpage2 é¡µé¢ç¼“å­˜</span><br>192.168.200.129/purge/testpage2<br></code></pre></div></td></tr></table></figure><p>å¦‚æœè¿”å›  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170911/055142311.png">  </p><p>åˆ™è¡¨ç¤ºæ¸…é™¤æˆåŠŸã€‚</p><h2 id="èµ„æºä¸‹è½½"><a href="#èµ„æºä¸‹è½½" class="headerlink" title="èµ„æºä¸‹è½½"></a>èµ„æºä¸‹è½½</h2><p><a href="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/conf.zip">ç¤ºä¾‹nginxé…ç½®æ–‡ä»¶</a></p>]]></content>
    
    
    <categories>
      
      <category>æœåŠ¡å™¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
      <tag>ç¼“å­˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼šæ„Ÿè§‰åˆ°å€¦æ€ ?</title>
    <link href="/%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E4%BB%AC%E4%BC%9A%E6%84%9F%E8%A7%89%E5%88%B0%E5%80%A6%E6%80%A0%EF%BC%9F.html"/>
    <url>/%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E4%BB%AC%E4%BC%9A%E6%84%9F%E8%A7%89%E5%88%B0%E5%80%A6%E6%80%A0%EF%BC%9F.html</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸ºä»€ä¹ˆäº§ç”Ÿå€¦æ€ ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆäº§ç”Ÿå€¦æ€ ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆäº§ç”Ÿå€¦æ€ ï¼Ÿ"></a>ä¸ºä»€ä¹ˆäº§ç”Ÿå€¦æ€ ï¼Ÿ</h2><p>åˆšå¼€å§‹ æ¥æ‰‹æ–°é¡¹ç›®ã€å­¦ä¹ æ–°æŠ€èƒ½æ—¶ï¼Œæˆ‘ä»¬æ€»æ˜¯å…´å¥‹ä¸å·²ã€è¸Œèº‡æ»¡å¿—ã€è¿«ä¸åŠå¾…åœ°æƒ³å¤§å±•èº«æ‰‹ã€‚ä½†æ˜¯è¿‡äº†ä¸ä¹…ï¼Œæ–°é²œæ„Ÿé€€å´åï¼Œå¤§éƒ¨åˆ†çƒ­æƒ…å°±ä¼šæ¶ˆé€€ï¼Œæœ€ç»ˆå°±ä¼šå…´è¶£ç´¢ç„¶ï¼Œç§¯ææ€§ä½ï¼Œè¿›å±•ç¼“æ…¢æˆ–è€…æ¯«æ— è¿›å±•ã€‚</p><a id="more"></a><p>è¿™æ ·çš„äº‹æƒ…å¾ˆå¤šï¼Œæ¯”å¦‚ï¼š</p><ul><li>åˆšå¼€å§‹å­¦ä¹ é©¾é©¶ï¼Œæ˜¯ä¸æ˜¯å¾ˆå…´å¥‹ï¼Ÿè¿‡äº†å¤šä¹…ä¹‹åï¼Œå°±ä¸å†çœŸæ­£å…³å¿ƒä½ çš„è½¦äº†ï¼Ÿå¤šä¹…ä»¥åï¼Œä½ å·²ç»è§‰å¾—å®ƒå·²ç»â€œè€â€äº†ï¼Ÿ</li><li>é›„å¿ƒå‹ƒå‹ƒåœ°æƒ³é”»ç‚¼å‡ºä¸€å‰¯å¥½èº«æï¼ŒåŠäº†å¥èº«å¡åï¼Œå»äº†å‡ æ¬¡ä¹‹åå°±å†æ²¡å»è¿‡äº†ï¼Ÿ</li><li>â€¦â€¦</li></ul><p>æˆ‘ä»¬å½“å¼€å§‹å€¦æ€ ï¼Œäºæ˜¯æˆ‘ä»¬åŠé€”è€ŒåºŸï¼ŒåŠªåŠ›å¯»æ‰¾æ–°äº‹ç‰©ï¼Œæ‰¾å›è‡ªå·±çœŸæ­£çš„æ¿€æƒ…ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170904/213718521.png"></p><p>å¼€å§‹çš„æ—¶å€™æˆ‘ä»¬çš„å…´è¶£æœ€é«˜ï¼Œè€ŒåŠ¨æœºåœ¨å¼€å§‹é˜¶æ®µå¯èƒ½ä¸é«˜ï¼Œä½†æ˜¯éšç€å–å¾—è¿›å±•ï¼Œæˆ‘ä»¬çš„åŠ¨æœºæ°´å¹³å¼€å§‹ä¸Šå‡ã€‚æ—©æœŸçš„æˆåŠŸè®©ä½ æ„Ÿè§‰åˆ°æœ‰åŠ¨åŠ›ï¼Œå†²é‡åˆ™æ¨åŠ¨ä½ å‰è¿›ã€‚</p><p>ä½†æ˜¯éšç€æ—¶é—´çš„æ¨ç§»ï¼Œç¼“æ…¢çš„æˆæœè¿›å±•åœ¨ä¸æ–­æ¶ˆè€—ä½ çš„åŠ¨æœºï¼Œæœ€ç»ˆä¼šå‘ç°åŠ¨æœºå’Œå…´è¶£éƒ½æ¿’ä¸´è°·åº•ï¼Œè¿™å°±æ˜¯é‚£å µå¢™ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ„Ÿè§‰å€¦æ€ çš„åŸå› ã€‚</p><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç©¿è¿‡äº†è¿™é“å¢™ï¼Œæˆ‘ä»¬çš„åŠ¨æœºã€å…´è¶£ä¼šéšç€æˆæœçš„ä¸æ–­å–å¾—è€Œä¸æ–­ä¸Šå‡åŠ å¼ºï¼Œæœ€ç»ˆæˆ‘ä»¬è·å¾—äº†æœ€å¤§çš„å›æŠ¥ï¼Œåªæ˜¯èƒ½å¤Ÿç©¿è¿‡è¿™é“å¢™çš„äººå¾ˆå°‘ã€‚</p><h2 id="å¦‚ä½•ç©¿è¿‡è¿™é“å¢™ï¼Ÿ"><a href="#å¦‚ä½•ç©¿è¿‡è¿™é“å¢™ï¼Ÿ" class="headerlink" title="å¦‚ä½•ç©¿è¿‡è¿™é“å¢™ï¼Ÿ"></a>å¦‚ä½•ç©¿è¿‡è¿™é“å¢™ï¼Ÿ</h2><p>åˆ¶å®šä¸€ä¸ªç›®æ ‡æˆ–è®¡åˆ’ï¼Œé‡‡å–â€œå®šé¢å·¥ä½œæ³•â€ï¼Œå¹¶åšå†³æŒ‰ç…§è®¡åˆ’å®Œæˆå®šé¢å·¥ä½œã€‚</p><p>é¦–å…ˆéœ€è¦ç¡®ç«‹ä¸€ä¸ªç›®æ ‡ï¼Œè§„å®šè‡ªå·±è¦åœ¨é¢„å®šç¡®å®šçš„æ—¶é—´æ®µå†…éœ€è¦å–å¾—å¤šå¤§çš„è¿›å±•ã€‚</p><p>æ¯”å¦‚ï¼š</p><ul><li>æ¯å‘¨è·‘æ­¥ 3 æ¬¡</li><li>æ¯å‘¨å†™ä¸€ç¯‡åšå®¢</li><li>æ¯å¤©çœ‹åŠå°æ—¶çš„ä¹¦</li><li>æ¯å¤©å¼¹åŠå°æ—¶çš„å‰ä»–</li></ul><p>å°†æ‰€æœ‰é‡å¤æ€§å·¥ä½œçš„é¢‘ç‡è¿›è¡Œé‡åŒ–ï¼Œæœ‰çš„ä¸€æœˆä¸€æ¬¡ï¼Œæœ‰çš„ä¸€å‘¨3æ¬¡ï¼Œæœ‰çš„åˆ™æ˜¯æ¯å¤©ä¸¤æ¬¡ã€‚å¹¶æ‰¿è¯ºå®Œæˆï¼Œæ— è®ºåˆ®é£ä¸‹é›¨ã€‚</p><p><strong>æ‰¿è¯ºæ˜¯å®šé¢å·¥ä½œæ³•çš„æ ¸å¿ƒï¼Œé™¤äº†æƒ³æ–¹è®¾æ³•å®Œæˆè‡ªå·±çš„å·¥ä½œï¼Œä¸ç»™è‡ªå·±ç•™ä¸‹ä»»ä½•å…¶ä»–çš„é€‰æ‹©ã€‚</strong> å¤±è´¥ä¸èƒ½è¢«æ¥å—ï¼Œå› ä¸ºä½ è®©è‡ªå·±å¤±ä¿¡ä¸€æ¬¡ï¼Œå°±ä¼šæœ‰ç¬¬äºŒæ¬¡ï¼Œå¾ˆå¿«å®šé¢åœ¨ä½ çœ¼ä¸­å°±ä¼šå˜å¾—ä¸€æ–‡ä¸å€¼ã€‚</p><p>å®šé¢å·¥ä½œæ³•çš„ä¼˜ç‚¹è¿˜å¯ä»¥å¸®ä½ å…‹æœæ„å¿—åŠ›è–„å¼±çš„é—®é¢˜ã€‚<strong>é€šè¿‡é¢„å…ˆè®¾å®šå¥½çš„å¿…é¡»è¦éµå¾ªçš„è¿‡ç¨‹ï¼Œæ¶ˆé™¤éœ€è¦ä½œå‡ºå†³ç­–çš„éƒ¨åˆ†ã€‚</strong> å³ä¸éœ€è¦åšåˆ¤æ–­â€”â€”ä½ çŸ¥é“å¿…é¡»è¦åšï¼Œåªéœ€è¦éµä»å‘½ä»¤ï¼Œé¿å…äº†æ„å¿—åŠ›è€—å°½çš„é—®é¢˜ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¯»ä¹¦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nginxç¼“å­˜é…ç½®</title>
    <link href="/Nginx%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE.html"/>
    <url>/Nginx%E7%BC%93%E5%AD%98%E9%85%8D%E7%BD%AE.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>æœ¬æ–‡ä»‹ç»åˆ©ç”¨ nginx çš„ nginx_ngx_cache_purge æ¨¡å—æ¥å®ç°ç¼“å­˜åŠŸèƒ½ï¼Œå‰å‡ ç¯‡æ–‡ç« ä»‹ç»äº† Nginx çš„åŠ¨é™åˆ†ç¦»ä»¥åŠ CDN æŠ€æœ¯ï¼Œåœ¨å…¶åŸºç¡€ä¸Šï¼Œå†å¯¹æ•´ä¸ªé¡µé¢è¿›è¡Œç¼“å­˜ï¼Œå°†å¤§å¤§æé«˜æœåŠ¡å™¨çš„è´Ÿè½½èƒ½åŠ›ã€‚</p></blockquote><a id="more"></a><h2 id="åŸºç¡€ç¯å¢ƒ"><a href="#åŸºç¡€ç¯å¢ƒ" class="headerlink" title="åŸºç¡€ç¯å¢ƒ"></a>åŸºç¡€ç¯å¢ƒ</h2><ul><li><a href="http://nullpointer.pw/2017/08/19/CentOS%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85">CentOS 6.8 minimal</a></li><li><a href="http://nginx.org/download/nginx-1.12.1.tar.gz">Nginx 1.12.1</a></li><li><a href="http://labs.frickle.com/files/ngx_cache_purge-2.3.tar.gz">ngx_cache_purge-2.3</a></li></ul><h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><p>Nginx ä¸ nginx_ngx_cache_purge ä¸‹è½½è§£å‹</p><p>å®‰è£… <em>wget</em></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yum install wget<br></code></pre></div></td></tr></table></figure><p>ä¸‹è½½ <em>Nginx</em></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">wget  http://nginx.org/download/nginx-1.12.1.tar.gz<br></code></pre></div></td></tr></table></figure><p>è§£å‹ <em>Nginx</em> åˆ° <em>/usr/local/src/</em> ç›®å½•</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">tar -zxvf nginx-1.8.1.tar.gz -C /usr/local/src/<br></code></pre></div></td></tr></table></figure><p>ä¸‹è½½ <em>ngx_cache_purge</em></p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">wget http://labs.frickle.com/files/ngx_cache_purge-2.3.tar.gz<br></code></pre></div></td></tr></table></figure><p>è§£å‹åˆ° Nginx åŒä¸€çº§ç›®å½•  </p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">tar -zxvf ngx_cache_purge-2.3.tar.gz -C /usr/local/src/<br></code></pre></div></td></tr></table></figure><p>ç›®å½•ç»“æ„ä¸º</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">---/usr/local/src<br>   --nginx-1.8.1<br>   --ngx_cache_purge-2.3<br></code></pre></div></td></tr></table></figure><p>è¿›å…¥ Nginx è§£å‹ç›®å½•</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">cd nginx-1.8.1<br></code></pre></div></td></tr></table></figure><p>å®‰è£…å¿…è¦ä¾èµ–</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">yum -y install gcc pcre-devel openssl openssl-devel<br></code></pre></div></td></tr></table></figure><p>æ£€æŸ¥å®‰è£…ç¯å¢ƒ,å¹¶æŒ‡å®šå°†æ¥è¦å®‰è£…çš„è·¯å¾„å’Œè¦å®‰è£…çš„æ’ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">./configure --prefix=/usr/local/nginx/ --with-http_realip_module --add-module=../ngx_cache_purge-2.3<br></code></pre></div></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š<br>â€“prefixï¼š å°† nginx å®‰è£…åˆ°æ­¤ç›®å½•<br>â€“with-http_realip_module å¯ç”¨è·å–ç”¨æˆ·çœŸå® IP æ¨¡å—<br>â€“add-module=../ngx_cache_purge-2.3 æ·»åŠ  ngx_cache_purge æ¨¡å—ï¼Œç”¨äºç¼“å­˜  </p><p>è¿›è¡Œç¼–è¯‘å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">make &amp;&amp; make install<br></code></pre></div></td></tr></table></figure><p>ç¼–è¯‘å®Œæˆåï¼Œæ²¡æœ‰å‡ºç° error ä¸ºç¼–è¯‘å®‰è£…æˆåŠŸ</p><h2 id="è®¾ç½®-Nginx-ç¼“å­˜"><a href="#è®¾ç½®-Nginx-ç¼“å­˜" class="headerlink" title="è®¾ç½® Nginx ç¼“å­˜"></a>è®¾ç½® Nginx ç¼“å­˜</h2><p>ç¼–è¾‘ <em>nginx.conf</em> é…ç½®æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">vi /usr/local/nginx/conf/nginx.conf<br></code></pre></div></td></tr></table></figure><p>æ·»åŠ å¦‚ä¸‹é…ç½®</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> éœ€è¦åœ¨ /tmp ç›®å½•ä¸‹åˆ›å»º cache æ–‡ä»¶å¤¹ï¼</span><br><span class="hljs-meta">#</span><span class="bash">è®¾ç½®ç¼“å­˜åŒºçš„åç§°ä¸º tmpcacheï¼Œå†…å­˜ç¼“å­˜ç©ºé—´å¤§å°ä¸º 200MBï¼Œ1 å¤©æ²¡æœ‰è¢«è®¿é—®çš„å†…å®¹è‡ªåŠ¨æ¸…é™¤ï¼Œç¡¬ç›˜ç¼“å­˜ç©ºé—´å¤§å°ä¸º 5GBï¼Œ å¦‚æœè®¿é—®é¢‘ç‡ä¸é«˜çš„è¯ï¼Œ inactive æ—¶é—´å¯ä»¥è®¾ç½®é•¿ä¸€äº›ã€‚</span><br>proxy_cache_path /tmp/cache levels=1:2 keys_zone=tmpcache:200m inactive=1d max_size=5g;<br><br>server &#123;<br>listen       80;<br>server_name  www.domain.com;#ä½ çš„åŸŸå<br>charset utf8;<br><br>proxy_set_header        Host            $host;<br>proxy_set_header        X-Real-IP       $remote_addr;<br>proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;<br>proxy_set_header        X-Up-Calling-Line-Id $http_x_up_calling_line_id;<br>proxy_ignore_headers    X-Accel-Expires Expires Cache-Control Set-Cookie;<br><br>access_log logs/access.log  main;<br><br>location / &#123;<br>proxy_pass http://127.0.0.1:8080;<br><span class="hljs-meta">#</span><span class="bash">proxy_cache çš„å€¼æ˜¯ proxy_cache_path ä¸­çš„ keys_zone çš„å€¼</span><br>proxy_cache tmpcache;<br><span class="hljs-meta">#</span><span class="bash">ç¼“å­˜ key çš„å€¼</span><br>proxy_cache_key $host$uri$is_args$args;<br>proxy_cache_valid 200 301 5m;<br>proxy_cache_use_stale updating error timeout invalid_header http_500 http_502 http_503 http_504;<br><br>expires 1m;<br><span class="hljs-meta">#</span><span class="bash"> å°†ç¼“å­˜çš„çŠ¶æ€æ·»åŠ åˆ° Header ä¸­</span><br>add_header X-Cache &#x27;$upstream_cache_status&#x27;;<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="å¯åŠ¨-Nginx"><a href="#å¯åŠ¨-Nginx" class="headerlink" title="å¯åŠ¨ Nginx"></a>å¯åŠ¨ Nginx</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">/usr/local/nginx/sbin/nginx<br></code></pre></div></td></tr></table></figure><h2 id="å¯åŠ¨-Tomcat"><a href="#å¯åŠ¨-Tomcat" class="headerlink" title="å¯åŠ¨ Tomcat"></a>å¯åŠ¨ Tomcat</h2><p>å¯ä»¥ä½¿ç”¨è‡ªå·±çš„é¡¹ç›®ï¼Œæˆ–è€…ä½¿ç”¨æˆ‘æä¾›çš„é¡¹ç›®æ¥è¿›è¡Œæµ‹è¯•ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">wget https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/SpringDemo.war<br></code></pre></div></td></tr></table></figure><p>å°†ä¸‹è½½çš„ war åŒ…æ”¾åˆ° Tomcat çš„ webapps ç›®å½•ä¸‹ï¼Œä¿®æ”¹ war åŒ…åç§°ä¸º ROOT.war ï¼Œå¯åŠ¨ Tomcatã€‚</p><h2 id="æµ‹è¯•-Nginx-ç¼“å­˜"><a href="#æµ‹è¯•-Nginx-ç¼“å­˜" class="headerlink" title="æµ‹è¯• Nginx ç¼“å­˜"></a>æµ‹è¯• Nginx ç¼“å­˜</h2><p>ç¼“å­˜ä¹‹å‰</p><p>æŸ¥çœ‹ <strong>/tmp/cache</strong> ç›®å½•ï¼Œ ç›®å½•ä¸‹é¢æ²¡æœ‰ä»»ä½•æ–‡ä»¶</p><p>ä¿®æ”¹æœ¬æœºï¼ˆwindowsï¼‰çš„ hosts æ–‡ä»¶ï¼Œå°†é…ç½®çš„åŸŸåæŒ‡å‘æœåŠ¡å™¨ IP</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">192.168.200.129 www.domain.com<br></code></pre></div></td></tr></table></figure><p>æ‰“å¼€æµè§ˆå™¨è®¿é—® <strong><a href="http://www.domain.com/testpage1">www.domain.com/testpage1</a></strong></p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170820/131820402.png"></p><p>å‘ç° <strong>X-Cache</strong> çš„çŠ¶æ€ä¸º <strong>MISS</strong> ï¼Œè¯´æ˜æ²¡æœ‰ç¼“å­˜ã€‚</p><p>å†æ¬¡åˆ·æ–°é¡µé¢å  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170820/133616261.png"></p><p><strong>X-Cache</strong> çš„çŠ¶æ€å·²ç»å˜æˆäº† <strong>HIT</strong></p><p>åŒæ—¶åœ¨æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹ <strong>/tmp/cache</strong> ç›®å½•</p><p><code>cd /tmp/cache/</code></p><p>å‘ç°è¯¥ç›®å½•ä¸‹é¢å·²ç»å¤šäº†æ–‡ä»¶ç›®å½•ï¼Œè¿›å»ä¹‹åæ‰“å¼€æ–‡ä»¶ï¼Œå‘ç°æ­£æ˜¯åˆšåˆšè®¿é—®é¡µé¢çš„æºç ï¼Œè¯´æ˜ Nginx çš„ç¼“å­˜å·²ç»é…ç½®æˆåŠŸäº†ã€‚åªè¦æ˜¯é…ç½®çš„åŸŸåä¸‹é¢çš„é¡µé¢ï¼Œ å¦‚æœæ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œéƒ½ä¼šç¼“å­˜åˆ°æœåŠ¡å™¨ã€‚å½“ç¬¬äºŒæ¬¡è®¿é—®çš„æ—¶å€™ï¼Œè¯·æ±‚ç»è¿‡ Nginx æœåŠ¡å™¨æ—¶ï¼ŒNginx ç›´æ¥è¿”å›å·²ç»ç¼“å­˜çš„é™æ€é¡µé¢ï¼Œè¿™æ ·å°†å¤§å¤§é™ä½åº”ç”¨æœåŠ¡å™¨ Tomcat çš„è´Ÿè½½ã€‚</p><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¹¶ä¸æ˜¯è¯¥åŸŸåä¸‹çš„æ‰€æœ‰é¡µé¢éƒ½éœ€è¦è¿›è¡Œç¼“å­˜ï¼Œå¦‚æœç¼“å­˜æœ‰è¯¯ï¼Œä¼šå‡ºç°å¾ˆä¸¥é‡çš„é—®é¢˜ã€‚æ¯”å¦‚ä¸æ­£ç¡®çš„å°†åŸŸåä¸‹çš„ç”¨æˆ·ä¸­å¿ƒè¿›è¡Œäº†ç¼“å­˜ï¼Œå½“å…¶ä»–ç”¨æˆ·ä¹Ÿè¿›å…¥é¡µé¢çš„æ—¶å€™ï¼Œæ˜¾ç¤ºçš„å…¨éƒ¨éƒ½æ˜¯ç¬¬ä¸€ä¸ªè¿›å…¥è¯¥é¡µé¢ç”¨æˆ·çš„ä¿¡æ¯ã€‚å› æ­¤å»ºè®®åšç¼“å­˜æ—¶ï¼Œæœ€å¥½æ ¹æ®åŸŸåæ¥åšï¼Œ æ ¹æ®ç”¨æˆ·ä¸åŒæ˜¾ç¤ºä¸åŒçš„é¡µé¢çš„åœ°å€å°±ä¸è¦åšç¼“å­˜ã€‚å½“ç„¶ï¼Œå¦‚æœæ¥å£åœ°å€è§„èŒƒï¼Œäº¦å¯ä»¥é€šè¿‡ Nginx æ­£åˆ™åŒ¹é…è·¯å¾„çš„æ–¹å¼ï¼Œåªå°†æŸäº›åŒ¹é…çš„è·¯å¾„åšç¼“å­˜ã€‚</strong></p>]]></content>
    
    
    <categories>
      
      <category>æœåŠ¡å™¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
      <tag>ç¼“å­˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é˜¿é‡Œäº‘CDNå®ç°ç½‘ç«™æ–‡ä»¶åŠ¨é™åˆ†ç¦»</title>
    <link href="/%E9%98%BF%E9%87%8C%E4%BA%91CDN%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%AB%99%E6%96%87%E4%BB%B6%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB.html"/>
    <url>/%E9%98%BF%E9%87%8C%E4%BA%91CDN%E5%AE%9E%E7%8E%B0%E7%BD%91%E7%AB%99%E6%96%87%E4%BB%B6%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸Šä¸€ç¯‡æ–‡ç« ä»‹ç»äº†å¦‚ä½•åˆ©ç”¨ Nginx æ¥å®ç°é™æ€èµ„æºè¯·æ±‚ä¸åŠ¨æ€è¯·æ±‚çš„åˆ†ç¦»ï¼Œè™½ç„¶ä¸æ˜¯æ‰€æœ‰çš„è¯·æ±‚éƒ½å‹åˆ° Tomcat åº”ç”¨æœåŠ¡å™¨ï¼Œä½†æ˜¯é™æ€èµ„æºè¯·æ±‚è¿˜æ˜¯éƒ½ä¼šåˆ° ä¸»æœºä¸Šç»™ä¸»æœºå¸¦æ¥å‹åŠ›ï¼Œå› æ­¤æœ¬æ–‡é€šè¿‡åˆ©ç”¨é˜¿é‡Œäº‘çš„ CDN æŠ€æœ¯æ¥æ›´åŠ å½»åº•åœ°é™ä½åº”ç”¨è®¿é—®çš„è´Ÿè½½ã€‚</p><a id="more"></a><h2 id="é…ç½®é™æ€èµ„æºåŸŸå"><a href="#é…ç½®é™æ€èµ„æºåŸŸå" class="headerlink" title="é…ç½®é™æ€èµ„æºåŸŸå"></a>é…ç½®é™æ€èµ„æºåŸŸå</h2><p>å»ºç«‹ä¸€ä¸ªåªç”¨äºè¯·æ±‚é™æ€èµ„æºæ–‡ä»¶çš„äºŒçº§åŸŸåï¼Œå°†åŠ¨æ€è¯·æ±‚ä¸é™æ€è¯·æ±‚åˆ†ç¦»å¼€ã€‚</p><p>æ¯”å¦‚é™æ€èµ„æºè¯·æ±‚çš„åŸŸåæ˜¯ <strong>res.domain.com</strong> ï¼Œ åŠ¨æ€è¯·æ±‚çš„åŸŸåæ˜¯ <strong><a href="http://www.domain.com/">www.domain.com</a></strong></p><h2 id="é…ç½®-Nginx-é™æ€èµ„æºè®¾ç½®"><a href="#é…ç½®-Nginx-é™æ€èµ„æºè®¾ç½®" class="headerlink" title="é…ç½® Nginx  é™æ€èµ„æºè®¾ç½®"></a>é…ç½® Nginx  é™æ€èµ„æºè®¾ç½®</h2><p>å‚è€ƒæˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç«  <a href="http://nullpointer.pw/2017/08/19/Nginx%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB/">NginxåŠ¨é™åˆ†ç¦»</a></p><h2 id="é˜¿é‡Œäº‘-CDN-é…ç½®"><a href="#é˜¿é‡Œäº‘-CDN-é…ç½®" class="headerlink" title="é˜¿é‡Œäº‘ CDN é…ç½®"></a>é˜¿é‡Œäº‘ CDN é…ç½®</h2><p>ç™»å½•é˜¿é‡Œäº‘ CDN æ§åˆ¶å°ï¼Œæ·»åŠ åŸŸåã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170820/070050098.png"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯èµ„æºæ–‡ä»¶åªéœ€è¦æ”¾åˆ°ä¸€å°ä¸»æœºä¸Šå³å¯ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚</p><p>æ·»åŠ  CDN åŸŸåæˆåŠŸåï¼Œå›åˆ°åŸŸåç®¡ç†é¡µé¢ï¼Œ åœ¨åŸŸååˆ—è¡¨ä¸­æ‰¾åˆ°æ–°åŠ çš„åŸŸåï¼Œå…‰æ ‡æ‚¬æµ®åˆ°è¯¥åŸŸåä¸Šï¼Œä¼šå‡ºç°ä¸€ä¸ª <strong>å¤åˆ¶ CNAME</strong> çš„æŒ‰é’®ï¼Œé€‰æ‹©å¤åˆ¶ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªç±»ä¼¼äº <strong>res.domain.com.w.kunlunle.com</strong> çš„åŸŸåã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170820/070354748.png"></p><h2 id="DNS-é…ç½®"><a href="#DNS-é…ç½®" class="headerlink" title="DNS é…ç½®"></a>DNS é…ç½®</h2><p>è¿›å…¥ä½ çš„åŸŸåçš„ DNS æœåŠ¡æä¾›å•†æ§åˆ¶å°ï¼Œæˆ‘è¿™é‡Œæ˜¯ <a href="https://www.dnspod.cn/">DNSPOD</a> ï¼Œ æ‰¾åˆ°é™æ€èµ„æºåŸŸåï¼Œæˆ‘çš„æ˜¯ <strong>res.domain.com</strong> ä¿®æ”¹è®°å½•ç±»å‹ä¸º CNAME ï¼Œè®°å½•å€¼ä¿®æ”¹ä¸ºä¸Šä¸€æ­¥å¤åˆ¶çš„ åŸŸåï¼Œå¦‚ <strong>res.domain.com.w.kunlunle.comã€‚</strong></p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170820/071213172.png"></p><p>é€‰æ‹©ä¿å­˜ï¼Œç­‰å¾…å‡ åˆ†é’Ÿ DNS ç”Ÿæ•ˆåï¼Œè®¿é—®åŸŸåè¯•è¯•å§ï¼</p><p>æ¯”å¦‚æˆ‘çš„ <strong>res.domain.com/_res/a.jpg</strong> ï¼ˆéœ€è¦äº‹å…ˆåœ¨èµ„æºæœåŠ¡å™¨ä¸Šäº‹å…ˆæ”¾ç½®è¯¥é™æ€æ–‡ä»¶ï¼‰ å¦‚æœè®¿é—®ä¸åˆ°è¯´æ˜é…ç½®æœ‰è¯¯æˆ–è€…ç¼“å­˜è¿˜æœªç”Ÿæ•ˆã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå‘å°±æ˜¯ï¼Œè‡ªå·±çš„ç”µè„‘æœ‰å¯èƒ½å› ä¸ºç¼“å­˜æ²¡åˆ·æ–°è®¿é—®ä¸åˆ°è¯¥è·¯å¾„é™æ€èµ„æºï¼Œè€Œåˆ«äººçš„ç”µè„‘å¯ä»¥ï¼Œå¯ä»¥æ¢ä¸€å°ç”µè„‘å°è¯•è®¿é—®ï¼Œæˆ–è€…é€šè¿‡æ‰‹æœºæµè§ˆå™¨è®¿é—®å°è¯•ã€‚</p><p>Endã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŠ¨é™åˆ†ç¦»</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NginxåŠ¨é™åˆ†ç¦»</title>
    <link href="/Nginx%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB.html"/>
    <url>/Nginx%E5%8A%A8%E9%9D%99%E5%88%86%E7%A6%BB.html</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€æ–°å…¬å¸æ–°å¼€äº†ä¸€ä¸ªé¡¹ç›®ï¼Œé¡¹ç›®ç”±æˆ‘æ¥é…ç½®åŸºç¡€ç¯å¢ƒï¼Œä¼šå†™ä¸€ç³»åˆ—çš„æ•™ç¨‹æ¥å±•ç¤ºï¼Œä¸€ä¸ªç½‘ç«™ä»é›¶åˆ°ä¸Šçº¿çš„æ•´ä¸ªè¿‡ç¨‹ã€‚é¦–å…ˆæœ¬æ–‡ä»‹ç»èµ„æºæ–‡ä»¶çš„éš”ç¦»ã€‚  </p><a id="more"></a><h2 id="ä¸ºä»€ä¹ˆè¦å®ç°åŠ¨é™åˆ†ç¦»"><a href="#ä¸ºä»€ä¹ˆè¦å®ç°åŠ¨é™åˆ†ç¦»" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å®ç°åŠ¨é™åˆ†ç¦»"></a>ä¸ºä»€ä¹ˆè¦å®ç°åŠ¨é™åˆ†ç¦»</h2><p>ä¸ºä»€ä¹ˆè¦å°†é™æ€èµ„æºæ–‡ä»¶ä¸åŠ¨æ€è¯·æ±‚è¿›è¡Œåˆ†ç¦»ï¼Ÿ ä¸ºäº†é™ä½ Tomcat æœåŠ¡å™¨çš„è´Ÿè½½ï¼Œå¯ä»¥é€šè¿‡æœ¬æ–‡è®¾ç½®å¹¶ç»“åˆ CDN æ¥å®ç°æ¥æ›´å½»åº•åœ°é™ä½æœåŠ¡å™¨çš„è´Ÿè½½ã€‚  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170819/192205341.png"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½å‹åˆ°äº†åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œ æ— è®ºé™æ€è¿˜æ˜¯åŠ¨æ€çš„è¯·æ±‚ï¼Œè¿™æ ·æµé‡å¤§çš„è¯åŠ¿å¿…ä¼šé€ æˆæœåŠ¡å™¨çš„è´Ÿè½½è¿‡é«˜ï¼Œå› ä¸ºåŠ¨é™åˆ†ç¦»æ˜¯å¿…ä¸å¯å°‘çš„ã€‚</p><h2 id="ç¯å¢ƒä»‹ç»"><a href="#ç¯å¢ƒä»‹ç»" class="headerlink" title="ç¯å¢ƒä»‹ç»"></a>ç¯å¢ƒä»‹ç»</h2><p>é¦–å…ˆè¿™æ˜¯æˆ‘ä»¬é¡¹ç›®çš„ç›®å½•ç»“æ„ï¼Œ <strong>resource</strong> ç›®å½•å’Œ <strong>_res</strong> ç›®å½•ä¸­éƒ½æ˜¯é™æ€èµ„æºæ–‡ä»¶ï¼Œå­˜æ”¾æ¯”å¦‚ js/css/img ç­‰èµ„æºã€‚è¿™ä¸¤ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶æœ‰æ‰€ä¸åŒï¼Œ<strong>_res</strong> ç›®å½•ä¸‹é¢æ˜¯å‹ç¼©ç‰ˆæœ¬çš„ï¼Œæ¯”å¦‚å‹ç¼©çš„js/cssã€‚é€šè¿‡ Git æˆ–è€… SVN å°†é¡¹ç›®ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šåï¼Œé…ç½® Nginx æ¥å®Œæˆé™æ€èµ„æºçš„åˆ†ç¦»ã€‚  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170819/131159884.png"></p><p>é¦–å…ˆçœ‹ä¸€å¼ å›¾(å›¾çš„æ¥æºæ˜¯ï¼š<a href="http://www.cnblogs.com/xiaoblog/p/4241086.html">http://www.cnblogs.com/xiaoblog/p/4241086.html</a>)  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170819/130334830.png"></p><p>å½“è¯·æ±‚ç»è¿‡ Nginx æ—¶ï¼Œå¦‚æœæ˜¯é™æ€èµ„æºçš„è¯·æ±‚ï¼Œå°±ç›´æ¥è¿”å›ä¸»æœºä¸Šé™æ€èµ„æºå³å¯ï¼Œ å¦‚æœæ˜¯åŠ¨æ€è¯·æ±‚ï¼Œåˆ™å»è¯·æ±‚ Tomcat æœåŠ¡å™¨åå†è¿”å›ã€‚å¦‚æœæµé‡ä¸æ˜¯å¾ˆå¤§ï¼Œé™æ€èµ„æºå¯ä»¥å’Œ Tomcat æœåŠ¡å™¨æ”¾åœ¨åŒä¸€å°ä¸»æœºä¸Šï¼Œå¦åˆ™éœ€è¦å°†é™æ€èµ„æºä¸ Tomcat æœåŠ¡å™¨åˆ†å¼€ã€‚</p><p>æˆ‘å¸å¯¹äºèµ„æºæ–‡ä»¶çš„åšæ³•æ˜¯æ–°å»ºä¸€ä¸ªäºŒçº§åŸŸåï¼Œè¯¥åŸŸååªç”¨äºåŠ è½½é™æ€èµ„æºæ–‡ä»¶ã€‚å¦‚ <strong>res.domain.com</strong>ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ç®€åŒ–äº†åœ¨ Nginx çš„ é…ç½®ã€‚</p><h2 id="é…ç½®-Nginx"><a href="#é…ç½®-Nginx" class="headerlink" title="é…ç½® Nginx"></a>é…ç½® Nginx</h2><p>é¦–å…ˆéœ€è¦å®‰è£… Nginxï¼Œ å¯ä»¥å‚è€ƒæˆ‘çš„å¦å¤–ä¸€ç¯‡æ–‡ç«  <a href="http://nullpointer.pw/2017/05/05/Nginx%E5%AE%9E%E7%8E%B0Tomcat%E9%9B%86%E7%BE%A4/">Nginxå®ç°Tomcaté›†ç¾¤</a>ã€‚è¿™é‡Œåªéœ€è¦å‚è€ƒåˆ°å®‰è£… Nginx å³å¯ã€‚</p><p>Nginx é™æ€èµ„æºé…ç½®</p><p>æ‰“å¼€ Nginx é…ç½®æ–‡ä»¶</p><p><code>vim /usr/local/nginx/conf/nginx.conf</code></p><p>æ·»åŠ  server</p><figure class="highlight sh"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sh">server &#123;<br><span class="hljs-comment"># åªæ¥æ”¶é™æ€èµ„æºè¯·æ±‚</span><br>listen       80;<br>server_name   res.domain.com;<br>charset utf8;<br><br>default_type            text/plain;<br>add_header Access-Control-Allow-Origin *;<br><span class="hljs-comment">#access_log logs/heiyan.image.access.log  click;</span><br><br>location ~* \.(zip|rar|gz|tar.gz|gz|exe)$ &#123;<br><span class="hljs-built_in">return</span> 500;<br>&#125;<br><br>location / &#123;<br><span class="hljs-comment">#èµ„æºæ–‡ä»¶çš„ç›®å½•</span><br>root /home/resources;<br>index index.html;<br><br>expires 30d;<br>default_type      text/plain;<br>&#125;<br>&#125;<br>server &#123;<br><span class="hljs-comment"># æ¥æ”¶åŠ¨æ€è¯·æ±‚</span><br>listen       80;<br>server_name  www.domain.com;<br>charset utf8;<br><br>access_log logs/access.log  main;<br><br>location / &#123;<br>proxy_pass http://127.0.0.1:8080;<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æ‹·è´é¡¹ç›®ä¸­èµ„æºæ–‡ä»¶åˆ°æŒ‡å®šçš„èµ„æºç›®å½•"><a href="#æ‹·è´é¡¹ç›®ä¸­èµ„æºæ–‡ä»¶åˆ°æŒ‡å®šçš„èµ„æºç›®å½•" class="headerlink" title="æ‹·è´é¡¹ç›®ä¸­èµ„æºæ–‡ä»¶åˆ°æŒ‡å®šçš„èµ„æºç›®å½•"></a>æ‹·è´é¡¹ç›®ä¸­èµ„æºæ–‡ä»¶åˆ°æŒ‡å®šçš„èµ„æºç›®å½•</h2><p>åœ¨ Nginx çš„é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šäº†èµ„æºæ–‡ä»¶çš„ç›®å½•ä¸º <strong>/home/resources</strong> ï¼Œæ‰€ä»¥éœ€è¦å°†èµ„æºæ‹·è´åˆ°è¯¥ç›®å½•ä¸‹ï¼Œè¿›å…¥ä¸Šæ–‡ä¸‹è½½çš„é¡¹ç›®çš„ç›®å½•ä¸­ï¼Œå°†èµ„æºç›®å½•ï¼ˆæˆ‘è¿™é‡Œæ˜¯<strong>_res</strong>ç›®å½•)æ‹·è´åˆ° <strong>/home/resources</strong>ç›®å½•ä¸‹é¢ã€‚</p><p><code>cp -rf _res /home/resources</code></p><p>æ‹·è´å®Œæˆåçš„ç›®å½•åº”è¯¥æ˜¯ï¼š <code>/home/resources/_res</code></p><p>åœ¨ <strong>/home/resources/_res</strong> ç›®å½•ä¸‹æ”¾ä¸€å¼ å›¾ç‰‡ a.jpg ï¼Œç”¨äºæµ‹è¯•ã€‚</p><h2 id="æµ‹è¯•é™æ€èµ„æºè·å–"><a href="#æµ‹è¯•é™æ€èµ„æºè·å–" class="headerlink" title="æµ‹è¯•é™æ€èµ„æºè·å–"></a>æµ‹è¯•é™æ€èµ„æºè·å–</h2><p>å¯åŠ¨ Nginx</p><p>æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š <code>http://res.domain.com/_res/a.jpg</code></p><p>å¦‚æœæ˜¯åŠ¨æ€è¯·æ±‚ï¼Œåˆ™ä½¿ç”¨ <code>http://www.domain.com</code> åŸŸå</p><p>è¿”å›ç»“æœï¼š  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170819/174007494.png"></p><p>å› ä¸ºé™æ€èµ„æºæ–‡ä»¶åŒ…å« css/js ç­‰æ–‡ä»¶ï¼Œä¿®æ”¹æäº¤åéœ€è¦æ‹·è´å¢é‡ä¸ä¿®æ”¹çš„æ–‡ä»¶åˆ° <strong>/home/resources</strong> ç›®å½•ä¸‹ï¼Œå¦‚æœå«Œéº»çƒ¦ï¼Œå¯ä»¥ç›´æ¥åœ¨ Nginx é…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½® è·¯å¾„ä¸ºé¡¹ç›®çš„èµ„æºæ–‡ä»¶å¤¹æ ¹è·¯å¾„ï¼Œæ¯”å¦‚ <strong>/home/wide-api/src/main/java/resources/_res</strong>ï¼Œ è¿™ç§åœ¨æ›´æ–°ä»£ç ä¹‹åï¼Œå¯ä»¥ç›´æ¥è¯·æ±‚åˆ°æ–°çš„èµ„æºæ–‡ä»¶ã€‚ä¹‹åä¼šå†™ä¸€ç¯‡é€šè¿‡é˜¿é‡Œäº‘CDNæ¥å®Œæˆé™æ€åˆ†ç¦»ã€‚</p><p>æ³¨ï¼š ç”±äºæˆ‘çš„æ˜¯åœ¨è™šæ‹Ÿæœºä¸Šçš„ Nginx è¿›è¡Œæµ‹è¯•ï¼Œä¹Ÿæ²¡æœ‰åŸŸåï¼Œä¸”æ˜¯minimalç‰ˆæœ¬ç³»ç»Ÿï¼Œæ²¡æœ‰æ¡Œé¢ç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦é…ç½®å®¿ä¸»æœºçš„hostsï¼Œ åœ¨å®¿ä¸»æœºçš„æµè§ˆå™¨ä¸­è®¿é—®ã€‚åœ¨çœŸå®æœåŠ¡å™¨ä¸”æœ‰è‡ªå·±ç»‘å®šåˆ°æœåŠ¡å™¨ä¸ŠåŸŸåçš„å°±ç›´æ¥æµ‹è¯•å³å¯ã€‚</p><p>ä½¿ç”¨ <em>SwitchHosts</em> è½¯ä»¶ é…ç½® hostsï¼Œæˆ‘çš„è™šæ‹Ÿæœº ip ä¸º192.168.200.129</p><figure class="highlight accesslog"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs accesslog"><span class="hljs-number">192.168.200.129</span> www.domain.com res.domain.com<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æœåŠ¡å™¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
      <tag>åŠ¨é™åˆ†ç¦»</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CentOSå¿«é€Ÿå®‰è£…</title>
    <link href="/CentOS%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85.html"/>
    <url>/CentOS%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85.html</url>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘å­¦ä¹ è¿‡ç¨‹ä¸­éœ€è¦ä½¿ç”¨åˆ° Linux ç³»ç»Ÿï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æœåŠ¡å™¨ï¼Œå› æ­¤é€šè¿‡è™šæ‹Ÿæœºæ¥å®Œæˆã€‚æœ¬æ–‡ä¸ä»å¤´å¼€å§‹ä»‹ç»è™šæ‹Ÿæœºçš„å®‰è£…ï¼Œåªè®²è§£ <strong>è™šæ‹Ÿæœºè‡ªåˆ¶é•œåƒ</strong> å¤‡ä»½çš„å¿«é€Ÿè¿˜åŸï¼Œå¦‚æœä½ éœ€è¦ä»å¤´å¼€å§‹å®‰è£…çš„ï¼Œè¯·å¦å¯»æ•™ç¨‹ã€‚<strong>æœ¬æ–‡ä¸­æ¶‰åŠçš„é•œåƒä¼šæä¾›ä¸‹è½½åœ°å€ï¼Œä»¥ä¾›å‚è€ƒ</strong>ã€‚</p><p>å­¦ä¹ è¿‡ç¨‹ä¸­å®‰è£…è™šæ‹Ÿæœºæ—¶æ€»æ˜¯ä¼šé‡åˆ°ä¸€äº›éœ€è¦èŠ±è´¹å¤§é‡æ—¶é—´æ‰èƒ½è§£å†³çš„é—®é¢˜ï¼Œæ¯”å¦‚ä¸èƒ½è”ç½‘ã€æ•°æ®åº“è¿æ¥ä¸ä¸Šã€ssh è¿æ¥ä¸äº†ç­‰é—®é¢˜ï¼Œä¸ºäº†ä¾¿äºå­¦ä¹ ï¼Œæœ¬äººå°†å®‰è£…å¥½çš„ç³»ç»Ÿå¯¼å‡ºä¸ºé•œåƒæ–‡ä»¶ï¼Œä»¥åå¦‚æœéœ€è¦æ·»åŠ è™šæ‹Ÿæœºæ—¶ï¼Œç›´æ¥è¿˜åŸé•œåƒä¿®æ”¹éƒ¨åˆ†é…ç½®å³å¯ï¼Œä»¥ä¸‹ä¸ºæ•™ç¨‹ã€‚</p><a id="more"></a><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><ul><li>è™šæ‹Ÿæœºè½¯ä»¶ VMware Workstation 11</li><li>ç³»ç»Ÿé•œåƒç‰ˆæœ¬ CentOS 6.8 minimal (å‘½ä»¤è¡Œç‰ˆæœ¬ï¼Œæ— æ¡Œé¢)  </li><li>è‡ªå®šä¹‰é•œåƒä»¥åŠVMwareä¸‹è½½   é“¾æ¥ï¼š<a href="http://pan.baidu.com/s/1nuKxhpf">http://pan.baidu.com/s/1nuKxhpf</a> å¯†ç ï¼š8dt8<br>è‹¥é“¾æ¥å¤±æ•ˆï¼Œå‘é‚®ä»¶ç»™æˆ‘è¡¥é“¾æ¥ <a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=JVNGSFRlQ0pdSERMSQtGSkg">è”ç³»æˆ‘</a></li></ul><h2 id="VMware-é…ç½®"><a href="#VMware-é…ç½®" class="headerlink" title="VMware é…ç½®"></a>VMware é…ç½®</h2><p>éœ€è¦å®‰è£…çš„è™šæ‹Ÿæœºé‡‡å– NAT æ–¹å¼è”ç½‘ï¼Œå› æ­¤ éœ€è¦åœ¨ VMware ä¸­é…ç½®ç½‘å…³åœ°å€ã€‚  </p><p>æ‰“å¼€è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨ï¼Œè®¾ç½®å­ç½‘ IP</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170819/070316487.png"></p><p>ç‚¹å‡» NAT è®¾ç½®ï¼Œè®¾ç½®ç½‘å…³åœ°å€IP ï¼ˆç½‘å…³ç›¸å½“äºä¸€ä¸ªè·¯ç”±å™¨ï¼‰ï¼Œæ³¨æ„ç½‘å…³ IP è¦å’Œå­ç½‘ IP å¤„äºåŒä¸€ä¸ªç½‘æ®µã€‚å¦‚192.168.200.x    </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170819/070502251.png"></p><h2 id="å¯¼å…¥é•œåƒæ–‡ä»¶"><a href="#å¯¼å…¥é•œåƒæ–‡ä»¶" class="headerlink" title="å¯¼å…¥é•œåƒæ–‡ä»¶"></a>å¯¼å…¥é•œåƒæ–‡ä»¶</h2><p>ä¾æ¬¡é€‰æ‹©èœå•ï¼Œ æ–‡ä»¶â€“&gt;æ‰“å¼€â€“&gt; æ‰¾åˆ°ä¸‹è½½é•œåƒè§£å‹çš„æ–‡ä»¶å¤¹ï¼Œé€‰æ‹©192.168.200.129.ovf æ–‡ä»¶  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170819/071206741.png"></p><p>è®¾ç½®è™šæ‹Ÿæœºåç§°å’Œè™šæ‹Ÿæœºä¿å­˜è·¯å¾„ï¼Œé€‰æ‹©å¯¼å…¥ã€‚</p><p>ç¨ç­‰ä¸€ä¼šå„¿å¯¼å…¥æˆåŠŸåï¼Œå¼€å¯è™šæ‹Ÿæœºã€‚</p><h2 id="è™šæ‹Ÿæœºç½‘ç»œé…ç½®"><a href="#è™šæ‹Ÿæœºç½‘ç»œé…ç½®" class="headerlink" title="è™šæ‹Ÿæœºç½‘ç»œé…ç½®"></a>è™šæ‹Ÿæœºç½‘ç»œé…ç½®</h2><p>ç™»å½•è´¦å·ï¼šroot   å¯†ç ï¼š123456</p><p>åˆšå®‰è£…å®Œæ˜¯æ— æ³• ping é€šå¤–ç½‘çš„ï¼Œéœ€è¦ä¿®æ”¹ç½‘ç»œé…ç½®ï¼Œ å½“å‰é•œåƒå·²ç»è®¾ç½®äº†é™æ€ ipï¼Œä¾¿äºä½¿ç”¨ã€‚</p><ol><li>ä¿®æ”¹ 70-persistent-net.rules æ–‡ä»¶  </li></ol><p><code>vi /etc/udev/rules.d/70-persistent-net.rules</code></p><p>æ³¨é‡Šæ‰ eth0 æ‰€åœ¨è¡Œï¼Œç»“æœåº”è¯¥ä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> PCI device 0x8086:0x100f (e1000)</span><br><span class="hljs-meta">#</span><span class="bash">SUBSYSTEM==<span class="hljs-string">&quot;net&quot;</span>, ACTION==<span class="hljs-string">&quot;add&quot;</span>, DRIVERS==<span class="hljs-string">&quot;?*&quot;</span>, ATTR&#123;address&#125;==<span class="hljs-string">&quot;00:0c:29:30:a4:b5&quot;</span>, ATTR&#123;<span class="hljs-built_in">type</span>&#125;==<span class="hljs-string">&quot;1&quot;</span>, KERNEL==<span class="hljs-string">&quot;eth*&quot;</span>, NAME=<span class="hljs-string">&quot;eth0&quot;</span></span><br><span class="hljs-meta">#</span><span class="bash"> PCI device 0x8086:0x100f (e1000)</span><br>SUBSYSTEM==&quot;net&quot;, ACTION==&quot;add&quot;, DRIVERS==&quot;?*&quot;, ATTR&#123;address&#125;==&quot;00:0c:29:cd:05:ea&quot;, ATTR&#123;type&#125;==&quot;1&quot;, KERNEL==&quot;eth*&quot;, NAME=&quot;eth1&quot;<br></code></pre></div></td></tr></table></figure><ol start="2"><li>ä¿®æ”¹ç½‘ç»œé…ç½®æ–‡ä»¶ï¼Œè®¾ç½®é™æ€IPåœ°å€å’Œç½‘å…³åœ°å€<br><code>vi /etc/sysconfig/network-scripts/ifcfg-eth0</code></li></ol><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">DEVICE=eth1 # ä¿®æ”¹eth0 ä¸ºeth1<br>TYPE=Ethernet<br>ONBOOT=yes<br>NM_CONTROLLED=yes<br>BOOTPROTO=static<br>IPADDR=192.168.200.132  # ä¿®æ”¹ä¸ºæƒ³è¦çš„é™æ€ipåœ°å€ï¼Œ å¦‚æœç½‘å…³åœ°å€ä¸º192.168.100.2  åˆ™ipåœ°å€ä¸º 192.168.100.x  xä¸º1-254ï¼Œä¸”ä¸ä¸ç½‘å…³åœ°å€é‡å¤<br>GATEWAY=192.168.200.2   # ä¿®æ”¹ä¸ºä½ è™šæ‹Ÿæœºçš„ç½‘å…³åœ°å€ IP<br>NAME=&quot;System eth0&quot;<br>NETMASK=255.255.255.0<br>DNS1=8.8.8.8<br>DNS2=4.4.4.4<br></code></pre></div></td></tr></table></figure><ol start="3"><li><p>é‡å¯è™šæ‹Ÿæœº  <strong>reboot</strong> è¿™æ˜¯å¿…é¡»çš„æ­¥éª¤ï¼</p></li><li><p>æ£€éªŒæ˜¯å¦ä¿®æ”¹ç”Ÿæ•ˆ</p><p>é‡å¯ç™»å½•æˆåŠŸåï¼Œ è¾“å…¥ <strong>ip addr</strong>ï¼Œ å¦‚æœä½ æ˜¾ç¤ºçš„å’Œæˆ‘ä¸€è‡´ï¼Œåˆ™æ˜¯æ­£ç¡®çš„ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170819/072943215.png"></p></li></ol><p>å¦‚æœä½ çš„å‡ºç°äº†ä¸¤æ¡ inetï¼Œ è¯´æ˜ç¬¬ 1 æ­¥ï¼Œ å’Œç¬¬ 2 æ­¥æ²¡æœ‰é…ç½®æ­£ç¡®ã€‚æ­¤æ—¶ <strong>ping</strong> ä¸€ä¸‹ç™¾åº¦ï¼Œå‘ç°å·²ç»å¯ä»¥ ping é€šäº†ã€‚  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170819/073150774.png"></p><p>è‡³æ­¤ï¼Œè™šæ‹Ÿæœºå·²ç»é…ç½®å¥½äº†ã€‚å¯ä»¥é€šè¿‡ SSH è½¯ä»¶è¿›è¡Œè¿æ¥äº†ã€‚</p><p>å»ºè®®ï¼šè™šæ‹Ÿæœºå®‰è£…å®Œæˆåï¼Œå¯¹å…¶è¿›è¡Œå¿«ç…§ï¼Œé˜²æ­¢å¼„åäº†è¿˜éœ€è¦é‡æ–°å®‰è£…ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170819/073454049.png"></p><p>åœ¨å¿«ç…§ç®¡ç†å™¨ä¸­ï¼Œå¯ä»¥é€‰æ‹©ä¿å­˜çš„å¿«ç…§ï¼Œè¿˜åŸåˆ°å¿«ç…§æ—¶çš„ç³»ç»Ÿã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æœåŠ¡å™¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>centos</tag>
      
      <tag>è™šæ‹Ÿæœº</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaä¹‹wordå¯¼å‡ºä¸‹è½½</title>
    <link href="/Java%E4%B9%8Bword%E5%AF%BC%E5%87%BA%E4%B8%8B%E8%BD%BD.html"/>
    <url>/Java%E4%B9%8Bword%E5%AF%BC%E5%87%BA%E4%B8%8B%E8%BD%BD.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘é‡åˆ°é¡¹ç›®éœ€æ±‚éœ€è¦å°†æ•°æ®åº“ä¸­çš„éƒ¨åˆ†æ•°æ®å¯¼å‡ºåˆ° word ä¸­ï¼Œå…·ä½“æ˜¯åœ¨ä¸€ä¸ªæ–°é—»åˆ—è¡¨ä¸­å°†é€‰ä¸­çš„æ–°é—»å¯¼å‡ºåˆ°ä¸€ä¸ª word ä¸­ã€‚å‚è€ƒäº†ç½‘ä¸Šä¸€äº›æ•™ç¨‹ï¼Œå®ç°äº†è¯¥åŠŸèƒ½ï¼Œåœ¨æ­¤è®°å½•ä¸‹æ¥ã€‚</p><a id="more"></a><p>å¯¼å‡ºç»“æœå¦‚ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170726/222116065.png"></p><p>å›¾ä¸­ä¸ºå¯¼å‡ºçš„å…¶ä¸­ä¸¤æ¡æ–°é—»ã€‚</p><p>æœç´¢ç½‘ä¸Šå¯¼å‡º word çš„æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œä½†æ˜¯å¾ˆå¤šéƒ½æ˜¯ä¸€ç¬”å¸¦è¿‡ï¼Œæœ‰ç¤ºä¾‹ä»£ç çš„åªæ‰¾åˆ°äº† POI å¯¼å‡ºï¼Œå’Œé€šè¿‡ FreeMarker æ–¹å¼å¯¼å‡ºï¼Œä½†æ˜¯åªæ˜¯å…·æœ‰å‚è€ƒæ„ä¹‰ã€‚æœ¬æ–‡é‡‡å–ä½¿ç”¨ FreeMark æ–¹å¼ã€‚</p><h2 id="å®ç°æ­¥éª¤"><a href="#å®ç°æ­¥éª¤" class="headerlink" title="å®ç°æ­¥éª¤"></a>å®ç°æ­¥éª¤</h2><ol><li><p>Maven å·¥ç¨‹å¼•å…¥FreeMarker çš„ä¾èµ–ï¼Œé Maven å·¥ç¨‹æ·»åŠ  jar åŒ…</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.freemarker<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>freemarker<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.3.26-incubating<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure></li><li><p>åˆ›å»º word æ¨¡æ¿</p><ol><li><p>æ–°å»º word æ›¿æ¢å†…å®¹ä¸ºå ä½ç¬¦  </p><p> <img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170726/223450741.png"></p></li><li><p>å¦å­˜æ¨¡æ¿ä¸º XML æ–‡ä»¶  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170726/223613199.png"></p></li><li><p>ä½¿ç”¨ NotePad++ æ‰“å¼€ xml æ–‡ä»¶</p></li><li><p>é€‰ä¸­å…¨éƒ¨å†…å®¹ï¼Œåˆ°<a href="http://tool.oschina.net/codeformat/xml">è¿™é‡Œ</a>è¿›è¡Œæ ¼å¼åŒ–</p></li><li><p>å°†åŸå†…å®¹æ›¿æ¢ä¸ºæ ¼å¼åŒ–åçš„å†…å®¹</p></li><li><p>å› ä¸ºæˆ‘çš„ word çš„å†…å®¹æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ‰€ä»¥éœ€è¦æ·»åŠ ä¸€ä¸ª freemarer æ ‡ç­¾æ ‡è¯†</p></li><li><p>æ‰¾åˆ°<code> &lt;w:document&gt;</code> å…ƒç´ ä¸‹é¢çš„ <code>&lt;w:body&gt;</code> å…ƒç´ ï¼Œæ·»åŠ <code> &lt;#list newsList news&gt;</code> ï¼Œ å¹¶åœ¨<code>&lt;/w:body&gt;</code>ç»“æŸæ ‡ç­¾ä¹‹å‰é—­åˆ <code>&lt;/#list&gt;</code>ï¼Œ æ­¤å¤„çš„ <strong>newsList</strong> ä¸ºåå°è¯»å–æ¨¡æ¿æ—¶éœ€è¦éœ€è¦æ¸²æŸ“æ•°æ®mapé›†åˆçš„keyï¼Œ å…¶æ‰€å¯¹åº”çš„æ˜¯ä¸€ä¸ªlisté›†åˆã€‚  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170726/224610046.png"></p></li><li><p> æ›¿æ¢æ¨¡æ¿ä¸­çš„å ä½ç¬¦ <code>&lt;w:t&gt;$&#123;news.title&#125;&lt;/w:t&gt;</code> ä¸ <code>&lt;w:t&gt;$&#123;news.content&#125;&lt;/w:t&gt;</code> ä¸ºéå†é›†åˆçš„å€¼ï¼Œè¿™é‡Œçš„ FreeMarker è¯­æ³•å¯ä»¥å‚è€ƒç½‘ä¸Šçš„æ•™ç¨‹ã€‚</p></li><li><p>ä¿å­˜ä¸º FreeMarker çš„æ¨¡æ¿æ–‡ä»¶ï¼Œåç¼€ä¸º ftl æ ¼å¼ï¼Œæ‹·è´åˆ°é¡¹ç›®ä¸­  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170726/224037421.png"></p></li></ol></li><li><p>ç¼–å†™ä»£ç </p><ol><li>ä»æ•°æ®ä¸­æŸ¥è¯¢æ•°æ®é›†åˆæ”¾å…¥Mapä¸­ï¼Œ è°ƒç”¨å·¥å…·æ–¹æ³•ï¼Œè¿”å›æµ<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">Map&lt;String, Object&gt; root = <span class="hljs-keyword">new</span> HashMap&lt;String, Object&gt;();<br>root.put(<span class="hljs-string">&quot;newsList&quot;</span>, newsList);<span class="hljs-comment">//newsListä¸ºæ–°é—»å¯¹è±¡é›†åˆ</span><br>String template = <span class="hljs-string">&quot;/temp.ftl&quot;</span>;  <span class="hljs-comment">//æ¨¡æ¿æ–‡ä»¶çš„åœ°å€</span><br>ByteArrayOutputStream outputStream = WordUtil.process(root, template);<br><span class="hljs-keyword">return</span> outputStream;<br></code></pre></div></td></tr></table></figure></li><li>è°ƒç”¨ä¸‹è½½å·¥å…·ç±»è¿›è¡Œä¸‹è½½å³å¯ã€‚<figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java">DownloadUtil.download(byteArrayOutputStream, response, returnname);<br></code></pre></div></td></tr></table></figure></li></ol><p>æ³¨ï¼šåœ¨å®ç°åŠŸèƒ½çš„æ—¶å€™ï¼Œç”±äºé‡‡å–çš„æ˜¯ ajax è¯·æ±‚æ–¹å¼ï¼Œå¯¼è‡´åªæ˜¯å°†æµå†™å…¥ Response æ—¶ï¼Œ Response ä¸º xml æ ¼å¼çš„æ•°æ®ã€‚ä½†æ˜¯æƒ³è¦å®ç°çš„æ•ˆæœæ˜¯å¼¹å‡ºä¸‹è½½æ¡†ï¼Œä¸‹è½½ word æ–‡æ¡£ã€‚æœ€åæŸ¥è¯¢èµ„æ–™ï¼Œä¿®æ”¹ajaxè¯·æ±‚ä¸ºformè¡¨å•æäº¤æ–¹å¼(ajax form)ï¼Œæ‰å¼¹å‡ºä¸‹è½½æ¡†å®ç°äº†åŠŸèƒ½ã€‚</p></li></ol><h2 id="æ–‡ç« æ¶‰åŠå·¥å…·ç±»"><a href="#æ–‡ç« æ¶‰åŠå·¥å…·ç±»" class="headerlink" title="æ–‡ç« æ¶‰åŠå·¥å…·ç±»"></a>æ–‡ç« æ¶‰åŠå·¥å…·ç±»</h2><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">//WordUtil.java</span><br><span class="hljs-keyword">import</span> java.io.BufferedWriter;<br><span class="hljs-keyword">import</span> java.io.ByteArrayOutputStream;<br><span class="hljs-keyword">import</span> java.io.OutputStreamWriter;<br><span class="hljs-keyword">import</span> java.io.Writer;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-keyword">import</span> freemarker.template.Configuration;<br><span class="hljs-keyword">import</span> freemarker.template.Template;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WordUtil</span> </span>&#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Configuration configuration = <span class="hljs-keyword">null</span>;<br><br>  <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-title">WordUtil</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> AssertionError();<br>  &#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * æ ¹æ®æ¨¡æ¿ç”Ÿæˆç›¸åº”çš„æ–‡ä»¶</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> root ä¿å­˜æ•°æ®çš„map</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> template æ¨¡æ¿æ–‡ä»¶çš„åœ°å€</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> path ç”Ÿæˆçš„wordæ–‡æ¡£è¾“å‡ºåœ°å€</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> ByteArrayOutputStream <span class="hljs-title">process</span><span class="hljs-params">(Map&lt;?, ?&gt; root, String template)</span> </span>&#123;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == root ) &#123;<br>  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;æ•°æ®ä¸èƒ½ä¸ºç©º&quot;</span>);<br>&#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == template) &#123;<br>  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(<span class="hljs-string">&quot;æ¨¡æ¿æ–‡ä»¶ä¸èƒ½ä¸ºç©º&quot;</span>);<br>&#125;<br><br>ByteArrayOutputStream outputStream = <span class="hljs-keyword">new</span> ByteArrayOutputStream();<br>String templatePath = template.substring(<span class="hljs-number">0</span>, template.lastIndexOf(<span class="hljs-string">&quot;/&quot;</span>));<br>String templateName = template.substring(template.lastIndexOf(<span class="hljs-string">&quot;/&quot;</span>) + <span class="hljs-number">1</span>, template.length());<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">null</span> == configuration) &#123;<br>  configuration = <span class="hljs-keyword">new</span> Configuration(Configuration.VERSION_2_3_23);  <span class="hljs-comment">// è¿™é‡ŒConfigurantionå¯¹è±¡ä¸èƒ½æœ‰ä¸¤ä¸ªï¼Œå¦åˆ™å¤šçº¿ç¨‹è®¿é—®ä¼šæŠ¥é”™</span><br>  configuration.setDefaultEncoding(<span class="hljs-string">&quot;utf-8&quot;</span>);<br>  configuration.setClassicCompatible(<span class="hljs-keyword">true</span>);<br>&#125;<br>configuration.setClassForTemplateLoading(WordUtil.class, templatePath);<br><br>Template t = <span class="hljs-keyword">null</span>;<br><span class="hljs-keyword">try</span> &#123;<br>  t = configuration.getTemplate(templateName);<br>  Writer w = <span class="hljs-keyword">new</span> BufferedWriter(<span class="hljs-keyword">new</span> OutputStreamWriter(outputStream, <span class="hljs-string">&quot;utf-8&quot;</span>));<br>  t.process(root, w);  <span class="hljs-comment">// è¿™é‡Œwæ˜¯ä¸€ä¸ªè¾“å‡ºåœ°å€ï¼Œå¯ä»¥è¾“å‡ºåˆ°ä»»ä½•ä½ç½®ï¼Œå¦‚æ§åˆ¶å°ï¼Œç½‘é¡µç­‰</span><br>  w.close();<br>&#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e);<br>&#125;<br><span class="hljs-keyword">return</span> outputStream;<br>  &#125;<br><br>&#125;<br></code></pre></div></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-comment">//DownloadUtil.java</span><br><span class="hljs-keyword">import</span> java.io.ByteArrayOutputStream;<br><span class="hljs-keyword">import</span> java.io.File;<br><span class="hljs-keyword">import</span> java.io.FileInputStream;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.OutputStream;<br><br><span class="hljs-keyword">import</span> javax.servlet.ServletOutputStream;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><br><span class="hljs-keyword">import</span> org.apache.commons.io.FileUtils;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DownloadUtil</span> </span>&#123;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> byteArrayOutputStream å°†æ–‡ä»¶å†…å®¹å†™å…¥ByteArrayOutputStream</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> response HttpServletResponseå†™å…¥response</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> returnName è¿”å›çš„æ–‡ä»¶å</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">download</span><span class="hljs-params">(ByteArrayOutputStream byteArrayOutputStream, HttpServletResponse response, String returnName)</span> <span class="hljs-keyword">throws</span> IOException</span>&#123;<br>  response.setContentType(<span class="hljs-string">&quot;application/msword&quot;</span>);<br>  response.setHeader(<span class="hljs-string">&quot;Content-Disposition&quot;</span>, <span class="hljs-string">&quot;attachment; filename=&quot;</span> + returnName);<br>  response.setContentLength(byteArrayOutputStream.size());<br>  OutputStream outputstream = response.getOutputStream();<span class="hljs-comment">//å–å¾—è¾“å‡ºæµ</span><br>  byteArrayOutputStream.writeTo(outputstream);<span class="hljs-comment">//å†™åˆ°è¾“å‡ºæµ</span><br>  byteArrayOutputStream.close();<span class="hljs-comment">//å…³é—­</span><br>  outputstream.flush();<span class="hljs-comment">//åˆ·æ•°æ®</span><br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h2 id="æºç ä¸‹è½½"><a href="#æºç ä¸‹è½½" class="headerlink" title="æºç ä¸‹è½½"></a>æºç ä¸‹è½½</h2><p><a href="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/wordDemo.zip">ç‚¹æˆ‘ä¸‹è½½</a></p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul><li><a href="http://itindex.net/detail/55080-springboot-freemarker-%E6%A0%BC%E5%BC%8F">http://itindex.net/detail/55080-springboot-freemarker-%E6%A0%BC%E5%BC%8F</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>word</tag>
      
      <tag>freemarker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaé…ç½®åˆ†ç¦»ä¹‹Springè¿œç¨‹é…ç½®</title>
    <link href="/Java%E9%85%8D%E7%BD%AE%E5%88%86%E7%A6%BB%E4%B9%8B%E8%BF%9C%E7%A8%8B%E9%85%8D%E7%BD%AE.html"/>
    <url>/Java%E9%85%8D%E7%BD%AE%E5%88%86%E7%A6%BB%E4%B9%8B%E8%BF%9C%E7%A8%8B%E9%85%8D%E7%BD%AE.html</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>é›†ç¾¤åº”ç”¨çš„é…ç½®æ–‡ä»¶å¦‚æœå†™åœ¨é¡¹ç›®çš„ <strong>resources</strong> ç›®å½•ä¸‹é¢ï¼Œå½“é‡åˆ°éœ€è¦ä¿®æ”¹æŸä¸€ä¸ªé…ç½®å€¼æ—¶ï¼Œéœ€è¦å°†é›†ç¾¤çš„æ‰€æœ‰åº”ç”¨çš„é…ç½®ä¿¡æ¯è¿›è¡Œä¿®æ”¹ï¼Œå¹¶ä¸”å°†æœºå¯†çš„é…ç½®ä¿¡æ¯æ¯”å¦‚æ•°æ®åº“è´¦å·å¯†ç å¦‚æœä¸è¿›è¡ŒåŠ å¯†é…ç½®åœ¨é¡¹ç›®ä¸­å¾ˆå±é™©ï¼Œä¸€æ—¦å‘ç”Ÿä»£ç æ³„éœ²é—®é¢˜ï¼Œåæœå¾ˆä¸¥é‡ã€‚</p><p>ä¸ºäº†é¿å…ä¸Šè¿°æƒ…å†µå‘ç”Ÿï¼Œå°†é…ç½®ä¿¡æ¯å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œæ¯”å¦‚æ•°æ®åº“è¿æ¥ã€ç”¨æˆ·åã€ä»¥åŠå¯†ç ï¼Œé€šè¿‡ Config é¡¹ç›®çš„ä¸€ä¸ª<strong>æ¥å£</strong>æä¾›è·å–é…ç½®ä¿¡æ¯ã€‚Config é¡¹ç›®åªç”¨äºè¯»å–é…ç½®ä¿¡æ¯ã€‚</p><a id="more"></a><h2 id="è¿œç¨‹é…ç½®"><a href="#è¿œç¨‹é…ç½®" class="headerlink" title="è¿œç¨‹é…ç½®"></a>è¿œç¨‹é…ç½®</h2><p>ä¸€ï¼‰æ–°å»ºç±» <strong>RemoteProperties</strong>   </p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSONArray;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSONObject;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RemoteProperties</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">InitializingBean</span>, <span class="hljs-title">FactoryBean</span>&lt;<span class="hljs-title">Properties</span>&gt; </span>&#123;<br><br>    <span class="hljs-keyword">private</span> String url = <span class="hljs-keyword">null</span>;<br><br>    <span class="hljs-keyword">private</span> Properties properties = <span class="hljs-keyword">new</span> Properties();<br><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Properties <span class="hljs-title">getObject</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        <span class="hljs-keyword">return</span> properties;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Class&lt;?&gt; getObjectType() &#123;<br>        <span class="hljs-keyword">return</span> properties.getClass();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isSingleton</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterPropertiesSet</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br>        loadProperty();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getUrl</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> url;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUrl</span><span class="hljs-params">(String url)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.url = url;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">loadProperty</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (StringUtil.strIsNull(url)) <span class="hljs-keyword">return</span>;<br>        String content = HttpClientUtil.urlGet(url);<br><br>        JSONObject object = JSONObject.parseObject(content);<br>        JSONArray data = object.getJSONArray(<span class="hljs-string">&quot;datasource&quot;</span>);<br>        <span class="hljs-keyword">for</span> (Object obj : data) &#123;<br>            JSONObject jsonObject = (JSONObject) obj;<br>            String key = obj.getString(<span class="hljs-string">&quot;key&quot;</span>);<br>            String value = obj.getString(<span class="hljs-string">&quot;value&quot;</span>);<br>            properties.put(key, value);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ­¤ç±»ç”¨äºå‘é€è¯·æ±‚è·å–é…ç½®ä¿¡æ¯ï¼Œè¯·æ±‚è¿”å›æ ¼å¼ä¸º JSON çš„é…ç½®ä¿¡æ¯, å¦‚ï¼š</p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json">&#123;<br>    <span class="hljs-attr">&quot;datasource&quot;</span>:[<br>        &#123;<br>            <span class="hljs-attr">&quot;value&quot;</span>:<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>,<br>            <span class="hljs-attr">&quot;key&quot;</span>:<span class="hljs-string">&quot;jdbc.driver&quot;</span><br>        &#125;,<br>        &#123;<br>            <span class="hljs-attr">&quot;value&quot;</span>:<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=utf8&quot;</span>,<br>            <span class="hljs-attr">&quot;key&quot;</span>:<span class="hljs-string">&quot;jdbc.url&quot;</span><br>        &#125;,<br>        &#123;<br>            <span class="hljs-attr">&quot;value&quot;</span>:<span class="hljs-string">&quot;root&quot;</span>,<br>            <span class="hljs-attr">&quot;key&quot;</span>:<span class="hljs-string">&quot;jdbc.username&quot;</span><br>        &#125;,<br>        &#123;<br>            <span class="hljs-attr">&quot;value&quot;</span>:<span class="hljs-string">&quot;root&quot;</span>,<br>            <span class="hljs-attr">&quot;key&quot;</span>:<span class="hljs-string">&quot;jdbc.password&quot;</span><br>        &#125;<br>    ]<br>&#125;<br></code></pre></div></td></tr></table></figure><p>äºŒï¼‰ç¼–å†™ Spring é…ç½®æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br>&lt;beans<br>xmlns=&quot;http://www.springframework.org/schema/beans&quot;<br>xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;<br>xmlns:context=&quot;http://www.springframework.org/schema/context&quot;<br>xmlns:dubbo=&quot;http://code.alibabatech.com/schema/dubbo&quot;<br>xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;<br>xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:p=&quot;http://www.springframework.org/schema/p&quot;<br>xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd<br>http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd<br>http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd<br>            http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd<br>            http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd&quot;&gt;<br><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;propertyConfigurerUserServer&quot;</span></span><br><span class="hljs-tag">  <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;properties&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;remoteProperties&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.craft.partner.server.util.RemoteProperties&quot;</span>    </span><br><span class="hljs-tag"><span class="hljs-attr">p:url</span>=<span class="hljs-string">&quot;http://api.xxx.com/config&quot;</span>/&gt;</span><br><span class="hljs-comment">&lt;!--è¿œç¨‹é…ç½®æä¾›æ¥å£--&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><br><span class="hljs-comment">&lt;!--è¿˜å¯ä»¥åŠ è½½æœ¬åœ°çš„propertiesæ–‡ä»¶--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;locations&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">list</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>classpath:configure.properties<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">list</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span> <span class="hljs-attr">destroy-method</span>=<span class="hljs-string">&quot;close&quot;</span></span><br><span class="hljs-tag">  <span class="hljs-attr">p:driverClass</span>=<span class="hljs-string">&quot;$&#123;jdbc.driver&#125;&quot;</span> </span><br><span class="hljs-tag">  <span class="hljs-attr">p:jdbcUrl</span>=<span class="hljs-string">&quot;$&#123;jdbc.url&#125;&quot;</span></span><br><span class="hljs-tag">  <span class="hljs-attr">p:user</span>=<span class="hljs-string">&quot;$&#123;jdbc.username&#125;&quot;</span></span><br><span class="hljs-tag">  <span class="hljs-attr">p:password</span>=<span class="hljs-string">&quot;$&#123;jdbc.password&#125;&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;initialPoolSize&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;10&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;minPoolSize&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;10&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxPoolSize&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;50&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxStatements&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;0&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;maxIdleTime&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;600&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;idleConnectionTestPeriod&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;300&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;acquireIncrement&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;5&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;autoCommitOnClose&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;checkoutTimeout&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;2000&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;transactionManager&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">tx:advice</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;txAdvice&quot;</span> <span class="hljs-attr">transaction-manager</span>=<span class="hljs-string">&quot;transactionManager&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">tx:attributes</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;save*&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;update*&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;delete*&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;find*&quot;</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;true&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;*&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span><span class="hljs-comment">&lt;!--å…¶ä»–ä¸ç¬¦åˆè§„èŒƒçš„æ–¹æ³•åªå…è®¸è¯»æ“ä½œ--&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">tx:attributes</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">tx:advice</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span> <span class="hljs-attr">expose-proxy</span>=<span class="hljs-string">&quot;false&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;serviceMethod&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* com.craft.partner.server.service.*.*(..))&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">aop:advisor</span> <span class="hljs-attr">advice-ref</span>=<span class="hljs-string">&quot;txAdvice&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;serviceMethod&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></div></td></tr></table></figure><p>æ³¨æ„ï¼š é€šè¿‡ <strong>p:url=â€åœ°å€â€</strong> çš„æ–¹å¼ï¼Œè°ƒç”¨ RemoteProperties çš„æ–¹æ³•ï¼Œå‘é€è¯·æ±‚è·å–é…ç½®ä¿¡æ¯ï¼Œé€šè¿‡ Spring è¿›è¡Œæ³¨å…¥ã€‚<br>æ³¨å…¥åï¼Œå¯ä»¥é€šè¿‡ <strong>p:å±æ€§</strong> çš„æ–¹å¼è·å–é…ç½®ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="http://www.cnblogs.com/yjmyzz/p/how-to-load-remote-config-in-spring.html">http://www.cnblogs.com/yjmyzz/p/how-to-load-remote-config-in-spring.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¿œç¨‹é…ç½®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaä¸Šä¼ å›¾ç‰‡åˆ°OSSçš„å®ç°</title>
    <link href="/Java%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E5%88%B0OSS%E7%9A%84%E5%AE%9E%E7%8E%B0.html"/>
    <url>/Java%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E5%88%B0OSS%E7%9A%84%E5%AE%9E%E7%8E%B0.html</url>
    
    <content type="html"><![CDATA[<p>å‰è¨€ï¼š  ä»¥å‰åšé¡¹ç›®ç”¨çš„éƒ½æ˜¯å¼€æºçš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå¦‚FastDFSã€‚<br>æœ€è¿‘å‡ å¹´ï¼Œéšç€äº‘çš„å‘å±•ï¼Œå›½å†…å¤–çš„å·¨å¤´å…¬å¸ä¹Ÿç›¸åº”çš„æ¨å‡ºäº†ç›¸å…³å•†ç”¨çš„ç±»ä¼¼äº§å“ã€‚<br>æ¯”å¦‚Amazon S3ï¼Œé˜¿é‡Œäº‘çš„OSSï¼Œè…¾è®¯äº‘çš„COSã€‚<br>ä»Šå¤©æˆ‘é€‰æ‹©ä½¿ç”¨é˜¿é‡Œäº‘çš„OSSæ¥ä½œä¸ºä¾‹å­ï¼Œæ¥å®ç°å›¾ç‰‡çš„ä¸Šä¼ ã€‚</p><a id="more"></a><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p><a href="https://help.aliyun.com/document_detail/32008.html">é˜¿é‡Œäº‘OSSå®˜æ–¹æ–‡æ¡£åœ°å€</a></p><h3 id="ä¸€ã€å¼€é€šé˜¿é‡Œäº‘OSS"><a href="#ä¸€ã€å¼€é€šé˜¿é‡Œäº‘OSS" class="headerlink" title="ä¸€ã€å¼€é€šé˜¿é‡Œäº‘OSS"></a>ä¸€ã€å¼€é€šé˜¿é‡Œäº‘OSS</h3><ol><li>ç™»å½•é˜¿é‡Œäº‘æ§åˆ¶å°å¼€é€šOSSæœåŠ¡ï¼Œå¹¶åˆ›å»º<code>AccessKeyId</code>å’Œ<code>AccessKeySecret</code></li><li>åœ¨OSSæ§åˆ¶é¢æ¿ä¸Šæ–°å»ºBucket<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170506/221118419.png"></li><li>è¿›å…¥æ–°å»ºçš„Bucket<br>é€‰æ‹©å·¦ä¾§çš„Objectç®¡ç†ï¼Œæ–°å»ºä¸€ä¸ª<code>img</code>çš„æ–‡ä»¶å¤¹ï¼Œä¾¿äºå­˜å‚¨å½’ç±»</li></ol><h3 id="äºŒã€mavené¡¹ç›®ä¸­å¼•å…¥ä¾èµ–"><a href="#äºŒã€mavené¡¹ç›®ä¸­å¼•å…¥ä¾èµ–" class="headerlink" title="äºŒã€mavené¡¹ç›®ä¸­å¼•å…¥ä¾èµ–"></a>äºŒã€mavené¡¹ç›®ä¸­å¼•å…¥ä¾èµ–</h3><p>åœ¨mavenå·¥ç¨‹ä¸­çš„pom.xmlæ·»åŠ ä¾èµ–  </p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.aliyun.oss<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>aliyun-sdk-oss<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.6.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h2 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h2><blockquote><p>æ³¨ï¼šæˆ‘æ‰€ä½¿ç”¨çš„çš„æ¡†æ¶æ˜¯ï¼šSpringMVC+Spring+Mybatis  </p></blockquote><h3 id="ä¸€ã€ä¸Šä¼ æ–‡ä»¶åˆ°OSSä¹‹HelloWorld"><a href="#ä¸€ã€ä¸Šä¼ æ–‡ä»¶åˆ°OSSä¹‹HelloWorld" class="headerlink" title="ä¸€ã€ä¸Šä¼ æ–‡ä»¶åˆ°OSSä¹‹HelloWorld"></a>ä¸€ã€ä¸Šä¼ æ–‡ä»¶åˆ°OSSä¹‹HelloWorld</h3><p>ä¸Šä¼ å›¾ç‰‡ä¹‹å‰ï¼Œå…ˆæƒ¯ä¾‹æ¥ä¸€ä¸ªHelloWorldç¤ºä¾‹ï¼  </p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.aliyun.oss.OSSClient;<br><span class="hljs-keyword">import</span> com.aliyun.oss.model.ObjectMetadata;<br><span class="hljs-keyword">import</span> com.aliyun.oss.model.PutObjectResult;<br><span class="hljs-keyword">import</span> com.nullpointer.common.Constants;<br><span class="hljs-keyword">import</span> com.nullpointer.service.AliyunOSSService;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><span class="hljs-keyword">import</span> org.springframework.web.multipart.MultipartFile;<br><br><span class="hljs-keyword">import</span> javax.annotation.PostConstruct;<br><span class="hljs-keyword">import</span> java.io.File;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.InputStream;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AliyunOSSServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AliyunOSSService</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String IMG = <span class="hljs-string">&quot;img/&quot;</span>;<span class="hljs-comment">//å¯¹åº”Objectçš„æ–‡ä»¶å¤¹åç§°</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> maxLength = <span class="hljs-number">5</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>;<span class="hljs-comment">//ç®€å•ä¸Šä¼ OSSé™åˆ¶ä¸º5Gä»¥ä¸‹</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String ENDPOINT = File.separatorChar == <span class="hljs-string">&#x27;/&#x27;</span> ? <span class="hljs-string">&quot;oss-cn-hangzhou-internal.aliyuncs.com&quot;</span> : <span class="hljs-string">&quot;http://oss-cn-hangzhou.aliyuncs.com&quot;</span>;<span class="hljs-comment">//ç”¨äºé€‰æ‹©ä¸åŒçš„åŸŸå</span><br><br>    <span class="hljs-keyword">private</span> OSSClient client;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String bucketName;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆå§‹åŒ–OSSClient</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@PostConstruct</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>&#123;<br>        String accessId = <span class="hljs-string">&quot;xxxxxxxxxxxxx&quot;</span>;<span class="hljs-comment">//ä½ çš„AccessIdï¼Œ åœ¨OSSæ§åˆ¶å°å¯ä»¥ç”Ÿæˆ</span><br>        String accessKey = <span class="hljs-string">&quot;xxxxxxxxxxxxxxxxx&quot;</span>;<span class="hljs-comment">//ä½ çš„AccessKey</span><br>        bucketName = <span class="hljs-string">&quot;xxxxx&quot;</span>;<span class="hljs-comment">//åˆ›å»ºçš„Bucketçš„åç§°ï¼Œæ³¨æ„è¦ä¸€è‡´åŒºåˆ†å¤§å°å†™</span><br><br>        client = <span class="hljs-keyword">new</span> OSSClient(ENDPOINT, accessId, accessKey);<span class="hljs-comment">//åˆå§‹åŒ–</span><br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">uploadIm</span><span class="hljs-params">()</span> </span>&#123;<br>        String content = <span class="hljs-string">&quot;Hello OSS&quot;</span>;<br>        PutObjectResult test01 = client.putObject(bucketName, <span class="hljs-string">&quot;test01&quot;</span>, <span class="hljs-keyword">new</span> ByteArrayInputStream(content.getBytes()));<br>        <span class="hljs-keyword">return</span> test01.getETag();<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>æ‰“å¼€OSSæ§åˆ¶å°çš„Objectç®¡ç†ï¼Œæ˜¯ä¸æ˜¯å‘ç°æ–°å¢äº†ä¸€ä¸ªæ–‡ä»¶å‘¢ï¼Ÿ<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170506/222456581.png"></p><h3 id="äºŒã€ç¼–å†™å›¾ç‰‡ä¸Šä¼ æœåŠ¡ç±»"><a href="#äºŒã€ç¼–å†™å›¾ç‰‡ä¸Šä¼ æœåŠ¡ç±»" class="headerlink" title="äºŒã€ç¼–å†™å›¾ç‰‡ä¸Šä¼ æœåŠ¡ç±»"></a>äºŒã€ç¼–å†™å›¾ç‰‡ä¸Šä¼ æœåŠ¡ç±»</h3><p>HelloWorldç¤ºä¾‹å®Œæˆäº†ï¼Œå¼€å§‹æ­£å¼ç¼–å†™å›¾ç‰‡ä¸Šä¼ ä»£ç äº†ã€‚æ³¨é‡Šéƒ½æœ‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AliyunOSSServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AliyunOSSService</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String IMG = <span class="hljs-string">&quot;img/&quot;</span>;<span class="hljs-comment">//å¯¹åº”Objectçš„æ–‡ä»¶å¤¹åç§°</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> maxLength = <span class="hljs-number">5</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>;<span class="hljs-comment">//ç®€å•ä¸Šä¼ OSSé™åˆ¶ä¸º5Gä»¥ä¸‹</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String ENDPOINT = File.separatorChar == <span class="hljs-string">&#x27;/&#x27;</span> ? <span class="hljs-string">&quot;oss-cn-hangzhou-internal.aliyuncs.com&quot;</span> : <span class="hljs-string">&quot;http://oss-cn-hangzhou.aliyuncs.com&quot;</span>;<span class="hljs-comment">//ç”¨äºé€‰æ‹©ä¸åŒçš„åŸŸå</span><br><br>    <span class="hljs-keyword">private</span> OSSClient client;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String bucketName;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆå§‹åŒ–OSSClient</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@PostConstruct</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>&#123;<br>        String accessId = <span class="hljs-string">&quot;xxxxxxxxxxxxx&quot;</span>;<span class="hljs-comment">//ä½ çš„AccessIdï¼Œ åœ¨OSSæ§åˆ¶å°å¯ä»¥ç”Ÿæˆ</span><br>        String accessKey = <span class="hljs-string">&quot;xxxxxxxxxxxxxxxxx&quot;</span>;<span class="hljs-comment">//ä½ çš„AccessKey</span><br>        bucketName = <span class="hljs-string">&quot;xxxxx&quot;</span>;<span class="hljs-comment">//åˆ›å»ºçš„Bucketçš„åç§°ï¼Œæ³¨æ„è¦ä¸€è‡´åŒºåˆ†å¤§å°å†™</span><br><br>        client = <span class="hljs-keyword">new</span> OSSClient(ENDPOINT, accessId, accessKey);<span class="hljs-comment">//åˆå§‹åŒ–</span><br>    &#125;<br><br><br>    <span class="hljs-comment">/*public String uploadIm() &#123;</span><br><span class="hljs-comment">        String content = &quot;Hello OSS&quot;;</span><br><span class="hljs-comment">        PutObjectResult test01 = client.putObject(bucketName, &quot;test01&quot;, new ByteArrayInputStream(content.getBytes()));</span><br><span class="hljs-comment">        return test01.getETag();</span><br><span class="hljs-comment">    &#125;*/</span><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">saveImage</span><span class="hljs-params">(MultipartFile file)</span> </span>&#123;<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            String fileName = <span class="hljs-keyword">this</span>.saveImage(file.getSize(), file.getOriginalFilename(), file.hashCode(), file.getInputStream());<br>            <span class="hljs-keyword">return</span> getHttpUrl(fileName);<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">getHttpUrl</span><span class="hljs-params">(String fileName)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> Constants.OSS_HTTP + <span class="hljs-string">&quot;/&quot;</span> + IMG + fileName;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">saveImage</span><span class="hljs-params">(<span class="hljs-keyword">long</span> size, String extName, <span class="hljs-keyword">int</span> hashCode, InputStream is)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (size &gt; maxLength)<span class="hljs-comment">//è¶…è¿‡5G</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br><br>        String name = extName.toLowerCase();<br>        name = name.substring(name.indexOf(<span class="hljs-string">&quot;.&quot;</span>));<span class="hljs-comment">//è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åç¼€åç§°å¦‚ .jpg</span><br>        String fileName = System.currentTimeMillis() + <span class="hljs-string">&quot;_&quot;</span> + hashCode + name;<span class="hljs-comment">//ä¸ºäº†é˜²æ­¢é‡å¤ï¼Œ ä½¿ç”¨æ—¶é—´æˆ³+hashcodeçš„æ–¹å¼æ¥å‘½å</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.saveImage(size, fileName, is);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">saveImage</span><span class="hljs-params">(<span class="hljs-keyword">long</span> size, String fileName, InputStream is)</span> </span>&#123;<br>        String key = IMG + fileName;<span class="hljs-comment">//ä¿å­˜åˆ°imgæ–‡ä»¶å¤¹ä¸‹</span><br>        <span class="hljs-keyword">this</span>.uploadObject(key, size, is);<br>        <span class="hljs-keyword">return</span> fileName;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">uploadObject</span><span class="hljs-params">(String key, <span class="hljs-keyword">long</span> size, InputStream is)</span> </span>&#123;<br>        ObjectMetadata metadata = <span class="hljs-keyword">new</span> ObjectMetadata();<span class="hljs-comment">//è®¾ç½®æ–‡ä»¶çš„metaä¿¡æ¯</span><br>        metadata.setContentLength(size);<br>        metadata.setContentType(<span class="hljs-string">&quot;image/jpeg&quot;</span>);<br><br>        PutObjectResult result = client.putObject(bucketName, key, is);<span class="hljs-comment">//è°ƒç”¨SDKçš„ä¸Šä¼ æ–¹æ³•</span><br>        System.out.println(result);<br>    &#125;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h3 id="ä¸‰ã€ç¼–å†™Controllerå±‚çš„ä¸Šä¼ æ¥å£"><a href="#ä¸‰ã€ç¼–å†™Controllerå±‚çš„ä¸Šä¼ æ¥å£" class="headerlink" title="ä¸‰ã€ç¼–å†™Controllerå±‚çš„ä¸Šä¼ æ¥å£"></a>ä¸‰ã€ç¼–å†™Controllerå±‚çš„ä¸Šä¼ æ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@RequestMapping(value = &quot;/upload&quot;, method = RequestMethod.POST)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">uploadOSS</span><span class="hljs-params">(MultipartFile pic, HttpServletResponse response,  Model model)</span> <span class="hljs-keyword">throws</span> Exception </span>&#123;<br><br>    String imgUrl = aliyunOSSService.saveImage(pic);<br>    System.out.println(<span class="hljs-string">&quot;path = &quot;</span> + imgUrl);<br><br>    <span class="hljs-comment">//å›¾ç‰‡å›æ˜¾</span><br>    JSONObject jsonObject = <span class="hljs-keyword">new</span> JSONObject();<br>    jsonObject.put(<span class="hljs-string">&quot;path&quot;</span>, imgUrl);<br>    response.setContentType(<span class="hljs-string">&quot;application/json;charset=UTF-8&quot;</span>);<br>    response.getWriter().write(jsonObject.toString());<br>&#125;<br></code></pre></div></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå…¥å‚ä¸­çš„MultipartFIleæ˜¯ä¸€ä¸ªæ¥å£ï¼Œéœ€è¦åœ¨Springçš„é…ç½®æ–‡ä»¶<code>applicationContext.xml</code>ä¸­å°†å…¶å®ç°ç±»æ³¨å…¥ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;multipartResolver&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span>/&gt;</span><br></code></pre></div></td></tr></table></figure><h3 id="å››ã€ç¼–å†™é¡µé¢JSP"><a href="#å››ã€ç¼–å†™é¡µé¢JSP" class="headerlink" title="å››ã€ç¼–å†™é¡µé¢JSP"></a>å››ã€ç¼–å†™é¡µé¢JSP</h3><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;<br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/static/js/jquery.js&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;/static/js/jquery.form.js&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br>    &lt;%@ page isELIgnored=&quot;false&quot; %&gt;<br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>home<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;application/javascript&quot;</span>&gt;</span><br><span class="javascript">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">uploadPic</span>(<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">            <span class="hljs-keyword">var</span> options = &#123;</span><br><span class="javascript">                url: <span class="hljs-string">&quot;/upload&quot;</span>,</span><br><span class="javascript">                type: <span class="hljs-string">&quot;POST&quot;</span>,</span><br><span class="javascript">                dataType: <span class="hljs-string">&quot;json&quot;</span>,</span><br><span class="javascript">                success: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>&#123;</span><br><span class="javascript">                    $(<span class="hljs-string">&quot;#imgUrl&quot;</span>).attr(<span class="hljs-string">&quot;src&quot;</span>, data.path);</span><br>                &#125;<br>            &#125;<br><span class="javascript">            $(<span class="hljs-string">&quot;#jform&quot;</span>).ajaxSubmit(options);</span><br>        &#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container-fluid&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;row-fluid&quot;</span> <span class="hljs-attr">align</span>=<span class="hljs-string">&quot;content&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/uploadOSS&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;POST&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;jform&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;span12&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;img&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;img-polaroid&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;imgUrl&quot;</span>/&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;pic&quot;</span> <span class="hljs-attr">onchange</span>=<span class="hljs-string">&quot;uploadPic()&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></div></td></tr></table></figure><p>é¡µé¢ä¸æ˜¯æˆ‘æ‰€æ“…é•¿ï¼Œèƒ½æ˜¾ç¤ºæ•ˆæœå³å¯ã€‚</p><h3 id="äº”ã€æµ‹è¯•å›¾ç‰‡ä¸Šä¼ "><a href="#äº”ã€æµ‹è¯•å›¾ç‰‡ä¸Šä¼ " class="headerlink" title="äº”ã€æµ‹è¯•å›¾ç‰‡ä¸Šä¼ "></a>äº”ã€æµ‹è¯•å›¾ç‰‡ä¸Šä¼ </h3><p><strong>å¯åŠ¨é¡¹ç›®ï¼Œè¿›å…¥å›¾ç‰‡ä¸Šä¼ çš„é¡µé¢ã€‚</strong></p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170506/224108910.png"></p><p><strong>ä¸Šä¼ å›¾ç‰‡</strong><br>æ§åˆ¶å°æ‰“å°äº†å¦‚ä¸‹å†…å®¹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170506/224449951.png"></p><p>é¡µé¢æ˜¾ç¤ºï¼š<br><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170506/224526048.png"></p>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>OSS</tag>
      
      <tag>å¯¹è±¡å­˜å‚¨ç³»ç»Ÿ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nginxå®ç°Tomcaté›†ç¾¤</title>
    <link href="/Nginx%E5%AE%9E%E7%8E%B0Tomcat%E9%9B%86%E7%BE%A4.html"/>
    <url>/Nginx%E5%AE%9E%E7%8E%B0Tomcat%E9%9B%86%E7%BE%A4.html</url>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡ä»‹ç»äº†åˆ©ç”¨nginxæ­å»ºäº†ä¸€ä¸ªç®€å•çš„è´Ÿè½½å‡è¡¡ã€‚</p><a id="more"></a><h2 id="ä¸€ã€å‡†å¤‡å·¥ä½œ"><a href="#ä¸€ã€å‡†å¤‡å·¥ä½œ" class="headerlink" title="ä¸€ã€å‡†å¤‡å·¥ä½œ"></a>ä¸€ã€å‡†å¤‡å·¥ä½œ</h2><p>Linuxç³»ç»Ÿ: CentOS 7 x64</p><p>Nginxç‰ˆæœ¬:1.12.0</p><p>Tomcatç‰ˆæœ¬: 7.0.77</p><h2 id="äºŒã€å®‰è£…"><a href="#äºŒã€å®‰è£…" class="headerlink" title="äºŒã€å®‰è£…"></a>äºŒã€å®‰è£…</h2><h3 id="CentOS-å¿«é€Ÿå®‰è£…ï¼Œè§æˆ‘å¦å¤–ä¸€ç¯‡æ–‡ç« CentOSå¿«é€Ÿå®‰è£…"><a href="#CentOS-å¿«é€Ÿå®‰è£…ï¼Œè§æˆ‘å¦å¤–ä¸€ç¯‡æ–‡ç« CentOSå¿«é€Ÿå®‰è£…" class="headerlink" title="CentOS å¿«é€Ÿå®‰è£…ï¼Œè§æˆ‘å¦å¤–ä¸€ç¯‡æ–‡ç« CentOSå¿«é€Ÿå®‰è£…"></a>CentOS å¿«é€Ÿå®‰è£…ï¼Œè§æˆ‘å¦å¤–ä¸€ç¯‡æ–‡ç« <a href="http://nullpointer.pw/2017/08/19/CentOS%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85/">CentOSå¿«é€Ÿå®‰è£…</a></h3><h3 id="å®‰è£…Nginxä¾èµ–"><a href="#å®‰è£…Nginxä¾èµ–" class="headerlink" title="å®‰è£…Nginxä¾èµ–"></a>å®‰è£…Nginxä¾èµ–</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> gcc ç”¨æ¥ç¼–è¯‘nginx</span><br>yum install gcc-c++<br><br><span class="hljs-meta">#</span><span class="bash"> PCRE nginxçš„httpæ¨¡å—ä½¿ç”¨pcreæ¥è§£ææ­£åˆ™è¡¨è¾¾å¼</span><br>yum -y install pcre*<br><br><span class="hljs-meta">#</span><span class="bash"> zlib nginxä½¿ç”¨zlibå¯¹httpçš„å†…å®¹è¿›è¡Œgzipå‹ç¼©</span><br>yum install -y zlib zlib-devel<br><br><span class="hljs-meta">#</span><span class="bash"> openssl httpsæ”¯æŒ</span><br>yum -y install openssl<br></code></pre></div></td></tr></table></figure><h3 id="ä¸‹è½½Nginx"><a href="#ä¸‹è½½Nginx" class="headerlink" title="ä¸‹è½½Nginx"></a>ä¸‹è½½Nginx</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å®‰è£…wget</span><br>yum install wget<br><span class="hljs-meta">#</span><span class="bash"> ä¸‹è½½nginx</span><br>wget http://nginx.org/download/nginx-1.12.0.tar.gz<br></code></pre></div></td></tr></table></figure><h3 id="ç¼–è¯‘å®‰è£…Nginx"><a href="#ç¼–è¯‘å®‰è£…Nginx" class="headerlink" title="ç¼–è¯‘å®‰è£…Nginx"></a>ç¼–è¯‘å®‰è£…Nginx</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> è§£å‹nginx</span><br>tar -zxvf nginx-1.12.0.tar.gz<br><span class="hljs-meta">#</span><span class="bash"> è¿›å…¥è§£å‹ç›®å½•</span><br>cd nginx-1.12.0<br>./configure<br><span class="hljs-meta">#</span><span class="bash"> è‹¥æ— é”™è¯¯ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å®‰è£…</span><br>make<br>make install<br><span class="hljs-meta">#</span><span class="bash"> é»˜è®¤å®‰è£…åˆ°/usr/<span class="hljs-built_in">local</span>/nginxç›®å½•</span><br></code></pre></div></td></tr></table></figure><h3 id="Nginxæµ‹è¯•"><a href="#Nginxæµ‹è¯•" class="headerlink" title="Nginxæµ‹è¯•"></a>Nginxæµ‹è¯•</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> å¯åŠ¨nginx</span><br>/usr/local/nginx/sbin/nginx<br><span class="hljs-meta">#</span><span class="bash"> è®¿é—®localhost</span><br>wget localhost<br><span class="hljs-meta">#</span><span class="bash"> æ­¤å‘½ä»¤ä¼šä¸‹è½½ä¸€ä¸ªindex.htmlæ–‡ä»¶</span><br>vim index.html<br><span class="hljs-meta">#</span><span class="bash"> index.htmlä¸­æœ‰å…³äºnginxçš„ç±»ä¼¼äºhelloworldè¯­å¥</span><br><span class="hljs-meta">#</span><span class="bash"> ç”±äºæˆ‘çš„Linuxå®‰è£…åœ¨è™šæ‹Ÿæœºä¸­ï¼Œæƒ³è¦å¤–éƒ¨è®¿é—®è™šæ‹Ÿæœºå†…ï¼Œéœ€è¦å…³é—­é˜²ç«å¢™æˆ–å¼€æ”¾ç«¯å£</span><br><span class="hljs-meta">#</span><span class="bash"> ç¼–è¾‘é˜²ç«å¢™ï¼Œ CentOS 7é»˜è®¤çš„é˜²ç«å¢™ä¸æ˜¯iptablesï¼Œéœ€è¦å¦è¡Œå®‰è£…ï¼Œè¯·è‡ªè¡Œè§£å†³</span><br>vim /etc/sysconfig/iptables<br><span class="hljs-meta">#</span><span class="bash"> æ·»åŠ 80ç«¯å£</span><br>-A INPUT -p tcp -m tcp --dport 80 -j ACCEPT<br><span class="hljs-meta">#</span><span class="bash"> é‡å¯é˜²ç«å¢™</span><br>service iptables restart<br><span class="hljs-meta">#</span><span class="bash"> é€šè¿‡æœ¬æœºçš„æµè§ˆå™¨è®¿é—®è™šæ‹Ÿæœºçš„ip</span><br>http://192.168.243.127(æ­¤å¤„ä¸ºè™šæ‹Ÿæœºçš„ip)<br></code></pre></div></td></tr></table></figure><h2 id="ä¸‰ã€é…ç½®ç”¨äºé›†ç¾¤çš„Tomcat"><a href="#ä¸‰ã€é…ç½®ç”¨äºé›†ç¾¤çš„Tomcat" class="headerlink" title="ä¸‰ã€é…ç½®ç”¨äºé›†ç¾¤çš„Tomcat"></a>ä¸‰ã€é…ç½®ç”¨äºé›†ç¾¤çš„Tomcat</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash"> ä¸‹è½½Tomcat</span><br>wget http://mirrors.tuna.tsinghua.edu.cn/apache/tomcat/tomcat-7/v7.0.77/bin/apache-tomcat-7.0.77.tar.gz<br><span class="hljs-meta">#</span><span class="bash"> åˆ›å»ºç›®å½•</span><br>mkdir /usr/local/tomcats<br><span class="hljs-meta">#</span><span class="bash"> è§£å‹Tomcat</span><br>tar -zxvf apache-tomcat-7.0.77.tar.gz -C /usr/local/tomcats<br><span class="hljs-meta">#</span><span class="bash"> ä¿®æ”¹è§£å‹çš„Tomcatç›®å½•åç§°</span><br>mv apache-tomcat-7.0.77 tomcat1<br><span class="hljs-meta">#</span><span class="bash"> ä¸ºäº†æµ‹è¯•nginxè´Ÿè½½å‡è¡¡,éœ€è¦å¯¹tomcatçš„server.xmlé…ç½®ä¸€ä¸‹</span><br>vim tomcat1/conf/server.xml<br><span class="hljs-meta">#</span><span class="bash"> æ˜¾ç¤ºè¡Œå·</span><br>:set nu<br><span class="hljs-meta">#</span><span class="bash"> åœ¨105è¡Œä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼Œ å¹¶ä¿å­˜é€€å‡º</span><br>&lt;Engine name=&quot;Catalina&quot; defaultHost=&quot;localhost&quot; jvmRoute=&quot;jvm1&quot;&gt;<br><span class="hljs-meta">#</span><span class="bash"> ä¿®æ”¹ç¤ºä¾‹ç¨‹åº</span><br>echo &#x27;tomcat1:&lt;%=session.getId()%&gt;&#x27; &gt; tomcat1/webapps/ROOT/index.jsp<br><br><span class="hljs-meta">#</span><span class="bash"> æ‹·è´tomcat1ç›®å½•ä¸ºtomcat2</span><br>cp -r tomcat1 tomcat2<br><span class="hljs-meta">#</span><span class="bash"> ä¿®æ”¹tomcat2çš„server.xmlä¸­çš„ç«¯å£å·</span><br>vim tomcat2/conf/server.xml<br><span class="hljs-meta">#</span><span class="bash"> ä¿®æ”¹22è¡Œ/71è¡Œ/93è¡Œçš„ç«¯å£</span><br><span class="hljs-meta">#</span><span class="bash"> ä¿®æ”¹105è¡Œ</span><br>&lt;Engine name=&quot;Catalina&quot; defaultHost=&quot;localhost&quot; jvmRoute=&quot;jvm2&quot;&gt;<br><span class="hljs-meta">#</span><span class="bash"> ä¿®æ”¹ç¤ºä¾‹ç¨‹åº</span><br>echo &#x27;tomcat2:&lt;%=session.getId()%&gt;&#x27; &gt; tomcat1/webapps/ROOT/index.jsp<br></code></pre></div></td></tr></table></figure><h2 id="å››ã€é…ç½®Nginx"><a href="#å››ã€é…ç½®Nginx" class="headerlink" title="å››ã€é…ç½®Nginx"></a>å››ã€é…ç½®Nginx</h2><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell">vim /usr/local/nginx/conf/nginx.conf<br></code></pre></div></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170505/220704835.png"></p><h3 id="å¯åŠ¨tomcat"><a href="#å¯åŠ¨tomcat" class="headerlink" title="å¯åŠ¨tomcat"></a>å¯åŠ¨tomcat</h3><figure class="highlight shell"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">  å¯åŠ¨ä¸¤ä¸ªtomcat</span><br>./tomat2/bin/startup.sh<br>./tomat1/bin/startup.sh<br></code></pre></div></td></tr></table></figure><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>å¤–éƒ¨è®¿é—®è™šæ‹Ÿæœº</p><p><code>http://192.168.243.127(æ­¤å¤„ä¸ºè™šæ‹Ÿæœºçš„ip)</code></p><p>å¤šåˆ·æ–°å‡ æ¬¡ï¼Œå¯ä»¥çœ‹åˆ°é¡µé¢çš„å†…å®¹åœ¨å˜åŒ–ï¼Œåœ¨tomcat1å’Œtomcat2ä¹‹é—´è¿›è¡Œåˆ‡æ¢ï¼Œè‡³æ­¤å®Œæˆäº†ç®€å•nginxè´Ÿè½½å‡è¡¡çš„æ­å»ºã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æœåŠ¡å™¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
      <tag>tomcat</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Šèªæ˜äººéƒ½ç”¨æ–¹æ ¼ç¬”è®°æœ¬ã€‹è¯»ä¹¦ç¬”è®°</title>
    <link href="/%E3%80%8A%E8%81%AA%E6%98%8E%E4%BA%BA%E9%83%BD%E7%94%A8%E6%96%B9%E6%A0%BC%E7%AC%94%E8%AE%B0%E6%9C%AC%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html"/>
    <url>/%E3%80%8A%E8%81%AA%E6%98%8E%E4%BA%BA%E9%83%BD%E7%94%A8%E6%96%B9%E6%A0%BC%E7%AC%94%E8%AE%B0%E6%9C%AC%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html</url>
    
    <content type="html"><![CDATA[<p>2017å¹´è¯»çš„ç¬¬ä¸€æœ¬ä¹¦ï¼Œè¯»å®Œäº†ä¸€ç›´æ²¡æœ‰å†™è¯»ä¹¦ç¬”è®°ï¼Œæ‹–å»¶åˆ°ä»Šå¤©ï¼Œæ‰å‹‰å¼ºå†™å®Œã€‚ä¸­é€”çœ‹åˆ°ã€Šå¦‚ä½•æœ‰æ•ˆé˜…è¯»ä¸€æœ¬ä¹¦ã€‹ï¼Œå°±ä¸€èµ·è¯»äº†ï¼Œå­¦å­¦è¯»ä¹¦ç¬”è®°çš„å†™æ³•ã€‚    </p><p>æ­¤ä¹¦ä¸»è¦è®²äº†ç¬”è®°æœ¬å¯¹äºç¬”è®°çš„å½±å“ï¼Œå¥½çš„ç¬”è®°æœ¬è®©ç¬”è®°å‘æŒ¥å®ƒåº”æœ‰çš„åŠŸèƒ½ï¼Œè€Œä¸å¥½çš„ç¬”è®°æœ¬ä½“ç°ä¸å‡ºç¬”è®°çš„ä»·å€¼æ‰€åœ¨ã€‚ä½œè€…ä»¥ä¸‰ä¸ªè‘—åæœºæ„ä½¿ç”¨çš„ç¬”è®°æœ¬ä¸ºä¾‹ï¼Œåˆ—ä¸¾äº†æ–¹æ ¼ç¬”è®°æœ¬çš„ç§ç§ç›Šå¤„ï¼Œå¹¶é€šè¿‡é…å›¾çš„æ–¹å¼ï¼Œè®©è¯»è€…ä¸€ç›®äº†ç„¶åœ°äº†è§£æ–¹æ ¼ç¬”è®°æœ¬è®°å½•ç¬”è®°çš„æ–¹å¼ã€‚</p><a id="more"></a><table><thead><tr><th align="center">ä¹¦å</th><th align="center">ä½œè€…</th><th align="center">å¼€å§‹æ—¶é—´</th><th align="center">ç»“æŸæ—¶é—´</th></tr></thead><tbody><tr><td align="center">èªæ˜äººéƒ½ç”¨æ–¹æ ¼ç¬”è®°æœ¬</td><td align="center">é«˜æ¡¥æ”¿å²</td><td align="center">2017.01.01</td><td align="center">2017.01.04</td></tr></tbody></table><blockquote><p>å°†æ–¹æ ¼ç¬”è®°æœ¬â€œåˆ†ä¸ºä¸‰éƒ¨åˆ†â€è®°å½•ã€‚ä»å·¦å‘å³ä¾æ¬¡å°†ç¬”è®°æœ¬åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼ŒæŒ‰ç…§â€œäº‹å®<br>â†’è§£é‡Šâ†’è¡ŒåŠ¨â€çš„é¡ºåºè®°å½•ç¬”è®°ã€‚</p></blockquote><h2 id="ä¸€ï¼‰ç¬”è®°æœ¬çš„åŒºåˆ«"><a href="#ä¸€ï¼‰ç¬”è®°æœ¬çš„åŒºåˆ«" class="headerlink" title="ä¸€ï¼‰ç¬”è®°æœ¬çš„åŒºåˆ«"></a>ä¸€ï¼‰ç¬”è®°æœ¬çš„åŒºåˆ«</h2><h4 id="1-â˜†ç¬”è®°æœ¬çš„å¯¹æ¯”"><a href="#1-â˜†ç¬”è®°æœ¬çš„å¯¹æ¯”" class="headerlink" title="1. â˜†ç¬”è®°æœ¬çš„å¯¹æ¯”"></a>1. â˜†ç¬”è®°æœ¬çš„å¯¹æ¯”</h4><table><thead><tr><th>ä½¿å¤´è„‘å˜èªæ˜çš„ç¬”è®°æœ¬</th><th>é˜»ç¢èƒ½åŠ›å‘æŒ¥çš„ç¬”è®°æœ¬</th><th>å¯¹æ¯”</th></tr></thead><tbody><tr><td>çœ‹èµ·æ¥å·¥æ•´</td><td>ç¬¬ä¸€å°è±¡ç»™äººè„ä¹±çš„æ„Ÿè§‰ï¼Œä½¿äººä¸æ„¿å†çœ‹ç¬¬äºŒçœ¼</td><td>ç†è§£åŠ›ã€ç§¯ææ€§ä½ä¸‹</td></tr><tr><td>æ¯”A4çº¸å¤§</td><td>æ¯”A6çº¸å°ã€è®°äº‹æœ¬å‹</td><td>æ€è€ƒå¤æ‚é—®é¢˜çš„èƒ½åŠ›ã€é€»è¾‘æ€ç»´èƒ½åŠ›ä½ä¸‹</td></tr><tr><td>é¢œè‰²ä¸è¶…è¿‡ä¸‰ç§</td><td>ç”¨äº†å››ç§ä»¥ä¸Šçš„é¢œè‰²</td><td>åˆ¤æ–­ä¼˜å…ˆé¡ºåºçš„èƒ½åŠ›ã€åˆ¤æ–­åŠ›ä½ä¸‹</td></tr><tr><td>æ¯ä¸€é¡µéƒ½æœ‰ä¸€ä¸ªä¸»é¢˜</td><td>è¿™ä¹Ÿå†™ã€é‚£ä¹Ÿå†™</td><td>èˆå¼ƒèƒ½åŠ›ã€æ•´ç†èƒ½åŠ›ä½ä¸‹</td></tr><tr><td>æ˜¯é»‘æ¿ã€ç™½æ¿æ¿ä¹¦å†…å®¹çš„æç‚¼</td><td>ç…§æŠ„é»‘æ¿ã€ç™½æ¿æ¿ä¹¦</td><td>è®°å¿†åŠ›ã€ç‹¬ç«‹æ€è€ƒèƒ½åŠ›ä½ä¸‹</td></tr><tr><td>ç•™æœ‰ç©ºç™½åŒºåŸŸ</td><td>æ— ç©ºéš™ï¼Œå†™å¾—æ»¡æ»¡å½“å½“</td><td>ç†è§£èƒ½åŠ›ã€å¤ä¹ èƒ½åŠ›ä½ä¸‹</td></tr><tr><td>ç”»æœ‰è®¸å¤šå›¾ã€è¡¨ã€ç”»</td><td>æ— å›¾ã€è¡¨ã€ç”»ï¼Œåªæœ‰æ–‡å­—</td><td>è§†è§‰æŠŠæ¡èƒ½åŠ›ã€è¡¨ç°åŠ›ä½ä¸‹</td></tr><tr><td>æ—¥åçœ‹ç¬”è®°æ—¶ä¾ç„¶å¯å†ç°å½“æ—¶çš„å†…å®¹</td><td>æ—¥åçœ‹ç¬”è®°æ—¶æ— æ³•å†ç°å½“æ—¶çš„å†…å®¹</td><td>å­¦ä¹ èƒ½åŠ›ã€ç†è§£åŠ›ä½ä¸‹</td></tr></tbody></table><h4 id="2-â˜…å¥½ä¸åçš„ç¬”è®°æœ¬çš„åŒºåˆ«"><a href="#2-â˜…å¥½ä¸åçš„ç¬”è®°æœ¬çš„åŒºåˆ«" class="headerlink" title="2. â˜…å¥½ä¸åçš„ç¬”è®°æœ¬çš„åŒºåˆ«"></a>2. â˜…å¥½ä¸åçš„ç¬”è®°æœ¬çš„åŒºåˆ«</h4><p>å¥½ç¬”è®°æœ¬çœ‹ä¸Šå»ä¸€ç›®äº†ç„¶ï¼Œèƒ½å¤Ÿè¿…é€ŸæŠŠæ¡é‡ç‚¹ï¼Œå¤ç°è®°ç¬”è®°æ—¶çš„åœºæ™¯ï¼›<br>è€Œåç¬”è®°å°±æ˜¯è®©ä½ æ ¹æœ¬æ²¡æœ‰çœ‹çš„æ¬²æœ›ï¼Œå³ä½¿æ˜¯çœ‹äº†ï¼Œä¹Ÿä¸èƒ½æå–æœ‰æ•ˆå†…å®¹ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåç¬”è®°æœ¬çš„ä½œç”¨å°±æ˜¯æ²¡æœ‰ä½œç”¨ã€‚</p><h2 id="äºŒï¼‰è®°ç¬”è®°çš„ç›®çš„"><a href="#äºŒï¼‰è®°ç¬”è®°çš„ç›®çš„" class="headerlink" title="äºŒï¼‰è®°ç¬”è®°çš„ç›®çš„"></a>äºŒï¼‰è®°ç¬”è®°çš„ç›®çš„</h2><h4 id="1-â˜†è®°ç¬”è®°çš„è¯¯åŒº"><a href="#1-â˜†è®°ç¬”è®°çš„è¯¯åŒº" class="headerlink" title="1. â˜†è®°ç¬”è®°çš„è¯¯åŒº"></a>1. â˜†è®°ç¬”è®°çš„è¯¯åŒº</h4><p>ä¸ç®¡ä½ å‚åŠ çš„æ˜¯å¤šä¹ˆä¼˜ç§€çš„åŸ¹è®­ã€è®²åº§ã€ç ”è®¨ï¼Œå¦‚æœä½ çš„ç¬”è®°æ— æ³•å†ç°å½“æ—¶çš„å­¦ä¹ å†…å®¹ï¼Œé‚£ä¹ˆï¼Œä½ å¥½ä¸å®¹æ˜“å­¦åˆ°çš„çŸ¥è¯†ã€æŠ€å·§åŒ–ä¸ºä¹Œæœ‰çš„å¯èƒ½æ€§å°†å¾ˆå¤§ã€‚  </p><blockquote><p><strong>ç¬”è®°çš„ç”Ÿå‘½çº¿æ˜¯â€œå†ç°æ€§â€ï¼Œè¿™æ˜¯è®°ç¬”è®°çš„æœ€ç»ˆç›®çš„ã€‚</strong>  </p></blockquote><p>å¯æ˜¯ï¼Œæ²¡æœ‰å­¦ä¹ è¿‡ç¬”è®°æœ¬ä½¿ç”¨æ–¹æ³•çš„äººæ—¥åå†çœ‹è‡ªå·±çš„ç¬”è®°æ—¶ï¼Œåªèƒ½çœ‹åˆ°ä¸Šé¢çš„è¯è¯­å’Œå¥å­ï¼Œå´å›å¿†ä¸å‡ºâ€œä¸ºä½•éœ€è¦è¿™äº›ä¿¡æ¯â€â€œè¿™äº›ä¿¡æ¯æœ‰ä»€ä¹ˆä½œç”¨â€è¿™äº›æ›´ä¸ºé‡è¦çš„éƒ¨åˆ†ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä»–ä»¬ç”¨çš„æ˜¯ç¼ºä¹å†ç°æ€§çš„è®°ç¬”è®°æ³•ã€‚</p><p>ä¸ºä»€ä¹ˆè¦åšç¬”è®°ï¼Ÿ</p><ul><li>æˆ‘æ˜¯æ€•æ—¥åå¿˜è®°æ‰è®°çš„</li><li>æˆ‘åªæ˜¯ç…§æŠ„æ¿ä¹¦ç½¢äº†</li><li>æˆ‘æœ‰è®°ç¬”è®°çš„ä¹ æƒ¯</li></ul><h4 id="2-â˜…è®°ç¬”è®°éœ€è¦å…‹æœçš„å›°éš¾"><a href="#2-â˜…è®°ç¬”è®°éœ€è¦å…‹æœçš„å›°éš¾" class="headerlink" title="2. â˜…è®°ç¬”è®°éœ€è¦å…‹æœçš„å›°éš¾"></a>2. â˜…è®°ç¬”è®°éœ€è¦å…‹æœçš„å›°éš¾</h4><p>ä½œè€…è¯´ï¼ŒæŠ±ç€ä»¥ä¸Šè¿™å‡ ç§ç›®çš„è€Œåšç¬”è®°çš„äººéœ€è¦å˜åŒ–è®°ç¬”è®°çš„æ–¹å¼ï¼Œåº”å½“åœæ­¢å½“å‰è¿™ç§è®°ç¬”è®°çš„æ–¹æ³•ã€‚ä¸€ç›´ä»¥æ¥ï¼Œè®°äº†å¾ˆå¤šç¬”è®°ï¼Œä½†æ˜¯æˆ‘æ¯æ¬¡è®°å®Œçš„ç¬”è®°åªæ˜¯å½“æˆäº†å¤‡å¿˜ï¼ŒæŠŠç¬”è®°æœ¬å½“æˆäº†å­—å…¸ã€‚  </p><p>éœ€è¦ä½¿ç”¨ä»¥å‰è®°è¿‡çš„ç¬”è®°çš„æ—¶å€™ï¼Œå°±å€ŸåŠ©ä¸ªäººè‰¯å¥½çš„åˆ†ç±»ä¹ æƒ¯æŸ¥æ‰¾å¯¹åº”çš„ç¬”è®°ï¼Œä»¥åŠå€ŸåŠ©è½¯ä»¶çš„å…¨æ–‡æ£€ç´¢åŠŸèƒ½æŸ¥æ‰¾æˆ‘æ‰€éœ€è¦çš„ç¬”è®°ã€‚  </p><p>é•¿è€Œä¹…ä¹‹ï¼Œä¾¿å…»æˆäº†ä¾èµ–çš„ä¹ æƒ¯ï¼Œè®°ç¬”è®°è®°å®Œä¹Ÿåªæ˜¯åœ¨è„‘æµ·ä¸­ä¿ç•™ä¸€ä»½å…³é”®å­—ï¼Œè€Œå†…å®¹å´ä¸€æ¦‚å¿˜è®°ï¼Œè¿™ææ€•æ˜¯æˆ‘çš„è®°ç¬”è®°æ–¹å¼çš„æœ€å¤§å¼Šç—…ï¼Œå†ç°ç¬”è®°çš„å†…å®¹æ˜¯ä¸ªäººéœ€è¦å…‹æœçš„éš¾ç‚¹ã€‚</p><h2 id="ä¸‰ï¼‰æ¡†æ¶Â·é»„é‡‘ä¸‰åˆ†æ³•"><a href="#ä¸‰ï¼‰æ¡†æ¶Â·é»„é‡‘ä¸‰åˆ†æ³•" class="headerlink" title="ä¸‰ï¼‰æ¡†æ¶Â·é»„é‡‘ä¸‰åˆ†æ³•"></a>ä¸‰ï¼‰æ¡†æ¶Â·é»„é‡‘ä¸‰åˆ†æ³•</h2><h4 id="1-â˜†è°é‡‡å–äº†è¿™ç§æ¡†æ¶"><a href="#1-â˜†è°é‡‡å–äº†è¿™ç§æ¡†æ¶" class="headerlink" title="1. â˜†è°é‡‡å–äº†è¿™ç§æ¡†æ¶"></a>1. â˜†è°é‡‡å–äº†è¿™ç§æ¡†æ¶</h4><ul><li><p>åº·å¥ˆå°”ç¬”è®°æœ¬åˆ†ä¸ºâ€œNoteâ€ï¼ˆæ¿ä¹¦ï¼‰ã€â€œQueueâ€ï¼ˆå‘ç°ç‚¹ï¼‰ã€â€œSummaryâ€ï¼ˆæ€»ç»“ï¼‰ä¸‰éƒ¨åˆ†ã€‚  </p></li><li><p>ä¸œå¤§å½•å–ç”Ÿä¸­çš„å¤§å¤šæ•°å­¦ç”Ÿå°†ç¬”è®°æœ¬çš„å·¦å³ä¸¤é¡µä½œä¸ºä¸€é¡µä½¿ç”¨ï¼Œå·¦ä¾§è®°å½•â€œæ¿ä¹¦â€ï¼Œå³ä¾§å†™â€œå‘ç°ç‚¹â€å’Œâ€œæ€»ç»“â€ï¼Œå’Œåº·å¥ˆå°”ç¬”è®°æœ¬çš„æ„é€ å®Œå…¨ç›¸åŒã€‚  </p></li><li><p>éº¦è‚¯é”¡å…¬å¸çš„â€œç©ºÂ·é›¨Â·ä¼â€ï¼ŒåŸƒæ£®å“²å…¬å¸çš„â€œPoint Sheetâ€ï¼Œæ‰€æœ‰å¤–èµ„ç®¡ç†å’¨è¯¢å…¬å¸çš„å’¨è¯¢é¡¾é—®éƒ½æ˜¯æŒ‰ç…§â€œäº‹å®â†’è§£é‡Šâ†’è¡ŒåŠ¨â€çš„ä¸‰åˆ†æ³•å±•å¼€æ€è€ƒçš„ã€‚   </p></li></ul><h4 id="2-â˜†æ¡†æ¶çš„ç»„æˆ"><a href="#2-â˜†æ¡†æ¶çš„ç»„æˆ" class="headerlink" title="2. â˜†æ¡†æ¶çš„ç»„æˆ"></a>2. â˜†æ¡†æ¶çš„ç»„æˆ</h4><table><thead><tr><th>å†…å®¹</th><th>å¯¹åº”</th></tr></thead><tbody><tr><td>æ¿ä¹¦</td><td>äº‹å®</td></tr><tr><td>å‘ç°</td><td>è§£é‡Š</td></tr><tr><td>æ€»ç»“</td><td>è¡ŒåŠ¨</td></tr></tbody></table><h4 id="3-â˜…æ¡†æ¶çš„ä½¿ç”¨æ­¥éª¤"><a href="#3-â˜…æ¡†æ¶çš„ä½¿ç”¨æ­¥éª¤" class="headerlink" title="3. â˜…æ¡†æ¶çš„ä½¿ç”¨æ­¥éª¤"></a>3. â˜…æ¡†æ¶çš„ä½¿ç”¨æ­¥éª¤</h4><ol><li>æ‘˜æŠ„åŸæ–‡ï¼šåŠ æ·±å¯¹åŸæ–‡çš„å°è±¡</li><li>æå‡ºé—®é¢˜ï¼Œåšå‡ºè§£é‡Šï¼šåŸºäºåŸæ–‡è¿›è¡Œæ€è€ƒï¼Œå¹¶ç»™å‡ºç»“æœ</li><li>è¿›è¡Œæ€»ç»“ï¼šå¯¹äºæ•´ç¯‡æ–‡ç« çš„æ€»ä½“æ¦‚è¿°  </li></ol><p>æŒ‰ç…§é»„é‡‘ä¸‰åˆ†æ³•æ¥åšç¬”è®°ï¼Œå¯ä»¥æé«˜ç¬”è®°å¯¹çŸ¥è¯†çš„å†ç°æ€§ï¼ŒçŸ¥åæœºæ„éƒ½é‡‡å–çš„æ˜¯é»„é‡‘ä¸‰åˆ†æ³•è¿™ç§æ¡†æ¶æ¥åšç¬”è®°ã€‚</p><h2 id="å››ï¼‰ç¬”è®°æœ¬çš„ç»“æ„"><a href="#å››ï¼‰ç¬”è®°æœ¬çš„ç»“æ„" class="headerlink" title="å››ï¼‰ç¬”è®°æœ¬çš„ç»“æ„"></a>å››ï¼‰ç¬”è®°æœ¬çš„ç»“æ„</h2><h4 id="1-â˜†ç¬”è®°æœ¬çš„æ–¹å‘"><a href="#1-â˜†ç¬”è®°æœ¬çš„æ–¹å‘" class="headerlink" title="1. â˜†ç¬”è®°æœ¬çš„æ–¹å‘"></a>1. â˜†ç¬”è®°æœ¬çš„æ–¹å‘</h4><p>äººçš„æ€è€ƒä¼šå—åˆ°çœ¼ç›æ„é€ çš„å·¦å³ï¼Œæ‰€ä»¥è¿›å…¥è§†é‡çš„æ˜¯â€œçºµå‘â€æ¡†æ¶è¿˜æ˜¯â€œæ¨ªå‘â€æ¡†æ¶ï¼Œèƒ½å¤Ÿå½±å“äººä»¬çš„ç†è§£é€Ÿåº¦ä»¥åŠå¯¹ä¿¡æ¯çš„æŠŠæ¡ç¨‹åº¦ã€‚  </p><p>åœ¨æŠŠæ¡æ•´ä½“æƒ…å†µæ—¶ï¼Œéœ€è¦è§£å†³çš„é—®é¢˜è¶Šå¤æ‚ã€å‚è€ƒçš„ä¿¡æ¯é‡è¶Šåºå¤§ï¼Œå°±è¶Šéœ€è¦åœ¨çŸ­æ—¶é—´å†…è¿…é€ŸæŠ“ä½é‡ç‚¹ã€‚  </p><p>éšç€å­¦ä¹ ã€å·¥ä½œå±‚æ¬¡çš„æå‡ï¼Œâ€œæ—¢è§æ ‘æœ¨ï¼Œåˆè§æ£®æ—â€è¿™ä¸€æ€è€ƒæ–¹å¼çš„é‡è¦æ€§ä¹Ÿå°±æ›´ä¸ºçªæ˜¾ã€‚</p><h4 id="2-â˜†ç¬”è®°æœ¬çš„å¤§å°"><a href="#2-â˜†ç¬”è®°æœ¬çš„å¤§å°" class="headerlink" title="2. â˜†ç¬”è®°æœ¬çš„å¤§å°"></a>2. â˜†ç¬”è®°æœ¬çš„å¤§å°</h4><p>â€œä¸å–„äºæç‚¼æƒ³æ³•â€â€œå¾ˆéš¾æŒ‰é€»è¾‘æ€§æ€ç»´æ€è€ƒâ€â€œä¸ä¼šè¨€ç®€æ„èµ…åœ°è¡¨è¾¾â€çš„åŸå› æ˜¯ä»€<br>ä¹ˆï¼Ÿ  </p><p>ç¬”è®°æœ¬çš„å¤§å°æ„å‘³ç€æ€è€ƒèƒ½åŠ›çš„å¼ºå¼±ã€‚</p><h4 id="3-â˜†ç¬”è®°çš„é¢œè‰²"><a href="#3-â˜†ç¬”è®°çš„é¢œè‰²" class="headerlink" title="3. â˜†ç¬”è®°çš„é¢œè‰²"></a>3. â˜†ç¬”è®°çš„é¢œè‰²</h4><p>ç”¨é»‘è‰²æˆ–è“è‰²ä¹¦å†™ç¬”è®°ï¼Œç”¨çº¢è‰²ä½œä¸ºåˆ¤æ–­ï¼Œä¹Ÿå°±æ˜¯é‡åˆ°éå¸¸é‡è¦æˆ–éœ€è¦ä¿®æ”¹çš„åœ°æ–¹æ—¶ä½¿ç”¨çº¢è‰²ã€‚ ç”¨æ­¤ç§ç®€å•æ–¹æ³•åŒºåˆ†ä½¿ç”¨é¢œè‰²çš„è¯ï¼Œä¾¿ä¼šåœ¨è®°ç¬”è®°çš„åŒæ—¶è‡ªç„¶èˆå¼ƒæ‰æ— ç”¨çš„å†…å®¹ï¼Œå°†æ€è€ƒé‡ç‚¹æ”¾åœ¨ä¸»è¦é—®é¢˜ä¸Šï¼Œå…»æˆåˆ¤æ–­ä¸»æ¬¡å…ˆåçš„ä¹ æƒ¯ï¼Œé€æ­¥æé«˜è§£å†³é—®é¢˜çš„é€Ÿåº¦å’Œè´¨é‡ã€‚  </p><blockquote><p><strong>é¢œè‰²æœ€å¤šç”¨ä¸‰ç§ã€‚</strong></p></blockquote><p>åªè¦èƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Œäº‹åå†ç¿»çœ‹ç¬”è®°æ—¶ï¼Œä»…çœ‹é¢œè‰²å°±èƒ½ç«‹åˆ»åŒºåˆ†å‡ºä¸»æ¬¡é¡ºåºï¼Œè®°ç¬”è®°æ—¶çš„æ€è·¯ä¹Ÿèƒ½åœ¨å¤§è„‘ä¸­æ¸…æ™°é‡ç°ï¼Œè¿›ä¸€æ­¥æå‡ä¿¡æ¯æ•´ç†å’Œè¾“å‡ºçš„æ•ˆç‡ã€‚</p><h4 id="4-â˜†ç¬”è®°æ ‡é¢˜åŒºåŸŸçš„åˆ©ç”¨"><a href="#4-â˜†ç¬”è®°æ ‡é¢˜åŒºåŸŸçš„åˆ©ç”¨" class="headerlink" title="4. â˜†ç¬”è®°æ ‡é¢˜åŒºåŸŸçš„åˆ©ç”¨"></a>4. â˜†ç¬”è®°æ ‡é¢˜åŒºåŸŸçš„åˆ©ç”¨</h4><p>é€šå¸¸ä¼šåœ¨ç¬”è®°æœ¬ä¸Šéƒ¨çš„ç©ºç™½åŒºåŸŸå†™å…¥è®ºç‚¹å’Œç»“è®ºã€‚<br>ä»¥è§£å†³å·¥ä½œé—®é¢˜çš„ç¬”è®°æœ¬ä¸ºä¾‹ï¼Œâ€œè®ºç‚¹=é—®é¢˜çš„æ ¸å¿ƒæ˜¯ä»€ä¹ˆâ€â€œç»“è®º=è¿™æ ·åšä¾¿å¯ä»¥è§£å†³é—®é¢˜â€ã€‚  </p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20170122151804.png"></p><h4 id="5-â˜…ç¬”è®°æœ¬ç»“æ„å¯¹äºç¬”è®°çš„å½±å“"><a href="#5-â˜…ç¬”è®°æœ¬ç»“æ„å¯¹äºç¬”è®°çš„å½±å“" class="headerlink" title="5. â˜…ç¬”è®°æœ¬ç»“æ„å¯¹äºç¬”è®°çš„å½±å“"></a>5. â˜…ç¬”è®°æœ¬ç»“æ„å¯¹äºç¬”è®°çš„å½±å“</h4><ul><li>ç¬”è®°é‡‡å–æ¨ªå‘ç»“æ„ï¼Œå¯ä»¥èµ·åˆ°ä¸€ç›®äº†ç„¶çš„ä½œç”¨ï¼Œå‚è€ƒçš„æ–‡ç« ä¿¡æ¯ä¾¿äºæå–åˆ°å¤§è„‘ä¸­ã€‚</li><li>å°ç¬”è®°æœ¬ä¸åˆ©äºæ€»ç»“æƒ³æ³•ï¼Œæ¥å›åœ°ç¿»é¡µä¼šæ‰“æ–­æ€è€ƒçš„ä¹¦å†™ã€‚å› æ­¤ä½¿ç”¨å¤§ç¬”è®°æœ¬æ¥è®°ç¬”è®°ã€‚</li><li>å¤ªå¤šçš„é¢œè‰²ä¼šå¯¼è‡´æ‰¾ä¸åˆ°é‡ç‚¹ï¼Œå¤„å¤„æ˜¯é‡ç‚¹çš„æƒ…å†µï¼Œ</li><li>åˆç†æ ‡è®°æ ‡é¢˜ï¼Œæ¢³ç†æ ¸å¿ƒå†…å®¹ï¼Œæœ‰åŠ©äºå¿«é€Ÿç†è§£ç¬”è®°å†…å®¹ã€‚</li></ul><h2 id="äº”ï¼‰ç¬”è®°æœ¬çš„åŠŸèƒ½"><a href="#äº”ï¼‰ç¬”è®°æœ¬çš„åŠŸèƒ½" class="headerlink" title="äº”ï¼‰ç¬”è®°æœ¬çš„åŠŸèƒ½"></a>äº”ï¼‰ç¬”è®°æœ¬çš„åŠŸèƒ½</h2><h4 id="1-â˜†è®°å¿†æ€§ç¬”è®°æœ¬"><a href="#1-â˜†è®°å¿†æ€§ç¬”è®°æœ¬" class="headerlink" title="1. â˜†è®°å¿†æ€§ç¬”è®°æœ¬"></a>1. â˜†è®°å¿†æ€§ç¬”è®°æœ¬</h4><p>ä¸Šè¯¾ã€ç ”è®¨æˆ–æ˜¯è¦è®°å¿†ã€ç†è§£å­¦ä¹ å†…å®¹æ—¶è®°å½•çš„ç¬”è®°ï¼Œä¸ºäº†è®°åœ¨è„‘å­é‡Œè€Œå†™çš„ç¬”è®°ã€‚æœ¬ä¹¦å°†è¿™ç±»ç¬”è®°æœ¬ç§°ä¸ºâ€œå­¦ä¹ ç¬”è®°æœ¬â€ã€‚  </p><h4 id="2-â˜†æ€è€ƒæ€§ç¬”è®°æœ¬"><a href="#2-â˜†æ€è€ƒæ€§ç¬”è®°æœ¬" class="headerlink" title="2. â˜†æ€è€ƒæ€§ç¬”è®°æœ¬"></a>2. â˜†æ€è€ƒæ€§ç¬”è®°æœ¬</h4><p>ä¸ºçœ‹å‡ºäº‹ç‰©æœ¬è´¨ã€ç†è§£é‡ç‚¹ã€å¾—å‡ºç»“è®ºè€Œå†™çš„ç¬”è®°ï¼Œå¸¸è§äºå·¥ä½œä¸­ã€‚æœ¬ä¹¦å°†è¿™ç±»ç¬”è®°æœ¬ç§°ä¸ºâ€œå·¥ä½œç¬”è®°æœ¬â€ã€‚</p><h4 id="3-â˜†ä¼ è¾¾æ€§ç¬”è®°æœ¬"><a href="#3-â˜†ä¼ è¾¾æ€§ç¬”è®°æœ¬" class="headerlink" title="3. â˜†ä¼ è¾¾æ€§ç¬”è®°æœ¬"></a>3. â˜†ä¼ è¾¾æ€§ç¬”è®°æœ¬</h4><p>ä¼ è¾¾æ€§ç¬”è®°å³èƒ½å¤Ÿä»ä¸°å¯Œçš„ä¿¡æ¯ä¸­ç­›é€‰å‡ºå¯¹æ–¹æ‰€éœ€çš„æ”¹å–„ç­–ç•¥åŠè§£å†³æ–¹æ³•ï¼Œä¸ºäº†è¯´æœå¯¹æ–¹è€Œå†™çš„ç¬”è®°ã€‚æœ¬ä¹¦å°†å†™è¿™ç±»ç¬”è®°çš„ç¬”è®°æœ¬ç§°ä¸ºâ€œææ¡ˆç¬”è®°æœ¬â€æˆ–â€œåšå¼ˆç¬”è®°æœ¬â€ã€‚</p><h4 id="4-â˜…ä¸åŒåŠŸèƒ½ç¬”è®°æœ¬å¯¹çš„è®°æ³•"><a href="#4-â˜…ä¸åŒåŠŸèƒ½ç¬”è®°æœ¬å¯¹çš„è®°æ³•" class="headerlink" title="4. â˜…ä¸åŒåŠŸèƒ½ç¬”è®°æœ¬å¯¹çš„è®°æ³•"></a>4. â˜…ä¸åŒåŠŸèƒ½ç¬”è®°æœ¬å¯¹çš„è®°æ³•</h4><p>ä½œè€…çš„è¿™æœ¬ä¹¦æ‰€æè¿°çš„é»„é‡‘ä¸‰åˆ†æ³•æœ€é€‚åˆäºåšæ€è€ƒæ€§ç¬”è®°ï¼Œè€Œå¯¹äºè®°å¿†æ€§ç¬”è®°æœ¬çš„è®°æ³•ï¼Œé‡‡å–è¿™ç§æ–¹å¼ï¼Œä¹Ÿèƒ½èµ·åˆ°ä¸€å®šåŠ æ·±å°è±¡çš„ä½œç”¨ã€‚å¯¹äºä¼ è¾¾æ€§ç¬”è®°æœ¬è€Œè¨€ï¼Œæ—¢åˆ—å‡ºäº‹å®ï¼Œåˆç»™å‡ºåˆç†è§£é‡Šï¼Œä¹Ÿæ˜¯ä¸é”™çš„æ–¹å¼ã€‚</p><h2 id="å…­ï¼‰-æé«˜ç¬”è®°æœ¬çš„ä½œç”¨"><a href="#å…­ï¼‰-æé«˜ç¬”è®°æœ¬çš„ä½œç”¨" class="headerlink" title="å…­ï¼‰ æé«˜ç¬”è®°æœ¬çš„ä½œç”¨"></a>å…­ï¼‰ æé«˜ç¬”è®°æœ¬çš„ä½œç”¨</h2><h4 id="1-â˜†èƒ½å½¢æˆâ€œæ°¸ä¹…è®°å¿†â€çš„ç”¨çœ¼æ–¹æ³•"><a href="#1-â˜†èƒ½å½¢æˆâ€œæ°¸ä¹…è®°å¿†â€çš„ç”¨çœ¼æ–¹æ³•" class="headerlink" title="1. â˜†èƒ½å½¢æˆâ€œæ°¸ä¹…è®°å¿†â€çš„ç”¨çœ¼æ–¹æ³•"></a>1. â˜†èƒ½å½¢æˆâ€œæ°¸ä¹…è®°å¿†â€çš„ç”¨çœ¼æ–¹æ³•</h4><p>å¦‚æœä½ ä¹‹å‰æ˜¯ä¸€è¾¹çœ‹ç€è€å¸ˆåœ¨é»‘æ¿ä¸Šå†™ä¸‹çš„å†…å®¹ï¼Œä¸€è¾¹åŸå°ä¸åŠ¨åœ°æŠ„å†™åœ¨ç¬”è®°æœ¬ä¸Šçš„è¯ï¼Œé‚£ä¹ˆï¼Œè¯·ä½ æ”¹å˜ä¸€ä¸‹æŠ„å†™ç¬”è®°æ—¶çš„â€œç”¨çœ¼æ–¹æ³•â€å§ï¼</p><p>å°†æ­¤å‰ï¼šÃ—â€œçœ‹é»‘æ¿â†’å†™ç¬”è®°â€çš„è®°å½•æ–¹æ³•æ”¹ä¸ºï¼š â€œçœ‹é»‘æ¿â†’å°åœ¨å¤§è„‘ä¸­â†’ä¸çœ‹é»‘æ¿ï¼Œå°†å°åœ¨å¤§è„‘ä¸­çš„å†…å®¹é‡ç°åœ¨ç¬”è®°æœ¬ä¸Šâ€ã€‚ ä¸æ˜¯ä¸€è¾¹çœ‹é»‘æ¿ä¸€è¾¹æŠ„å†™ï¼Œè€Œæ˜¯åœ¨â€œçœ‹é»‘æ¿â†’æŠ„å†™â€ä¹‹é—´åŠ å…¥â€œå°åœ¨å¤§è„‘ä¸­çš„ä¸€ç§’é’Ÿâ€ã€‚ æˆ‘æŠŠè¿™ä¸€ç§’é’Ÿç§°ä¸ºâ€œç©ºç™½çš„ä¸€ç§’é’Ÿâ€ã€‚</p><p>åªéœ€è¦è¿™ä¸€ç§’é’Ÿï¼Œä½ çš„ç¬”è®°æœ¬å°±èƒ½å‡çº§æˆèƒ½ä½¿å¤§è„‘è¶Šå˜è¶Šèªæ˜çš„ç¬”è®°æœ¬ã€‚</p><h4 id="2-â˜…æ–¹æ³•çš„æ•ˆæœ"><a href="#2-â˜…æ–¹æ³•çš„æ•ˆæœ" class="headerlink" title="2. â˜…æ–¹æ³•çš„æ•ˆæœ"></a>2. â˜…æ–¹æ³•çš„æ•ˆæœ</h4><p>åœ¨æŠ„å†™çš„è¿™ä¸€æ­¥éª¤ä¸­åŠ å…¥<strong>æ˜ å…¥å¤§è„‘</strong>ï¼Œå¯ä»¥åŠ æ·±å¯¹æ‰€æŠ„å†™å†…å®¹çš„è®°å¿†ã€‚</p><p>è®°å¾—ä»¥å‰åœ¨èƒŒæ—¥è¯­å•è¯æ—¶ï¼Œé‡‡å–çš„å°±æ˜¯è¿™ç§æ–¹æ³•ï¼Œçœ‹ä¸€ä¸‹å•è¯ï¼Œç„¶åé—­ä¸Šçœ¼ç›ï¼Œè®©å•è¯åœ¨è„‘æµ·ä¸­æµ®ç°å‡ºæ¥ï¼Œæ•ˆæœæ¯”ç›´æ¥æŠ„å†™åˆ°æœ¬ä¸Šçš„æ–¹æ³•è¦å¥½ã€‚</p><h4 id="3-â˜†é€»è¾‘è¿æ¥è¯çš„ç§ç±»ä¸ç”¨é€”"><a href="#3-â˜†é€»è¾‘è¿æ¥è¯çš„ç§ç±»ä¸ç”¨é€”" class="headerlink" title="3. â˜†é€»è¾‘è¿æ¥è¯çš„ç§ç±»ä¸ç”¨é€”"></a>3. â˜†é€»è¾‘è¿æ¥è¯çš„ç§ç±»ä¸ç”¨é€”</h4><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20170122154035.png"></p><h4 id="4-â˜…è¿æ¥è¯çš„æ•ˆæœ"><a href="#4-â˜…è¿æ¥è¯çš„æ•ˆæœ" class="headerlink" title="4. â˜…è¿æ¥è¯çš„æ•ˆæœ"></a>4. â˜…è¿æ¥è¯çš„æ•ˆæœ</h4><p>æ‰¾åˆ°é€‚åˆè‡ªå·±çš„é€»è¾‘è¿æ¥è¯ï¼Œå°†æ€è€ƒè¿›è¡Œæµç¨‹åŒ–ã€‚ï¼ˆåœ¨ä¸­éƒ¨åŒºåŸŸä½¿ç”¨ï¼‰</p><h4 id="5-â˜†ä¸‰ä¸ªç®­å¤´çš„ä½¿ç”¨"><a href="#5-â˜†ä¸‰ä¸ªç®­å¤´çš„ä½¿ç”¨" class="headerlink" title="5. â˜†ä¸‰ä¸ªç®­å¤´çš„ä½¿ç”¨"></a>5. â˜†ä¸‰ä¸ªç®­å¤´çš„ä½¿ç”¨</h4><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20170122161754.png"></p><h4 id="6-â˜†ä¸¤ä¸ªèƒ½åŠ›çš„å®è´¨"><a href="#6-â˜†ä¸¤ä¸ªèƒ½åŠ›çš„å®è´¨" class="headerlink" title="6. â˜†ä¸¤ä¸ªèƒ½åŠ›çš„å®è´¨"></a>6. â˜†ä¸¤ä¸ªèƒ½åŠ›çš„å®è´¨</h4><ul><li>æé—®èƒ½åŠ›</li><li>æ¦‚æ‹¬èƒ½åŠ›</li></ul><p>æ‰€è°“â€œæé—®èƒ½åŠ›â€ï¼Œå°±æ˜¯å¾—åˆ°æŸä¸ªä¿¡æ¯åå¹¶ä¸ä¼šç›´æ¥ä¸€å£åä¸‹ï¼Œè€Œæ˜¯ä¼šæå‡ºç±»ä¼¼â€œè¿™åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€â€â€œä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆè¯´â€ä¹‹ç±»é—®é¢˜çš„èƒ½åŠ›ã€‚  </p><p>æ‰€è°“â€œæ¦‚æ‹¬èƒ½åŠ›â€ï¼Œå°±æ˜¯èƒ½çœ‹é€äº‹ç‰©æœ¬è´¨ï¼Œå¹¶ä¸”å°†æ¢³ç†åçš„é‡ç‚¹å†…å®¹è®°åœ¨è„‘å­é‡Œï¼Œç„¶åç®€å•æ˜äº†åœ°è®²ç»™åˆ«äººå¬ã€‚</p><h4 id="7-â˜…ä¸¤ä¸ªèƒ½åŠ›çš„ä½œç”¨"><a href="#7-â˜…ä¸¤ä¸ªèƒ½åŠ›çš„ä½œç”¨" class="headerlink" title="7. â˜…ä¸¤ä¸ªèƒ½åŠ›çš„ä½œç”¨"></a>7. â˜…ä¸¤ä¸ªèƒ½åŠ›çš„ä½œç”¨</h4><p>å¦‚ä½•åº”ç”¨å­¦ä¹ çš„çŸ¥è¯†ï¼Œæ˜¯ç”±è¿™ä¸¤ä¸ªèƒ½åŠ›æ¥å†³å®šã€‚è¿™ä¸¤ä¸ªèƒ½åŠ›çš„æé«˜ä¸æ¯å¤©çš„è„‘åŠ›è®­ç»ƒæ˜¯å¯†ä¸å¯åˆ†çš„ï¼Œåªæœ‰ä¸æ–­åœ°è”ç³»ï¼Œé€æ¸å¼ºåŒ–ï¼Œè¿™äºŒè€…çš„èƒ½åŠ›å¯¹äºä¸ªäººçš„æå‡å°±ä¼šè¶Šå‘æ˜æ˜¾ã€‚</p><h4 id="8-â˜†ä¸è¦è®©ä½ çš„ç¬”è®°æœ¬å˜å¾—ä»£è°¢ä¸è‰¯"><a href="#8-â˜†ä¸è¦è®©ä½ çš„ç¬”è®°æœ¬å˜å¾—ä»£è°¢ä¸è‰¯" class="headerlink" title="8. â˜†ä¸è¦è®©ä½ çš„ç¬”è®°æœ¬å˜å¾—ä»£è°¢ä¸è‰¯"></a>8. â˜†ä¸è¦è®©ä½ çš„ç¬”è®°æœ¬å˜å¾—ä»£è°¢ä¸è‰¯</h4><p>â€œä»£è°¢ä¸è‰¯ç¬”è®°æœ¬â€æ˜¯ä¸åˆ†æœ‰ç”¨ä¿¡æ¯å’Œæ— ç”¨ä¿¡æ¯ã€ä»€ä¹ˆéƒ½å¾€ä¸Šå†™çš„ã€ä¸è¿›è¡Œæ•´ç†æ€»ç»“çš„â€œé˜»ç¢èƒ½åŠ›å‘æŒ¥çš„ç¬”è®°æœ¬â€çš„å…¸å‹ä¾‹å­ã€‚</p><p>å¦‚æœè¿™ä¹Ÿè®°ã€é‚£ä¹Ÿè®°çš„è¯ï¼Œé‚£ä¹ˆä¸çŸ¥ä¸è§‰ä¸­ï¼Œç¬”è®°æœ¬ä¸­çš„â€œç»“è®ºå’Œè®ºç‚¹â€å°±ä¼šå˜å¾—æ¨¡ç³Šï¼Œä»€ä¹ˆæ˜¯â€œè¯¥èˆå¼ƒçš„æ— ç”¨ä¿¡æ¯â€ï¼Œä»€ä¹ˆæ˜¯â€œåº”è¯¥ç•™ä¸‹çš„é‡ç‚¹å†…å®¹â€ï¼Œä¹Ÿä¼šå˜å¾—éš¾ä»¥åŒºåˆ†ã€‚</p><p>â€œè¿™ä¹Ÿè®°ã€é‚£ä¹Ÿè®°â€â€œå…ˆè®°ä¸‹å†è¯´â€â€œè¯´ä¸å®šä»¥åä¼šç”¨åˆ°â€â€¦â€¦æŒ‰ç…§è¿™æ ·çš„æƒ³æ³•è®°ç¬”è®°çš„è¯ï¼Œè®°åœ¨ç¬”è®°ä¸Šçš„ä¿¡æ¯æ—¥åè¢«ä½¿ç”¨çš„æ¦‚ç‡å‡ ä¹ä¸ºé›¶ã€‚</p><h4 id="9-â˜…ä»£è°¢ä¸è‰¯ç¬”è®°æœ¬çš„åå¤„"><a href="#9-â˜…ä»£è°¢ä¸è‰¯ç¬”è®°æœ¬çš„åå¤„" class="headerlink" title="9. â˜…ä»£è°¢ä¸è‰¯ç¬”è®°æœ¬çš„åå¤„"></a>9. â˜…ä»£è°¢ä¸è‰¯ç¬”è®°æœ¬çš„åå¤„</h4><p>å¦‚æœä»€ä¹ˆéƒ½è®°ã€ä¹Ÿä¸è¿›è¡Œæ•´ç†æ€»ç»“ï¼Œè¿™æ ·è®°å½•çš„ç¬”è®°åªæ˜¯æ‘˜æŠ„ç½¢äº†ï¼Œå°±åƒä¸­å­¦æ—¶ä½¿ç”¨çš„æ‘˜æŠ„æœ¬ï¼Œ å¦‚æœä¸å¯¹æ‘˜æŠ„è¿›è¡Œåˆ†ç±»ï¼Œä¸æ—¶å¸¸å»ç¿»çœ‹ï¼Œæ‘˜æŠ„çš„å†…å®¹æ˜¯ä¸ä¼šè¢«å®Œæ•´åœ°å­˜å‚¨åˆ°è®°å¿†å½“ä¸­ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¯»ä¹¦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ã€Šå¦‚ä½•æœ‰æ•ˆé˜…è¯»ä¸€æœ¬ä¹¦:è¶…å®ç”¨è¯»ä¹¦ç¬”è®°æ³•ã€‹è¯»ä¹¦ç¬”è®°</title>
    <link href="/%E3%80%8A%E5%A6%82%E4%BD%95%E6%9C%89%E6%95%88%E9%98%85%E8%AF%BB%E4%B8%80%E6%9C%AC%E4%B9%A6%EF%BC%9A%E8%B6%85%E5%AE%9E%E7%94%A8%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%E6%B3%95%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html"/>
    <url>/%E3%80%8A%E5%A6%82%E4%BD%95%E6%9C%89%E6%95%88%E9%98%85%E8%AF%BB%E4%B8%80%E6%9C%AC%E4%B9%A6%EF%BC%9A%E8%B6%85%E5%AE%9E%E7%94%A8%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%E6%B3%95%E3%80%8B%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0.html</url>
    
    <content type="html"><![CDATA[<p>ä¹°å®ŒKindleè¯»çš„ç¬¬ä¸‰æœ¬ä¹¦ï¼Œä½œè€…çš„è§‚ç‚¹éƒ¨åˆ†é€‚ç”¨äºç°åœ¨çš„æˆ‘ï¼Œå¯èƒ½æ˜¯ç”±äºç¯å¢ƒçš„ä¸åŒï¼ˆä½œè€…åœ¨æ—¥æœ¬ï¼‰ã€‚<br>ä½œè€…æå€¡ä½¿ç”¨çº¸è´¨ç¬”è®°æœ¬æ¥è®°å½•è¯»ä¹¦ç¬”è®°ï¼Œä½†æ˜¯å¯¹äºä¸€ä¸ªå‡ºé—¨ä¸å–œæ¬¢èƒŒåŒ…çš„äººæ¥è¯´ï¼Œè¿™å¾ˆmuli~<br>åŸæ–‡å¯¹äºå¦‚ä½•é€‰ä¹¦ã€è´­ä¹¦è¯´äº†å¾ˆå¤šï¼Œå¯¹äºå¦‚ä½•è®°ç¬”è®°çš„å†…å®¹ä¸å¤ªå¤šï¼Œä¸è¿‡ï¼Œè¿˜æ˜¯å¾ˆæœ‰å‚è€ƒä»·å€¼ã€‚</p><a id="more"></a><table><thead><tr><th>ä¹¦å</th><th>ä½œè€…</th><th>å¼€å§‹æ—¶é—´</th><th>ç»“æŸæ—¶é—´</th></tr></thead><tbody><tr><td>å¦‚ä½•æœ‰æ•ˆé˜…è¯»ä¸€æœ¬ä¹¦ï¼šè¶…å®ç”¨è¯»ä¹¦ç¬”è®°æ³•</td><td>å¥¥é‡å®£ä¹‹</td><td>2017.01.11</td><td>2017.01.15</td></tr></tbody></table><h1 id="ä¸€ã€è´­ä¹¦"><a href="#ä¸€ã€è´­ä¹¦" class="headerlink" title="ä¸€ã€è´­ä¹¦"></a>ä¸€ã€è´­ä¹¦</h1><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/17-1-15/34562477-file_1484461118342_161ce.jpg"></p><p>â˜†åªæœ‰ä»æ—¥å¸¸ç”Ÿæ´»ä¸­å–æï¼Œæ‰èƒ½åˆ—å‡ºåæ˜ è‡ªå·±çœŸæ­£éœ€æ±‚çš„è´­ä¹¦æ¸…å•ã€‚</p><p>â˜… ä¹¦å•å†…å®¹æ¥æºäºç”Ÿæ´»ï¼Œå¯èƒ½æ˜¯åˆ«äººçš„æ¨èã€ä¹Ÿå¯èƒ½æ˜¯å®£ä¼ ã€æˆ–è€…è‡ªå·±è„‘æµ·ä¸­è¹¦å‡ºçš„å…³é”®è¯ã€‚æ”¶é›†è¿™äº›å†…å®¹ï¼Œè¿™æ ·åˆ°äº†ä¹¦åº—ï¼Œåœ¨ä¹¦æµ·ä¸­å°±ä¸ä¼šèŒ«ç„¶è‹¥å¤±ï¼Œä¸çŸ¥é“æƒ³è¦ä¹°äº›ä»€ä¹ˆæ ·çš„ä¹¦äº†ã€‚<strong>æœ‰ç›®çš„åœ°é€›ä¹¦åº—ï¼Œä¹°è‡ªå·±æƒ³è¦çš„ä¹¦</strong></p><h1 id="äºŒã€å¦‚ä½•åšè¯»ä¹¦ç¬”è®°"><a href="#äºŒã€å¦‚ä½•åšè¯»ä¹¦ç¬”è®°" class="headerlink" title="äºŒã€å¦‚ä½•åšè¯»ä¹¦ç¬”è®°"></a>äºŒã€å¦‚ä½•åšè¯»ä¹¦ç¬”è®°</h1><h2 id="1-åšæŒåšè¯»ä¹¦ç¬”è®°"><a href="#1-åšæŒåšè¯»ä¹¦ç¬”è®°" class="headerlink" title="1)åšæŒåšè¯»ä¹¦ç¬”è®°"></a>1)åšæŒåšè¯»ä¹¦ç¬”è®°</h2><p>â˜† 2013å¹´8æœˆ5æ—¥ï¼Œæˆ‘è¯»äº†ã€ŠXXXXã€‹ã€‚è¿™æœ¬ä¹¦æ¯”æˆ‘æƒ³è±¡ä¸­æœ‰æ„æ€ã€‚  </p><p>å¦‚æœå†™å¾—è¿™æ ·ç®€å•ï¼Œå°±æ›´å®¹æ˜“åšæŒä¸‹å»äº†.ç¬¬ä¸€æ­¥è¦åšåˆ°çš„å°±æ˜¯åšæŒä¸‹å»ï¼Œæ¯«ä¸å¤¸å¼ åœ°è¯´ï¼Œåªæœ‰åšæŒä¸‹å»ï¼Œè¯»ä¹¦ç¬”è®°æ‰èƒ½å‘æŒ¥ä½œç”¨ã€‚è¯»ä¹¦æ—¶åº”è¯¥æ—¶åˆ»è®°å¾—è¿™ä¸ªç›®çš„ï¼Œæ­£ç¡®åœ°å¯¹å¾…å†™è¯»ä¹¦ç¬”è®°è¿™ä»¶äº‹ã€‚  </p><p>äººä»¬ç»å¸¸è¯´â€œä½ ä¸ºåˆ«äººè®²è§£ä¹¦ä¸­çš„å†…å®¹æ—¶ï¼Œæ‰ä¼šçœŸæ­£ç†è§£å®ƒã€‚â€æŠŠè®°è¯»ä¹¦ç¬”è®°ä½œä¸ºç›®æ ‡å»è¯»ä¹¦ï¼Œå¾—åˆ°çš„æ•ˆæœä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚å½“ä½ <strong>ä»¥æ€æƒ³è¾“å‡ºä¸ºå‰æ</strong>å»è¯»ä¹¦æ—¶ï¼Œæ€æƒ³è¾“å…¥çš„è´¨é‡ä¹Ÿä¼šæœ‰æ‰€æå‡ï¼Œè€Œä¸”äº²æ‰‹å†™æ–‡ç« çš„å¥½å¤„æ¯”å£å¤´å™è¿°è¦å¤šã€‚</p><p>â˜… åˆšå¼€å§‹å­¦ä¹ åšè¯»ä¹¦ç¬”è®°æ—¶ï¼Œä¸å¿…è‹›åˆ»è‡ªå·±è¦åšå¾—å¤šä¹ˆå¥½ï¼Œæ€»ç»“å¾—å¤šä¹ˆå¦™ï¼Œæœ€å¼€å§‹çš„æ—¶å€™ï¼Œæœ€é‡è¦çš„æ˜¯åŸ¹å…»è‡ªå·±åšè¯»ä¹¦ç¬”è®°çš„ä¹ æƒ¯ã€‚è¯»ä¹¦ç¬”è®°ä¸»è¦æ˜¯å¯¹è‡ªå·±è¯»ä¹¦çš„ä¸€ç§æ€»ç»“ï¼Œå¸æ”¶ä¹¦ä¸­çš„ç²¾åï¼Œè€Œå¹¶éæ˜¯ä¸ºäº†ä»–äººè€Œå†™ã€‚</p><h2 id="2-è¯»ä¹¦ç¬”è®°ä»ä¸€å¥è¯å¼€å§‹"><a href="#2-è¯»ä¹¦ç¬”è®°ä»ä¸€å¥è¯å¼€å§‹" class="headerlink" title="2)è¯»ä¹¦ç¬”è®°ä»ä¸€å¥è¯å¼€å§‹"></a>2)è¯»ä¹¦ç¬”è®°ä»ä¸€å¥è¯å¼€å§‹</h2><p>â˜† ä¹¦å†™è¿™ä¸€åŠ¨ä½œï¼Œä¹Ÿæœ‰æ•´ç†è‡ªå·±æƒ³æ³•çš„å«ä¹‰ã€‚  </p><p>ä¸¾ä¸ªä¾‹å­ï¼Œè¯»å®Œå†’é™©é¢˜æçš„çºªå®æ–‡å­¦ä»¥åï¼Œå°±ä¼šæƒ³åœ¨è¯»ä¹¦ç¬”è®°é‡Œå†™ä¸Šâ€œ<strong>è¿™ä¸ªäººçœŸå‰å®³</strong>â€ã€‚ä½ æ‹¿èµ·ç¬”æ—¶ï¼Œä¼šæƒ³åˆ°ã€‚ç­‰ä¸€ä¸‹ï¼Œä¸å†™ä¸Šè¿™ä¸ªäººæ˜¯å“ªé‡Œå‰å®³ã€ä¸ºä»€ä¹ˆå‰å®³çš„è¯ï¼Œä¸‹æ¬¡å†è¯»åˆ°è¿™å¥è¯æ—¶ä¼šçœ‹ä¸æ‡‚å§â€ï¼Œäºæ˜¯ä½ ä¼šè¿™æ ·å†™<br>ä½œè€…çš„ä½“åŠ›å’Œç²¾ç¥æ‰¿å—åŠ›éƒ½å¤ªå¼ºäº†ã€‚æ™®é€šäººåœ¨å¤±æ˜åä¸€å®šä¼šæ„Ÿåˆ°ç»æœ›ï¼Œå°±ç®—ä»–æ¯”ä¸€èˆ¬äººå¼ºå£®ï¼Œåœ¨è¿™æ ·çš„ç¯å¢ƒä¸‹ä¹Ÿå¾ˆéš¾ç”Ÿè¿˜ã€‚ä¸ºä»€ä¹ˆä½œè€…å¯ä»¥å¦‚æ­¤åšå¼º?  </p><p>æœ¬æ¥åªæƒ³å†™ä¸€å¥è¯ï¼Œå´æŠŠè‡ªå·±çš„æ„Ÿå—ä¸€è‚¡è„‘å„¿åœ°å†™äº†ä¸‹æ¥ï¼Œå¹¶ç”±æ­¤å±•å¼€æ€è€ƒï¼Œè¯»ä¹¦ç¬”è®°å°±è¿™æ ·å……å®äº†èµ·æ¥ã€‚</p><p>â˜… ä¸€ç¯‡ä¸Šä¸‡å­—çš„æ–‡ç« ä¹Ÿæ˜¯ä»ä¸€å¥è¯å¼€å§‹çš„ï¼Œä¸Šç™¾ä¸‡å­—çš„å°è¯´å¯èƒ½ä¹Ÿåªæ˜¯é€šè¿‡ä¸€ä»½ä¸è¿‡åƒå­—çš„å¤§çº²é€æ¸æ‰©å±•è€Œæ¥ã€‚ä¸æ€•å†™ä¸å‡ºä¸€ä¸‡å­—çš„é•¿æ–‡ï¼Œåªæ€•è¿ä¸€å¥æœ€æœ€ç®€å•çš„è¯éƒ½ä¸å†™ã€‚</p><h2 id="3-æ— æ³•åšæŒåšç¬”è®°çš„åŸå› "><a href="#3-æ— æ³•åšæŒåšç¬”è®°çš„åŸå› " class="headerlink" title="3)æ— æ³•åšæŒåšç¬”è®°çš„åŸå› "></a>3)æ— æ³•åšæŒåšç¬”è®°çš„åŸå› </h2><p>â˜† éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåƒä¸‡ä¸è¦ä¸ºäº†åšæŒå†™è¯»ä¹¦ç¬”è®°è€Œèµ°å½¢å¼ä¸»ä¹‰ã€‚ä¸ç®¡é‡‡ç”¨ä»€ä¹ˆæ–¹å¼ï¼Œéƒ½è¦è¸å®åœ°å†™ç¬”è®°ï¼Œå¹¶çœŸæ­£ç†è§£ä¹¦çš„å†…å®¹ã€‚</p><p>â˜… å¹¶éå¦‚ä½œè€…æ‰€è¯´ï¼Œæˆ‘ä»¬ä¸å¯èƒ½çœŸæ­£ç†è§£æ‰€æœ‰è¯»è¿‡çš„ä¹¦çš„å†…å®¹ï¼Œä½†æ˜¯å†™ç¬”è®°ä¸€å®šè¦è¸å®åœ°å»åšä¾¿æ˜¯ã€‚</p><h1 id="ä¸‰-åšç¬”è®°çš„æ­¥éª¤"><a href="#ä¸‰-åšç¬”è®°çš„æ­¥éª¤" class="headerlink" title="ä¸‰) åšç¬”è®°çš„æ­¥éª¤"></a>ä¸‰) åšç¬”è®°çš„æ­¥éª¤</h1><h2 id="1-é’ˆå¯¹çº¸è´¨ä¹¦"><a href="#1-é’ˆå¯¹çº¸è´¨ä¹¦" class="headerlink" title="1) é’ˆå¯¹çº¸è´¨ä¹¦"></a>1) é’ˆå¯¹çº¸è´¨ä¹¦</h2><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/17-1-15/68426691-file_1484463761370_db52.jpg"></p><p>â˜… åˆšå¼€å§‹è®¤ä¸ºè¿™æ ·æ˜¯å¯¹äºä¹¦çš„ä¸€ç§ä¸çˆ±æŠ¤çš„è¡¨ç°ï¼Œç°åœ¨æ‰è§‰å¾—å…¶å®è¿™ä¹ˆåšçš„æ–¹å¼å¹¶æ²¡æœ‰å¤šä¹ˆä¸å¥½ï¼Œå‰ææ˜¯ä¹¦çš„ä¸»äººæ˜¯è‡ªå·±ã€‚ä¸å…¶çœ‹è¿‡ä¸€éå°±æ‰”æ‰æˆ–è€…å†ä¹Ÿä¸çœ‹ï¼›ä¸å¦‚è®©çœ‹è¿‡çš„ä¹¦ç•™ä¸‹è‡ªå·±è¯»è¿‡çš„ç—•è¿¹ï¼Œæ›´å¥½çš„å¸æ”¶ä¹¦ä¸­çš„å†…å®¹ã€‚</p><h2 id="2-é’ˆå¯¹ç”µå­ä¹¦Kindle"><a href="#2-é’ˆå¯¹ç”µå­ä¹¦Kindle" class="headerlink" title="2) é’ˆå¯¹ç”µå­ä¹¦Kindle"></a>2) é’ˆå¯¹ç”µå­ä¹¦Kindle</h2><p>â˜… ä»¥ä¸‹é’ˆå¯¹Kindleçš„éƒ¨åˆ†ä¸ºä¸ªäººæ€»ç»“ï¼Œä¹¦ä¸­å¹¶æœªæåŠã€‚</p><h3 id="1-é€šè¯»"><a href="#1-é€šè¯»" class="headerlink" title="1.é€šè¯»:"></a>1.é€šè¯»:</h3><p>æŠŠè¯»èµ·æ¥è§‰å¾—ä¸é”™çš„é‚£ä¸€é¡µçš„ä¸­é—´éƒ¨åˆ†çš„ä¸¤ä¸ªå­—åŠ å…¥ç¬”è®°ã€ç¬”è®°å†…å®¹ä¸º1ï¼ˆ1åªæ˜¯åšçš„ä¸€ä¸ªæ ‡è®°ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/17-1-15/26283815-file_1484464293276_bf8f.png">  </p><p>ç”±äºKindleåœ¨æ·»åŠ ç¬”è®°æ—¶ä¼šåŒæ—¶æ’å…¥ä¸€æ¡ç¬”è®°å’Œä¸€æ¡æ ‡æ³¨è®°å½•ã€æ‰€ä»¥éœ€è¦åˆ é™¤æ ‡è®°é‚£æ¡è®°å½•ã€‚åˆ é™¤ç¬¬ä¸€æ¡è®°å½•ã€ä¿ç•™ç¬”è®°å†…å®¹ä¸º1çš„è®°å½•ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/17-1-15/18334103-file_1484464451004_11366.png"></p><h3 id="2-é‡è¯»"><a href="#2-é‡è¯»" class="headerlink" title="2.é‡è¯»"></a>2.é‡è¯»</h3><p>è¯»å®Œä¸€éä¹‹åï¼Œå†æŠŠç¬”è®°åˆ—è¡¨ä¸­çš„å‡ é¡µé‡æ–°è¯»ä¸€éã€‚å¦‚æœä»ç„¶è§‰å¾—å¾ˆå¥½ï¼Œæ·»åŠ ä¹¦ç­¾</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/17-1-15/61173486-file_1484464665024_11516.png"></p><h3 id="3-æ ‡è®°"><a href="#3-æ ‡è®°" class="headerlink" title="3.æ ‡è®°"></a>3.æ ‡è®°</h3><p>å†é‡æ–°è¯»ä¸€éåŠ æœ‰ä¹¦ç­¾çš„å‡ é¡µï¼Œå¦‚æœç¬¬ä¸‰æ¬¡é˜…è¯»åä»ç„¶è§‰å¾—å€¼å¾—ä¸€è¯»ï¼Œå°±ç”¨æ ‡è®°åŠŸèƒ½åœ¨ä¸Šé¢åšè®°å·ã€‚<br>æœ€åç•™ä¸‹æ¥çš„å°±æ˜¯ä½ è®¤ä¸ºæœ€æœ‰ç”¨çš„éƒ¨åˆ†äº†ã€‚è¿™ä¸€é¡µä¸Šä¼šæœ‰é€šè¯»æ­¥éª¤çš„ç¬”è®°è®°å½•ã€æœ‰é‡è¯»æ­¥éª¤åŠ çš„ä¹¦ç­¾ã€æœ‰æ ‡è®°æ­¥éª¤æ—¶åˆ’çš„æ ‡è®°ã€‚</p><p>å¯ä»¥é€šè¿‡<a href="http://kmate.me/cn/">Kindle Mate</a>è¿™ä¸ªè½¯ä»¶å°†æ ‡è®°çš„å†…å®¹å¯¼å‡ºæ¥ï¼Œä¾¿äºåšè¯»ä¹¦ç¬”è®°ã€‚è¯»ä¹¦ç¬”è®°å¯ä»¥ç”¨æœ‰é“äº‘ç¬”è®°ï¼Œä¸ªäººä½¿ç”¨æœ‰é“äº‘çš„Markdownåšç¬”è®°ï¼Œå¦‚æœæƒ³ä¿å­˜Kindleç”µå­ä¹¦ä¸­çš„å›¾ç‰‡ï¼Œå¯ä»¥æŒ‰ä½å·¦ä¸‹è§’å’Œå³ä¸Šè§’è¿›è¡Œæˆªå›¾ï¼Œä¼šè‡ªåŠ¨ä¿å­˜ï¼Œè¿æ¥ç”µè„‘åKindelæ‰€åœ¨ç›˜çš„æ ¹ç›®å½•å¯ä»¥æ‰¾åˆ°ã€‚</p><h1 id="å››-è‘±é²”-wei-é”…å¼è¯»ä¹¦ç¬”è®°"><a href="#å››-è‘±é²”-wei-é”…å¼è¯»ä¹¦ç¬”è®°" class="headerlink" title="å››)è‘±é²”[wÄ›i]é”…å¼è¯»ä¹¦ç¬”è®°"></a>å››)è‘±é²”[wÄ›i]é”…å¼è¯»ä¹¦ç¬”è®°</h1><p>â˜† <strong>è‘±é²”ç«é”…å¼è¯»ä¹¦ç¬”è®°=æ‘˜æŠ„+è¯„è®º</strong><br>å†™è¯»ä¹¦ç¬”è®°ä¹‹å‰æ³¨æ„çš„ä¸‰ä¸ªäº‹é¡¹:</p><ol><li><p>  å†™è¯»ä¹¦ç¬”è®°çš„æ—¥æœŸ</p></li><li><p>  ä¹¦å</p></li><li><p>ä½œè€…å  </p><p>  é™¤äº†ä»¥ä¸Šä¸‰ä¸ªè¦ç´ ã€ä¹Ÿå¯ä»¥åŠ ä¸Šä»¥ä¸‹ä¸¤ä¸ªè¦ç´ ã€‚</p></li><li><p>  å¯¹è‡ªå·±æ¥è¯´é‡è¦çš„å†…å®¹ï¼ˆæ‘˜æŠ„ï¼‰</p></li><li><p>  è‡ªå·±å¯¹è¿™ç¯‡æ–‡ç« çš„æ„Ÿæƒ³ï¼ˆè¯„è®ºï¼‰  </p></li></ol><p>æ­¥éª¤:</p><ol><li>å†™ä¸Šæ—¥æœŸï¼Œæ¯æ¬¡æ¢è¡Œéƒ½è¦ç•™ä¸€è¡Œç©ºç™½ï¼Œè€Œæ¯ä¸ªæ®µè½ä¹‹é—´ç•™ä¸¤è¡Œç©ºç™½ï¼Œä¾¿äºæ—¥åé‡è¯»ã€æ’å…¥æ–‡å­—å’Œæ›´æ­£ä¿®æ”¹ã€‚</li><li>æ‘˜æŠ„å’Œå†™è¯„è®ºï¼Œé‡è¯»åšè¿‡è®°å·çš„å†…å®¹ï¼Œä¸¥æ ¼ç­›é€‰å‡ºè‡ªå·±è®¤ä¸ºå¯ä»¥å¤šè¯»å‡ éçš„éƒ¨åˆ†ã€æœ€ååœ¨æ‘˜æŠ„å®Œçš„æ–‡ç« åé¢ç•™å‡ºä¸€äº›ç©ºç™½ï¼Œå†™ä¸Šè‡ªå·±çš„è¯„è®ºã€‚æ‘˜æŠ„éƒ¨åˆ†ç”¨â˜†è¡¨ç¤ºï¼Œè€Œç”¨è‡ªå·±è¯­è¨€è¡¨è¾¾çš„æ„Ÿæƒ³å’Œè¡¥å……è¯´æ˜åˆ™æ ‡ä¸Šâ˜…ä»¥æ­¤ä½œä¸ºåŒºåˆ†ï¼Œäº¤æ›¿æ ‡åœ¨æ¯ä¸ªæ®µè½å‰ã€‚</li></ol><h1 id="äº”-ç¤ºä¾‹"><a href="#äº”-ç¤ºä¾‹" class="headerlink" title="äº”)ç¤ºä¾‹"></a>äº”)ç¤ºä¾‹</h1><p>ã€080715ã€‘ã€Šå†³å®šäººç±»æœªæ¥çš„50ä»¶äº‹ã€‹/æ°è¥¿å¡Â·å¨å»‰å§†æ–¯/è‰æ€ç¤¾  </p><p>â˜†è‡ªæ€è€…ä¸­æœ‰ä¸‰åˆ†ä¹‹äºŒæ˜¯å› ä¸ºæŠ‘éƒã€‚(P180)  </p><p>â˜…ä½œè€…è¯´ï¼Œä¸–ç•Œä¸Šçš„è‡ªæ€è€…æ¯”åœ¨æˆ˜äº‰ä¸­æ­»å»çš„äººè¿˜è¦å¤šã€‚äººç±»åœ¨æˆ˜äº‰å¹³ä»£ä¼šæ­»äº¡ï¼Œåœ¨å’Œå¹³å¹´ä»£ä¹Ÿä¼šæ­»äº¡ï¼ŒçœŸæ˜¯ä¸å®¹æ˜“ã€‚</p><p>â˜†æ‰€è°“å¥´éš¶ï¼Œå°±æ˜¯è¢«å‰¥å¤ºäº†äººæƒçš„äººã€‚å³ä½¿æ˜¯è¿™æ ·ï¼Œå¥´éš¶ç¤¾ä¼šä¸­ä¹Ÿå­˜åœ¨å¯¹å¾…å¥´éš¶äººæ€§åŒ–çš„æƒ…å†µï¼Œå¥´éš¶ä»¬åœ¨é¥¥é¥¿æˆ–è€…ç”Ÿç—…çš„æ—¶å€™æ˜¯å¯ä»¥ä¸å·¥ä½œçš„ã€‚ä½†åœ¨ç°ä»£ç¤¾ä¼šã€å¥´éš¶å°±æ˜¯ä¸€æ¬¡æ€§çš„è´¢äº§ï¼Œè¢«è´±ä¹°è´±å–ã€‚</p><p>â˜…ä»¥å‰çš„å¥´éš¶æ˜¯é•¿æœŸé›‡ä½£åˆ¶ï¼Œè€Œç°åœ¨çš„åˆ™æ˜¯å› ä¸ºæŠµæŠ¼è´·æ¬¾è€Œè¢«äººèº«ä¹°å–ã€‚ä¸ºäº†äº‹åä¸ç•™éº»çƒ¦ï¼Œå¥´éš¶ä»¬è¢«é€å»åšåˆåŒå·¥æˆ–é›¶å·¥ï¼Œè¢«ä»»æ„é©±ä½¿ã€‚ä¸€ä¸ªäººæ´»åœ¨ä¸–ä¸Šï¼Œæœ€ä¸å¯æˆ–ç¼ºçš„åˆ°åº•æ˜¯äººæƒè¿˜æ˜¯é‡‘é’±å‘¢?</p><p>â€œâ˜†â€ã€‚åé¢æ˜¯æ‘˜æŠ„ã€‚æ³¨æ„ä¸è¦çœç•¥ï¼Œè¦ä¿æŒåŸæ±åŸå‘³ã€‚</p><p>â€œâ˜…â€åé¢åˆ™æ˜¯è‡ªå·±çš„è¯„è®ºï¼Œå†™ä¸€äº›å¯¹æ‘˜æŠ„å†…å®¹çš„æ„Ÿæƒ³</p><p>å¹¶éæ‰€æœ‰çš„ä¹¦éƒ½è¦æŒ‰ç…§è¿™ç§æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ ¹æ®å¯¹ä½œå“çš„é‡è§†ç¨‹åº¦æ”¹å˜ç¬”è®°çš„å†™æ³•</p><p>æ¯”å¦‚åƒâ€œæ–‡ä»¶æ•´ç†æŠ€å·§â€ä¸€ç±»çš„çº¯å®ç”¨æŠ€å·§ä¹¦ã€å¯ä»¥ä¸å»æ‘˜æŠ„ï¼Œè€Œæ˜¯åªæ ‡è®°â€œâ˜…â€å¹¶æ€»ç»“è¦ç‚¹ã€‚å¦‚æœæ˜¯å°è¯´ç­‰ä¼‘é—²è¯»ç‰©ï¼Œå¯ä»¥ç›´æ¥åˆ†æ¡ä¹¦å†™è‡ªå·±å¯¹è¿™æœ¬ä¹¦çš„æ„Ÿæƒ³ã€‚</p><h1 id="å…­-å¯»æ‰¾æœ€å…·ä»£è¡¨æ€§çš„è¯­å¥"><a href="#å…­-å¯»æ‰¾æœ€å…·ä»£è¡¨æ€§çš„è¯­å¥" class="headerlink" title="å…­)å¯»æ‰¾æœ€å…·ä»£è¡¨æ€§çš„è¯­å¥"></a>å…­)å¯»æ‰¾æœ€å…·ä»£è¡¨æ€§çš„è¯­å¥</h1><ol><li>â˜† åªæœ‰è®©è‡ªå·±æ„ŸåŠ¨çš„æ®µè½æ‰å€¼å¾—æ‘˜æŠ„ï¼Œä¸€å®šæ˜¯æ‘˜æŠ„è®©è‡ªå·±å¿ƒåŠ¨çš„è¯­å¥ã€‚</li><li>å¦ä¸€æ–¹é¢ï¼Œé€‰æ‹©æ‘˜æŠ„æ®µè½æ—¶ï¼Œä¸æ˜¯æ‰¾è®©äººè§‰å¾—â€œç†åº”å¦‚æ­¤â€çš„æ–‡ç« ï¼Œè€Œæ˜¯è§‰å¾—â€œè¿™ä¹ˆä¸€è¯´ç¡®å®æœ‰é“ç†â€çš„å†…å®¹ã€‚</li></ol><p>è¯»è¿‡ä¸€æœ¬ä¹¦ä»¥åï¼Œå¯¹ä¹¦ä¸­å†…å®¹æ„ŸåŒèº«å—å›ºç„¶è®©äººå¿ƒæƒ…æ„‰æ‚¦ï¼Œä½†è¿™ä¹Ÿä»£è¡¨è¿™æ¬¡è¯»ä¹¦æ²¡æœ‰ç»™ä½ å¸¦æ¥æ–°ä¸œè¥¿ã€‚ç›¸åï¼Œå¦‚æœä¸€ç¯‡æ–‡ç« é¢ è¦†äº†ä½ ä¹‹å‰çš„æƒ³æ³•ï¼Œä½¿ä½ çš„è®¤è¯†å‘ç”ŸåŠ¨æ‘‡ï¼Œåœ¨æŠ„å†™å’Œé‡è¯»çš„è¿‡ç¨‹ä¸­ä»ç„¶ä¼šè®©äººä¿¡æœæˆ–æ˜¯æ„Ÿè§‰éœ‡æ’¼ï¼Œè¿™ç§æ–‡ç« æ‰æ˜¯å€¼å¾—æ‘˜æŠ„çš„ã€‚</p><h1 id="ä¸ƒ-æ¿€å‘æ€æƒ³çš„ç«èŠ±"><a href="#ä¸ƒ-æ¿€å‘æ€æƒ³çš„ç«èŠ±" class="headerlink" title="ä¸ƒ)æ¿€å‘æ€æƒ³çš„ç«èŠ±"></a>ä¸ƒ)æ¿€å‘æ€æƒ³çš„ç«èŠ±</h1><p>â˜† åœ¨æ‘˜æŠ„çš„åŒæ—¶ï¼Œé™„ä¸Šè‡ªå·±çš„æ„Ÿæƒ³å’Œæ€è€ƒï¼ŒæŠŠä½œè€…çš„è¯å’Œè‡ªå·±çš„è¯æ”¾åœ¨ä¸€èµ·ï¼Œæ„Ÿå—è½å·®ã€‚å¥½ä¸»æ„ä¸ä¼šå‡­ç©ºå‡ºç°ã€‚ä¸è®ºæ˜¯ä»€ä¹ˆæƒ³æ³•ï¼Œéƒ½ä¸€å®šæ˜¯å¯¹æŸç§åˆºæ¿€åšå‡ºçš„å›åº”ã€‚<br>åªæœ‰åœ¨è¯»å®Œä¹¦åå¯¹ä¹¦ä¸­å†…å®¹åšå‡ºååº”ï¼Œè¿›è¡Œä¸»åŠ¨æ€è€ƒï¼Œæ‰èƒ½çœŸæ­£æŒæ¡è¿™æœ¬ä¹¦çš„å†…å®¹ã€‚  </p><p>ä¸¤ä¸ªæ¦‚å¿µ</p><p>â€œå¸å–ç²¾åâ€:åŸå°ä¸åŠ¨åœ°å¸å–ä¹¦ä¸Šçš„çŸ¥è¯†ã€‚</p><p>â€œè¯»ä¹¦ä½“éªŒâ€:</p><p>  â— â€œä¹¦ä¸Šå†™çš„è¿™äº›ï¼Œæˆ‘æ˜¯è¿™ä¹ˆç†è§£çš„â€</p><p>  â— â€œä»¥æ­¤ä¸ºå¥‘æœºï¼Œæˆ‘æƒ³åˆ°äº†ä¸€ä»¶äº‹â€¦â€¦â€</p><p>â˜… æ²¡æœ‰ä¸»åŠ¨æ€è€ƒçš„é˜…è¯»ï¼Œä¹¦ä¸­çš„å†…å®¹è¢«æŒæ¡çš„æå…¶æœ‰é™ï¼Œç”šè‡³äºæœªè¯»è¿‡ä¸€æ ·ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¯»ä¹¦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç‚¹å‡»æŒ‰é’®æ‹·è´ä»£ç çš„å®ç°</title>
    <link href="/%E7%82%B9%E5%87%BB%E6%8C%89%E9%92%AE%E6%8B%B7%E8%B4%9D%E4%BB%A3%E7%A0%81%E7%9A%84%E5%AE%9E%E7%8E%B0.html"/>
    <url>/%E7%82%B9%E5%87%BB%E6%8C%89%E9%92%AE%E6%8B%B7%E8%B4%9D%E4%BB%A3%E7%A0%81%E7%9A%84%E5%AE%9E%E7%8E%B0.html</url>
    
    <content type="html"><![CDATA[<p>ä¾‹å­ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/Mosiki/blog-imgs/blog/20170216/071218636.png"></p><hr><p>1ã€ headä¸­å¼•å…¥ä¸€ä¸ªjs <code>clipboard.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">&lt;script src=<span class="hljs-string">&quot;//cdn.bootcss.com/clipboard.js/1.5.15/clipboard.js&quot;</span>&gt;&lt;/script&gt;<br></code></pre></div></td></tr></table></figure><p>2ã€åˆå§‹åŒ–å¯¹è±¡</p><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript">&lt;script type=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;<br><span class="hljs-keyword">new</span> Clipboard(<span class="hljs-string">&#x27;.btn&#x27;</span>);<span class="hljs-comment">//æ­¤å¤„btnæ˜¯copyæŒ‰é’®çš„id</span><br>&lt;/script&gt;<br></code></pre></div></td></tr></table></figure><p>3ã€ä½¿ç”¨copy</p><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;col-lg-6 col-md-8 col-sm-8&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;form-control&quot;</span>  <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;murl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;murl&#125;&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn&quot;</span> <span class="hljs-attr">data-clipboard-target</span>=<span class="hljs-string">&quot;#murl&quot;</span> &gt;</span>å¤åˆ¶<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-comment">&lt;!--</span><br><span class="hljs-comment">data-clipboard-target è¦å¤åˆ¶çš„ç›®æ ‡</span><br><span class="hljs-comment">--&gt;</span><br></code></pre></div></td></tr></table></figure><h4 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h4><blockquote><p><a href="http://clipboardjs.52fhy.com/">http://clipboardjs.52fhy.com/</a></p></blockquote>]]></content>
    
    
    
    <tags>
      
      <tag>JS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Onsæ¶ˆæ¯é˜Ÿåˆ—</title>
    <link href="/Ons%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97.html"/>
    <url>/Ons%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97.html</url>
    
    <content type="html"><![CDATA[<h2 id="Onsæ¶ˆæ¯é˜Ÿåˆ—"><a href="#Onsæ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="Onsæ¶ˆæ¯é˜Ÿåˆ—"></a>Onsæ¶ˆæ¯é˜Ÿåˆ—</h2><p><strong>å‰å¼•ï¼šå…¬å¸é¡¹ç›®éœ€è¦å†™ä¸€ä¸ªæ¨å¹¿ç³»ç»Ÿï¼Œæ¨å¹¿ç³»ç»Ÿæ˜¯ä¸€ä¸ªé¡¹ç›®ï¼Œå’Œä¸»é¡¹ç›®åˆ†ç¦»ï¼Œé¡¹ç›®é—´çš„é€šä¿¡ä½¿ç”¨Onsæ¥å®Œæˆï¼Œä»¥ä¸‹æ˜¯å…¬å¸ä»£ç ç•¥å¾®ä¿®æ”¹çš„ç»“æœï¼Œä»¥ä¾›å‚è€ƒã€‚</strong></p><a id="more"></a><blockquote><p>æœ¯è¯­ï¼š</p><p>Producerï¼šæ¶ˆæ¯ç”Ÿäº§è€…ï¼Œè´Ÿè´£äº§ç”Ÿæ¶ˆæ¯ï¼Œä¸€èˆ¬ç”±ä¸šåŠ¡ç³»ç»Ÿè´Ÿè´£äº§ç”Ÿæ¶ˆæ¯ã€‚</p><p>Consumerï¼šæ¶ˆæ¯æ¶ˆè´¹è€…ï¼Œè´Ÿè´£æ¶ˆè´¹æ¶ˆæ¯ï¼Œä¸€èˆ¬æ˜¯åå°ç³»ç»Ÿè´Ÿè´£å¼‚æ­¥æ¶ˆè´¹ã€‚</p><p>Producer IDï¼šä¸€ç±» Producer çš„é›†åˆåç§°ï¼Œè¿™ç±» Producer é€šå¸¸å‘é€ä¸€ç±»æ¶ˆæ¯ï¼Œä¸å‘é€é€»è¾‘ä¸€è‡´ã€‚</p><p>Consumer IDï¼šä¸€ç±» Consumer çš„é›†åˆåç§°ï¼Œè¿™ç±» Consumer é€šå¸¸æ¶ˆè´¹ä¸€ç±»æ¶ˆæ¯ï¼Œä¸æ¶ˆè´¹é€»è¾‘ä¸€è‡´ã€‚</p><p>å¹¿æ’­æ¶ˆè´¹ï¼šä¸€æ¡æ¶ˆæ¯è¢«å¤šä¸ª Consumer æ¶ˆè´¹ï¼Œå³ä½¿è¿™äº› Consumer å±äºåŒä¸€ä¸ª Consumer IDï¼Œæ¶ˆæ¯ä¹Ÿä¼šè¢« Consumer IDä¸­çš„æ¯ä¸ª Consumer éƒ½æ¶ˆè´¹ä¸€æ¬¡ï¼Œå¹¿æ’­æ¶ˆè´¹ä¸­çš„ Consumer ID æ¦‚å¿µå¯ä»¥è®£ä¸ºåœ¨æ¶ˆæ¯åˆ’åˆ†æ–¹é¢æ— æ„ä¹‰ã€‚</p><p>é›†ç¾¤æ¶ˆè´¹ï¼šä¸€ä¸ª Consumer ID ä¸­çš„ Consumer å®ä¾‹å¹³å‡åˆ†æ‘Šæ¶ˆè´¹æ¶ˆæ¯ã€‚ ä¾‹å¦‚æŸä¸ª Topic æœ‰ 9 æ¡æ¶ˆæ¯ï¼Œ å…¶ä¸­ä¸€ä¸ª ConsumerId æœ‰ 3 ä¸ªå®ä¾‹ï¼ˆå¯èƒ½æ˜¯ 3 ä¸ªè¿›ç¨‹ï¼Œæˆ–è€… 3 å°æœºå™¨ï¼‰ ï¼Œé‚£ä¹ˆæ¯ä¸ªå®ä¾‹åªæ¶ˆè´¹å…¶ä¸­çš„ 3 æ¡æ¶ˆæ¯</p></blockquote><ul><li><p>å¼•å…¥ä¾èµ–</p><ul><li>Mavenæ–¹å¼</li></ul><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.aliyun.openservices<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>ons-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></div></td></tr></table></figure><ul><li><p>jaråŒ…æ–¹å¼</p><p><code>http://onsall.oss-cn-hangzhou.aliyuncs.com/aliyun-ons-client-java.tar.gz</code></p></li></ul></li></ul><hr><h2 id="ä¸€ã€å‘é€æ¶ˆæ¯"><a href="#ä¸€ã€å‘é€æ¶ˆæ¯" class="headerlink" title="ä¸€ã€å‘é€æ¶ˆæ¯"></a>ä¸€ã€å‘é€æ¶ˆæ¯</h2><h3 id="1ã€åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­é…ç½®-Topicã€Producer-IDï¼Œ-Consumer-ID"><a href="#1ã€åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­é…ç½®-Topicã€Producer-IDï¼Œ-Consumer-ID" class="headerlink" title="1ã€åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­é…ç½® Topicã€Producer IDï¼Œ Consumer ID"></a>1ã€åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°çš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­é…ç½® Topicã€Producer IDï¼Œ Consumer ID</h3><h3 id="2ã€åˆ›å»ºOnsæ¶ˆæ¯ç”Ÿäº§è€…"><a href="#2ã€åˆ›å»ºOnsæ¶ˆæ¯ç”Ÿäº§è€…" class="headerlink" title="2ã€åˆ›å»ºOnsæ¶ˆæ¯ç”Ÿäº§è€…"></a>2ã€åˆ›å»ºOnsæ¶ˆæ¯ç”Ÿäº§è€…</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProducerService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IProducerService</span> </span>&#123;<br><br><span class="hljs-keyword">private</span> Producer producer;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sendMessage</span><span class="hljs-params">(String topic, String tag, String content)</span> </span>&#123;<br><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-keyword">byte</span>[] bytes = content.getBytes(<span class="hljs-string">&quot;UTF-8&quot;</span>);<br>Message msg = <span class="hljs-keyword">new</span> Message(topic, tag, bytes);<br><br>SendResult sendResult = producer.send(msg);<br>System.out.println(<span class="hljs-string">&quot;SendMessageIng... topic:&quot;</span> + topic + <span class="hljs-string">&quot; tag:&quot;</span> + tag + <span class="hljs-string">&quot; &quot;</span>+ sendResult);<br>&#125; <span class="hljs-keyword">catch</span> (UnsupportedEncodingException e) &#123;<br>e.printStackTrace();<br>&#125;<br><br>&#125;<br><br><span class="hljs-meta">@PostConstruct</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>&#123;<br>Properties properties = <span class="hljs-keyword">new</span> Properties();<br>                <span class="hljs-comment">//PropertyKeyConst æ˜¯Onså®˜æ–¹å®šä¹‰çš„å¸¸é‡</span><br>               <span class="hljs-comment">//éœ€è¦åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°åˆ›å»º AccessKeyï¼ŒSecretKey</span><br>properties.put(PropertyKeyConst.ProducerId, ProducerConstants.PRODUCERID_PCHOME);<br>              <span class="hljs-comment">//PRODUCERID_PCHOMEæ˜¯åœ¨æ§åˆ¶å°é…ç½®Topic çš„ Producer ID</span><br>properties.put(PropertyKeyConst.AccessKey, ProducerConstants.ACCESSID);<br>properties.put(PropertyKeyConst.SecretKey, ProducerConstants.ACCESSKEY);<br>producer = ONSFactory.createProducer(properties);<br><br><span class="hljs-comment">// åœ¨å‘é€æ¶ˆæ¯å‰ï¼Œå¿…é¡»è°ƒç”¨startæ–¹æ³•æ¥å¯åŠ¨Producerï¼Œåªéœ€è°ƒç”¨ä¸€æ¬¡å³å¯ã€‚</span><br>producer.start();<br>&#125;<br><br><span class="hljs-meta">@PreDestroy</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destory</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-comment">// åœ¨åº”ç”¨é€€å‡ºå‰ï¼Œé”€æ¯Producerå¯¹è±¡</span><br><span class="hljs-comment">// æ³¨æ„ï¼šå¦‚æœä¸é”€æ¯ä¹Ÿæ²¡æœ‰é—®é¢˜</span><br>producer.shutdown();<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="3ã€åˆ›å»ºå‘é€æ¶ˆæ¯ç±»"><a href="#3ã€åˆ›å»ºå‘é€æ¶ˆæ¯ç±»" class="headerlink" title="3ã€åˆ›å»ºå‘é€æ¶ˆæ¯ç±»"></a>3ã€åˆ›å»ºå‘é€æ¶ˆæ¯ç±»</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-keyword">import</span> net.minidev.json.JSONObject;<br><span class="hljs-keyword">import</span> com.aliyun.openservices.ons.api.Action;<br><span class="hljs-keyword">import</span> com.aliyun.openservices.ons.api.ConsumeContext;<br><span class="hljs-keyword">import</span> com.aliyun.openservices.ons.api.Message;<br><span class="hljs-keyword">import</span> com.aliyun.openservices.ons.api.MessageListener;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OnsService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IOnsService</span>, <span class="hljs-title">MessageListener</span>  </span>&#123;<br><br><span class="hljs-meta">@Resource</span><br><span class="hljs-keyword">private</span> IProducerService producerService;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String TOPIC = <span class="hljs-string">&quot;TopicTestONS&quot;</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String TOPIC_TAG = <span class="hljs-string">&quot;TagA&quot;</span>;<br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Action <span class="hljs-title">consume</span><span class="hljs-params">(Message message, ConsumeContext context)</span> </span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sendBindObject</span><span class="hljs-params">(<span class="hljs-keyword">int</span> uid, <span class="hljs-keyword">int</span> tid, <span class="hljs-keyword">int</span> eid, String pageUrl)</span> </span>&#123;<br>JSONObject json = <span class="hljs-keyword">new</span> JSONObject();<br>json.put(<span class="hljs-string">&quot;uid&quot;</span>, uid);<br>json.put(<span class="hljs-string">&quot;tid&quot;</span>, tid);<br>json.put(<span class="hljs-string">&quot;eid&quot;</span>, eid);<br>json.put(<span class="hljs-string">&quot;pageUrl&quot;</span>, pageUrl);<br>producerService.sendMessage(TOPIC, TOPIC_TAG, json.toJSONString());<br>      <span class="hljs-comment">//ç¬¬ä¸‰ä¸ªå‚æ•°å°±æ˜¯éœ€è¦å‘é€çš„å†…å®¹ï¼Œå…¬å¸ä½¿ç”¨çš„Json</span><br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><hr><h2 id="äºŒã€è®¢é˜…æ¶ˆæ¯"><a href="#äºŒã€è®¢é˜…æ¶ˆæ¯" class="headerlink" title="äºŒã€è®¢é˜…æ¶ˆæ¯"></a>äºŒã€è®¢é˜…æ¶ˆæ¯</h2><h3 id="1ã€åˆ›å»ºOnsæ¶ˆæ¯æ¶ˆè´¹è€…"><a href="#1ã€åˆ›å»ºOnsæ¶ˆæ¯æ¶ˆè´¹è€…" class="headerlink" title="1ã€åˆ›å»ºOnsæ¶ˆæ¯æ¶ˆè´¹è€…"></a>1ã€åˆ›å»ºOnsæ¶ˆæ¯æ¶ˆè´¹è€…</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-meta">@Lazy(value=false)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConsumerService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IConsumerService</span> </span>&#123;<br><span class="hljs-keyword">private</span> Consumer consumer;<br><br><span class="hljs-meta">@PostConstruct</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>&#123;<br>System.out.println(<span class="hljs-string">&quot;init....&quot;</span>);<br>Properties properties = <span class="hljs-keyword">new</span> Properties();<br>properties.put(PropertyKeyConst.ConsumerId, ConsumerConstants.CONSUMERID);<br>properties.put(PropertyKeyConst.AccessKey,ConsumerConstants.ACCESSID);<br>properties.put(PropertyKeyConst.SecretKey,ConsumerConstants.ACCESSKEY);<br>properties.put(PropertyKeyConst.MessageModel,PropertyValueConst.CLUSTERING);<br>consumer = ONSFactory.createConsumer(properties);<br>consumer.start();<br>&#125;<br><br>        <span class="hljs-comment">//MessageListener æ˜¯é˜¿é‡ŒOnsåŒ…å†…çš„æ¶ˆæ¯ç›‘å¬å™¨</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String topic, <span class="hljs-keyword">final</span> String subExpression,</span></span><br><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span> MessageListener listener)</span> </span>&#123;<br>consumer.subscribe(topic, subExpression, listener);<br>&#125;<br><br><span class="hljs-meta">@PreDestroy</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">desotry</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">if</span> (consumer != <span class="hljs-keyword">null</span>) &#123;<br>consumer.shutdown();<br>&#125;<br>&#125;<br><br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="2ã€åˆ›å»ºæ¶ˆè´¹æ¶ˆæ¯ç±»"><a href="#2ã€åˆ›å»ºæ¶ˆè´¹æ¶ˆæ¯ç±»" class="headerlink" title="2ã€åˆ›å»ºæ¶ˆè´¹æ¶ˆæ¯ç±»"></a>2ã€åˆ›å»ºæ¶ˆè´¹æ¶ˆæ¯ç±»</h3><figure class="highlight java"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OnsConsumerService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">IOnsConsumerService</span> </span>&#123;<br><span class="hljs-meta">@Resource</span><br><span class="hljs-keyword">private</span> IConsumerService consumerService;<br> <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String TOPIC = <span class="hljs-string">&quot;TopicTestONS&quot;</span>;<br><br><span class="hljs-meta">@PostConstruct</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>&#123;<br>System.out.println(<span class="hljs-string">&quot;starting...&quot;</span>);<br>onsConsumerService.subscribe(TOPIC, <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-keyword">new</span> MessageListener() &#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Action <span class="hljs-title">consume</span><span class="hljs-params">(Message message, ConsumeContext context)</span> </span>&#123;<br>JSONObject parse = (JSONObject) JSONValue.parse(message.getBody());<br><span class="hljs-keyword">int</span> uid = JsonUtil.getInt(parse, <span class="hljs-string">&quot;uid&quot;</span>);<br><span class="hljs-keyword">int</span> tid = JsonUtil.getInt(parse, <span class="hljs-string">&quot;tid&quot;</span>);<br><span class="hljs-keyword">int</span> eid = JsonUtil.getInt(parse, <span class="hljs-string">&quot;eid&quot;</span>);<br>String pageUrl = JsonUtil.getString(parse, <span class="hljs-string">&quot;pageUrl&quot;</span>);<br><br>System.out.println(uid + tid + eid + pageUrl);<br><span class="hljs-keyword">return</span> Action.CommitMessage;<br>&#125;<br>&#125;);<br>&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ä»¥ä¸Šä¸ºOnsçš„é›†ç¾¤è®¢é˜…æ¶ˆæ¯ä»£ç ã€‚</p><blockquote><p>å‚è€ƒï¼š</p><p>Onså®˜æ–¹æ–‡æ¡£</p><p><a href="http://onsteam.oss-cn-hangzhou.aliyuncs.com/ALIYUN_ONS_USER_GUIDE.pdf">http://onsteam.oss-cn-hangzhou.aliyuncs.com/ALIYUN_ONS_USER_GUIDE.pdf</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å·¥ä½œæŠ€æœ¯æ€»ç»“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ons</tag>
      
      <tag>æ¶ˆæ¯é˜Ÿåˆ—</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
